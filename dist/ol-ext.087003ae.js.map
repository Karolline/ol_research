{"version":3,"sources":["dist/ol-ext.js"],"names":["window","ol","ext","inherits","child","parent","prototype","Object","create","constructor","NodeList","forEach","Array","Element","remove","parentNode","removeChild","Ajax","options","call","_auth","auth","set","dataType","get","ajax","success","on","e","response","error","send","url","data","self","encode","encodeURI","parameters","index","hasOwnProperty","undefined","encodeURIComponent","_request","abort","XMLHttpRequest","open","setRequestHeader","dispatchEvent","type","onload","status","JSON","parse","statusText","jqXHR","onerror","element","tagName","elt","document","createTextNode","html","appendChild","createElement","test","setAttribute","attr","className","trim","innerHTML","setStyle","style","addListener","checked","setHTML","appendText","text","eventType","fn","split","addEventListener","removeListener","removeEventListener","show","display","hide","hidden","getStyle","toggle","el","st","s","styleProp","value","defaultView","ownerDocument","getComputedStyle","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","left","oldRsLeft","runtimeStyle","pixelLeft","parseInt","outerHeight","offsetHeight","outerWidth","offsetWidth","offsetRect","rect","getBoundingClientRect","top","pageYOffset","documentElement","scrollTop","body","pageXOffset","scrollLeft","height","bottom","width","widtth","right","scrollDiv","pos","speed","d","dt","onmove","page","vertical","scroll","querySelectorAll","i","ondragstart","Date","classList","add","delta","mousewheel","contains","Math","max","min","wheelDelta","detail","getMapCanvas","map","canvas","getViewport","getElementsByClassName","querySelector","after","getSize","frameState","pixelRatio","sphere","getDistance","c1","c2","radius","Sphere","haversineDistance","getArea","getLength","control","CanvasBase","Control","setMap","getCanvas","oldmap","getMap","_listener","Observable","unByKey","renderSync","_draw","bind","getContext","ctx","context","c","_style","Style","getStroke","t","setStroke","Stroke","color","getFill","setFill","Fill","getTextStroke","getText","Text","getTextFill","getTextFont","getFont","setFont","console","warn","SelectBase","_features","setFeatures","features","target","preventDefault","content","btInfo","doSelect","setSources","source","unset","Collection","getFeatures","operationsList","_escape","_checkCondition","f","condition","usecase","val","rex","op","RegExp","_selectFeatures","result","conditions","all","length","isok","k","push","removeAt","getSources","sources","layers","l","getLayers","getSource","Vector","matchAll","useCase","getArray","Search","typing","_classname","classNames","button","label","focus","listElements","input","drawList_","inputLabel","innerText","tout","cur","_input","placeholder","doSearch","li","key","nextElementSibling","previousElementSibling","setTimeout","blur","_handleSelect","_list","getAttribute","clearTimeout","autocomplete","auto","noCollapse","activeElement","reverse","tyoe","class","title","click","ul","getTitle","copy","minLength","maxItems","maxHistory","restoreHistory","_handleClick","getInputField","name","search","_triggerCustomEvent","reverseGeocode","coordinate","eventName","event","CustomEvent","createEvent","initCustomEvent","setInput","select","hist","fstr","stringify","splice","unshift","pop","saveHistory","_history","localStorage","removeItem","clearHistory","getHistory","cback","equalFeatures","currentTarget","SearchJSON","location","protocol","parser","href","_ajax","authentication","resp","_callback","log","arguments","handleResponse","requestData","q","SearchPhoton","lang","position","p","properties","housenumber","street","postcode","city","country","limit","view","getView","pt","geom","Point","getCenter","transform","getProjection","getCoordinates","lon","lat","f1","f2","geometry","coordinates","proj","reverseData","coord","lonlat","SearchGeoportail","apiKey","request","xls","xml","Number","x","y","fulltext","String","insee","zipcode","kind","number","maximumResponses","results","classification","searchCommune","LayerSwitcher","dcount","show_progress","oninfo","onextent","hasextent","extent","hastrash","trash","reordering","_layers","displayInLayerSwitcher","switcherClass","collapsed","overflow","mouseover","topv","botv","panel_","stopPropagation","header_","drawDelay","tip","up","down","info","plus","layer","drawPanel","change","moveend","size","getLayerGroup","viewChange","isOpen","setHeader","dir","h","hp","dh","offsetTop","lh","round","_setLayerForLI","_getLayerForLI","testLayerVisibility","drawPanel_","dragging_","drawList","switchLayerVisibility","setVisible","getVisible","res","getResolution","getMaxResolution","getMinResolution","ex0","getExtent","ex","calculateExtent","intersects","dragOrdering_","start","panel","pageY","pageY0","touches","changedTouches","dragElt","group","stop","drop","collection","j","insertAt","move","abs","offsetLeft","opacity","elementFromPoint","clientX","clientY","dragOpacity_","pageX","setOpacity","setVisibility","onInfo","zoomExtent","fit","removeLayer","layer_buttons","unselectable","userSelect","nb","Tile","setprogress_","layerswitcher_progress","offsetX","getOpacity","ul2","VectorTile","Image","Heatmap","loaded","loading","draw","toFixed","Bar","classes","filter","apply","toggleOne","autoDeactivate","controls_","controls","addControl","getControls","setPosition","setTarget","onActivateControl_","getActive","active","deactivateControls","except","setActive","getActiveControls","b","ctrls","sb","ctrl","n","getControlsByName","Button","bt","button_","evtFunction","handleClick","firstElementChild","setTitle","setHtml","getButtonElement","CanvasAttribution","Attribution","setCanvas","isCanvas_","setCollapsed","visibility","map_","font_","stroke","fill","fontStrokeStyle_","asString","getColor","fontFillStyle_","fontStrokeWidth_","getWidth","render","ScaleLine","drawAttribution_","slice","textContent","ratio","save","scale","eltRect","mapRect","sc","translate","clientHeight","w","clientWidth","beginPath","strokeStyle","fillStyle","lineWidth","textAlign","textBaseline","font","strokeText","fillText","closePath","restore","CanvasScaleLine","scaleHeight_","drawScale_","olscale","strokeStyle_","strokeWidth_","fillStyle_","scalewidth","CanvasTitle","CenterPosition","projection","_format","coordinateFormat","toStringXY","Compass","rotateWithView","image","img_","src","defaultCompass_","da_","cos","PI","sin","r","r2","moveTo","lineTo","draw2","globalCompositeOperation","arc","rotate","compass","rot","viewState","rotation","m","drawImage","Dialog","zoom","close","form","submit","_onButton","closeBox","hideOnClick","setContent","buttons","inputs","Disable","stylesOptions","background","keys","styleKey","isOn","disableMap","EditBar","interactions","_source","_interactions","_setSelectInteraction","edition","_setEditInteraction","_setModifyInteraction","Delete","removeInteraction","ModifySelect","addInteraction","getInteraction","_getTitle","option","sbar","selectCtrl","interaction","del","delete","evt","selected","deselected","mapBrowserEvent","clear","Info","Select","events","sel","Toggle","bar","autoActivate","DrawPoint","Draw","pedit","DrawLine","geometryFunction","setCoordinates","LineString","nbpts","ledit","TextButton","UndoDraw","removeLastPoint","FinishDraw","finishDrawing","DrawPolygon","concat","Polygon","_setDrawPolygon","DrawHole","DrawRegular","sides","regular","div","getSides","setSides","fedit","ModifyFeature","Transform","addCondition","shiftKeyOnly","Split","Offset","offset","Gauge","title_","gauge_","v","val_","GeoBookmark","menu","addBookmark","namespace","editable","setBookmarks","marks","bmark","modify","bm","setCenter","setZoom","permanent","removeBookmark","getBookmarks","getZoom","GeolocationBar","GeolocationDraw","followTrack","minAccuracy","_geolocBt","onToggle","pause","setFollowTrack","centerBt","centerLabel","startBt","pauseBt","following","Globe","opt_options","align","pointer_","ovmap_","Map","View","center","updateSize","follow","extentLayer","Circle","addLayer","setView","getGlobe","getPixelFromCoordinate","animate","Graticule","Projection","code","getMetersPerUnit","fac","maxResolution","Infinity","step","stepCoord","spacing","margin","borderWidth","formatCoord","resolution","bbox","getCoordinateFromPixel","xmax","xmin","ymax","ymin","step2","ds","floor","hasLines","hasText","hasBorder","clip","txt","p0","p1","tf","fillColor","GridReference","property","getFeatureName","sortFeatures","indexTitle","source_","setIndex","once","getState","filterLabel","a","charAt","sort","searchKeyupFunction","nextAll","children","htmlElement","nextVisible","feat","getReference","getGeometry","getFirstCoordinate","li_title","li_ref_name","span_name","span_ref","feature","coords","dx","dy","fromCharCode","boundingExtent","lw","Imageline","collapsible","_setScrolling","_scrolldiv","getImage","_getImage","maxFeatures","linkColor","hover","useExtent","refresh","_drawLink","isCollapsed","collapse","getFeaturesInExtent","_moving","current","_select","_iline","addImage","img","parseFloat","IsochroneGeoportail","_addSearchCtrl","setMethod","setMode","setDirection","_success","_error","method","_search","mode","direction","iter","unit","toLonLat","graphName","exclusions","time","distance","smoothing","holes","iteration","format","WKT","readFeature","wktGeometry","dataProjection","featureProjection","LayerPopup","LayerSwitcherImage","preview","getPreview","Legend","_imgElement","_tableElement","_rows","addRow","row","removeRow","getRow","table","col","paddingLeft","has","DEVICE_PIXEL_RATIO","append","getStyleImage","theCanvas","vectorContext","toContext","typeGeom","Feature","setProperties","getType","cx","cy","sx","sy","getAnchor","anchor","si","extend","drawGeometry","MapZone","maps","zones","z","transformExtent","centerOnClick","DOM","TOM","DOMTOM","Notification","contentElement","what","duration","Node","Overlay","_timeout","cb","insertBefore","firstChild","center_","visible","showImage","setClass","vis","Overview","minZoom","maxZoom","toggleMap","oview_","elasticFn","bounce","amplitude","pow","Pointer","handleDownEvent","panAnimation","elasticPan","easing","getOverviewMap","calcExtent_","getRotation","res2","setGeometry","addFeature","setRotation","mapExtent","getZoomForResolution","Permalink","replaceState_","urlReplace","fixed_","fixed","hash_","_localStorage","linkto","onclick","getLink","setUrlReplace","viewChange_","search_","hash","layerChange_","getLayerByLink","id","param","resetLayers","getUrlParams","setUrlParam","getUrlParam","decodeURIComponent","hasUrlParam","layerStr_","host","pathname","history","replaceState","origin","Print","print","imageType","quality","orientation","immediate","assign","fillRect","globalAlpha","tr","orient","toDataURL","imageWidth","imageHeight","Profil","click_touchstart_function","div_inner","canvas_","styles","div_to_canvas","onMove","margin_","ytitle","xtitle","bar_","cursor_","popup_","cellPadding","cellSpacing","firstTr","div_zmin","zmin","div_zmax","zmax","div_distance","div_time","secondTr","div_altitude","altitude","div_distance2","div_time2","tab_","popup","box_canvas","clientTop","clientLeft","scale_","dy_","parentElement","altitudeUnits","distanceUnitsKM","isShown","g","setTransform","clearRect","getLayout","dist2d","p2","getTime","t0","t1","ti","trunc","mn","distanceUnitsM","grad","graduation","ceil","nbgrad","scx","scy","zunit","setLineDash","encoderOptions","RoutingGeoportail","listElt","addSearch","carlabel","pedlabel","runlabel","calculate","resultElement","addButton","removeSearch","removeControl","olsearch","nextSibling","startlabel","ctrlKey","shiftKey","steps","end","waypoints","destination","listRouting","routing","dist","iElement","route","legs","points","instruction","navInstruction","distanceMeters","durationSeconds","distanceT","durationT","path","onsuccess","Scale","readOnly","setScale","ppi","_showScale","px","formatScale","toLocaleString","setResolution","SearchBAN","SearchDFCI","fromDFCI","level","dfci","toDFCI","substring","SearchFeature","getSearchString","setSource","att","SearchGPS","geolocation","Geolocation","trackingOptions","maximumAge","enableHighAccuracy","timeout","setTracking","dms","_createForm","onchange","lond","lonm","lons","latd","latm","lats","toStringHDMS","Event","createInput","gps","getPosition","SearchGeoportailParcelle","_inputParcelle","prefix","section","numero","autocompleteParcelle","activateParcelle","_listParcelle","_commune","selectCommune","pageSize","setParcelle","Commune","CommuneAbsorbee","Section","Numero","complete","commune","searchParcelle","jsonResp","DOMParser","xmlDoc","parseFromString","parcelles","getElementsByTagName","parc","node","childNodes","nodeValue","json","attributes","_listParc","showPage","na","INSEE","_handleParcelle","fromLonLat","SearchNominatim","polygon","viewbox","bounded","display_name","join","icon","addressdetails","polygon_geojson","SearchWikipedia","desc","setLang","action","uri","prop","exintro","explaintext","piprop","redirects","titles","query","pages","extract","original","pageid","_ul","_all","label_match_all","allLabel","_useCase","label_case_sensitive","caseLabel","addLabel","_conditions","attrPlaceHolder","valuePlaceHolder","_drawlist","getConditions","setConditions","cond","getConditionsString","_getLiCondition","_autocomplete","getProperties","initEvent","input_attr","ul_autocomplete","input_value","div_delete","removeCondition","SelectCheck","defaultLabel","_selectAll","selectAll","_onchoice","onchoice","setValues","_checks","values","vals","addCheck","SelectCondition","_check","setCondition","SelectFulltext","placeHolder","SelectMulti","_container","_controls","remveControl","SelectPopup","Status","Storymap","dataset","layerX","layerY","originalEvent","chapter","scrollto","currentDiv","setChapter","Swipe","precomposeRight_","precomposeRight","precomposeLeft_","precomposeLeft","postcompose_","postcompose","rightLayers","un","isLayer_","isMoving","getTargetElement","Target","RegularShape","radius1","radius2","snapToPixel","composite","inversePixelTransform","coordinateToPixelTransform","getVectorContext","Timeline","zoomButton","_scrollDiv","_buttons","_intervalDiv","scrollListener","date","getDate","dateStart","dateEnd","scrollTimeout","_tline","maxWidth","minDate","maxDate","setInterval","interval","getHTML","_getHTML","getFeatureDate","_getFeatureDate","endFeatureDate","_endFeatureDate","first","d2","tline","isNaN","_minDate","_maxDate","isFinite","_scale","_drawTime","line","lineHeight","fdiv","minWidth","_nbline","setDate","anim","tdiv","month","dmonth","heigth","year","getFullYear","setFullYear","dyear","setMonth","toLocaleDateString","dday","day","getMonth","indexOf","getStartDate","getEndDate","interaction_","toggleFn","subbar_","setDisable","disable","getSubBar","getDisable","disabled","oldValue","setInteraction","featureAnimation","duration_","fade_","fade","repeat_","repeat","linear","revers","easing_","hiddenStyle","drawGeom_","shadow","elapsed","imgs","getFeaturesAtPixel","getScale","getZIndex","animateFeature","fanim","animLayer","Base","useFilter","listenerKey","flashStyle","getStyleFunction","filters","getFilters","precompose","changed","isPlaying","Bounce","amplitude_","bounce_","flashGeom","clone","Drop","speed_","side_","side","angle","Fade","None","Null","Path","path_","rotate_","getLineString","dist_","dmax","dl","sqrt","atan2","Shake","horizontal_","horizontal","Show","Slide","Teleport","Throw","Zoom","zoomOut","ZoomOut","precompose_","filterRedraw_","addFilter_","filters_","listener","removeFilter_","addFilter","removeFilter","Mask","feature_","inner","fillColor_","drawFeaturePath_","out","coordinateToPixelMatrix","ll","Clip","units","keepAspectRatio","clipPath_","fx","fy","Colorize","setFilter","operation","red","green","blue","asArray","setValue","setColor","Composite","setOperation","Crop","Fold","fold","padding","fsize","drawLine_","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","grd","createRadialGradient","addColorStop","Lego","ol3","crossOrigin","pattern","setBrick","brickSize","internal_","brick","lego","createPattern","getPattern","offsetY","ctx2","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled","w2","h2","Texture","setPattern","mt","pixelToCoordinateTransform","pixelToCoordinateMatrix","CenterTouch","targetStyle","ctouch","Interaction","handleEvent","pixel","pos_","drawtarget","drawTarget_","layers_","handleMoveEvent","precomposeBind_","postcomposeBind_","setRadius","CopyPaste","_cloneFeature","_featuresSource","setDestination","silent","cut","paste","_destination","getDestination","removeFeature","addFeatures","_getSources","delFeatures","DragOverlay","_dragging","overlay","handleDragEvent","handleUpEvent","_overlays","overlays","addOverlay","ov","o","handler","removeOverlay","geometryFn","geomFn","_geometryFn","_startDrawing","_finishDrawing","_feature","getPolygon","_polygon","layersFilter","layerFilter","_current","poly","intersectsCoordinate","_polygonIndex","hole","item","newGeom","MultiPolygon","pi","appendLinearRing","LinearRing","appendPolygon","lastOKCoord","squaredClickTolerance_","clickTolerance","maxCircleCoordinates_","maxCircleCoordinates","features_","squareFn_","squareCondition","centeredFn_","centerCondition","canRotate_","canRotate","geometryName_","geometryName","white","defaultStyle","sketch_","overlayLayer_","useSpatialIndex","handleEvent_","reset","started_","sides_","startAngle","getGeom_","coord_","circle","centerPx","square_","centered_","coordPx_","fromCircle","hasrotation","dm","sign","applyTransform","g1","g2","dim","drawSketch_","metaKey","setGeometryName","drawPoint_","noclear","_eventTime","downPx_","start_","_longTouch","handleMoveEvent_","lastEvent","end_","upPx_","startCoordinate","square","centered","DrawTouch","addPoint","typeGeom_","tap","overlay_","geom_","drawSketch","drawSketchLink_","startDrawing","getGeometryType","DropFile","DragAndDrop","zone","onstop","formatConstructors_","formatConstructors","GPX","GeoJSON","IGC","KML","TopoJSON","projection_","accept_","accept","ondrop","dataTransfer","files","file","pat","match","filesize","filetype","fileextension","reader","FileReader","tryReadFeatures","readFeatures","theFile","ii","formatConstructor","readAsText","FillAttribute","_attributes","cursor","_cursor","_previousCursor","setAttributes","getAttributes","Flashlight","startColor","endColor","midColor","radGrd","FocusMap","focusBt","zIndex","draw_","lastPosition_","triangle","setImage","locStyle","ok","condition_","loc","getAccuracy","tolerance","setProjection","pause_","isPaused","accu","getAltitude","getAccuracyGeometry","containsExtent","containsCoordinate","geo","heading","getHeading","accuracy","altitudeAccuracy","getAltitudeAccuracy","getSpeed","simplify","Hover","handleMove_","setFeatureFilter","featureFilter","setLayerFilter","hitTolerance","setCursor","previousCursor_","featureFilter_","layerFilter_","forEachFeatureAtPixel","dragging","layer_","LongTouch","delay_","delay","ltouch","handleLongTouchEvent","Modify","getModifiedFeatures","featuresById","dragSegments_","getUid","modifying","_deleteCondition","snapDistance_","pixelTolerance","tolerance_","sources_","filterSplit_","_condition","primaryAction","deleteCondition","altKeyOnly","_insertVertexCondition","insertVertexCondition","always","sketchStyle","getClosestFeature","getClosestFeatureToCoordinate","ci","getClosestPoint","di","getNearestCoord","MAX_VALUE","lstring","getLineStrings","ring","lring","getLinearRings","getPolygons","getGeometries","getArcs","arcs","equal","coord1","coord2","splitAt","shift","c0","nbpt","closed","typeg","buffer","_modifiedFeatures","_removePoint","removePoint","_getModification","geoms","found","setGeometries","setArcCoordinates","ModifyTouch","_popup","Popup","popupClass","calssName","positioning","offsetBox","setPopupContent","searchDist","showDeleteBt","usePopup","_menu","getPopupContent","handleDownEvent_","handleDragEvent_","handleUpEvent_","duplicate","getFeatureAtPixel_","hit","geomType","current_","seg","v1","v2","findSegment","segment","offsetCoords","Ripple","rainDrop","riprad","ripplemap","last_map","rains","oncompose","onrain","vdelay","rnd","random","rain","oldind","half_width","half_height","newind","texture","getImageData","ripple","cur_pixel","new_pixel","_rd","_td","_newind","_mapind","putImageData","SelectCluster","pointRadius","circleMaxObjects","maxObjects","spiral","animationDuration","selectCluster_","selectCluster","wrapX","updateWhileAnimating","updateWhileInteracting","featureStyle","filter_","getLayer","cluster","pix","cf","lk","animateCluster_","listenerKey_","stylefn","easeOut","setImageStyle","drawPointGeometry","SnapGuides","getIntersectionPoint","d1","d1x","d1y","d2x","d2y","det","dist2D","enableInitialGuides_","enableInitialGuides","lineDash","overlaySource_","renderMode","prev","projExtent_","clearGuides","getGuides","getFeaturesCollection","addGuide","ortho","guideLength","generateLine","loopDir","loopCond","f0","addOrthoGuide","setDrawInteraction","drawi","setGuides","setModifyInteraction","modifyi","mod","computeGuides","selectedVertex","vertexFeature_","modifyVertex","idx","findIndex","drawEnd","snapDistance","_sketch_","link","tosplit","linkGeometry","Splitter","lastEvent_","splitSource","moving_","added_","removed_","trigger","triggerSource","triggerFeatures","onAddFeature","onChangeFeature","onRemoveFeature","intersectSegs","s1","s2","tol","x12","x34","y12","y34","r1","splitting","feaure","intersect","forEachFeatureIntersectingExtent","splitOriginal","featureAdded","featureRemoved","Synchronize","mouseout","syncMaps","handleMouseOut_","showTarget","targetOverlay_","setPositioning","hideTarget","TinkerBell","sparkle","sparkles","lastSparkle","out_","isout_","TouchCompass","opt","getCenter_","ondrag_","onDrag","alpha","drawCompass_","dpixel","traction","selection_","handles_","_filter","_handleEvent","addFn_","translateFeature","stretch","modifyCenter","noFlip","selection","setDefaultStyle","Cursors","isTouch","strokedash","fill0","bigpt","smallpt","createStyle","olstyle","im","tx","setOffsetX","bbox_","handle","constraint","some","ispt_","fromExtent","iscircle_","watchFeatures_","_featureListeners","mode_","opt_","constraint_","coordinate_","pixel_","geoms_","createEmpty","extent_","rotate0","angle_","ispt","setCenterAndRadius","getRadius","deltaX","deltaY","default","oldgeom","oldgeoms","UndoRedo","_undoStack","_redoStack","_block","_record","_defs","define","undoFn","redoFn","undo","redo","_watchSources","_watchInteractions","_sourceListener","getVectorLayers","init","vectors","_onAddRemove","blockStart","blockEnd","_interactionListener","getInteractions","_onInteraction","setattributestart","newp","oldp","newProperties","oldProperties","rotatestart","translatestart","scalestart","modifystart","oldFeature","beforesplit","deletestart","aftersplit","deleteend","_handleDo","substr","hasUndo","hasRedo","BinBase","_bindModify","_onModifyFeature","_watch","_origin","_listen","listenChange","_geomFn","getFeatureCenter","_onAddFeature","_onRemoveFeature","_onClearFeature","flatAttributes","_flatAttributes","bin","listen","getBinAt","fi","getBin","bins","getGridGeomAt","getInteriorPoint","getInteriorPoints","getFeaturesAtCoordinate","bin2","getGridFeatures","DBPedia","loader","_loaderFn","_url","_maxResolution","_lang","_limit","attributions","strategy","loadingstrategy","lastfeature","subject","querySubject","queryFilter","bindings","long","clearDBPediaStyleCache","dbPediaStyleFunction","styleCache","glyph","FontSymbol","DFCI","_calcGrid","_bbox","resolutions","proj4","defs","register","_features0","_getFeatures","_midPt","_trFeature","Delaunay","_nodes","hull","_onAddNode","_onRemoveNode","epsilon","_addTriangle","pts","flip","getNodes","getNodeSource","getNodesAt","triangles","getTrianglesAt","edges","se","listpt","testEdge","convexHull","clockwise","i1","clock","enveloppe","inCircle","flipTriangles","finserted","nodes","hull2","count","tri","mid","pt1","_ptInTriangle","pt2","tmp","getCircumCircle","x1","y1","x2","y2","x3","y3","m1","m2","b1","b2","FeatureBin","_sourceFeature","GeoImage","logo","imageCenter","imageScale","imageRotate","crop","imageCrop","mask","imageMask","_image","setCrop","canvasFunction","_imageSize","xy","naturalWidth","naturalHeight","ImageCanvas","getGeoImage","getCrop","setMask","getMask","opt_extent","usemask","Geoportail","matrixIds","tg","tilegrid","WMTS","attribution","_server","server","_gppKey","gppKey","wmts_options","serviceURL","matrixSet","tileGrid","setTileLoadFunction","tileLoadFunctionWithAuthentication","getFormat","geoportailConfig","getGPPKey","setGPPKey","setTileUrlFunction","getTileUrlFunction","args","getFeatureInfoUrl","tileCoord","getTileCoordForCoordAndResolution","tileResolution","tileExtent","getTileCoordExtent","INFO_FORMAT","getFeatureInfo","callback","tile","xhr","responseType","arrayBufferView","Uint8Array","blob","Blob","urlCreator","URL","webkitURL","imageUrl","createObjectURL","GridBin","gridProjection","setGridProjection","setSize","HexBin","_hexgrid","HexGrid","coord2hex","getHexagon","newSize","noreset","setLayout","newLayout","setOrigin","getOrigin","getHexFeatures","InseeBin","_grid","InseeGrid","getGridAtCoordinate","getGridExtent","Mapillary","now","Overpass","OSM","ATTRIBUTION","_types","way","rel","OSMXML","responseText","hasFeature","getId","existing","opt_fast","Vector3D","height_","getHfn","defaultHeight","onPostcompose_","setText","res_","animate_","animateDuration_","elapsedRatio_","toHeight_","matrix_","lineCap","getLineCap","builds","getFeature3D_","getFeatureHeight","drawFeature3D_","animating","h1","hvector_","build","measureText","strokeRect","WikiCommons","descriptionurl","user","extmetadata","LicenseShortName","meta","imageinfo","metadata","AnimatedCluster","oldcluster","clusters","animation","animationMethod","saveCluster","postanimate","sourceChanged","getClusterForFeature","stopAnimation","cA","cB","getOffsetX","getOffsetY","fontSize","getTextBaseline","setOffsetY","drawFeature","clip_","tileoptions","capabilities","originators","_originators","getTileGrid","queryable","loadCapabilities","onSuccess","onError","onFinally","getCapabilities","then","catch","finally","geopresolutions","mergeConstraints","ori","bok","config","service","tilematrix","Source","TileWMS","getGetFeatureInfoUrl","rmin","rmax","Group","setRender3D","setLayer","render3D","anchorElement","onclose","onshow","stopEvent","_elt","setPopupClass","getClassPositioning","getPositioning","setClosebox","classesPositioning","addPopupClass","removePopupClass","autoPositioning","setPositioning_","prevHTML","insertAdjacentHTML","setOffset","_tout","Magnify","mgmap_","mgview_","external_","zoomOffset","setView_","onMouseMove_","getMagMap","getEventCoordinate","Placemark","backgroundColor","contentColor","setContentColor","setBackgroundColor","setClassName","oldclass","PopupFeature","setTemplate","template","canFix","maxChar","_noselect","_template","_count","_getHtml","atts","before","maxc","setFix","fix","getFix","localString","locales","Tooltip","maximumFractionDigits","formatLength","formatArea","_interaction","_coord","setInfo","setFeature","area","measure","lower","upper","getLinearRing","Geometry","step1","x0","charCodeAt","validDFCI","validDFCICoord","graph","Dijskra","maxIteration","stepIteration","astar","candidat","weight","getEdges","getNode","addNode","wdist","from","dtotal","arrival","closestCoordinate","getLastCoordinate","running","wDistance","_resume","resume","getBestWay","getRoute","sens","getGeomCenter","N","mi","mi1","li1","ri","ri1","si1","Xi1","Yi1","isClosed","d0","v0","splitH","list","contour","createFromType","MultiLineString","MultiPoint","scribbleFill","scribbles","mls","scribble","ls","appendLineString","lines","done","scrib","nexty","l2","mline","cspline","pointsPerSeg","tension","greatCircleBearing","toRad","dest","bearing","computeDestinationPoint","phi1","lambda1","phi2","asin","lambda2","normalize","greatCircleTrack","animExtent","upAndDown","getColr","elapsedRatio","calcCSpline_","csplineGeometryRevision","getRevision","csplineOption","csplineGeometry_","GeometryCollection","g0","t1x","t2x","t1y","t2y","c3","c4","numOfSegments","size_","origin_","layout_","layout","pointy","flat","cube2hex","hex2cube","hex2offset","offset2hex","cube_round","rx","ry","rz","x_diff","y_diff","z_diff","hex_round","hex_corner","getHexagonAtCoord","hex","hex2coord","cube_distance","lerp","cube_lerp","cube_line","neighbors","hex_neighbors","cube_neighbors","cube","markup","ordering","yOrdering","attribute","equalFn","pulse","maxRadius","Chart","strokeWidth","stroke_","radius_","donutratio_","donutRatio","type_","offset_","animation_","max_","data_","colors","colors_","classic","renderChart_","getData","getSnapToPixel","setData","donuratio_","setAnimation","lineJoin","sum","a0","getChecksum","strokeChecksum","fillChecksum","recalculate","checksums_","checksum","toString","FillPattern","load","getPattern_","circles","char","patterns","dot","addPattern","FlowLine","renderer","_render","_visible","_widthFn","setWidth","setWidth2","width2","_colorFn","setColor2","color2","setLineCap","_width","_width2","cap","_lineCap","_color","_color2","_splitInto","color_","fontSize_","fontStyle_","fontStyle","fill_","form_","gradient_","gradient","glyph_","getGlyph","renderMarker_","getImagePNG","addDefs","glyphs","thefont","fontname","fonts","theme","getRotateWithView","getGlyphName","getFontInfo","renderOptions","drawMarker_","drawPath_","transfo","posX","posY","quadraticCurveTo","fcolor","scolor","createLinearGradient","glyphs_","Photo","sanchor_","shadow_","hitDetectionCanvas_","crop_","crossOrigin_","kind_","src_","onload_","renderPhoto_","CanvasRenderingContext2D","roundRect","arcTo","drawBack_","atan","drawImage_","sw","sh","drawTextPath","textPathMaxResolution_","c2p","getPath","readable","path1","path2","textPathStyle_","getTextAlign","textJustify","textOverflow","getTextOverflow","getMinWidth","textPath","setTextPathStyle","textPath_","TextPath","textOverflow_","minWidth_","dpos","getPoint","letterPadding","nbspace","wl","Shadow","blur_","renderShadow_","StrokePattern"],"mappings":"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","file":"ol-ext.087003ae.js","sourceRoot":"..","sourcesContent":["/**\n * ol-ext - A set of cool extensions for OpenLayers (ol) in node modules structure\n * @description ol3,openlayers,popup,menu,symbol,renderer,filter,canvas,interaction,split,statistic,charts,pie,LayerSwitcher,toolbar,animation\n * @version v3.1.7\n * @author Jean-Marc Viglino\n * @see https://github.com/Viglino/ol-ext#,\n * @license BSD-3-Clause\n */\n/** @namespace  ol.ext\n */\n/*global ol*/\nif (window.ol && !ol.ext) {\n  ol.ext = {};\n}\n/** Inherit the prototype methods from one constructor into another.\n * replace deprecated ol method\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function module:ol.inherits\n * @api\n */\nol.ext.inherits = function(child,parent) {\n  child.prototype = Object.create(parent.prototype);\n  child.prototype.constructor = child;\n};\n// Compatibilty with ol > 5 to be removed when v6 is out\nif (window.ol) {\n  if (!ol.inherits) ol.inherits = ol.ext.inherits;\n}\n/* IE Polyfill */\n// NodeList.forEach\nif (window.NodeList && !NodeList.prototype.forEach) {\n  NodeList.prototype.forEach = Array.prototype.forEach;\n}\n// Element.remove\nif (window.Element && !Element.prototype.remove) {\n  Element.prototype.remove = function() {\n    if (this.parentNode) this.parentNode.removeChild(this);\n  }\n}\n/* End Polyfill */\n\n/** Ajax request\n * @fires success\n * @fires error\n * @param {*} options\n *  @param {string} options.auth Authorisation as btoa(\"username:password\");\n *  @param {string} options.dataType The type of data that you're expecting back from the server, default JSON\n */\nol.ext.Ajax = function(options) {\n  options = options || {};\n\tol.Object.call(this);\n  this._auth = options.auth;\n  this.set('dataType', options.dataType || 'JSON');\n};\nol.ext.inherits(ol.ext.Ajax, ol.Object);\n/** Helper for get\n * @param {*} options\n *  @param {string} options.url\n *  @param {string} options.auth Authorisation as btoa(\"username:password\");\n *  @param {string} options.dataType The type of data that you're expecting back from the server, default JSON\n *  @param {string} options.success\n *  @param {string} options.error\n *  @param {*} options.options get options\n */\nol.ext.Ajax.get = function(options) {\n  var ajax = new ol.ext.Ajax(options);\n  if (options.success) ajax.on('success', function(e) { options.success(e.response, e); } );\n  if (options.error) ajax.on('error', function(e) { options.error(e); } );\n  ajax.send(options.url, options.data, options.options);\n};\n/** Send an ajax request (GET)\n * @fires success\n * @fires error\n * @param {string} url\n * @param {*} data Data to send to the server as key / value\n * @param {*} options a set of options that are returned in the \n *  @param {boolean} options.abort false to prevent aborting the current request, default true\n */\nol.ext.Ajax.prototype.send = function (url, data, options){\n  options = options || {};\n\tvar self = this;\n  // Url\n  var encode = (options.encode !== false) \n  if (encode) url = encodeURI(url);\n  // Parameters\n  var parameters = '';\n\tfor (var index in data) {\n\t\tif (data.hasOwnProperty(index) && data[index]!==undefined) {\n      parameters += (parameters ? '&' : '?') + index + '=' + (encode ? encodeURIComponent(data[index]) : data[index]);\n    }\n  }\n\t// Abort previous request\n\tif (this._request && options.abort!==false) {\n\t\tthis._request.abort();\n\t}\n\t// New request\n\tvar ajax = this._request = new XMLHttpRequest();\n\tajax.open('GET', url + parameters, true);\n\tif (this._auth) {\n\t\tajax.setRequestHeader(\"Authorization\", \"Basic \" + this._auth);\n\t}\n  // Load complete\n  this.dispatchEvent ({ type: 'loadstart' });\n\tajax.onload = function() {\n\t\tself._request = null;\n    self.dispatchEvent ({ type: 'loadend' });\n    if (this.status >= 200 && this.status < 400) {\n      var response;\n      // Decode response\n      try {\n        switch (self.get('dataType')) {\n          case 'JSON': {\n            response = JSON.parse(this.response);\n            break;\n          }\n          default: {\n            response = this.response;\n          }\n        }\n      } catch(e) {\n        // Error\n        self.dispatchEvent ({ \n          type: 'error',\n          status: 0,\n          statusText: 'parsererror',\n          error: e,\n          options: options,\n          jqXHR: this\n        });\n        return;\n      }\n      // Success\n      //console.log('response',response)\n      self.dispatchEvent ({ \n        type: 'success',\n        response: response,\n        status: this.status,\n        statusText: this.statusText,\n        options: options,\n        jqXHR: this\n      });\n    } else {\n      self.dispatchEvent ({ \n        type: 'error',\n        status: this.status,\n        statusText: this.statusText,\n        options: options,\n        jqXHR: this\n      });\n    }\n\t};\n\t// Oops\n\tajax.onerror = function() {\n    self._request = null;\n    self.dispatchEvent ({ type: 'loadend' });\n    self.dispatchEvent ({ \n      type: 'error',\n      status: this.status,\n      statusText: this.statusText,\n      options: options,\n      jqXHR: this\n    });\n  };\n\t// GO!\n\tajax.send();\n};\n\n/** Vanilla JS helper to manipulate DOM without jQuery\n * @see https://github.com/nefe/You-Dont-Need-jQuery\n * @see https://plainjs.com/javascript/\n * @see http://youmightnotneedjquery.com/\n */\n ol.ext.element = {};\n/**\n * Create an element\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\n * @param {*} options\n *  @param {string} options.className className The element class name \n *  @param {Element} options.parent Parent to append the element as child\n *  @param {Element|string} options.html Content of the element\n *  @param {string} options.* Any other attribut to add to the element\n */\nol.ext.element.create = function (tagName, options) {\n  options = options || {};\n  var elt;\n  // Create text node\n  if (tagName === 'TEXT') {\n    elt = document.createTextNode(options.html||'');\n    if (options.parent) options.parent.appendChild(elt);\n  } else {\n    // Other element\n    elt = document.createElement(tagName);\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\n    for (var attr in options) {\n      switch (attr) {\n        case 'className': {\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\n          break;\n        }\n        case 'html': {\n          if (options.html instanceof Element) elt.appendChild(options.html)\n          else if (options.html!==undefined) elt.innerHTML = options.html;\n          break;\n        }\n        case 'parent': {\n          options.parent.appendChild(elt);\n          break;\n        }\n        case 'style': {\n          this.setStyle(elt, options.style);\n          break;\n        }\n        case 'change':\n        case 'click': {\n          ol.ext.element.addListener(elt, attr, options[attr]);\n          break;\n        }\n        case 'on': {\n          for (var e in options.on) {\n            ol.ext.element.addListener(elt, e, options.on[e]);\n          }\n          break;\n        }\n        case 'checked': {\n          elt.checked = !!options.checked;\n          break;\n        }\n        default: {\n          elt.setAttribute(attr, options[attr]);\n          break;\n        }\n      }\n    }\n  }\n  return elt;\n};\n/** Set inner html or append a child element to an element\n * @param {Element} element\n * @param {Element|string} html Content of the element\n */\nol.ext.element.setHTML = function(element, html) {\n  if (html instanceof Element) element.appendChild(html)\n  else if (html!==undefined) element.innerHTML = html;\n};\n/** Append text into an elemnt\n * @param {Element} element\n * @param {string} text text content\n */\nol.ext.element.appendText = function(element, text) {\n  element.appendChild(document.createTextNode(text||''));\n};\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol.ext.element.addListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.addEventListener(e, fn);\n  });\n};\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol.ext.element.removeListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.removeEventListener(e, fn);\n  });\n};\n/**\n * Show an element\n * @param {Element} element\n */\nol.ext.element.show = function (element) {\n  element.style.display = '';\n};\n/**\n * Hide an element\n * @param {Element} element\n */\nol.ext.element.hide = function (element) {\n  element.style.display = 'none';\n};\n/**\n * Test if an element is hihdden\n * @param {Element} element\n * @return {boolean}\n */\nol.ext.element.hidden = function (element) {\n  return ol.ext.element.getStyle(element, 'display') === 'none';\n};\n/**\n * Toggle an element\n * @param {Element} element\n */\nol.ext.element.toggle = function (element) {\n  element.style.display = (element.style.display==='none' ? '' : 'none');\n};\n/** Set style of an element\n * @param {DOMElement} el the element\n * @param {*} st list of style\n */\nol.ext.element.setStyle = function(el, st) {\n  for (var s in st) {\n    switch (s) {\n      case 'top':\n      case 'left':\n      case 'bottom':\n      case 'right':\n      case 'minWidth':\n      case 'maxWidth':\n      case 'width':\n      case 'height': {\n        if (typeof(st[s]) === 'number') {\n          el.style[s] = st[s]+'px';\n        } else {\n          el.style[s] = st[s];\n        }\n        break;\n      }\n      default: {\n        el.style[s] = st[s];\n      }\n    }\n  }\n};\n/**\n * Get style propertie of an element\n * @param {DOMElement} el the element\n * @param {string} styleProp Propertie name\n * @return {*} style value\n */\nol.ext.element.getStyle = function(el, styleProp) {\n  var value, defaultView = (el.ownerDocument || document).defaultView;\n  // W3C standard way:\n  if (defaultView && defaultView.getComputedStyle) {\n    // sanitize property name to css notation\n    // (hypen separated words eg. font-Size)\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\n  } else if (el.currentStyle) { // IE\n    // sanitize property name to camelCase\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\n      return letter.toUpperCase();\n    });\n    value = el.currentStyle[styleProp];\n    // convert other units to pixels on IE\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \n      return (function(value) {\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\n        el.runtimeStyle.left = el.currentStyle.left;\n        el.style.left = value || 0;\n        value = el.style.pixelLeft + \"px\";\n        el.style.left = oldLeft;\n        el.runtimeStyle.left = oldRsLeft;\n        return value;\n      })(value);\n    }\n  }\n  if (/px$/.test(value)) return parseInt(value);\n  return value;\n};\n/** Get outerHeight of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol.ext.element.outerHeight = function(elt) {\n  return elt.offsetHeight + ol.ext.element.getStyle(elt, 'marginBottom')\n};\n/** Get outerWidth of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol.ext.element.outerWidth = function(elt) {\n  return elt.offsetWidth + ol.ext.element.getStyle(elt, 'marginLeft')\n};\n/** Get element offset rect\n * @param {DOMElement} elt\n * @return {*} \n */\nol.ext.element.offsetRect = function(elt) {\n  var rect = elt.getBoundingClientRect();\n  return {\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\n    height: rect.height || (rect.bottom - rect.top),\n    width: rect.widtth || (rect.right - rect.left)\n  }\n};\n/** Make a div scrollable without scrollbar.\n * On touch devices the default behavior is preserved\n * @param {DOMElement} elt\n * @param {function} onmove a function that takes a boolean indicating that the div is scrolling\n */\nol.ext.element.scrollDiv = function(elt, options) {\n  var pos = false;\n  var speed = 0;\n  var d, dt = 0;\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\n  var page = options.vertical ? 'pageY' : 'pageX';\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\n  // Prevent image dragging\n  elt.querySelectorAll('img').forEach(function(i) {\n    i.ondragstart = function(){ return false; };\n  });\n  // Start scrolling\n  ol.ext.element.addListener(elt, ['mousedown'], function(e) {\n    pos = e[page];\n    dt = new Date();\n    elt.classList.add('ol-move');\n  });\n  // Register scroll\n  ol.ext.element.addListener(window, ['mousemove'], function(e) {\n    if (pos !== false) {\n      var delta = pos - e[page];\n      elt[scroll] += delta;\n      d = new Date();\n      if (d-dt) {\n        speed = (speed + delta / (d - dt))/2;\n      }\n      pos = e[page];\n      dt = d;\n      // Tell we are moving\n      if (delta) onmove(true);\n    } else {\n      // Not moving yet\n      onmove(false);\n    }\n  });\n  // Stop scrolling\n  ol.ext.element.addListener(window, ['mouseup'], function(e) {\n    elt.classList.remove('ol-move');\n    dt = new Date() - dt;\n    if (dt>100) {\n      // User stop: no speed\n      speed = 0;\n    } else if (dt>0) {\n      // Calculate new speed\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\n    }\n    elt[scroll] += speed*100;\n    pos = false;\n    speed = 0;\n    dt = 0;\n  });\n  // Handle mousewheel\n  if (options.mousewheel && !elt.classList.contains('ol-touch')) {\n    ol.ext.element.addListener(elt, \n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \n      function(e) {\n        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\n        elt.classList.add('ol-move');\n        elt[scroll] -= delta*30;\n        return false;\n      }\n    );\n  }\n};\n\n/** Get a canvas overlay for a map (non rotated, on top of the map)\n * @param {ol.Map} map\n * @return \n */\nol.ext.getMapCanvas = function(map) {\n  if (!map) return null;\n  var canvas = map.getViewport().getElementsByClassName('ol-fixedoverlay')[0];\n  if (!canvas && map.getViewport().querySelector('.ol-layers')) {\n    // Add a fixed canvas layer on top of the map\n    canvas = document.createElement('canvas');\n    canvas.className = 'ol-fixedoverlay';\n    map.getViewport().querySelector('.ol-layers').after(canvas);\n    // Clear before new compose\n    map.on('precompose', function (e){\n      canvas.width = map.getSize()[0] * e.frameState.pixelRatio;\n      canvas.height = map.getSize()[1] * e.frameState.pixelRatio;\n    });\n  }\n  return canvas;\n};\n  \n/* global ol */\n/* Create ol.sphere for backward compatibility with ol < 5.0\n * To use with Openlayers package\n */\nif (window.ol && !ol.sphere) {\n  ol.sphere = {};\n  ol.sphere.getDistance = function (c1, c2, radius) {\n    var sphere = new ol.Sphere(radius || 6371008.8);\n    return sphere.haversineDistance(c1, c2);\n  }\n  ol.sphere.getArea = ol.Sphere.getArea;\n  ol.sphere.getLength = ol.Sphere.getLength;\n}\n/**\n * @classdesc \n *   Attribution Control integrated in the canvas (for jpeg/png \n * @see http://www.kreidefossilien.de/webgis/dokumentation/beispiele/export-map-to-png-with-scale\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options extend the ol.control options. \n *  @param {ol.style.Style} options.style style used to draw the title.\n */\nol.control.CanvasBase = function(options) {\n  if (!options) options = {};\n  // Define a style to draw on the canvas\n  this.setStyle(options.style);\n  ol.control.Control.call(this, options);\n}\nol.ext.inherits(ol.control.CanvasBase, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {o.Map} map Map.\n * @api stable\n */\nol.control.CanvasBase.prototype.setMap = function (map) {\n  this.getCanvas(map);\n  var oldmap = this.getMap();\n  if (this._listener) {\n    ol.Observable.unByKey(this._listener);\n    this._listener = null;\n  }\n  ol.control.Control.prototype.setMap.call(this, map);\n  if (oldmap) oldmap.renderSync();\n  if (map) {\n    this._listener = map.on('postcompose', this._draw.bind(this));\n    // Get a canvas layer on top of the map\n  }\n};\n/** Get canvas overlay\n */\nol.control.CanvasBase.prototype.getCanvas = function(map) {\n  return ol.ext.getMapCanvas(map);\n};\n/** Get map Canvas\n * @private\n */\nol.control.CanvasBase.prototype.getContext = function(e) {\n  var ctx = e.context;\n  if (!ctx && this.getMap()) {\n    var c = this.getMap().getViewport().getElementsByClassName('ol-fixedoverlay')[0];\n    ctx = c ? c.getContext('2d') : null;\n  }\n  return ctx;\n};\n/** Set Style\n * @api\n */\nol.control.CanvasBase.prototype.setStyle = function(style) {\n  this._style = style ||  new ol.style.Style ({});\n};\n/** Get style\n * @api\n */\nol.control.CanvasBase.prototype.getStyle = function() {\n  return this._style;\n};\n/** Get stroke\n * @api\n */\nol.control.CanvasBase.prototype.getStroke = function() {\n  var t = this._style.getStroke();\n  if (!t) this._style.setStroke(new ol.style.Stroke ({ color:'#000', width:1.25 }));\n  return this._style.getStroke();\n};\n/** Get fill\n * @api\n */\nol.control.CanvasBase.prototype.getFill = function() {\n  var t = this._style.getFill();\n  if (!t) this._style.setFill(new ol.style.Fill ({ color:'#fff' }));\n  return this._style.getFill();\n};\n/** Get stroke\n * @api\n */\nol.control.CanvasBase.prototype.getTextStroke = function() {\n  var t = this._style.getText();\n  if (!t) t = new ol.style.Text({});\n  if (!t.getStroke()) t.setStroke(new ol.style.Stroke ({ color:'#fff', width:3 }));\n  return t.getStroke();\n};\n/** Get text fill\n * @api\n */\nol.control.CanvasBase.prototype.getTextFill = function() {\n  var t = this._style.getText();\n  if (!t) t = new ol.style.Text({});\n  if (!t.getFill()) t.setFill(new ol.style.Fill ({ color:'#fff', width:3 }));\n  return t.getFill();\n};\n/** Get text font\n * @api\n */\nol.control.CanvasBase.prototype.getTextFont = function() {\n  var t = this._style.getText();\n  if (!t) t = new ol.style.Text({});\n  if (!t.getFont()) t.setFont('12px sans-serif');\n  return t.getFont();\n};\n/** Draw the control on canvas\n * @private\n */\nol.control.CanvasBase.prototype._draw = function(/* e */) {\n  console.warn('[CanvasBase] draw function not implemented.');\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * This is the base class for Select controls on attributes values. \n * Abstract base class; \n * normally only used for creating subclasses and not instantiated in apps. \n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol.Collection<ol.Feature>} options.features a collection of feature to search in, the collection will be kept in date while selection\n *  @param {ol.source.Vector | Array<ol.source.Vector>} options.source the source to search in if no features set\n */\nol.control.SelectBase = function(options) {\n  if (!options) options = {};\n  this._features = this.setFeatures(options.features);\n  var element;\n  if (options.target) {\n    element = document.createElement(\"div\");\n  } else {\n    element = document.createElement(\"div\");\n    element.className = 'ol-select ol-unselectable ol-control ol-collapsed';\n    ol.ext.element.create('BUTTON', {\n      type: 'button',\n      on: {\n        'click touchstart': function(e) {\n          element.classList.toggle('ol-collapsed');\n          e.preventDefault();\n        }\n      },\n      parent: element\n    });\n  }\n  if (options.className) element.classList.add(options.className);\n  element.appendChild(options.content);\n  // OK button\n  ol.ext.element.create('BUTTON', {\n    html: options.btInfo || 'OK',\n    className: 'ol-ok',\n    on: { 'click touchstart': this.doSelect.bind(this) },\n    parent: options.content\n  });\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.setSources(options.source);\n};\nol.ext.inherits(ol.control.SelectBase, ol.control.Control);\n/** Set the current sources\n * @param {ol.source.Vector|Array<ol.source.Vector>|undefined} source\n */\nol.control.SelectBase.prototype.setSources = function (source) {\n  if (source) {\n    this.set ('source', (source instanceof Array) ? source : [source]);\n  } else {\n    this.unset('source');\n  }  \n};\n/** Set feature collection to search in\n * @param {ol.Collection<ol.Feature>} features\n */\nol.control.SelectBase.prototype.setFeatures = function (features) {\n  if (features instanceof ol.Collection) this._features = features;\n  else this._features = null;\n};\n/** Get feature collection to search in\n * @return {ol.Collection<ol.Feature>}\n */\nol.control.SelectBase.prototype.getFeatures = function () {\n  return this._features;\n};\n/** List of operators / translation\n * @api\n */\nol.control.SelectBase.prototype.operationsList = {\n  '=': '=',\n  '!=': '',\n  '<': '<',\n  '<=': '',\n  '>=': '',\n  '>': '>',\n  'contain': '', // \n  '!contain': '',\t// \n  'regexp': ''\n};\n/** Escape string for regexp\n * @param {string} search\n * @return {string}\n */\nol.control.SelectBase.prototype._escape = function (s) {\n  return s.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n};\n/**\n * Test if a feature check aconditino\n * @param {ol.Feature} f the feature to check condition\n * @param {Object} condition an object to use for test\n *  @param {string} condition.attr attribute name\n *  @param {string} condition.op operator\n *  @param {any} condition.val value to test\n * @param {boolean} usecase use case or not when testing strings\n * @return {boolean}\n * @private\n */\nol.control.SelectBase.prototype._checkCondition = function (f, condition, usecase) {\n  if (!condition.attr) return true;\n  var val = f.get(condition.attr);\n  var rex;\n  switch (condition.op) {\n    case '=':\n      rex = new RegExp('^'+this._escape(condition.val)+'$', usecase ? '' : 'i');\n      return rex.test(val);\n    case '!=':\n      rex = new RegExp('^'+this._escape(condition.val)+'$', usecase ? '' : 'i');\n      return !rex.test(val);\n    case '<':\n      return val < condition.val;\n    case '<=':\n      return val <= condition.val;\n    case '>':\n      return val > condition.val;\n      case '>=':\n      return val >= condition.val;\n    case 'contain':\n      rex = new RegExp(this._escape(condition.val), usecase ? '' : 'i');\n      return rex.test(val);\n    case '!contain':\n      rex = new RegExp(this._escape(condition.val), usecase ? '' : 'i');\n      return !rex.test(val);\n    case 'regexp':\n      rex = new RegExp(condition.val, usecase ? '' : 'i');\n      return rex.test(val);\n    default:\n      return false;\n  }\n};\n/** Selection features in a list of features\n * @param {Array<ol.Feature>} result the current list of features\n * @param {Array<ol.Feature>} features to test in\n * @param {Object} condition \n *  @param {string} condition.attr attribute name\n *  @param {string} condition.op operator\n *  @param {any} condition.val value to test\n * @param {boolean} all all conditions must be valid\n * @param {boolean} usecase use case or not when testing strings\n */\nol.control.SelectBase.prototype._selectFeatures = function (result, features, conditions, all, usecase) {\n  conditions = conditions || [];\n  var f;\n  for (var i=features.length-1; f=features[i]; i--) {\n    var isok = all;\n    for (var k=0, c; c=conditions[k]; k++) {\n      if (c.attr) {\n        if (all) {\n          isok = isok && this._checkCondition(f,c,usecase);\n        }\n        else {\n          isok = isok || this._checkCondition(f,c,usecase);\n        }\n      }\n    }\n    if (isok) {\n      result.push(f);\n    } else if (this._features) {\n      this._features.removeAt(i);\n    }\n  }\n  return result;\n};\n/** Get vector source\n * @return {Array<ol.source.Vector>}\n */\nol.control.SelectBase.prototype.getSources = function () {\n  if (this.get('source')) return this.get('source');\n  var sources = [];\n  function getSources(layers) {\n    layers.forEach(function(l){\n      if (l.getLayers) {\n        getSources(l.getLayers());\n      } else if (l.getSource && l.getSource() instanceof ol.source.Vector) {\n        sources.push(l.getSource());\n      }\n    });\n  }\n  if (this.getMap()) {\n    getSources(this.getMap().getLayers());\n  }\n  return sources;\n};\n/** Select features by attributes\n * @param {*} options\n *  @param {Array<ol.source.Vector>|undefined} options.sources source to apply rules, default the select sources\n *  @param {bool} options.useCase case sensitive, default false\n *  @param {bool} options.matchAll match all conditions, default false\n *  @param {Array<conditions>} options.conditions array of conditions\n * @return {Array<ol.Feature>}\n * @fires select\n */\nol.control.SelectBase.prototype.doSelect = function (options) {\n  options = options || {};\n  var features = [];\n  if (options.features) {\n    this._selectFeatures(features, options.features, options.conditions, options.matchAll, options.useCase);\n  } else if (this._features) {\n    this._selectFeatures(features, this._features.getArray(), options.conditions, options.matchAll, options.useCase);\n  } else {\n    var sources = options.sources || this.getSources();\n    sources.forEach(function(s) {\n      this._selectFeatures(features, s.getFeatures(), options.conditions, options.matchAll, options.useCase);\n    }.bind(this));\n  }\n  this.dispatchEvent({ type:\"select\", features: features });\n  return features;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search Control.\n * This is the base class for search controls. You can use it for simple custom search or as base to new class.\n * @see ol.control.SearchFeature\n * @see ol.control.SearchPhoton\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires change:input\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {boolean | undefined} options.reverse enable reverse geocoding, default false\n *  @param {string | undefined} options.inputLabel label for the input, default none\n *  @param {string | undefined} options.noCollapse prevent collapsing on input blur, default false\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms) use -1 to prevent autocompletion, default 300.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 1\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {integer | undefined} options.maxHistory maximum number of items to display in history. Set -1 if you don't want history, default maxItems\n *  @param {function} options.getTitle a function that takes a feature and return the name to display in the index.\n *  @param {function} options.autocomplete a function that take a search string and callback function to send an array\n */\nol.control.Search = function(options) {\n  var self = this;\n  if (!options) options = {};\n  if (options.typing == undefined) options.typing = 300;\n  // Class name for history\n  this._classname = options.className || 'search';\n  var classNames = (options.className||'')+ ' ol-search'\n    + (options.target ? '' : ' ol-unselectable ol-control ol-collapsed');\n  var element = ol.ext.element.create('DIV',{\n    className: classNames + ' ol-collapsed'\n  })\n  if (!options.target) {\n    this.button = document.createElement(\"BUTTON\");\n    this.button.setAttribute(\"type\", \"button\");\n    this.button.setAttribute(\"title\", options.label||\"search\");\n    this.button.addEventListener(\"click\", function() {\n      element.classList.toggle(\"ol-collapsed\");\n      if (!element.classList.contains(\"ol-collapsed\")) {\n        element.querySelector(\"input.search\").focus();\n        var listElements = element.querySelectorAll(\"li\");\n        for (var i = 0; i < listElements.length; i++) {\n          listElements[i].classList.remove(\"select\");\n        }\n        // Display history\n        if (!input.value) {\n          self.drawList_();\n        }\n      }\n    });\n    element.appendChild(this.button);\n  }\n  // Input label\n  if (options.inputLabel) {\n    var label = document.createElement(\"LABEL\");\n    label.innerText = options.inputLabel;\n    element.appendChild(label);\n  }\n  // Search input\n  var tout, cur=\"\";\n  var input = this._input = document.createElement(\"INPUT\");\n  input.setAttribute(\"type\", \"search\");\n  input.setAttribute(\"class\", \"search\");\n  input.setAttribute(\"autocomplete\", \"off\");\n  input.setAttribute(\"placeholder\", options.placeholder||\"Search...\");\n  input.addEventListener(\"change\", function(e) {\n    self.dispatchEvent({ type:\"change:input\", input:e, value:input.value });\n  });\n  var doSearch = function(e) {\n    // console.log(e.type+\" \"+e.key)'\n    var li  = element.querySelector(\"ul.autocomplete li.select\");\n    var\tval = input.value;\n    // move up/down\n    if (e.key=='ArrowDown' || e.key=='ArrowUp' || e.key=='Down' || e.key=='Up') {\n      if (li) {\n        li.classList.remove(\"select\");\n        li = (/Down/.test(e.key)) ? li.nextElementSibling : li.previousElementSibling;\n        if (li) li.classList.add(\"select\");\n      }\n      else element.querySelector(\"ul.autocomplete li\").classList.add(\"select\");\n    }\n    // Clear input\n    else if (e.type=='input' && !val) {\n      setTimeout(function(){\n        self.drawList_();\n      }, 200);\n    }\n    // Select in the list\n    else if (li && (e.type==\"search\" || e.key ==\"Enter\")) {\n      if (element.classList.contains(\"ol-control\")) input.blur();\n      li.classList.remove(\"select\");\n      cur = val;\n      self._handleSelect(self._list[li.getAttribute(\"data-search\")]);\n    }\n    // Search / autocomplete\n    else if ( (e.type==\"search\" || e.key =='Enter')\n      || (cur!=val && options.typing>=0)) {\n      // current search\n      cur = val;\n      if (cur) {\n        // prevent searching on each typing\n        if (tout) clearTimeout(tout);\n        tout = setTimeout(function() {\n          if (cur.length >= self.get(\"minLength\")) {\n            var s = self.autocomplete (cur, function(auto) { self.drawList_(auto); });\n            if (s) self.drawList_(s);\n          }\n          else self.drawList_();\n        }, options.typing);\n      }\n      else self.drawList_();\n    }\n    // Clear list selection\n    else {\n      li = element.querySelector(\"ul.autocomplete li\");\n      if (li) li.classList.remove('select');\n    }\n  };\n  input.addEventListener(\"keyup\", doSearch);\n  input.addEventListener(\"search\", doSearch);\n  input.addEventListener(\"cut\", doSearch);\n  input.addEventListener(\"paste\", doSearch);\n  input.addEventListener(\"input\", doSearch);\n  if (!options.noCollapse) {\n    input.addEventListener('blur', function() {\n      setTimeout(function(){ \n        if (input !== document.activeElement) {\n          element.classList.add('ol-collapsed');\n          this.set('reverse', false);\n          element.classList.remove('ol-revers');\n        }\n      }.bind(this), 200);\n    }.bind(this));\n    input.addEventListener('focus', function() {\n      if (!this.get('reverse')) {\n        element.classList.remove('ol-collapsed');\n        element.classList.remove('ol-revers');\n      }\n    }.bind(this));\n  }\n  element.appendChild(input);\n  // Reverse geocode\n  if (options.reverse) {\n    var reverse = ol.ext.element.create('BUTTON', {\n      tyoe: 'button',\n      class: 'ol-revers',\n      title: 'click on the map',\n      click: function() {\n        if (!this.get('reverse')) {\n          this.set('reverse', !this.get('reverse'));\n          input.focus();\n          element.classList.add('ol-revers');\n        } else {\n          this.set('reverse', false);\n        }\n      }.bind(this)\n    });\n    element.appendChild(reverse);\n  }\n  // Autocomplete list\n  var ul = document.createElement('UL');\n  ul.classList.add('autocomplete');\n  element.appendChild(ul);\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  if (typeof (options.getTitle)=='function') this.getTitle = options.getTitle;\n  if (typeof (options.autocomplete)=='function') this.autocomplete = options.autocomplete;\n  // Options\n  this.set('copy', options.copy);\n  this.set('minLength', options.minLength || 1);\n  this.set('maxItems', options.maxItems || 10);\n  this.set('maxHistory', options.maxHistory || options.maxItems || 10);\n  // History\n  this.restoreHistory();\n  this.drawList_();\n};\nol.ext.inherits(ol.control.Search, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.Search.prototype.setMap = function (map) {\n  if (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n  ol.control.Control.prototype.setMap.call(this, map);\n  if (map) {\n\t\tthis._listener = map.on('click', this._handleClick.bind(this));\n\t}\n};\n/** Get the input field\n*\t@return {Element} \n*\t@api\n*/\nol.control.Search.prototype.getInputField = function () {\n  return this._input;\n};\n/** Returns the text to be displayed in the menu\n*\t@param {any} f feature to be displayed\n*\t@return {string} the text to be displayed in the index, default f.name\n*\t@api\n*/\nol.control.Search.prototype.getTitle = function (f) {\n  return f.name || \"No title\";\n};\n/** Force search to refresh\n */\nol.control.Search.prototype.search = function () {\n  var search = this.element.querySelector(\"input.search\");\n  this._triggerCustomEvent('search', search);\n};\n/** Reverse geocode\n * @param {Object} event\n *  @param {ol.coordinate} event.coordinate\n * @private\n */\nol.control.Search.prototype._handleClick = function (e) {\n  if (this.get('reverse')) {\n    document.activeElement.blur();\n    this.reverseGeocode(e.coordinate);\n  }\n};\n/** Reverse geocode\n * @param {ol.coordinate} coord\n * @param {function | undefined} cback a callback function, default trigger a select event\n * @api\n */\nol.control.Search.prototype.reverseGeocode = function (/*coord, cback*/) {\n  // this._handleSelect(f);\n};\n/** Trigger custom event on elemebt\n * @param {*} eventName \n * @param {*} element \n * @private\n */\nol.control.Search.prototype._triggerCustomEvent = function (eventName, element) {\n  var event;\n  if (window.CustomEvent) {\n    event = new CustomEvent(eventName);\n  } else {\n    event = document.createEvent(\"CustomEvent\");\n    event.initCustomEvent(eventName, true, true, {});\n  }\n  element.dispatchEvent(event);\n};\n/** Set the input value in the form (for initialisation purpose)\n*\t@param {string} value\n*\t@param {boolean} search to start a search\n*\t@api\n*/\nol.control.Search.prototype.setInput = function (value, search) {\n  var input = this.element.querySelector(\"input.search\");\n  input.value = value;\n  if (search) this._triggerCustomEvent(\"keyup\", input);\n};\n/** A ligne has been clicked in the menu > dispatch event\n*\t@param {any} f the feature, as passed in the autocomplete\n*\t@api * @param {boolean} reverse true if reverse geocode\n*/\nol.control.Search.prototype.select = function (f, reverse) {\n  this.dispatchEvent({ type:\"select\", search:f, reverse: !!reverse });\n};\n/**\n * Save history and select\n * @param {*} f \n * @param {boolean} reverse true if reverse geocode\n * @private\n */\nol.control.Search.prototype._handleSelect = function (f, reverse) {\n  if (!f) return;\n  // Save input in history\n  var hist = this.get('history');\n  // Prevent error on stringify\n  var i;\n  try {\n    var fstr = JSON.stringify(f);\n    for (i=hist.length-1; i>=0; i--) {\n      if (!hist[i] || JSON.stringify(hist[i]) === fstr) {\n        hist.splice(i,1);\n      }\n    }\n  } catch (e) {\n    for (i=hist.length-1; i>=0; i--) {\n      if (hist[i] === f) {\n        hist.splice(i,1);\n      }\n    }\n  }\n  hist.unshift(f);\n  while (hist.length > (this.get('maxHistory')||10)) {\n    hist.pop();\n  } \n  this.saveHistory();\n  // Select feature\n  this.select(f, reverse);\n  //this.drawList_();\n};\n/** Current history */\nol.control.Search.prototype._history = {};\n/** Save history (in the localstorage)\n */\nol.control.Search.prototype.saveHistory = function () {\n  if (this.get('maxHistory')>=0) {\n    try {\n      localStorage[\"ol@search-\"+this._classname] = JSON.stringify(this.get('history'));\n    } catch (e) { /* ok */ }\n  } else {\n    localStorage.removeItem(\"ol@search-\"+this._classname);\n  }\n};\n/** Restore history (from the localstorage) \n */\nol.control.Search.prototype.restoreHistory = function () {\n  if (this._history[this._classname]) {\n    this.set('history', this._history[this._classname]);\n  } else {\n    try {\n      this._history[this._classname] = JSON.parse(localStorage[\"ol@search-\"+this._classname]);\n      this.set('history', this._history[this._classname]);\n    } catch(e) {\n      this.set('history', []);\n    }\n  }\n};\n/**\n * Remove previous history\n */\nol.control.Search.prototype.clearHistory = function () {\n  this.set('history', []);\n  this.saveHistory();\n  this.drawList_();\n};\n/**\n * Get history table\n */\nol.control.Search.prototype.getHistory = function () {\n  return this.get('history');\n};\n/** Autocomplete function\n* @param {string} s search string\n* @param {function} cback a callback function that takes an array to display in the autocomplete field (for asynchronous search)\n* @return {Array|false} an array of search solutions or false if the array is send with the cback argument (asnchronous)\n* @api\n*/\nol.control.Search.prototype.autocomplete = function (s, cback) {\n  cback ([]);\n  return false;\n  // or just return [];\n};\n/** Draw the list\n* @param {Array} auto an array of search result\n* @private\n*/\nol.control.Search.prototype.drawList_ = function (auto) {\n  var self = this;\n  var ul = this.element.querySelector(\"ul.autocomplete\");\n  ul.innerHTML = '';\n  this._list = [];\n  if (!auto) {\n    var input = this.element.querySelector(\"input.search\");\n    var value = input.value;\n    if (!value) {\n      auto = this.get('history');\n    } else {\n      return;\n    }\n    ul.setAttribute('class', 'autocomplete history');\n  } else {\n    ul.setAttribute('class', 'autocomplete');\n  }\n  var li, max = Math.min (self.get(\"maxItems\"),auto.length);\n  for (var i=0; i<max; i++) {\t\n    if (auto[i]) {\n      if (!i || !self.equalFeatures(auto[i], auto[i-1])) {\n        li = document.createElement(\"LI\");\n        li.setAttribute(\"data-search\", this._list.length);\n        this._list.push(auto[i]);\n        li.addEventListener(\"click\", function(e) {\n          self._handleSelect(self._list[e.currentTarget.getAttribute(\"data-search\")]);\n        });\n        var title = self.getTitle(auto[i]);\n        if (title instanceof Element) li.appendChild(title);\n        else li.innerHTML = title;\n        ul.appendChild(li);\n      }\n    }\n  }\n  if (max && this.get(\"copy\")) {\n    li = document.createElement(\"LI\");\n    li.classList.add(\"copy\");\n    li.innerHTML = this.get(\"copy\");\n    ul.appendChild(li);\n  }\n};\n/** Test if 2 features are equal\n * @param {any} f1\n * @param {any} f2\n * @return {boolean}\n */\nol.control.Search.prototype.equalFeatures = function (/* f1, f2 */) {\n  return false;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * This is the base class for search controls that use a json service to search features.\n * You can use it for simple custom search or as base to new class.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {any} options extend ol.control.Search options\n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 1000.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 3\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {function | undefined} options.handleResponse Handle server response to pass the features array to the list\n *\n *  @param {string|undefined} options.url Url of the search api\n *  @param {string | undefined} options.authentication: basic authentication for the search API as btoa(\"login:pwd\")\n */\nol.control.SearchJSON = function(options) {\n  options = options || {};\n  options.className = options.className || 'JSON';\n  delete options.autocomplete;\n  options.minLength = options.minLength || 3;\n  options.typing = options.typing || 800;\n  ol.control.Search.call(this, options);\n  // Handle Mix Content Warning\n  // If the current connection is an https connection all other connections must be https either\n  var url = options.url || \"\";\n  if (window.location.protocol === \"https:\") {\n    var parser = document.createElement('a');\n    parser.href = url;\n    parser.protocol = window.location.protocol;\n    url = parser.href;\n  }\n  this.set('url', url);\n  this._ajax = new ol.ext.Ajax({ dataType:'JSON', auth: options.authentication });\n  this._ajax.on('success', function (resp) {\n    if (resp.status >= 200 && resp.status < 400) {\n      if (typeof(this._callback) === 'function') this._callback(resp.response);\n    } else {\n      console.log('AJAX ERROR', arguments);\n    }\n  }.bind(this));\n  this._ajax.on('error', function() {\n    console.log('AJAX ERROR', arguments);\n  }.bind(this));\n  // Handle searchin\n  this._ajax.on('loadstart', function() {\n    this.element.classList.add('searching');\n  }.bind(this));\n  this._ajax.on('loadend', function() {\n    this.element.classList.remove('searching');\n  }.bind(this));\n  // Overwrite handleResponse\n  if (typeof(options.handleResponse)==='function') this.handleResponse = options.handleResponse;\n};\nol.ext.inherits(ol.control.SearchJSON, ol.control.Search);\n/** Send ajax request\n * @param {string} url\n * @param {*} data\n * @param {function} cback a callback function that takes an array of {name, feature} to display in the autocomplete field\n */\nol.control.SearchJSON.prototype.ajax = function (url, data, cback, options) {\n  options = options || {};\n  this._callback = cback;\n  this._ajax.set('dataType', options.dataType || 'JSON');\n  this._ajax.send(url, data, options);\n};\n/** Autocomplete function (ajax request to the server)\n * @param {string} s search string\n * @param {function} cback a callback function that takes an array of {name, feature} to display in the autocomplete field\n */\nol.control.SearchJSON.prototype.autocomplete = function (s, cback) {\n  var data = this.requestData(s);\n  var url = encodeURI(this.get('url'));\n  this.ajax(url, data, function(resp) {\n    if (typeof(cback) === 'function') cback(this.handleResponse(resp));\n  });\n};\n/**\n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchJSON.prototype.requestData = function (s){\n  return { q: s };\n};\n/**\n * Handle server response to pass the features array to the display list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n * @api\n */\nol.control.SearchJSON.prototype.handleResponse = function (response) {\n  return response;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the photon API.\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {Object=} Control options.\n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 1000.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 3\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {function | undefined} options.handleResponse Handle server response to pass the features array to the list\n * \n *  @param {string|undefined} options.url Url to photon api, default \"http://photon.komoot.de/api/\"\n *  @param {string|undefined} options.lang Force preferred language, default none\n *  @param {boolean} options.position Search, with priority to geo position, default false\n *  @param {function} options.getTitle a function that takes a feature and return the name to display in the index, default return street + name + contry\n */\nol.control.SearchPhoton = function(options) {\n  options = options || {};\n  options.className = options.className || 'photon';\n  options.url = options.url || 'http://photon.komoot.de/api/';\n  options.copy = '<a href=\"http://www.openstreetmap.org/copyright\" target=\"new\">&copy; OpenStreetMap contributors</a>';\n  ol.control.SearchJSON.call(this, options);\n  this.set('lang', options.lang);\n  this.set('position', options.position);\n};\nol.ext.inherits(ol.control.SearchPhoton, ol.control.SearchJSON);\n/** Returns the text to be displayed in the menu\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.SearchPhoton.prototype.getTitle = function (f) {\n  var p = f.properties;\n  return (p.housenumber||\"\")\n    + \" \"+(p.street || p.name || \"\")\n    + \"<i>\"\n    + \" \"+(p.postcode||\"\")\n    + \" \"+(p.city||\"\")\n    + \" (\"+p.country\n    + \")</i>\";\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchPhoton.prototype.requestData = function (s) {\n  var data = {\n    q: s,\n    lang: this.get('lang'),\n    limit: this.get('maxItems')\n  }\n  // Handle position proirity\n  if (this.get('position')) {\n    var view = this.getMap().getView();\n    var pt = new ol.geom.Point(view.getCenter());\n    pt = (pt.transform (view.getProjection(), \"EPSG:4326\")).getCoordinates();\n    data.lon = pt[0];\n    data.lat = pt[1];\n  }\n  return data;\n};\n/**\n * Handle server response to pass the features array to the list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n */\nol.control.SearchPhoton.prototype.handleResponse = function (response) {\n  return response.features;\n};\n/** Prevent same feature to be drawn twice: test equality\n * @param {} f1 First feature to compare\n * @param {} f2 Second feature to compare\n * @return {boolean}\n * @api\n */\nol.control.SearchPhoton.prototype.equalFeatures = function (f1, f2) {\n  return (this.getTitle(f1) === this.getTitle(f2)\n    && f1.geometry.coordinates[0] === f2.geometry.coordinates[0]\n    && f1.geometry.coordinates[1] === f2.geometry.coordinates[1]);\n};\n/** A ligne has been clicked in the menu > dispatch event\n*\t@param {any} f the feature, as passed in the autocomplete\n*\t@api\n*/\nol.control.SearchPhoton.prototype.select = function (f) {\n  var c = f.geometry.coordinates;\n  // Add coordinate to the event\n  try {\n    c = ol.proj.transform (f.geometry.coordinates, 'EPSG:4326', this.getMap().getView().getProjection());\n  } catch(e) { /* ok */ }\n  this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n};\n/** Get data for reverse geocode \n * @param {ol.coordinate} coord\n */\nol.control.SearchPhoton.prototype.reverseData = function (coord) {\n  var lonlat = ol.proj.transform (coord, this.getMap().getView().getProjection(), 'EPSG:4326');\n  return { lon: lonlat[0], lat: lonlat[1] };\n};\n/** Reverse geocode\n * @param {ol.coordinate} coord\n * @api\n */\nol.control.SearchPhoton.prototype.reverseGeocode = function (coord, cback) {\n  this.ajax(\n    this.get('url').replace('/api/', '/reverse/').replace('/search/', '/reverse/'),\n    this.reverseData(coord),\n    function(resp) {\n      if (resp.features) resp = resp.features;\n      if (!(resp instanceof Array)) resp = [resp];\n      if (cback) {\n        cback.call(this, resp);\n      } else {\n        this._handleSelect(resp[0], true);\n        // this.setInput('', true);\n      }\n    }.bind(this)\n  );\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {any} options extend ol.control.SearchJSON options\n *\t@param {string} options.className control class name\n *\t@param {boolean | undefined} options.apiKey the service api key.\n *\t@param {string | undefined} options.authentication: basic authentication for the service API as btoa(\"login:pwd\")\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {boolean | undefined} options.reverse enable reverse geocoding, default false\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {StreetAddress|PositionOfInterest|CadastralParcel|Commune} options.type type of search. Using Commune will return the INSEE code, default StreetAddress,PositionOfInterest\n * @see {@link https://geoservices.ign.fr/documentation/geoservices/geocodage.html}\n */\nol.control.SearchGeoportail = function(options) {\n  options = options || {};\n  options.className = options.className || 'IGNF';\n  options.typing = options.typing || 500;\n  options.url = \"https://wxs.ign.fr/\"+options.apiKey+\"/ols/apis/completion\";\n  options.copy = '<a href=\"https://www.geoportail.gouv.fr/\" target=\"new\">&copy; IGN-Goportail</a>';\n  ol.control.SearchJSON.call(this, options);\n  this.set('type', options.type || 'StreetAddress,PositionOfInterest');\n  // Authentication\n  // this._auth = options.authentication;\n};\nol.ext.inherits(ol.control.SearchGeoportail, ol.control.SearchJSON);\n/** Reverse geocode\n * @param {ol.coordinate} coord\n * @api\n */\nol.control.SearchGeoportail.prototype.reverseGeocode = function (coord, cback) {\n  // Search type\n  var type = this.get('type')==='Commune' ? 'PositionOfInterest' : this.get('type') || 'StreetAddress';\n  type = 'StreetAddress';\n  var lonlat = ol.proj.transform(coord, this.getMap().getView().getProjection(), 'EPSG:4326');\n  // request\n  var request = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\n    +'<XLS xmlns:xls=\"http://www.opengis.net/xls\" xmlns:gml=\"http://www.opengis.net/gml\" xmlns=\"http://www.opengis.net/xls\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.2\" xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\">'\n    +' <Request requestID=\"1\" version=\"1.2\" methodName=\"ReverseGeocodeRequest\" maximumResponses=\"1\" >'\n    +'  <ReverseGeocodeRequest>'\n    +'   <ReverseGeocodePreference>'+type+'</ReverseGeocodePreference>'\n    +'   <Position>'\n    +'    <gml:Point><gml:pos>'+lonlat[1]+' '+lonlat[0]+'</gml:pos></gml:Point>'\n    +'   </Position>'\n    +'  </ReverseGeocodeRequest>'\n    +' </Request>'\n    +'</XLS>';\n  this.ajax (this.get('url').replace('ols/apis/completion','geoportail/ols'), \n    { xls: request },\n    function(xml) {\n      if (xml) {\n        xml = xml.replace(/\\n|\\r/g,'');\n        var p = (xml.replace(/.*<gml:pos>(.*)<\\/gml:pos>.*/, \"$1\")).split(' ');\n        var f = {};\n        if (!Number(p[1]) && !Number(p[0])) {\n          f = { x: lonlat[0], y: lonlat[1], fulltext: String(lonlat) }\n        } else {\n          f.x = lonlat[0];\n          f.y = lonlat[1];\n          f.city = (xml.replace(/.*<Place type=\"Municipality\">([^<]*)<\\/Place>.*/, \"$1\"));\n          f.insee = (xml.replace(/.*<Place type=\"INSEE\">([^<]*)<\\/Place>.*/, \"$1\"));\n          f.zipcode = (xml.replace(/.*<PostalCode>([^<]*)<\\/PostalCode>.*/, \"$1\"));\n          if (/<Street>/.test(xml)) {\n            f.kind = '';\n            f.country = 'StreetAddress';\n            f.street = (xml.replace(/.*<Street>([^<]*)<\\/Street>.*/, \"$1\"));\n            var number = (xml.replace(/.*<Building number=\"([^\"]*).*/, \"$1\"));\n            f.fulltext = number+' '+f.street+', '+f.zipcode+' '+f.city;\n          } else {\n            f.kind = (xml.replace(/.*<Place type=\"Nature\">([^<]*)<\\/Place>.*/, \"$1\"));\n            f.country = 'PositionOfInterest';\n            f.street = '';\n            f.fulltext = f.zipcode+' '+f.city;\n          }\n        }\n        if (cback) {\n          cback.call(this, [f]);\n        } else {\n          this._handleSelect(f, true);\n          // this.setInput('', true);\n          // this.drawList_();\n        }\n      }\n    }.bind(this),\n    { dataType: 'XML' }\n  );\n};\n/** Returns the text to be displayed in the menu\n *\t@param {ol.Feature} f the feature\n *\t@return {string} the text to be displayed in the index\n *\t@api\n */\nol.control.SearchGeoportail.prototype.getTitle = function (f) {\n  var title = f.fulltext;\n  return (title);\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchGeoportail.prototype.requestData = function (s) {\n\treturn { \n    text: s, \n    type: this.get('type')==='Commune' ? 'PositionOfInterest' : this.get('type') || 'StreetAddress,PositionOfInterest', \n    maximumResponses: this.get('maxItems')\n  };\n};\n/**\n * Handle server response to pass the features array to the display list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n * @api\n */\nol.control.SearchGeoportail.prototype.handleResponse = function (response) {\n  var features = response.results;\n  if (this.get('type') === 'Commune') {\n    for (var i=features.length-1; i>=0; i--) {\n      if ( features[i].kind \n        && (features[i].classification>5 || features[i].kind==\"Dpartement\") ) {\n          features.splice(i,1);\n      }\n    }\n\t}\n\treturn features;\n};\n/** A ligne has been clicked in the menu > dispatch event\n *\t@param {any} f the feature, as passed in the autocomplete\n *\t@api\n */\nol.control.SearchGeoportail.prototype.select = function (f){\n  if (f.x || f.y) {\n    var c = [Number(f.x), Number(f.y)];\n    // Add coordinate to the event\n    try {\n        c = ol.proj.transform (c, 'EPSG:4326', this.getMap().getView().getProjection());\n    } catch(e) { /* ok */}\n    // Get insee commune ?\n    if (this.get('type')==='Commune') {\n      this.searchCommune(f, function () {\n        this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n      });\n    } else {\n      this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n    }\n  } else {\n    this.searchCommune(f);\n  }\n};\n/** Search if no position and get the INSEE code\n * @param {string} s le nom de la commune\n */\nol.control.SearchGeoportail.prototype.searchCommune = function (f, cback) {\n  var request = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\n\t+'<XLS xmlns:xls=\"http://www.opengis.net/xls\" xmlns:gml=\"http://www.opengis.net/gml\" xmlns=\"http://www.opengis.net/xls\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.2\" xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\">'\n\t\t+'<RequestHeader/>'\n\t\t+'<Request requestID=\"1\" version=\"1.2\" methodName=\"LocationUtilityService\">'\n\t\t\t+'<GeocodeRequest returnFreeForm=\"false\">'\n\t\t\t\t+'<Address countryCode=\"PositionOfInterest\">'\n\t\t\t\t+'<freeFormAddress>'+f.fulltext+'+</freeFormAddress>'\n\t\t\t\t+'</Address>'\n\t\t\t+'</GeocodeRequest>'\n\t\t+'</Request>'\n\t+'</XLS>'\n  // Search \n  this.ajax (this.get('url').replace('ols/apis/completion','geoportail/ols'),\n    { 'xls': request }, \n    function(xml) {\n      if (xml) {\n        xml = xml.replace(/\\n|\\r/g,'');\n        var p = (xml.replace(/.*<gml:pos>(.*)<\\/gml:pos>.*/, \"$1\")).split(' ');\n        f.x = Number(p[1]);\n        f.y = Number(p[0]);\n        f.kind = (xml.replace(/.*<Place type=\"Nature\">([^<]*)<\\/Place>.*/, \"$1\"));\n        f.insee = (xml.replace(/.*<Place type=\"INSEE\">([^<]*)<\\/Place>.*/, \"$1\"));\n        if (f.x || f.y) {\n          if (cback) cback.call(this, [f]);\n          else this._handleSelect(f);\n        }\n      }\n    }.bind(this),\n    { dataType: 'XML' }\n  );\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc OpenLayers 3 Layer Switcher Control.\n * @fires drawlist\n * @fires toggle\n * \n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options\n *  @param {function} options.displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\n *  @param {boolean} options.mouseover show the panel on mouseover, default false\n *  @param {boolean} options.reordering allow layer reordering, default true\n *  @param {boolean} options.trash add a trash button to delete the layer, default false\n *  @param {function} options.oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\n *  @param {boolean} options.extent add an extent button to zoom to the extent of the layer\n *  @param {function} options.onextent callback when click on extent, default fits view to extent\n *  @param {number} options.drawDelay delay in ms to redraw the layer (usefull to prevent flickering when manipulating the layers)\n *  @param {boolean} options.collapsed collapse the layerswitcher at beginning, default true\n *\n * Layers attributes that control the switcher\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\n *\t- displayInLayerSwitcher {boolean} display in switcher, default true\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\n */\nol.control.LayerSwitcher = function(options) {\n  options = options || {};\n  var self = this;\n  this.dcount = 0;\n  this.show_progress = options.show_progress;\n  this.oninfo = (typeof (options.oninfo) == \"function\" ? options.oninfo: null);\n  this.onextent = (typeof (options.onextent) == \"function\" ? options.onextent: null);\n  this.hasextent = options.extent || options.onextent;\n  this.hastrash = options.trash;\n  this.reordering = (options.reordering!==false);\n  this._layers = [];\n  // displayInLayerSwitcher\n  if (typeof(options.displayInLayerSwitcher) === 'function') {\n    this.displayInLayerSwitcher = options.displayInLayerSwitcher;\n  }\n  var element;\n  if (options.target) {\n    element = ol.ext.element.create('DIV', {\n      className: options.switcherClass || \"ol-layerswitcher\"\n    });\n  } else {\n    element = ol.ext.element.create('DIV', {\n      className: (options.switcherClass || \"ol-layerswitcher\") +' ol-unselectable ol-control'\n    });\n    if (options.collapsed !== false) element.classList.add('ol-collapsed'); \n    else element.classList.add('ol-forceopen'); \n    this.button = ol.ext.element.create('BUTTON', {\n      type: 'button',\n      parent: element\n    });\n    this.button.addEventListener('touchstart', function(e){\n      element.classList.toggle('ol-collapsed');\n      self.dispatchEvent({ type: 'toggle', collapsed: element.classList.contains('ol-collapsed') });\n      e.preventDefault(); \n      self.overflow();\n    });\n    this.button.addEventListener('click', function(){\n      element.classList.toggle('ol-forceopen');\n      element.classList.add('ol-collapsed'); \n      self.dispatchEvent({ type: 'toggle', collapsed: !element.classList.contains('ol-forceopen') });\n      self.overflow();\n    });\n    if (options.mouseover) {\n      element.addEventListener ('mouseleave', function(){ \n        element.classList.add(\"ol-collapsed\"); \n        self.dispatchEvent({ type: 'toggle', collapsed: true });\n      });\n      element.addEventListener ('mouseover', function(){ \n        element.classList.remove(\"ol-collapsed\"); \n        self.dispatchEvent({ type: 'toggle', collapsed: false });\n      });\n    }\n    this.topv = ol.ext.element.create('DIV', {\n      className: 'ol-switchertopdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"+50%\");\n      }\n    });\n    this.botv = ol.ext.element.create('DIV', {\n      className: 'ol-switcherbottomdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"-50%\");\n      }\n    });\n  }\n  this.panel_ = ol.ext.element.create ('UL', {\n    className: 'panel',\n    parent: element\n  });\n  ol.ext.element.addListener (this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function(e) {\n    if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n  this.header_ = ol.ext.element.create('LI', {\n    className: 'ol-header',\n    parent: this.panel_\n  });\n  ol.control.Control.call (this, {\n    element: element,\n    target: options.target\n  });\n  this.set('drawDelay',options.drawDelay||0);\n};\nol.ext.inherits(ol.control.LayerSwitcher, ol.control.Control);\n/** List of tips for internationalization purposes\n*/\nol.control.LayerSwitcher.prototype.tip = {\n  up: \"up/down\",\n  down: \"down\",\n  info: \"informations...\",\n  extent: \"zoom to extent\",\n  trash: \"remove layer\",\n  plus: \"expand/shrink\"\n};\n/** Test if a layer should be displayed in the switcher\n * @param {ol.layer} layer\n * @return {boolean} true if the layer is displayed\n */\nol.control.LayerSwitcher.prototype.displayInLayerSwitcher = function(layer) {\n  return (layer.get(\"displayInLayerSwitcher\")!==false);\n};\n/**\n * Set the map instance the control is associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.LayerSwitcher.prototype.setMap = function(map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  this.drawPanel();\n  if (this._listener) {\n    if (this._listener) ol.Observable.unByKey(this._listener.change);\n    if (this._listener) ol.Observable.unByKey(this._listener.moveend);\n    if (this._listener) ol.Observable.unByKey(this._listener.size);\n  }\n  this._listener = null;\n  // Get change (new layer added or removed)\n  if (map) {\n    this._listener = {\n      change: map.getLayerGroup().on('change', this.drawPanel.bind(this)),\n      moveend: map.on('moveend', this.viewChange.bind(this)),\n      size: map.on('change:size', this.overflow.bind(this))\n    }\n  }\n};\n/** Show control\n */\nol.control.LayerSwitcher.prototype.show = function() {\n  this.element.classList.add(\"ol-forceopen\");\n  this.overflow();\n};\n/** Hide control\n */\nol.control.LayerSwitcher.prototype.hide = function() {\n  this.element.classList.remove(\"ol-forceopen\");\n  this.overflow();\n};\n/** Toggle control\n */\nol.control.LayerSwitcher.prototype.toggle = function() {\n  this.element.classList.toggle(\"ol-forceopen\");\n  this.overflow();\n};\n/** Is control open\n * @return {boolean}\n */\nol.control.LayerSwitcher.prototype.isOpen = function() {\n  return this.element.classList.contains(\"ol-forceopen\");\n};\n/** Add a custom header\n * @param {Element|string} html content html\n */\nol.control.LayerSwitcher.prototype.setHeader = function(html) {\n  ol.ext.element.setHTML(this.header_, html);\n};\n/** Calculate overflow and add scrolls\n *\t@param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\n */\nol.control.LayerSwitcher.prototype.overflow = function(dir) {\t\n  if (this.button) {\n    // Nothing to show\n    if (ol.ext.element.hidden(this.panel_)) {\n      ol.ext.element.setStyle(this.element, { height: 'auto' });\n      return;\n    }\n    // Calculate offset\n    var h = ol.ext.element.outerHeight(this.element);\n    var hp = ol.ext.element.outerHeight(this.panel_);\n    var dh = this.button.offsetTop + ol.ext.element.outerHeight(this.button);\n    //var dh = this.button.position().top + this.button.outerHeight(true);\n    var top = this.panel_.offsetTop - dh;\n    if (hp > h-dh) {\n      // Bug IE: need to have an height defined\n      ol.ext.element.setStyle(this.element, { height: '100%' });\n      var lh = 2 * ol.ext.element.getStyle(this.panel_.querySelectorAll('li.visible .li-content')[0], 'height');\n      switch (dir) {\n        case 1: top += lh; break;\n        case -1: top -= lh; break;\n        case \"+50%\": top += Math.round(h/2); break;\n        case \"-50%\": top -= Math.round(h/2); break;\n        default: break;\n      }\n      // Scroll div\n      if (top+hp <= h-3*dh/2) {\n        top = h-3*dh/2-hp;\n        ol.ext.element.hide(this.botv);\n      } else {\n        ol.ext.element.show(this.botv);\n      }\n      if (top >= 0) {\n        top = 0;\n        ol.ext.element.hide(this.topv);\n      } else {\n        ol.ext.element.show(this.topv);\n      }\n      // Scroll ?\n      ol.ext.element.setStyle(this.panel_, { top: top+\"px\" });\n      return true;\n    } else {\n      ol.ext.element.setStyle(this.element, { height: \"auto\" });\n      ol.ext.element.setStyle(this.panel_, { top: 0 });\n      ol.ext.element.hide(this.botv);\n      ol.ext.element.hide(this.topv);\n      return false;\n    }\n  }\n  else return false;\n};\n/** Set the layer associated with a li\n * @param {Element} li\n * @param {ol.layer} layer\n */\nol.control.LayerSwitcher.prototype._setLayerForLI = function(li, layer) {\n  this._layers.push({ li:li, layer:layer });\n};\n/** Get the layer associated with a li\n * @param {Element} li\n * @return {ol.layer}\n */\nol.control.LayerSwitcher.prototype._getLayerForLI = function(li) {\n  for (var i=0, l; l=this._layers[i]; i++) {\n    if (l.li===li) return l.layer;\n  }\n  return null;\n};\n/**\n * On view change hide layer depending on resolution / extent\n * @private\n */\nol.control.LayerSwitcher.prototype.viewChange = function() {\n  this.panel_.querySelectorAll('li').forEach( function(li) {\n    var l = this._getLayerForLI(li);\n    if (l) {\n      if (this.testLayerVisibility(l)) li.classList.remove('ol-layer-hidden');\n      else li.classList.add('ol-layer-hidden');\n    }\n  }.bind(this));\n};\n/**\n *\tDraw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\n*/\nol.control.LayerSwitcher.prototype.drawPanel = function() {\n  if (!this.getMap()) return;\n  var self = this;\n  // Multiple event simultaneously / draw once => put drawing in the event queue\n  this.dcount++;\n  setTimeout (function(){ self.drawPanel_(); }, this.get('drawDelay') || 0);\n};\n/** Delayed draw panel control \n * @private\n */\nol.control.LayerSwitcher.prototype.drawPanel_ = function() {\n  if (--this.dcount || this.dragging_) return;\n  // Remove existing layers\n  this._layers = [];\n  this.panel_.querySelectorAll('li').forEach (function(li) {\n    if (!li.classList.contains('ol-header')) li.remove();\n  }.bind(this));\n  // Draw list\n  this.drawList (this.panel_, this.getMap().getLayers());\n};\n/** Change layer visibility according to the baselayer option\n * @param {ol.layer}\n * @param {Array<ol.layer>} related layers\n */\nol.control.LayerSwitcher.prototype.switchLayerVisibility = function(l, layers) {\n  if (!l.get('baseLayer')) {\n    l.setVisible(!l.getVisible());\n  } else {\n    if (!l.getVisible()) l.setVisible(true);\n    layers.forEach(function(li) {\n      if (l!==li && li.get('baseLayer') && li.getVisible()) li.setVisible(false);\n    });\n  }\n};\n/** Check if layer is on the map (depending on zoom and extent)\n * @param {ol.layer}\n * @return {boolean}\n */\nol.control.LayerSwitcher.prototype.testLayerVisibility = function(layer) {\n  if (!this.getMap()) return true;\n  var res = this.getMap().getView().getResolution();\n  if (layer.getMaxResolution()<=res || layer.getMinResolution()>=res) {\n    return false;\n  } else {\n    var ex0 = layer.getExtent();\n    if (ex0) {\n      var ex = this.getMap().getView().calculateExtent(this.getMap().getSize());\n      return ol.extent.intersects(ex, ex0);\n    }\n    return true;\n  }\n};\n/** Start ordering the list\n*\t@param {event} e drag event\n*\t@private\n*/\nol.control.LayerSwitcher.prototype.dragOrdering_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  // Get params\n  var self = this;\n  var elt = e.currentTarget.parentNode.parentNode;\n  var start = true;\n  var panel = this.panel_; \n  var pageY;\n  var pageY0 = e.pageY \n    || (e.touches && e.touches.length && e.touches[0].pageY) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n  var target, dragElt;\n  var layer, group;\n  elt.parentNode.classList.add('drag');\n  // Stop ordering\n  function stop() {\n    if (target) {\n      // Get drag on parent\n      var drop = layer;\n      if (drop && target) {\n        var collection ;\n        if (group) collection = group.getLayers();\n        else collection = self.getMap().getLayers();\n        var layers = collection.getArray();\n        // Switch layers\n        for (var i=0; i<layers.length; i++) {\n          if (layers[i]==drop) {\n            collection.removeAt (i);\n            break;\n          }\n        }\n        for (var j=0; j<layers.length; j++) {\n          if (layers[j]==target) {\n            if (i>j) collection.insertAt (j,drop);\n            else collection.insertAt (j+1,drop);\n            break;\n          }\n        }\n      }\n    }\n    elt.parentNode.querySelectorAll('li').forEach(function(li){\n      li.classList.remove('dropover');\n      li.classList.remove('dropover-after');\n      li.classList.remove('dropover-before');\n    });\n    elt.classList.remove(\"drag\");\n    elt.parentNode.classList.remove(\"drag\");\n    self.element.classList.remove('drag');\n    if (dragElt) dragElt.remove();\n    ol.ext.element.removeListener(document, 'mousemove touchmove', move);\n    ol.ext.element.removeListener(document, 'mouseup touchend touchcancel', stop);\n  }\n  // Ordering\n  function move(e) {\n    // First drag (more than 2 px) => show drag element (ghost)\n    pageY = e.pageY \n        || (e.touches && e.touches.length && e.touches[0].pageY) \n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n    if (start && Math.abs(pageY0 - pageY) > 2) {\n      start = false;\n      elt.classList.add(\"drag\");\n      layer = self._getLayerForLI(elt);\n      target = false;\n      group = self._getLayerForLI(elt.parentNode.parentNode);\n      // Ghost div\n      dragElt = ol.ext.element.create('LI', { \n        className: 'ol-dragover',\n        html: elt.innerHTML,\n        style: { \n          position: \"absolute\", \n          \"z-index\": 10000, \n          left: elt.offsetLeft, \n          opacity: 0.5,\n          width: ol.ext.element.outerWidth(elt),\n          height: ol.ext.element.getStyle(elt,'height'),\n        },\n        parent: panel \n      });\n      self.element.classList.add('drag');\n    }\n    // Start a new drag sequence\n    if (!start) {\n      e.preventDefault();\n      e.stopPropagation();\n      // Ghost div\n      ol.ext.element.setStyle(dragElt, { top: pageY - ol.ext.element.offsetRect(panel).top + panel.scrollTop +5 });\n      var li;\n      if (!e.touches) {\n        li = e.target;\n      } else {\n        li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\n      }\n      if (li.classList.contains(\"ol-switcherbottomdiv\")) {\n        self.overflow(-1);\n      } else if (li.classList.contains(\"ol-switchertopdiv\")) {\n        self.overflow(1);\n      }\n      // Get associated li\n      while (li && li.tagName!=='LI') {\n        li = li.parentNode;\n      }\n      if (!li || !li.classList.contains('dropover')) {\n        elt.parentNode.querySelectorAll('li').forEach(function(li) {\n          li.classList.remove('dropover');\n          li.classList.remove('dropover-after');\n          li.classList.remove('dropover-before');\n        });\n      }\n      if (li && li.parentNode.classList.contains('drag') && li !== elt) {\n        target = self._getLayerForLI(li);\n        // Don't mix layer level\n        if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\n          li.classList.add(\"dropover\");\n          li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before');\n        } else {\n          target = false;\n        }\n        ol.ext.element.show(dragElt);\n      } else {\n        target = false;\n        if (li===elt) ol.ext.element.hide(dragElt);\n        else ol.ext.element.show(dragElt);\n      }\n      if (!target) dragElt.classList.add(\"forbidden\");\n      else dragElt.classList.remove(\"forbidden\");\n    }\n  }\n  // Start ordering\n  ol.ext.element.addListener(document, 'mousemove touchmove', move);\n  ol.ext.element.addListener(document, 'mouseup touchend touchcancel', stop);\n};\n/** Change opacity on drag \n*\t@param {event} e drag event\n*\t@private\n*/\nol.control.LayerSwitcher.prototype.dragOpacity_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  var self = this\n  // Register start params\n  var elt = e.target;\n  var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode);\n  if (!layer) return;\n  var x = e.pageX \n    || (e.touches && e.touches.length && e.touches[0].pageX) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n  var start = ol.ext.element.getStyle (elt, 'left') - x;\n  self.dragging_ = true;\n  // stop dragging\n  function stop() {\n    ol.ext.element.removeListener(document, \"mouseup touchend touchcancel\", stop);\n    ol.ext.element.removeListener(document, \"mousemove touchmove\", move);\n    self.dragging_ = false;\n  }\n  // On draggin\n  function move(e) {\n    var x = e.pageX \n      || (e.touches && e.touches.length && e.touches[0].pageX) \n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n    var delta = (start + x) / ol.ext.element.getStyle(elt.parentNode, 'width');\n    var opacity = Math.max (0, Math.min(1, delta));\n    ol.ext.element.setStyle (elt, { left: (opacity*100) + \"%\" });\n    elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity*100);\n    layer.setOpacity(opacity);\n  }\n  // Register move\n  ol.ext.element.addListener(document, \"mouseup touchend touchcancel\", stop);\n  ol.ext.element.addListener(document, \"mousemove touchmove\", move);\n};\n/** Render a list of layer\n * @param {Elemen} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol.control.LayerSwitcher.prototype.drawList = function(ul, collection) {\n  var self = this;\n  var layers = collection.getArray();\n  // Change layer visibility\n  var setVisibility = function(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.switchLayerVisibility(l, collection);\n  };\n  // Info button click\n  function onInfo(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.oninfo(l); \n    self.dispatchEvent({ type: \"info\", layer: l });\n  }\n  // Zoom to extent button\n  function zoomExtent(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    if (self.onextent) self.onextent(l); \n    else self.getMap().getView().fit (l.getExtent(), self.getMap().getSize()); \n    self.dispatchEvent({ type: \"extent\", layer: l });\n  }\n  // Remove a layer on trash click\n  function removeLayer(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var li = this.parentNode.parentNode.parentNode.parentNode;\n    var layer, group = self._getLayerForLI(li);\n    // Remove the layer from a group or from a map\n    if (group) {\n      layer = self._getLayerForLI(this.parentNode.parentNode);\n      group.getLayers().remove(layer);\n      if (group.getLayers().getLength()==0 && !group.get('noSwitcherDelete')) {\n        removeLayer.call(li.querySelectorAll('.layerTrash')[0], e);\n      }\n    } else {\n      li = this.parentNode.parentNode;\n      self.getMap().removeLayer(self._getLayerForLI(li));\n    }\n  }\n  // Add the layer list\n  for (var i=layers.length-1; i>=0; i--) {\n    var layer = layers[i];\n    if (!self.displayInLayerSwitcher(layer)) continue;\n    var li = ol.ext.element.create('LI', {\n      className: (layer.getVisible()?\"visible \":\" \")+(layer.get('baseLayer')?\"baselayer\":\"\"),\n      parent: ul\n    });\n    this._setLayerForLI(li, layer);\n    var layer_buttons = ol.ext.element.create('DIV', {\n      className: 'ol-layerswitcher-buttons',\n      parent: li\n    });\n    // Content div\n    var d = ol.ext.element.create('DIV', {\n      className: 'li-content',// + (this.testLayerVisibility(layer) ? '' : ' ol-layer-hidden'),\n      parent: li\n    });\n    // Visibility\n    ol.ext.element.create('INPUT', {\n      type: layer.get('baseLayer') ? 'radio' : 'checkbox',\n      checked: layer.getVisible(),\n      click: setVisibility,\n      parent: d\n    });\n    // Label\n    ol.ext.element.create('LABEL', {\n      html: layer.get(\"title\") || layer.get(\"name\"),\n      title: layer.get(\"title\") || layer.get(\"name\"),\n      click: setVisibility,\n      unselectable: 'on',\n      style: {\n        userSelect: 'none'\n      },\n      parent: d\n    }).addEventListener('selectstart', function(){ return false; });\n    //  up/down\n    if (this.reordering) {\n      if ( (i<layers.length-1 && (layer.get(\"allwaysOnTop\") || !layers[i+1].get(\"allwaysOnTop\")) )\n      || (i>0 && (!layer.get(\"allwaysOnTop\") || layers[i-1].get(\"allwaysOnTop\")) ) ) {\n        ol.ext.element.create('DIV', {\n          className: 'layerup',\n          title: this.tip.up,\n          on: { 'mousedown touchstart': function(e) { self.dragOrdering_(e) } },\n          parent: layer_buttons\n        });\n      }\n    }\n    // Show/hide sub layers\n    if (layer.getLayers) {\n      var nb = 0;\n      layer.getLayers().forEach(function(l) {\n        if (self.displayInLayerSwitcher(l)) nb++;\n      });\n      if (nb) {\n        ol.ext.element.create('DIV', {\n          className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\n          title: this.tip.plus,\n          click: function() {\n            var l = self._getLayerForLI(this.parentNode.parentNode);\n            l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\") )\n          },\n          parent: layer_buttons\n        });\n      }\n    }\n    // Info button\n    if (this.oninfo) {\n      ol.ext.element.create('DIV', {\n        className: 'layerInfo',\n        title: this.tip.info,\n        click: onInfo,\n        parent: layer_buttons\n      });\n    }\n    // Layer remove\n    if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\n      ol.ext.element.create('DIV', {\n        className: 'layerTrash',\n        title: this.tip.trash,\n        click: removeLayer,\n        parent: layer_buttons\n      });\n    }\n    // Layer extent\n    if (this.hasextent && layers[i].getExtent()) {\n      var ex = layers[i].getExtent();\n      if (ex.length==4 && ex[0]<ex[2] && ex[1]<ex[3]) {\n        ol.ext.element.create('DIV', {\n          className: 'layerExtent',\n          title: this.tip.extent,\n          click: zoomExtent,\n          parent: layer_buttons  \n        });\n      }\n    }\n    // Progress\n    if (this.show_progress && layer instanceof ol.layer.Tile) {\n      var p = ol.ext.element.create('DIV', {\n        className: 'layerswitcher-progress',\n        parent: d\n      });\n      this.setprogress_(layer);\n      layer.layerswitcher_progress = ol.ext.element.create('DIV', { parent: p });\n    }\n    // Opacity\n    var opacity = ol.ext.element.create('DIV', {\n      className: 'layerswitcher-opacity',\n      // Click on the opacity line\n      click: function(e){\n        if (e.target !== this) return;\n        e.stopPropagation();\n        e.preventDefault();\n        var op = Math.max ( 0, Math.min( 1, e.offsetX / ol.ext.element.getStyle(this, 'width')));\n        self._getLayerForLI(this.parentNode.parentNode).setOpacity(op);\n      },\n      parent: d\n    });\n    // Start dragging\n    ol.ext.element.create('DIV', {\n      className: 'layerswitcher-opacity-cursor',\n      style: { left: (layer.getOpacity()*100)+\"%\" },\n      on: {\n        'mousedown touchstart': function(e) { self.dragOpacity_ (e); }\n      },\n      parent: opacity\n    });\n    // Percent\n    ol.ext.element.create('DIV', {\n      className: 'layerswitcher-opacity-label',\n      html: Math.round(layer.getOpacity()*100),\n      parent: d\n    });\n    // Layer group\n    if (layer.getLayers) {\n      li.classList.add('ol-layer-group');\n      if (layer.get(\"openInLayerSwitcher\") === true) {\n        var ul2 = ol.ext.element.create('UL', {\n          parent: li\n        });\n        this.drawList (ul2, layer.getLayers());\n      }\n    }\n    else if (layer instanceof ol.layer.Vector) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol.layer.VectorTile) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol.layer.Tile) li.classList.add('ol-layer-tile');\n    else if (layer instanceof ol.layer.Image) li.classList.add('ol-layer-image');\n    else if (layer instanceof ol.layer.Heatmap) li.classList.add('ol-layer-heatmap');\n    // Dispatch a dralist event to allow customisation\n    this.dispatchEvent({ type:'drawlist', layer:layer, li:li });\n  }\n  this.viewChange();\n  if (ul === this.panel_) this.overflow();\n};\n/** Handle progress bar for a layer\n*\t@private\n*/\nol.control.LayerSwitcher.prototype.setprogress_ = function(layer) {\n  if (!layer.layerswitcher_progress) {\n    var loaded = 0;\n    var loading = 0;\n    var draw = function() {\n      if (loading === loaded) {\n        loading = loaded = 0;\n        ol.ext.element.setStyle(layer.layerswitcher_progress, { width: 0 });// layer.layerswitcher_progress.width(0);\n      } else {\n        ol.ext.element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' });// layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\n      }\n    }\n    layer.getSource().on('tileloadstart', function() {\n      loading++;\n      draw();\n    });\n    layer.getSource().on('tileloadend', function() {\n      loaded++;\n      draw();\n    });\n    layer.getSource().on('tileloaderror', function() {\n      loaded++;\n      draw();\n    });\n  }\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control bar for OL3\n * The control bar is a container for other controls. It can be used to create toolbars.\n * Control bars can be nested and combined with ol.control.Toggle to handle activate/deactivate.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *  @param {String} options.className class of the control\n *  @param {bool} options.group is a group, default false\n *  @param {bool} options.toggleOne only one toggle control is active at a time, default false\n *  @param {bool} options.autoDeactivate used with subbar to deactivate all control when top level control deactivate, default false\n *  @param {Array<_ol_control_>} options.controls a list of control to add to the bar\n */\nol.control.Bar = function(options) {\n  if (!options) options={};\n  var element = document.createElement(\"div\");\n      element.classList.add('ol-unselectable', 'ol-control', 'ol-bar');\n  if (options.className) {\n    var classes = options.className.split(' ').filter(function(className) {\n      return className.length > 0;\n    });\n    element.classList.add.apply(element.classList, classes)\n  }\n  if (options.group) element.classList.add('ol-group');\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('toggleOne', options.toggleOne);\n  this.set('autoDeactivate', options.autoDeactivate);\n  this.controls_ = [];\n  if (options.controls instanceof Array) {\n    for (var i=0; i<options.controls.length; i++) {\n      this.addControl(options.controls[i]);\n    }\n  }\n};\nol.ext.inherits(ol.control.Bar, ol.control.Control);\n/** Set the control visibility\n * @param {boolean} b\n */\nol.control.Bar.prototype.setVisible = function (val) {\n  if (val) this.element.style.display = '';\n  else this.element.style.display = 'none';\n}\n/** Get the control visibility\n * @return {boolean} b\n */\nol.control.Bar.prototype.getVisible = function () {\n  return this.element.style.display != 'none';\n}\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Bar.prototype.setMap = function (map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  for (var i=0; i<this.controls_.length; i++) {\n    var c = this.controls_[i];\n    // map.addControl(c);\n    c.setMap(map);\n  }\n};\n/** Get controls in the panel\n *\t@param {Array<_ol_control_>}\n */\nol.control.Bar.prototype.getControls = function () {\n  return this.controls_;\n};\n/** Set tool bar position\n *\t@param {top|left|bottom|right} pos\n */\nol.control.Bar.prototype.setPosition = function (pos) {\n  this.element.classList.remove('ol-left', 'ol-top', 'ol-bottom', 'ol-right');\n  pos=pos.split ('-');\n  for (var i=0; i<pos.length; i++) {\n    switch (pos[i]) {\n      case 'top':\n      case 'left':\n      case 'bottom':\n      case 'right':\n        this.element.classList.add(\"ol-\"+pos[i]);\n        break;\n      default: break;\n    }\n  }\n};\n/** Add a control to the bar\n *\t@param {_ol_control_} c control to add\n */\nol.control.Bar.prototype.addControl = function (c) {\n  this.controls_.push(c);\n  c.setTarget(this.element);\n  if (this.getMap()) {\n    this.getMap().addControl(c);\n  }\n  // Activate and toogleOne\n  c.on ('change:active', function(e) { this.onActivateControl_(e, c); }.bind(this));\n  if (c.getActive) {\n    // c.dispatchEvent({ type:'change:active', key:'active', oldValue:false, active:true });\n    this.onActivateControl_({ target: c, active: c.getActive() }, c);\n  }\n};\n/** Deativate all controls in a bar\n * @param {_ol_control_} except a control\n */\nol.control.Bar.prototype.deactivateControls = function (except) {\n  for (var i=0; i<this.controls_.length; i++) {\n  if (this.controls_[i] !== except && this.controls_[i].setActive) {\n    this.controls_[i].setActive(false);\n    }\n  }\n};\nol.control.Bar.prototype.getActiveControls = function () {\n  var active = [];\n  for (var i=0, c; c=this.controls_[i]; i++) {\n    if (c.getActive && c.getActive()) active.push(c);\n  }\n  return active;\n}\n/** Auto activate/deactivate controls in the bar\n * @param {boolean} b activate/deactivate\n */\nol.control.Bar.prototype.setActive = function (b) {\n  if (!b && this.get(\"autoDeactivate\")) {\n    this.deactivateControls();\n  }\n  if (b) {\n    var ctrls = this.getControls();\n    for (var i=0, sb; (sb = ctrls[i]); i++) {\n      if (sb.get(\"autoActivate\")) sb.setActive(true);\n    }\n  }\n}\n/** Post-process an activated/deactivated control\n *\t@param {ol.event} e :an object with a target {_ol_control_} and active flag {bool}\n */\nol.control.Bar.prototype.onActivateControl_ = function (e, ctrl) {\n  if (this.get('toggleOne')) {\n    if (e.active) {\n      var n;\n      //var ctrl = e.target;\n      for (n=0; n<this.controls_.length; n++) {\n        if (this.controls_[n]===ctrl) break;\n      }\n      // Not here!\n      if (n==this.controls_.length) return;\n      this.deactivateControls (this.controls_[n]);\n    } else {\n      // No one active > test auto activate\n      if (!this.getActiveControls().length) {\n        for (var i=0, c; c=this.controls_[i]; i++) {\n          if (c.get(\"autoActivate\")) {\n            c.setActive(true);\n            break;\n          }\n        }\n      }\n    }\n  }\n};\n/**\n * @param {string} name of the control to search\n * @return {ol.control.Control}\n */\nol.control.Bar.prototype.getControlsByName = function(name) {\n  var controls = this.getControls();\n  return controls.filter(\n    function(control) {\n      return (control.get('name') === name);\n    }\n  );\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple push button control\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *  @param {String} options.className class of the control\n *  @param {String} options.title title of the control\n *  @param {String} options.name an optional name, default none\n *  @param {String} options.html html to insert in the control\n *  @param {function} options.handleClick callback when control is clicked (or use change:active event)\n */\nol.control.Button = function(options){\n  options = options || {};\n  var element = document.createElement(\"div\");\n  element.className = (options.className || '') + \" ol-button ol-unselectable ol-control\";\n  var self = this;\n  var bt = this.button_ = document.createElement(/ol-text-button/.test(options.className) ? \"div\": \"button\");\n  bt.type = \"button\";\n  if (options.title) bt.title = options.title;\n  if (options.html instanceof Element) bt.appendChild(options.html)\n  else bt.innerHTML = options.html || \"\";\n  var evtFunction = function(e) {\n    if (e && e.preventDefault) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n    if (options.handleClick) {\n      options.handleClick.call(self, e);\n    }\n  };\n  bt.addEventListener(\"click\", evtFunction);\n  bt.addEventListener(\"touchstart\", evtFunction);\n  element.appendChild(bt);\n  // Try to get a title in the button content\n  if (!options.title && bt.firstElementChild) {\n    bt.title = bt.firstElementChild.title;\n  }\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  if (options.title) {\n    this.set(\"title\", options.title);\n  }\n  if (options.title) this.set(\"title\", options.title);\n  if (options.name) this.set(\"name\", options.name);\n};\nol.ext.inherits(ol.control.Button, ol.control.Control);\n/** Set the control visibility\n* @param {boolean} b \n*/\nol.control.Button.prototype.setVisible = function (val) {\n  if (val) ol.ext.element.show(this.element);\n  else ol.ext.element.hide(this.element);\n};\n/**\n * Set the button title\n * @param {string} title\n * @returns {undefined}\n */\nol.control.Button.prototype.setTitle = function(title) {\n  this.button_.setAttribute('title', title);\n};\n/**\n * Set the button html\n * @param {string} html\n * @returns {undefined}\n */\nol.control.Button.prototype.setHtml = function(html) {\n  ol.ext.element.setHTML (this.button_, html);\n};\n/**\n * Get the button element\n * @returns {undefined}\n */\nol.control.Button.prototype.getButtonElement = function() {\n  return this.button_;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc \n *   OpenLayers 3 Attribution Control integrated in the canvas (for jpeg/png \n * @see http://www.kreidefossilien.de/webgis/dokumentation/beispiele/export-map-to-png-with-scale\n *\n * @constructor\n * @extends {ol.control.Attribution}\n * @param {Object=} options extend the ol.control.Attribution options.\n * \t@param {ol.style.Style} options.style  option is usesd to draw the text.\n */\nol.control.CanvasAttribution = function(options)\n{\tif (!options) options = {};\n\tol.control.Attribution.call(this, options);\n\t// Draw in canvas\n\tthis.setCanvas(!!options.canvas);\n\t// Get style options\n\tif (!options) options={};\n\tif (!options.style) options.style = new ol.style.Style();\n\tthis.setStyle (options.style);\n}\nol.ext.inherits(ol.control.CanvasAttribution, ol.control.Attribution);\n/**\n * Draw attribution on canvas\n * @param {boolean} b draw the attribution on canvas.\n */\nol.control.CanvasAttribution.prototype.setCanvas = function (b)\n{\tthis.isCanvas_ = b;\n\tif (b) this.setCollapsed(false);\n\tthis.element.style.visibility = b ? \"hidden\":\"visible\";\n\tif (this.map_) this.map_.renderSync();\n};\n/** Get map Canvas\n * @private\n */\nol.control.CanvasAttribution.prototype.getContext = ol.control.CanvasBase.prototype.getContext;\n/**\n * Change the control style\n * @param {ol.style.Style} style\n */\nol.control.CanvasAttribution.prototype.setStyle = function (style)\n{\tvar text = style.getText();\n\tthis.font_ = text ? text.getFont() : \"10px Arial\";\n\tvar stroke = text ? text.getStroke() : null;\n\tvar fill = text ? text.getFill() : null;\n\tthis.fontStrokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : \"#fff\";\n\tthis.fontFillStyle_ = fill ? ol.color.asString(fill.getColor()) : \"#000\";\n\tthis.fontStrokeWidth_ = stroke ? stroke.getWidth() : 3;\n\tif (this.getMap()) this.getMap().render();\n};\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.CanvasAttribution.prototype.setMap = function (map)\n{\t\n\tol.control.CanvasBase.prototype.getCanvas.call(this, map);\n\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.ScaleLine.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Get change (new layer added or removed)\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawAttribution_.bind(this));\n\t}\n\tthis.map_ = map;\n\tthis.setCanvas (this.isCanvas_);\n};\n/** \n * Draw attribution in the final canvas\n * @private\n */\nol.control.CanvasAttribution.prototype.drawAttribution_ = function(e) {\n\tif (!this.isCanvas_) return;\n\tvar ctx = this.getContext(e);\n\tif (!ctx) return;\n\tvar text = \"\";\n\tArray.prototype.slice.call(this.element.querySelectorAll('li'))\n\t\t.filter(function(el) {\n\t\t\treturn el.style.display !== \"none\";\n\t\t})\n\t\t.map(function(el) {\n\t\t\ttext += (text ? \" - \":\"\") + el.textContent;\n\t\t});\n\t// Retina device\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\t// Position\n\tvar eltRect = this.element.getBoundingClientRect();\n\tvar mapRect = this.getMap().getViewport().getBoundingClientRect();\n\tvar sc = this.getMap().getSize()[0] / mapRect.width;\n\tctx.translate((eltRect.left-mapRect.left)*sc, (eltRect.top-mapRect.top)*sc);\n\tvar h = this.element.clientHeight;\n\tvar w = this.element.clientWidth;\n\tvar left = w/2 + this.element.querySelectorAll('button')[0].clientWidth;\n\t// Draw scale text\n\tctx.beginPath();\n\t\tctx.strokeStyle = this.fontStrokeStyle_;\n\t\tctx.fillStyle = this.fontFillStyle_;\n\t\tctx.lineWidth = this.fontStrokeWidth_;\n\t\tctx.textAlign = \"center\";\n\t\tctx.textBaseline =\"middle\";\n\t\tctx.font = this.font_;\n\t\tctx.strokeText(text, left, h/2);\n\t\tctx.fillText(text, left, h/2);\n\tctx.closePath();\n\tctx.restore();\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc \n *    OpenLayers 3 Scale Line Control integrated in the canvas (for jpeg/png \n * @see http://www.kreidefossilien.de/webgis/dokumentation/beispiele/export-map-to-png-with-scale\n *\n * @constructor\n * @extends {ol.control.ScaleLine}\n * @param {Object=} options extend the ol.control.ScaleLine options.\n * \t@param {ol.style.Style} options.style used to draw the scale line (default is black/white, 10px Arial).\n */\nol.control.CanvasScaleLine = function(options)\n{\tol.control.ScaleLine.call(this, options);\n\tthis.scaleHeight_ = 6;\n\t// Get style options\n\tif (!options) options={};\n\tif (!options.style) options.style = new ol.style.Style();\n\tthis.setStyle(options.style);\n}\nol.ext.inherits(ol.control.CanvasScaleLine, ol.control.ScaleLine);\n/** Get map Canvas\n * @private\n */\nol.control.CanvasScaleLine.prototype.getContext = ol.control.CanvasBase.prototype.getContext;\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.control.CanvasScaleLine.prototype.setMap = function (map)\n{\t\n\tol.control.CanvasBase.prototype.getCanvas.call(this, map);\n\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.ScaleLine.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Add postcompose on the map\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawScale_.bind(this));\n\t} \n\t// Hide the default DOM element\n\tthis.element.style.visibility = 'hidden';\n\tthis.olscale = this.element.querySelector(\".ol-scale-line-inner\");\n}\n/**\n * Change the control style\n * @param {_ol_style_Style_} style\n */\nol.control.CanvasScaleLine.prototype.setStyle = function (style)\n{\tvar stroke = style.getStroke();\n\tthis.strokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : \"#000\";\n\tthis.strokeWidth_ = stroke ? stroke.getWidth() : 2;\n\tvar fill = style.getFill();\n\tthis.fillStyle_ = fill ? ol.color.asString(fill.getColor()) : \"#fff\";\n\tvar text = style.getText();\n\tthis.font_ = text ? text.getFont() : \"10px Arial\";\n\tstroke = text ? text.getStroke() : null;\n\tfill = text ? text.getFill() : null;\n\tthis.fontStrokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : this.fillStyle_;\n\tthis.fontStrokeWidth_ = stroke ? stroke.getWidth() : 3;\n\tthis.fontFillStyle_ = fill ? ol.color.asString(fill.getColor()) : this.strokeStyle_;\n\t// refresh\n\tif (this.getMap()) this.getMap().render();\n}\n/** \n * Draw attribution in the final canvas\n * @private\n */\nol.control.CanvasScaleLine.prototype.drawScale_ = function(e)\n{\tif ( this.element.style.visibility!==\"hidden\" ) return;\n\tvar ctx = this.getContext(e);\n\tif (!ctx) return;\n\t// Get size of the scale div\n\tvar scalewidth = parseInt(this.olscale.style.width);\n\tif (!scalewidth) return;\n\tvar text = this.olscale.textContent;\n\tvar position = {left: this.element.offsetLeft, top: this.element.offsetTop};\n\t// Retina device\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\t// On top\n\tposition.top += this.element.clientHeight - this.scaleHeight_;\n\t// Draw scale text\n\tctx.beginPath();\n    ctx.strokeStyle = this.fontStrokeStyle_;\n    ctx.fillStyle = this.fontFillStyle_;\n    ctx.lineWidth = this.fontStrokeWidth_;\n    ctx.textAlign = \"center\";\n\tctx.textBaseline =\"bottom\";\n    ctx.font = this.font_;\n\tctx.strokeText(text, position.left+scalewidth/2, position.top);\n    ctx.fillText(text, position.left+scalewidth/2, position.top);\n\tctx.closePath();\n\t// Draw scale bar\n\tposition.top += 2;\n\tctx.lineWidth = this.strokeWidth_;\n\tctx.strokeStyle = this.strokeStyle_;\n\tvar max = 4;\n\tvar n = parseInt(text);\n\twhile (n%10 === 0) n/=10;\n\tif (n%5 === 0) max = 5;\n\tfor (var i=0; i<max; i++)\n\t{\tctx.beginPath();\n\t\tctx.fillStyle = i%2 ? this.fillStyle_ : this.strokeStyle_;\n\t\tctx.rect(position.left+i*scalewidth/max, position.top, scalewidth/max, this.scaleHeight_);\n\t\tctx.stroke();\n\t\tctx.fill();\n\t\tctx.closePath();\n\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * A title Control integrated in the canvas (for jpeg/png \n *\n * @constructor\n * @extends {ol.control.CanvasBase}\n * @param {Object=} options extend the ol.control options. \n *  @param {string} options.title the title, default 'Title'\n *  @param {ol.style.Style} options.style style used to draw the title.\n */\nol.control.CanvasTitle = function(options) {\n  if (!options) options = {};\n  var elt = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-control-title ol-unselectable',\n    style: {\n      display: 'block',\n      visibility: 'hidden'\n    }\n  });\n  ol.control.CanvasBase.call(this, {\n    element: elt,\n    style: options.style\n  });\n  this.setTitle(options.title || 'Title');\n  this.element.style.font = this.getTextFont();\n};\nol.ext.inherits(ol.control.CanvasTitle, ol.control.CanvasBase);\n/**\n * Change the control style\n * @param {ol.style.Style} style\n */\nol.control.CanvasTitle.prototype.setStyle = function (style) {\n  ol.control.CanvasBase.prototype.setStyle.call(this, style);\n  // Element style\n  if (this.element) {\n    this.element.style.font = this.getTextFont();\n  }\n  // refresh\n  if (this.getMap()) this.getMap().render();\n};\n/**\n * Set the map title \n * @param {string} map title.\n * @api stable\n */\nol.control.CanvasTitle.prototype.setTitle = function (title) {\n  this.element.textContent = title;\n  this.set('title', title);\n  if (this.getMap()) this.getMap().renderSync();\n};\n/**\n * Get the map title \n * @param {string} map title.\n * @api stable\n */\nol.control.CanvasTitle.prototype.getTitle = function () {\n  return this.get('title');\n};\n/**\n * Set control visibility\n * @param {bool} b\n * @api stable\n */\nol.control.CanvasTitle.prototype.setVisible = function (b) {\n  this.element.style.display = (b ? 'block' : 'none');\n  if (this.getMap()) this.getMap().renderSync();\n};\n/**\n * Get control visibility\n * @return {bool} \n * @api stable\n */\nol.control.CanvasTitle.prototype.getVisible = function () {\n  return this.element.style.display !== 'none';\n};\n/** Draw title in the final canvas\n * @private\n*/\nol.control.CanvasTitle.prototype._draw = function(e) {\n  if (!this.getVisible()) return;\n  var ctx = this.getContext(e);\n\tif (!ctx) return;\n  // Retina device\n  var ratio = e.frameState.pixelRatio;\n  ctx.save();\n  ctx.scale(ratio,ratio);\n  // Position\n  var eltRect = this.element.getBoundingClientRect();\n  var mapRect = this.getMap().getViewport().getBoundingClientRect();\n  var sc = this.getMap().getSize()[0] / mapRect.width;\n  ctx.translate((eltRect.left-mapRect.left)*sc, (eltRect.top-mapRect.top)*sc);\n  var h = this.element.clientHeight;\n  var w = this.element.clientWidth;\n  var left = w/2;\n  ctx.beginPath();\n  ctx.fillStyle = ol.color.asString(this.getFill().getColor());\n  ctx.rect(0,0, w, h);\n  ctx.fill();\n  ctx.closePath();\n  ctx.beginPath();\n  ctx.fillStyle = ol.color.asString(this.getTextFill().getColor());\n  ctx.strokeStyle = ol.color.asString(this.getTextStroke().getColor());\n  ctx.lineWidth = this.getTextStroke().getWidth();\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.font = this.getTextFont();\n  if (ctx.lineWidth) ctx.strokeText(this.getTitle(), left, h/2);\n  ctx.fillText(this.getTitle(), left, h/2);\n  ctx.closePath();\n  ctx.restore();\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * A title Control integrated in the canvas (for jpeg/png \n *\n * @constructor\n * @extends {ol.control.CanvasBase}\n * @param {Object=} options extend the ol.control options. \n *  @param {string} options.className CSS class name\n *  @param {ol.style.Style} options.style style used to draw in the canvas\n *  @param {ol.proj.ProjectionLike} options.projection\tProjection. Default is the view projection.\n *  @param {ol.coordinate.CoordinateFormat} options.coordinateFormat A function that takes a ol.Coordinate and transforms it into a string.\n *  @param {boolean} options.canvas true to draw in the canvas\n */\nol.control.CenterPosition = function(options) {\n  if (!options) options = {};\n  var elt = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-center-position ol-unselectable',\n    style: {\n      display: 'block',\n      visibility: 'hidden'\n    }\n  });\n  ol.control.CanvasBase.call(this, {\n    element: elt,\n    style: options.style\n  });\n  this.element.style.font = this.getTextFont();\n  this.set('projection', options.projection);\n  this.setCanvas(options.canvas);\n  this._format = (typeof options.coordinateFormat === 'function') ? options.coordinateFormat : ol.coordinate.toStringXY; \n};\nol.ext.inherits(ol.control.CenterPosition, ol.control.CanvasBase);\n/**\n * Change the control style\n * @param {ol.style.Style} style\n */\nol.control.CenterPosition.prototype.setStyle = function (style) {\n  ol.control.CanvasBase.prototype.setStyle.call(this, style);\n  // Element style\n  if (this.element) {\n    this.element.style.font = this.getTextFont();\n  }\n  // refresh\n  if (this.getMap()) this.getMap().render();\n};\n/**\n * Draw on canvas\n * @param {boolean} b draw the attribution on canvas.\n */\nol.control.CenterPosition.prototype.setCanvas = function (b) {\n  this.set('canvas', b);\n\tthis.element.style.visibility = b ? \"hidden\":\"visible\";\n\tif (this.getMap()) this.getMap().renderSync();\n};\n/**\n * Set control visibility\n * @param {bool} b\n * @api stable\n */\nol.control.CenterPosition.prototype.setVisible = function (b) {\n  this.element.style.display = (b ? '' : 'none');\n  if (this.getMap()) this.getMap().renderSync();\n};\n/**\n * Get control visibility\n * @return {bool} \n * @api stable\n */\nol.control.CenterPosition.prototype.getVisible = function () {\n  return this.element.style.display !== 'none';\n};\n/** Draw position in the final canvas\n * @private\n*/\nol.control.CenterPosition.prototype._draw = function(e) {\n  if (!this.getVisible() || !this.getMap()) return;\n  // Coordinate\n  var coord = this.getMap().getView().getCenter();\n  if (this.get('projection')) coord = ol.proj.transform (coord, this.getMap().getView().getProjection(), this.get('projection'));\n  coord  = this._format(coord);\n  this.element.textContent = coord;\n  if (!this.get('canvas')) return;\n  var ctx = this.getContext(e);\n\tif (!ctx) return;\n  // Retina device\n  var ratio = e.frameState.pixelRatio;\n  ctx.save();\n  ctx.scale(ratio,ratio);\n  // Position\n  var eltRect = this.element.getBoundingClientRect();\n  var mapRect = this.getMap().getViewport().getBoundingClientRect();\n  var sc = this.getMap().getSize()[0] / mapRect.width;\n  ctx.translate((eltRect.left-mapRect.left)*sc, (eltRect.top-mapRect.top)*sc);\n  var h = this.element.clientHeight;\n  var w = this.element.clientWidth;\n  ctx.beginPath();\n  ctx.fillStyle = ol.color.asString(this.getTextFill().getColor());\n  ctx.strokeStyle = ol.color.asString(this.getTextStroke().getColor());\n  ctx.lineWidth = this.getTextStroke().getWidth();\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.font = this.getTextFont();\n  if (ctx.lineWidth) ctx.strokeText(coord, w/2, h/2);\n  ctx.fillText(coord, w/2, h/2);\n  ctx.closePath();\n  ctx.restore();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Draw a compass on the map. The position/size of the control is defined in the css.\n *\n * @constructor\n * @extends {ol.control.CanvasBase}\n * @param {Object=} options Control options. The style {_ol_style_Stroke_} option is usesd to draw the text.\n *  @param {string} options.className class name for the control\n *  @param {Image} options.image an image, default use the src option or a default image\n *  @param {string} options.src image src, default use the image option or a default image\n *  @param {boolean} options.rotateVithView rotate vith view (false to show watermark), default true\n *  @param {ol.style.Stroke} options.style style to draw the lines, default draw no lines\n */\nol.control.Compass = function(options) {\n  var self = this;\n  if (!options) options = {};\n  // Initialize parent\n  var elt = document.createElement(\"div\");\n  elt.className = \"ol-compassctrl ol-unselectable ol-hidden\" + (options.className ? \" \"+options.className : \"\");\n  elt.style.position = \"absolute\";\n  elt.style.visibility = \"hidden\";\n  var style = (options.style instanceof ol.style.Stroke) ? new ol.style.Style({stroke: options.style}) : options.style;\n  if (!options.style) {\n    style = new ol.style.Style({stroke: new ol.style.Stroke({width:0}) });\n  }\n  ol.control.CanvasBase.call(this, { \n    element: elt,\n    style: style\n  });\n  this.set('rotateVithView', options.rotateWithView!==false);\n  // The image\n  if (options.image) {\n    this.img_ = options.image;\n  }\n  else if (options.src) {\n    this.img_ = new Image();\n    this.img_.onload = function(){ if (self.getMap()) self.getMap().renderSync(); }\n    this.img_.src = options.src;\n  } else {\n    this.img_ = this.defaultCompass_(this.element.clientWidth, this.getStroke().getColor());\n  }\n  // 8 angles\n  this.da_ = [];\n  for (var i=0; i<8; i++) this.da_[i] = [ Math.cos(Math.PI*i/8), Math.sin(Math.PI*i/8) ];\n};\nol.ext.inherits(ol.control.Compass, ol.control.CanvasBase);\n/**\n * Create a default image.\n * @param {number} s the size of the compass\n * @private\n */\nol.control.Compass.prototype.defaultCompass_ = function (s, color) {\n  var canvas = document.createElement('canvas');\n  var ctx = canvas.getContext(\"2d\");\n  s = canvas.width = canvas.height = s || 150;\n  var r = s/2;\n  var r2 = 0.22*r;\n  function draw (r, r2) {\n    ctx.fillStyle = color ||\"#963\";\n    ctx.beginPath();\n    ctx.moveTo (0,0); \n    ctx.lineTo (r,0); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n    ctx.lineTo (-r,0); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n    ctx.lineTo (0,r); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n    ctx.lineTo (0,-r); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n    ctx.fill();\n    ctx.stroke();\n  }\n  function draw2 (r, r2) {\n    ctx.globalCompositeOperation = \"destination-out\";\n    ctx.fillStyle = \"#fff\";\n    ctx.beginPath();\n    ctx.moveTo (0,0); \n    ctx.lineTo (r,0); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n    ctx.lineTo (-r,0); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n    ctx.lineTo (0,r); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n    ctx.lineTo (0,-r); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n    ctx.fill();\n    ctx.globalCompositeOperation=\"source-over\";\n    ctx.beginPath();\n    ctx.moveTo (0,0); \n    ctx.lineTo (r,0); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n    ctx.lineTo (-r,0); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n    ctx.lineTo (0,r); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n    ctx.lineTo (0,-r); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n    ctx.stroke();\n  }\n  ctx.translate(r,r);\n  ctx.strokeStyle = color || \"#963\";\n  ctx.lineWidth = 1.5;\n  ctx.beginPath();\n  ctx.arc (0,0, s*0.41, 0, 2*Math.PI);\n  ctx.arc (0,0, s*0.44, 0, 2*Math.PI);\n  ctx.stroke();\n  ctx.rotate(Math.PI/4)\n  draw (r*0.9, r2*0.8);\n  draw2 (r*0.9, r2*0.8);\n  ctx.rotate(-Math.PI/4)\n  draw (r, r2);\n  draw2 (r, r2);\n  return canvas;\n};\n/** Draw compass\n* @param {ol.event} e postcompose event\n* @private\n*/\nol.control.Compass.prototype._draw = function(e) {\n  var ctx = this.getContext(e);\n  if (!ctx) return;\n  var canvas = ctx.canvas;\n  // Retina device\n  var ratio = e.frameState.pixelRatio;\n  ctx.save();\n  ctx.scale(ratio,ratio);\n  var w = this.element.clientWidth;\n  var h = this.element.clientHeight;\n  var pos = {left: this.element.offsetLeft, top: this.element.offsetTop};\n  var compass = this.img_;\n  var rot = e.frameState.viewState.rotation;\n  ctx.beginPath();\n    ctx.translate(pos.left+w/2, pos.top+h/2);\n    if (this.get('rotateVithView')) ctx.rotate(rot);\n    /*\n    ctx.globalCompositeOperation = \"multiply\";\n    ctx.globalAlpha = this.opacity || 1;\n    */\n    if (this.getStroke().getWidth()) {\n      ctx.beginPath();\n        ctx.strokeStyle = this.getStroke().getColor();\n        ctx.lineWidth = this.getStroke().getWidth();\n        var m = Math.max(canvas.width, canvas.height);\n        for (var i=0; i<8; i++) {\n          ctx.moveTo (-this.da_[i][0]*m, -this.da_[i][1]*m);\n          ctx.lineTo (this.da_[i][0]*m, this.da_[i][1]*m);\n        }\n      ctx.stroke();\n    }\n    if (compass.width) {\n      ctx.drawImage (compass, -w/2, -h/2, w, h);\n    }\n  ctx.closePath();\n  ctx.restore();\n};\n\n/** \n * @classdesc\n * Application dialog\n * @extends {ol.control.Control}\n * @constructor\n * @param {*} options\n *  @param {string} options.className\n *  @param {ol.Map} options.map the map to place the dialog inside\n *  @param {Element} options.target target to place the dialog\n *  @param {boolean} options.zoom add a zoom effect\n *  @param {boolean} options.closeBox add a close button\n *  @param {boolean} options.hideOnClick close dialog when click the background\n */\nol.control.Dialog = function(options) {\n  options = options || {};\n  // Constructor\n  var element = ol.ext.element.create('DIV', {\n    className: ((options.className || '') + (options.zoom ? ' ol-zoom':'') + ' ol-ext-dialog').trim(),\n    click: function() {\n      if (this.get('hideOnClick')) this.close();\n    }.bind(this)\n  });\n  // form\n  var form = ol.ext.element.create('FORM', {\n    on: {\n      submit: this._onButton('submit')\n    },\n    parent: element\n  });\n  // Title\n  ol.ext.element.create('H2', {\n    parent: form\n  });\n  // Close box\n  ol.ext.element.create('DIV', {\n    className: 'ol-closebox',\n    click: this._onButton('cancel'),\n    parent: form\n  });\n  // Content\n  ol.ext.element.create('DIV', {\n    className: 'ol-content',\n    parent: form\n  });\n  // Buttons\n  ol.ext.element.create('DIV', {\n    className: 'ol-buttons',\n    parent: form\n  });\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('closeBox', options.closeBox);\n  this.set('zoom', options.zoom);\n  this.set('hideOnClick', options.hideOnClick);\n  this.set('className', options.className);\n};\nol.ext.inherits(ol.control.Dialog, ol.control.Control);\n/** Show a new dialog \n * @param { * | Element | string } options options or a content to show\n *  @param {Element | string} options.content dialog content\n *  @param {string} options.title title of the dialog\n *  @param {Object} options.buttons a key/value list of button to show \n */\nol.control.Dialog.prototype.show = function(options) {\n  if (options instanceof Element || typeof(options) === 'string') {\n    options = { content: options };\n  }\n  this.setContent(options);\n  this.element.classList.add('ol-visible');\n  this.dispatchEvent ({ type: 'show' });\n};\n/** Open the dialog\n */\nol.control.Dialog.prototype.open = function() {\n  this.show();\n};\n/** Set the dialog content\n * @param {*} options\n *  @param {Element | String} options.content dialog content\n *  @param {string} options.title title of the dialog\n *  @param {string} options.className dialog class name\n *  @param {Object} options.buttons a key/value list of button to show \n */\nol.control.Dialog.prototype.setContent = function(options) {\n  if (!options) return;\n  this.element.className = 'ol-ext-dialog' + (this.get('zoom') ? ' ol-zoom' : '');\n  if (options.className) {\n    this.element.classList.add(options.className);\n  } else if (this.get('className')) {\n    this.element.classList.add(this.get('className'));\n  }\n  var form = this.element.querySelector('form');\n  ol.ext.element.setHTML(form.querySelector('.ol-content'), options.content || '');\n  // Title\n  form.querySelector('h2').innerText = options.title || '';\n  if (options.title) {\n    form.classList.add('ol-title');\n  } else {\n    form.classList.remove('ol-title');\n  }\n  // Closebox\n  if (options.closeBox || (this.get('closeBox') && options.closeBox !== false)) {\n    form.classList.add('ol-closebox');\n  } else {\n    form.classList.remove('ol-closebox');\n  }\n  // Buttons\n  var buttons = this.element.querySelector('.ol-buttons');\n  buttons.innerHTML = '';\n  if (options.buttons) {\n    form.classList.add('ol-button');\n    for (var i in options.buttons) {\n      ol.ext.element.create ('INPUT', {\n        type: (i==='submit' ? 'submit':'button'),\n        value: options.buttons[i],\n        click: this._onButton(i),\n        parent: buttons\n      });\n    }\n  } else {\n    form.classList.remove('ol-button');\n  }\n};\n/** Do something on button click\n * @private\n */\nol.control.Dialog.prototype._onButton = function(button) {\n  var fn = function(e) {\n    e.preventDefault();\n    this.hide();\n    var inputs = {};\n    this.element.querySelectorAll('form input').forEach (function(input) {\n      if (input.className) inputs[input.className] = input;\n    });\n    this.dispatchEvent ({ type: 'button', button: button, inputs: inputs });\n  }.bind(this);\n  return fn;\n};\n/** Close the dialog \n */\nol.control.Dialog.prototype.hide = function() {\n  this.element.classList.remove('ol-visible');\n  this.dispatchEvent ({ type: 'hide' });\n};\n/** Close the dialog \n * @method Dialog.close\n * @return {bool} true if a dialog is closed\n */\nol.control.Dialog.prototype.close = ol.control.Dialog.prototype.hide;\n/** The dialog is shown\n * @return {bool} true if a dialog is open\n */\nol.control.Dialog.prototype.isOpen = function() {\n  return (this.element.classList.contains('ol-visible'));\n};\n\n/** A simple control to disable all actions on the map.\n * The control will create an invisible div over the map.\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t\t@param {String} options.class class of the control\n *\t\t@param {String} options.html html code to insert in the control\n *\t\t@param {bool} options.on the control is on\n *\t\t@param {function} options.toggleFn callback when control is clicked \n */\nol.control.Disable = function(options)\n{\toptions = options||{};\n\tvar element = document.createElement(\"div\");\n\t\t\telement.className = (options.className||\"\"+' ol-disable ol-unselectable ol-control').trim();\n\tvar stylesOptions = { top:\"0px\", left:\"0px\", right:\"0px\", bottom:\"0px\", \"zIndex\":10000, background:\"none\", display:\"none\" };\n\tObject.keys(stylesOptions).forEach(function(styleKey) {\n\t\telement.style[styleKey] = stylesOptions[styleKey];\n\t});\n\tol.control.Control.call(this,\n\t{\telement: element\n\t});\n}\nol.ext.inherits(ol.control.Disable, ol.control.Control);\n/** Test if the control is on\n * @return {bool}\n * @api stable\n */\nol.control.Disable.prototype.isOn = function()\n{\treturn this.element.classList.contains(\"ol-disable\");\n}\n/** Disable all action on the map\n * @param {bool} b, default false\n * @api stable\n */\nol.control.Disable.prototype.disableMap = function(b)\n{\tif (b) \n\t{\tthis.element.classList.add(\"ol-enable\").show();\n\t}\n\telse \n\t{\tthis.element.classList.remove(\"ol-enable\").hide();\n\t}\n}\n\n/** Control bar for editing in a layer\n * @constructor\n * @extends {ol.control.Bar}\n * @fires info\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {boolean} options.edition false to remove the edition tools, default true\n *\t@param {Object} options.interactions List of interactions to add to the bar \n *    ie. Select, Delete, Info, DrawPoint, DrawLine, DrawPolygon\n *    Each interaction can be an interaction or true (to get the default one) or false to remove it from bar\n *\t@param {ol.source.Vector} options.source Source for the drawn features. \n */\nol.control.EditBar = function(options) {\n  options = options || {};\n  options.interactions = options.interactions || {};\n  // New bar\n\tol.control.Bar.call(this, {\n    className: (options.className ? options.className+' ': '') + 'ol-editbar',\n    toggleOne: true,\n\t\ttarget: options.target\n  });\n  this._source = options.source;\n  // Add buttons / interaction\n  this._interactions = {};\n  this._setSelectInteraction(options);\n  if (options.edition!==false) this._setEditInteraction(options);\n  this._setModifyInteraction(options);\n};\nol.ext.inherits(ol.control.EditBar, ol.control.Bar);\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.EditBar.prototype.setMap = function (map) {\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().removeInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().removeInteraction(this._interactions.ModifySelect);\n  }\n  ol.control.Bar.prototype.setMap.call(this, map);\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().addInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().addInteraction(this._interactions.ModifySelect);\n  }\n};\n/** Get an interaction associated with the bar\n * @param {string} name \n */\nol.control.EditBar.prototype.getInteraction = function (name) {\n  return this._interactions[name];\n};\n/** Get the option title */\nol.control.EditBar.prototype._getTitle = function (option) {\n  return (option && option.title) ? option.title : option;\n};\n/** Add selection tool:\n * 1. a toggle control with a select interaction\n * 2. an option bar to delete / get information on the selected feature\n * @private\n */\nol.control.EditBar.prototype._setSelectInteraction = function (options) {\n  var self = this;\n  // Sub bar\n  var sbar = new ol.control.Bar();\n  var selectCtrl;\n  // Delete button\n  if (options.interactions.Delete !== false) {\n    if (options.interactions.Delete instanceof ol.interaction.Delete) {\n      this._interactions.Delete = options.interactions.Delete; \n    } else {\n      this._interactions.Delete = new ol.interaction.Delete();\n    }\n    var del = this._interactions.Delete;\n    del.setActive(false);\n    if (this.getMap()) this.getMap().addInteraction(del);\n    sbar.addControl (new ol.control.Button({\n      className: 'ol-delete',\n      title: this._getTitle(options.interactions.Delete) || \"Delete\",\n      handleClick: function(e) {\n        // Delete selection\n        del.delete(selectCtrl.getInteraction().getFeatures());\n        console.log('del')\n        var evt = {\n          type: 'select',\n          selected: [],\n          deselected: selectCtrl.getInteraction().getFeatures().getArray().slice(),\n          mapBrowserEvent: e.mapBrowserEvent\n        };\n        selectCtrl.getInteraction().getFeatures().clear();\n        selectCtrl.getInteraction().dispatchEvent(evt);\n      }\n    }));\n  }\n  // Info button\n  if (options.interactions.Info !== false) {\n    sbar.addControl (new ol.control.Button({\n      className: 'ol-info',\n      title: this._getTitle(options.interactions.Info) || \"Show informations\",\n      handleClick: function() {\n        self.dispatchEvent({ \n          type: 'info', \n          features: selectCtrl.getInteraction().getFeatures() \n        });\n      }\n    }));\n  }\n  // Select button\n  if (options.interactions.Select !== false) {\n    if (options.interactions.Select instanceof ol.interaction.Select) {\n      this._interactions.Select = options.interactions.Select\n    } else {\n      this._interactions.Select = new ol.interaction.Select({\n        condition: ol.events.condition.click\n      });\n    }\n    var sel = this._interactions.Select;\n    selectCtrl = new ol.control.Toggle({\n      className: 'ol-selection',\n      title: this._getTitle(options.interactions.Select) || \"Select\",\n      interaction: sel,\n      bar: sbar.getControls().length ? sbar : undefined,\n      autoActivate:true,\n      active:true\n    });\n    this.addControl(selectCtrl);\n    sel.on('change:active', function() {\n      sel.getFeatures().clear();\n    });\n  }\n};\n/** Add editing tools\n * @private\n */ \nol.control.EditBar.prototype._setEditInteraction = function (options) {\n  if (options.interactions.DrawPoint !== false) {\n    if (options.interactions.DrawPoint instanceof ol.interaction.Draw) {\n      this._interactions.DrawPoint = options.interactions.DrawPoint;\n    } else {\n      this._interactions.DrawPoint = new ol.interaction.Draw({\n        type: 'Point',\n        source: this._source\n      });\n    }\n    var pedit = new ol.control.Toggle({\n      className: 'ol-drawpoint',\n      title: this._getTitle(options.interactions.DrawPoint) || 'Point',\n      interaction: this._interactions.DrawPoint\n    });\n    this.addControl ( pedit );\n  }\n  if (options.interactions.DrawLine !== false) {\n    if (options.interactions.DrawLine instanceof ol.interaction.Draw) {\n      this._interactions.DrawLine = options.interactions.DrawLine\n    } else {\n      this._interactions.DrawLine = new ol.interaction.Draw ({\n        type: 'LineString',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          if (geometry) geometry.setCoordinates(coordinates);\n          else geometry = new ol.geom.LineString(coordinates);\n          this.nbpts = geometry.getCoordinates().length;\n          return geometry;\n        }\n      });\n    }\n    var ledit = new ol.control.Toggle({\n      className: 'ol-drawline',\n      title: this._getTitle(options.interactions.DrawLine) || 'LineString',\n      interaction: this._interactions.DrawLine,\n      // Options bar associated with the control\n      bar: new ol.control.Bar ({\n        controls:[ \n          new ol.control.TextButton({\n            html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n            title: this._getTitle(options.interactions.UndoDraw) || \"delete last point\",\n            handleClick: function() {\n              if (ledit.getInteraction().nbpts>1) ledit.getInteraction().removeLastPoint();\n            }\n          }),\n          new ol.control.TextButton ({\n            html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n            title: this._getTitle(options.interactions.FinishDraw) || \"finish\",\n            handleClick: function() {\n              // Prevent null objects on finishDrawing\n              if (ledit.getInteraction().nbpts>2) ledit.getInteraction().finishDrawing();\n            }\n          })\n        ]\n      }) \n    });\n    this.addControl ( ledit );\n  }\n  if (options.interactions.DrawPolygon !== false) {\n    if (options.interactions.DrawPolygon instanceof ol.interaction.Draw){\n      this._interactions.DrawPolygon = options.interactions.DrawPolygon\n    } else {\n      this._interactions.DrawPolygon = new ol.interaction.Draw ({\n        type: 'Polygon',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          this.nbpts = coordinates[0].length;\n          if (geometry) geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n          else geometry = new ol.geom.Polygon(coordinates);\n          return geometry;\n        }\n      });\n    }\n    this._setDrawPolygon(\n      'ol-drawpolygon', \n      this._interactions.DrawPolygon, \n      this._getTitle(options.interactions.DrawPolygon) || 'Polygon', \n      options\n    );\n  }\n  // Draw hole\n  if (options.interactions.DrawHole !== false) {\n    if (options.interactions.DrawHole instanceof ol.interaction.DrawHole){\n      this._interactions.DrawHole = options.interactions.DrawHole;\n    } else {\n      this._interactions.DrawHole = new ol.interaction.DrawHole ();\n    }\n    this._setDrawPolygon(\n      'ol-drawhole', \n      this._interactions.DrawHole, \n      this._getTitle(options.interactions.DrawHole) || 'Hole', \n      options\n    );\n  }\n  // Draw regular\n  if (options.interactions.DrawRegular !== false) {\n    if (options.interactions.DrawRegular instanceof ol.interaction.DrawRegular) {\n      this._interactions.DrawRegular = options.interactions.DrawRegular\n    } else {\n      this._interactions.DrawRegular = new ol.interaction.DrawRegular ({\n        source: this._source,\n        sides: 4\n      });\n    }\n    var regular = this._interactions.DrawRegular;\n    var div = document.createElement('DIV');\n    var down = ol.ext.element.create('DIV', { parent: div });\n    ol.ext.element.addListener(down, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() -1;\n      if (sides < 2) sides = 2;\n      regular.setSides (sides);\n      text.textContent = sides>2 ? sides+' pts' : 'circle';\n    }.bind(this));\n    var text = ol.ext.element.create('TEXT', { html:'4 pts', parent: div });\n    var up = ol.ext.element.create('DIV', { parent: div });\n    ol.ext.element.addListener(up, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() +1;\n      if (sides<3) sides=3;\n      regular.setSides(sides);\n      text.textContent = sides+' pts';\n    }.bind(this));\n    var ctrl = new ol.control.Toggle({\n      className: 'ol-drawregular',\n      title: this._getTitle(options.interactions.DrawRegular) || 'Regular',\n      interaction: this._interactions.DrawRegular,\n      // Options bar associated with the control\n      bar: new ol.control.Bar ({\n        controls:[ \n          new ol.control.TextButton({\n            html: div\n          })\n        ]\n      }) \n    });\n    this.addControl (ctrl);\n  }\n};\n/**\n * @private\n */\nol.control.EditBar.prototype._setDrawPolygon = function (className, interaction, title, options) {\n  var fedit = new ol.control.Toggle ({\n    className: className,\n    title: title,\n    interaction: interaction,\n    // Options bar associated with the control\n    bar: new ol.control.Bar({\n      controls:[ \n        new ol.control.TextButton ({\n          html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n          title: this._getTitle(options.interactions.UndoDraw) || 'undo last point',\n          handleClick: function(){\n            if (fedit.getInteraction().nbpts>1) fedit.getInteraction().removeLastPoint();\n          }\n        }),\n        new ol.control.TextButton({\n          html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          title: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          handleClick: function() {\n            // Prevent null objects on finishDrawing\n            if (fedit.getInteraction().nbpts>3) fedit.getInteraction().finishDrawing();\n          }\n        })\n      ]\n    }) \n  });\n  this.addControl (fedit);\n};\n/** Add modify tools\n * @private\n */ \nol.control.EditBar.prototype._setModifyInteraction = function (options) {\n  // Modify on selected features\n  if (options.interactions.ModifySelect !== false && options.interactions.Select !== false) {\n    if (options.interactions.ModifySelect instanceof ol.interaction.ModifyFeature) {\n      this._interactions.ModifySelect = options.interactions.ModifySelect;\n    } else {\n      this._interactions.ModifySelect = new ol.interaction.ModifyFeature({\n        features: this.getInteraction('Select').getFeatures()\n      });\n    }\n    if (this.getMap()) this.getMap().addInteraction(this._interactions.ModifySelect);\n    // Activate with select\n    this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    this._interactions.Select.on('change:active', function() {\n      this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    }.bind(this));\n  }\n  if (options.interactions.Transform !== false) {\n    if (options.interactions.Transform instanceof ol.interaction.Transform) {\n      this._interactions.Transform = options.interactions.Transform;\n    } else {\n      this._interactions.Transform = new ol.interaction.Transform ({\n        addCondition: ol.events.condition.shiftKeyOnly\n      });\n    }\n    var transform = new ol.control.Toggle ({\n      html: '<i></i>',\n      className: 'ol-transform',\n      title: this._getTitle(options.interactions.Transform) || 'Transform',\n      interaction: this._interactions.Transform\n    });\n    this.addControl (transform);\n  }\n  if (options.interactions.Split !== false) {\n    if (options.interactions.Split instanceof ol.interaction.Split) {\n      this._interactions.Split = options.interactions.Split;\n    } else {\n      this._interactions.Split = new ol.interaction.Split ({\n          sources: this._source\n      });\n    }\n    var split = new ol.control.Toggle ({\n      className: 'ol-split',\n      title: this._getTitle(options.interactions.Split) || 'Split',\n      interaction: this._interactions.Split\n    });\n    this.addControl (split);\n  }\n  if (options.interactions.Offset !== false) {\n    if (options.interactions.Offset instanceof ol.interaction.Offset) {\n      this._interactions.Offset = options.interactions.Offset;\n    } else {\n      this._interactions.Offset = new ol.interaction.Offset ({\n          source: this._source\n      });\n    }\n    var offset = new ol.control.Toggle ({\n      html: '<i></i>',\n      className: 'ol-offset',\n      title: this._getTitle(options.interactions.Offset) || 'Offset',\n      interaction: this._interactions.Offset\n    });\n    this.addControl (offset);\n  }\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple gauge control to display level information on the map.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t\t@param {String} options.className class of the control\n *\t\t@param {String} options.title title of the control\n *\t\t@param {number} options.max maximum value, default 100;\n *\t\t@param {number} options.val the value, default 0\n */\nol.control.Gauge = function(options)\n{\toptions = options || {};\n\tvar element = document.createElement(\"div\");\n\t\t\telement.className = ((options.className||\"\") + ' ol-gauge ol-unselectable ol-control').trim();\n\tthis.title_ = document.createElement(\"span\");\n\telement.appendChild(this.title_);\n\tthis.gauge_ = document.createElement(\"button\");\n\tthis.gauge_.setAttribute('type','button');\n\telement.appendChild(document.createElement(\"div\").appendChild(this.gauge_))\n\tthis.gauge_.style.width = '0px';\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\tthis.setTitle(options.title);\n\tthis.val(options.val);\n\tthis.set(\"max\", options.max||100);\n};\nol.ext.inherits(ol.control.Gauge, ol.control.Control);\n/** Set the control title\n* @param {string} title\n*/\nol.control.Gauge.prototype.setTitle = function(title)\n{\tthis.title_.innerHTML = title||\"\";\n\tif (!title) this.title_.display = 'none';\n\telse this.title_.display = '';\n};\n/** Set/get the gauge value\n* @param {number|undefined} v the value or undefined to get it\n* @return {number} the value\n*/\nol.control.Gauge.prototype.val = function(v)\n{\tif (v!==undefined)\n\t{\tthis.val_ = v;\n\t\tthis.gauge_.style.width = (v/this.get('max')*100)+\"%\";\n\t}\n\treturn this.val_;\n};\n\n/** Bookmark positions on ol maps.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires add\n * @fires remove\n * @param {} options Geobookmark's options\n *  @param {string} options.className default ol-bookmark\n *  @param {string} options.placeholder input placeholder, default Add a new geomark...\n *  @param {bool} options.editable enable modification, default true\n *  @param {string} options.namespace a namespace to save the boolmark (if more than one on a page), default ol\n *  @param {Array<any>} options.marks a list of default bookmarks: \n * @see [Geobookmark example](../../examples/map.control.geobookmark.html)\n * @example \nvar bm = new GeoBookmark ({ \n  marks: {\n    \"Paris\": {pos:_ol_proj_.transform([2.351828, 48.856578], 'EPSG:4326', 'EPSG:3857'), zoom:11, permanent: true },\n    \"London\": {pos:_ol_proj_.transform([-0.1275,51.507222], 'EPSG:4326', 'EPSG:3857'), zoom:12}\n  }\n});\n */\nol.control.GeoBookmark = function(options) {\n  options = options || {};\n  var self = this;\n  var element = document.createElement('div');\n  if (options.target) {\n    element.className = options.className || \"ol-bookmark\";\n  } else {\n    element.className = (options.className || \"ol-bookmark\") +\n          \" ol-unselectable ol-control ol-collapsed\";\n    element.addEventListener(\"mouseleave\", function() {\n      if (input !== document.activeElement) {\n        menu.style.display = 'none';\n      }\n    });\n    // Show bookmarks on click\n    this.button = document.createElement('button');\n    this.button.setAttribute('type', 'button');\n    this.button.addEventListener('click', function() {\n      menu.style.display = (menu.style.display === '' || menu.style.display === 'none' ? 'block': 'none');\n    });\n    element.appendChild(this.button);\n  }\n  // The menu\n  var menu = document.createElement('div');\n  element.appendChild(menu);\n  var ul = document.createElement('ul');\n  menu.appendChild(ul);\n  var input = document.createElement('input');\n  input.setAttribute(\"placeholder\", options.placeholder || \"Add a new geomark...\")\n  input.addEventListener(\"change\", function() {\n    var title = this.value;\n    if (title) {\n      self.addBookmark(title);\n      this.value = '';\n      self.dispatchEvent({\n        type: \"add\",\n        name: title\n      });\n    }\n    menu.style.display = 'none';\n  });\n  input.addEventListener(\"blur\", function() {\n    menu.style.display = 'none';\n  });\n  menu.appendChild(input);\n  // Init\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.on(\"propertychange\", function(e) {\n    if (e.key==='editable') {\n      element.className = element.className.replace(\" ol-editable\",\"\");\n      if (this.get('editable')) {\n        element.className += \" ol-editable\";\n      }\n    }\n    // console.log(e);\n  }.bind(this));\n  this.set(\"namespace\", options.namespace || 'ol');\n  this.set(\"editable\", options.editable !== false);\n  // Set default bmark\n  this.setBookmarks(localStorage[this.get('namespace')+\"@bookmark\"] ? null:options.marks);\n};\nol.ext.inherits(ol.control.GeoBookmark, ol.control.Control);\n/** Set bookmarks\n* @param {} bmark a list of bookmarks, default retreave in the localstorage\n* @example \nbm.setBookmarks({ \n  \"Paris\": {pos:_ol_proj_.transform([2.351828, 48.856578], 'EPSG:4326', 'EPSG:3857'), zoom:11, permanent: true },\n  \"London\": {pos:_ol_proj_.transform([-0.1275,51.507222], 'EPSG:4326', 'EPSG:3857'), zoom:12}\n});\n*/\nol.control.GeoBookmark.prototype.setBookmarks = function(bmark) {\n  if (!bmark) bmark = JSON.parse(localStorage[this.get('namespace')+\"@bookmark\"] || \"{}\");\n  var modify = this.get(\"editable\");\n  var ul = this.element.querySelector(\"ul\");\n  var menu = this.element.querySelector(\"div\");\n  var self = this;\n  ul.innerHTML = '';\n  for (var b in bmark) {\n    var li = document.createElement('li');\n    li.textContent = b;\n    li.setAttribute('data-bookmark', JSON.stringify(bmark[b]));\n    li.addEventListener('click', function() {\n      var bm = JSON.parse(this.getAttribute(\"data-bookmark\"));\n      self.getMap().getView().setCenter(bm.pos);\n      self.getMap().getView().setZoom(bm.zoom);\n      menu.style.display = 'none';\n    });\n    ul.appendChild(li);\n    if (modify && !bmark[b].permanent) {\n      var button = document.createElement('button');\n      button.setAttribute('data-name', b);\n      button.setAttribute(\"title\", \"Suppr.\");\n      button.addEventListener('click', function(e) {\n        self.removeBookmark(this.getAttribute(\"data-name\"));\n        self.dispatchEvent({ type: \"remove\", name: this.getAttribute(\"data-name\") });\n        e.stopPropagation();\n      });\n      li.appendChild(button);\n    }\n  }\n  localStorage[this.get('namespace')+\"@bookmark\"] = JSON.stringify(bmark);\n};\n/** Get Geo bookmarks\n* @return {any} a list of bookmarks : { BM1:{pos:ol.coordinates, zoom: integer}, BM2:{pos:ol.coordinates, zoom: integer} }\n*/\nol.control.GeoBookmark.prototype.getBookmarks = function() {\n  return JSON.parse(localStorage[this.get('namespace')+\"@bookmark\"] || \"{}\");\n};\n/** Remove a Geo bookmark\n* @param {string} name\n*/\nol.control.GeoBookmark.prototype.removeBookmark = function(name) {\n  if (!name) {\n    return;\n  }\n  var bmark = this.getBookmarks();\n  delete bmark[name];\n  this.setBookmarks(bmark);\n};\n/** Add a new Geo bookmark (replace existing one if any)\n* @param {string} name name of the bookmark (display in the menu)\n* @param {_ol_coordinate_} position default current position\n* @param {number} zoom default current map zoom\n* @param {bool} permanent prevent from deletion, default false\n*/\nol.control.GeoBookmark.prototype.addBookmark = function(name, position, zoom, permanent)\n{\n  if (!name) return;\n  var bmark = this.getBookmarks();\n  // Don't override permanent bookmark\n  if (bmark[name] && bmark[name].permanent) return;\n  // Create or override\n  bmark[name] = {\n    pos: position || this.getMap().getView().getCenter(),\n    zoom: zoom || this.getMap().getView().getZoom(),\n\tpermanent: !!permanent\n  };\n  this.setBookmarks(bmark);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control bar for OL3\n * The control bar is a container for other controls. It can be used to create toolbars.\n * Control bars can be nested and combined with ol.control.Toggle to handle activate/deactivate.\n *\n * @constructor\n * @extends {ol.control.Bar}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.centerLabel label for center button, default center\n */\nol.control.GeolocationBar = function(options) {\n  if (!options) options = {};\n  options.className = options.className || 'ol-geobar';\n  ol.control.Bar.call(this, options);\n  this.setPosition(options.position || 'bottom-right');\n  var element = this.element;\n  // Geolocation draw interaction\n  var interaction = new ol.interaction.GeolocationDraw({\n    source: options.source,\n    zoom: options.zoom,\n    followTrack: options.followTrack,\n    minAccuracy: options.minAccuracy || 10000\n  });\n  this._geolocBt = new ol.control.Toggle ({\n    className: 'geolocBt',\n    interaction: interaction,\n    onToggle: function() {\n      interaction.pause(true);\n      interaction.setFollowTrack(options.followTrack);\n      element.classList.remove('pauseTrack');\n    }\n  });\n  this.addControl(this._geolocBt);\n  this._geolocBt.setActive(false);\n  // Buttons\n  var bar = new ol.control.Bar();\n  this.addControl(bar);\n  var centerBt = new ol.control.TextButton ({\n    className: 'centerBt',\n    html: options.centerLabel ||'center',\n    handleClick: function() {\n      interaction.setFollowTrack('auto');\n    }\n  });\n  bar.addControl(centerBt);\n  var startBt = new ol.control.Button ({\n    className: 'startBt',\n    handleClick: function(){\n      interaction.pause(false);\n      interaction.setFollowTrack('auto');\n      element.classList.add('pauseTrack');\n    }\n  });\n  bar.addControl(startBt);\n  var pauseBt = new ol.control.Button ({\n    className: 'pauseBt',\n    handleClick: function(){\n      interaction.pause(true);\n      interaction.setFollowTrack('auto');\n      element.classList.remove('pauseTrack');\n    }\n  });\n  bar.addControl(pauseBt);\n  interaction.on('follow', function(e) {\n    if (e.following) {\n      element.classList.remove('centerTrack');\n    } else {\n      element.classList.add('centerTrack');\n    }\n  });\n  // Activate\n  this._geolocBt.on('change:active', function(e) {\n    if (e.active) {\n      element.classList.add('ol-active');\n    } else {\n      element.classList.remove('ol-active');\n    }\n  });\n};\nol.ext.inherits(ol.control.GeolocationBar, ol.control.Bar);\n/** Get the ol.interaction.GeolocationDraw associatedwith the bar\n * \n */\nol.control.GeolocationBar.prototype.getInteraction = function () {\n  return this._geolocBt.getInteraction();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers 3 lobe Overview Control.\n * The globe can rotate with map (follow.) \n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n * \t@param {boolean} follow follow the map when center change, default false\n * \t@param {top|bottom-left|right} align position as top-left, etc.\n * \t@param {Array<ol.layer>} layers list of layers to display on the globe\n * \t@param {ol.style.Style | Array.<ol.style.Style> | undefined} style style to draw the position on the map , default a marker\n */\nol.control.Globe = function(opt_options)\n{\tvar options = opt_options || {};\n\tvar self = this;\n\t// API\n\tvar element;\n\tif (options.target)\n\t{\telement = document.createElement(\"div\");\n\t\tthis.panel_ = options.target;\n\t}\n\telse\n\t{\telement = document.createElement(\"div\");\n\t\telement.classList.add('ol-globe', 'ol-unselectable', 'ol-control');\n\t\tif (/top/.test(options.align)) element.classList.add('ol-control-top');\n\t\tif (/right/.test(options.align)) element.classList.add('ol-control-right');\n\t\tthis.panel_ = document.createElement(\"div\");\n\t\tthis.panel_.classList.add(\"panel\")\n\t\telement.appendChild(this.panel_);\n\t\tthis.pointer_ = document.createElement(\"div\");\n\t\tthis.pointer_.classList.add(\"ol-pointer\");\n\t\telement.appendChild(this.pointer_);\n\t}\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n// http://openlayers.org/en/latest/examples/sphere-mollweide.html ???\n\t// Create a globe map\n\tthis.ovmap_ = new ol.Map(\n\t{\tcontrols: new ol.Collection(),\n\t\tinteractions: new ol.Collection(),\n\t\ttarget: this.panel_,\n\t\tview: new ol.View\n\t\t\t({\tzoom: 0,\n\t\t\t\tcenter: [0,0]\n\t\t\t}),\n\t\tlayers: options.layers\n\t});\n\tsetTimeout (function()\n\t{\tself.ovmap_.updateSize(); \n\t}, 0);\n\tthis.set('follow', options.follow || false);\n\t// Cache extent\n\tthis.extentLayer = new ol.layer.Vector(\n\t{\tname: 'Cache extent',\n\t\tsource: new ol.source.Vector(),\n\t\tstyle: options.style || [new ol.style.Style(\n\t\t\t\t\t{\timage: new ol.style.Circle(\n\t\t\t\t\t\t{\tfill: new ol.style.Fill({\n\t\t\t\t\t\t\t\tcolor: 'rgba(255,0,0, 1)'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tstroke: new ol.style.Stroke(\n\t\t\t\t\t\t\t{\twidth: 7,\n\t\t\t\t\t\t\t\tcolor: 'rgba(255,0,0, 0.8)'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tradius: 5\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t)]\n\t})\n\tthis.ovmap_.addLayer(this.extentLayer);\n};\nol.ext.inherits(ol.control.Globe, ol.control.Control);\n/**\n * Set the map instance the control associated with.\n * @param {ol.Map} map The map instance.\n */\nol.control.Globe.prototype.setMap = function(map) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\t// Get change (new layer added or removed)\n\tif (map) \n\t{\tthis._listener = map.getView().on('propertychange', this.setView.bind(this));\n\t\tthis.setView();\n\t}\n};\n/** Set the globe center with the map center\n*/\nol.control.Globe.prototype.setView = function()\n{\tif (this.getMap() && this.get('follow'))\n\t{\tthis.setCenter(this.getMap().getView().getCenter());\n\t}\n}\n/** Get globe map\n*\t@return {ol.Map}\n*/\nol.control.Globe.prototype.getGlobe = function()\n{\treturn this.ovmap_;\n}\n/** Show/hide the globe\n*/\nol.control.Globe.prototype.show = function(b)\n{\tif (b!==false) this.element.classList.remove(\"ol-collapsed\");\n\telse this.element.classList.add(\"ol-collapsed\");\n\tthis.ovmap_.updateSize();\n}\n/** Set position on the map\n*\t@param {top|bottom-left|right}  align\n*/\nol.control.Globe.prototype.setPosition = function(align)\n{\tif (/top/.test(align)) this.element.classList.add(\"ol-control-top\");\n\telse this.element.classList.remove(\"ol-control-top\");\n\tif (/right/.test(align)) this.element.classList.add(\"ol-control-right\");\n\telse this.element.classList.remove(\"ol-control-right\");\n}\n/** Set the globe center\n* @param {_ol_coordinate_} center the point to center to\n* @param {boolean} show show a pointer on the map, defaylt true\n*/\nol.control.Globe.prototype.setCenter = function (center, show)\n{\tvar self = this;\n\tthis.pointer_.classList.add(\"hidden\");\n\tif (center)\n\t{\tvar map = this.ovmap_;\n\t\tvar p = map.getPixelFromCoordinate(center);\n\t\tif (p) {\n\t\t\tif (show!==false) {\n\t\t\t\tvar h = this.element.clientHeight;\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.pointer_.style.top = String(Math.min(Math.max(p[1],0),h)) + 'px';\n\t\t\t\t\tself.pointer_.style.left = \"50%\";\n\t\t\t\t\tself.pointer_.classList.remove(\"hidden\");\n\t\t\t\t}, 800);\n\t\t\t}\n\t\t\tmap.getView().animate({ center: [center[0],0] });\n\t\t}\n\t}\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Draw a graticule on the map.\n *\n * @constructor\n * @extends {ol.control.CanvasBase}\n * @param {Object=} _ol_control_ options.\n *  @param {ol.projectionLike} options.projection projection to use for the graticule, default EPSG:4326 \n *  @param {number} options.maxResolution max resolution to display the graticule\n *  @param {ol.style.Style} options.style Style to use for drawing the graticule, default black.\n *  @param {number} options.step step beetween lines (in proj units), default 1\n *  @param {number} options.stepCoord show a coord every stepCoord, default 1\n *  @param {number} options.spacing spacing beetween lines (in px), default 40px \n *  @param {number} options.borderWidthwidth of the border (in px), default 5px \n *  @param {number} options.marginmargin of the border (in px), default 0px \n */\nol.control.Graticule = function(options) {\n  if (!options) options = {};\n  // Initialize parent\n  var elt = document.createElement(\"div\");\n  elt.className = \"ol-graticule ol-unselectable ol-hidden\";\n  ol.control.CanvasBase.call(this, { element: elt });\n  this.set('projection', options.projection || 'EPSG:4326');\n  // Use to limit calculation \n  var p = new ol.proj.Projection({code:this.get('projection')});\n  var m = p.getMetersPerUnit();\n  this.fac = 1;\n  while (m/this.fac>10) {\n    this.fac *= 10;\n  }\n  this.fac = 10000/this.fac;\n  this.set('maxResolution', options.maxResolution || Infinity);\n  this.set('step', options.step || 0.1);\n  this.set('stepCoord', options.stepCoord || 1);\n  this.set('spacing', options.spacing || 40);\n  this.set('margin', options.margin || 0);\n  this.set('borderWidth', options.borderWidth || 5);\n  this.set('stroke', options.stroke!==false);\n  this.formatCoord = options.formatCoord || function(c){return c;};\n  if (options.style instanceof ol.style.Style) {\n    this.setStyle(options.style);\n  }\n  else {\n    this.setStyle(new ol.style.Style({\n      stroke: new ol.style.Stroke({ color:\"#000\", width:1 }),\n      fill: new ol.style.Fill({ color: \"#fff\" }),\n      text: new ol.style.Text({\n        stroke: new ol.style.Stroke({ color:\"#fff\", width:2 }),\n        fill: new ol.style.Fill({ color:\"#000\" }),\n      }) \n    }));\n  }\n};\nol.ext.inherits(ol.control.Graticule, ol.control.CanvasBase);\nol.control.Graticule.prototype.setStyle = function (style) {\n  this._style = style;\n};\nol.control.Graticule.prototype._draw = function (e) {\n  if (this.get('maxResolution')<e.frameState.viewState.resolution) return;\n  var ctx = this.getContext(e);\n  var canvas = ctx.canvas;\n  var ratio = e.frameState.pixelRatio;\n  var w = canvas.width/ratio;\n  var h = canvas.height/ratio;\n  var proj = this.get('projection');\n  var map = this.getMap();\n  var bbox = \n  [\tmap.getCoordinateFromPixel([0,0]),\n    map.getCoordinateFromPixel([w,0]),\n    map.getCoordinateFromPixel([w,h]),\n    map.getCoordinateFromPixel([0,h])\n  ];\n  var xmax = -Infinity;\n  var xmin = Infinity;\n  var ymax = -Infinity;\n  var ymin = Infinity;\n  for (var i=0, c; c=bbox[i]; i++)\n  {\tbbox[i] = ol.proj.transform (c, map.getView().getProjection(), proj);\n    xmax = Math.max (xmax, bbox[i][0]);\n    xmin = Math.min (xmin, bbox[i][0]);\n    ymax = Math.max (ymax, bbox[i][1]);\n    ymin = Math.min (ymin, bbox[i][1]);\n  }\n  var spacing = this.get('spacing');\n  var step = this.get('step');\n  var step2 = this.get('stepCoord');\n  var borderWidth = this.get('borderWidth');\n  var margin = this.get('margin');\n  // Limit max line draw\n  var ds = (xmax-xmin)/step*spacing;\n  if (ds>w) \n  {\tvar dt = Math.round((xmax-xmin)/w*spacing /step);\n    step *= dt;\n    if (step>this.fac) step = Math.round(step/this.fac)*this.fac;\n  }\n  xmin = (Math.floor(xmin/step))*step -step;\n  ymin = (Math.floor(ymin/step))*step -step;\n  xmax = (Math.floor(xmax/step))*step +2*step;\n  ymax = (Math.floor(ymax/step))*step +2*step;\n  var extent = ol.proj.get(proj).getExtent();\n  if (extent)\n  {\tif (xmin < extent[0]) xmin = extent[0];\n    if (ymin < extent[1]) ymin = extent[1];\n    if (xmax > extent[2]) xmax = extent[2]+step;\n    if (ymax > extent[3]) ymax = extent[3]+step;\n  }\n  var hasLines = this.getStyle().getStroke() && this.get(\"stroke\");\n  var hasText = this.getStyle().getText();\n  var hasBorder = this.getStyle().getFill();\n  ctx.save();\n    ctx.scale(ratio,ratio);\n    ctx.beginPath();\n    ctx.rect(margin, margin, w-2*margin, h-2*margin);\n    ctx.clip();\n    ctx.beginPath();\n    var txt = {top:[],left:[],bottom:[], right:[]};\n    var x, y, p, p0, p1;\n    for (x=xmin; x<xmax; x += step)\n    {\tp0 = ol.proj.transform ([x, ymin], proj, map.getView().getProjection());\n      p0 = map.getPixelFromCoordinate(p0);\n      if (hasLines) ctx.moveTo(p0[0], p0[1]);\n      p = p0;\n      for (y=ymin+step; y<=ymax; y+=step)\n      {\tp1 = ol.proj.transform ([x, y], proj, map.getView().getProjection());\n        p1 = map.getPixelFromCoordinate(p1);\n        if (hasLines) ctx.lineTo(p1[0], p1[1]);\n        if (p[1]>0 && p1[1]<0) txt.top.push([x, p]);\n        if (p[1]>h && p1[1]<h) txt.bottom.push([x,p]);\n        p = p1;\n      }\n    }\n    for (y=ymin; y<ymax; y += step)\n    {\tp0 = ol.proj.transform ([xmin, y], proj, map.getView().getProjection());\n      p0 = map.getPixelFromCoordinate(p0);\n      if (hasLines) ctx.moveTo(p0[0], p0[1]);\n      p = p0;\n      for (x=xmin+step; x<=xmax; x+=step)\n      {\tp1 = ol.proj.transform ([x, y], proj, map.getView().getProjection());\n        p1 = map.getPixelFromCoordinate(p1);\n        if (hasLines) ctx.lineTo(p1[0], p1[1]);\n        if (p[0]<0 && p1[0]>0) txt.left.push([y,p]);\n        if (p[0]<w && p1[0]>w) txt.right.push([y,p]);\n        p = p1;\n      }\n    }\n    if (hasLines)\n    {\tctx.strokeStyle = this.getStyle().getStroke().getColor();\n      ctx.lineWidth = this.getStyle().getStroke().getWidth();\n      ctx.stroke();\n    }\n    // Draw text\n    if (hasText)\n    {\n      ctx.fillStyle = this.getStyle().getText().getFill().getColor();\n      ctx.strokeStyle = this.getStyle().getText().getStroke().getColor();\n      ctx.lineWidth = this.getStyle().getText().getStroke().getWidth();\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'hanging';\n      var t, tf;\n      var offset = (hasBorder ? borderWidth : 0) + margin + 2;\n      for (i=0; t = txt.top[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n      {\ttf = this.formatCoord(t[0]);\n        ctx.strokeText(tf, t[1][0], offset);\n        ctx.fillText(tf, t[1][0], offset);\n      }\n      ctx.textBaseline = 'alphabetic';\n      for (i=0; t = txt.bottom[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n      {\ttf = this.formatCoord(t[0]);\n        ctx.strokeText(tf, t[1][0], h-offset);\n        ctx.fillText(tf, t[1][0], h-offset);\n      }\n      ctx.textBaseline = 'middle';\n      ctx.textAlign = 'left';\n      for (i=0; t = txt.left[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n      {\ttf = this.formatCoord(t[0]);\n        ctx.strokeText(tf, offset, t[1][1]);\n        ctx.fillText(tf, offset, t[1][1]);\n      }\n      ctx.textAlign = 'right';\n      for (i=0; t = txt.right[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n      {\ttf = this.formatCoord(t[0]);\n        ctx.strokeText(tf, w-offset, t[1][1]);\n        ctx.fillText(tf, w-offset, t[1][1]);\n      }\n    }\n    // Draw border\n    if (hasBorder)\n    {\tvar fillColor = this.getStyle().getFill().getColor();\n      var color, stroke;\n      if (stroke = this.getStyle().getStroke())\n      {\tcolor = this.getStyle().getStroke().getColor();\n      }\n      else\n      {\tcolor = fillColor;\n        fillColor = \"#fff\";\n      }\n      ctx.strokeStyle = color;\n      ctx.lineWidth = stroke ? stroke.getWidth() : 1;\n      // \n      for (i=1; i<txt.top.length; i++)\n      {\tctx.beginPath();\n        ctx.rect(txt.top[i-1][1][0], margin, txt.top[i][1][0]-txt.top[i-1][1][0], borderWidth);\n        ctx.fillStyle = Math.round(txt.top[i][0]/step)%2 ? color: fillColor;\n        ctx.fill(); \n        ctx.stroke(); \n      }\n      for (i=1; i<txt.bottom.length; i++)\n      {\tctx.beginPath();\n        ctx.rect(txt.bottom[i-1][1][0], h-borderWidth-margin, txt.bottom[i][1][0]-txt.bottom[i-1][1][0], borderWidth);\n        ctx.fillStyle = Math.round(txt.bottom[i][0]/step)%2 ? color: fillColor;\n        ctx.fill(); \n        ctx.stroke(); \n      }\n      for (i=1; i<txt.left.length; i++)\n      {\tctx.beginPath();\n        ctx.rect(margin, txt.left[i-1][1][1], borderWidth, txt.left[i][1][1]-txt.left[i-1][1][1]);\n        ctx.fillStyle = Math.round(txt.left[i][0]/step)%2 ? color: fillColor;\n        ctx.fill(); \n        ctx.stroke(); \n      }\n      for (i=1; i<txt.right.length; i++)\n      {\tctx.beginPath();\n        ctx.rect(w-borderWidth-margin, txt.right[i-1][1][1], borderWidth, txt.right[i][1][1]-txt.right[i-1][1][1]);\n        ctx.fillStyle = Math.round(txt.right[i][0]/step)%2 ? color: fillColor;\n        ctx.fill(); \n        ctx.stroke(); \n      }\n      ctx.beginPath();\n      ctx.fillStyle = color;\n      ctx.rect(margin,margin, borderWidth, borderWidth);\n      ctx.rect(margin,h-borderWidth-margin, borderWidth,borderWidth);\n      ctx.rect(w-borderWidth-margin,margin, borderWidth, borderWidth);\n      ctx.rect(w-borderWidth-margin,h-borderWidth-margin, borderWidth,borderWidth);\n      ctx.fill(); \n    }\n  ctx.restore();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Draw a grid reference on the map and add an index.\n *\n * @constructor\n * @extends {ol.control.CanvasBase}\n * @fires select\n * @param {Object=} Control options.\n *  @param {ol.style.Style} options.style Style to use for drawing the grid (stroke and text), default black.\n *  @param {number} options.maxResolution max resolution to display the graticule\n *  @param {ol.extent} options.extent extent of the grid, required\n *  @param {ol.size} options.size number of lines and cols, required\n *  @param {number} options.margin margin to display text (in px), default 0px\n *  @param {ol.source.Vector} options.source source to use for the index, default none (use setIndex to reset the index)\n *  @param {string | function} options.property a property to display in the index or a function that takes a feature and return the name to display in the index, default 'name'.\n *  @param {function|undefined} options.sortFeatures sort function to sort 2 features in the index, default sort on property option\n *  @param {function|undefined} options.indexTitle a function that takes a feature and return the title to display in the index, default the first letter of property option\n *  @param {string} options.filterLabel label to display in the search bar, default 'filter'\n */\nol.control.GridReference = function(options) {\n  if (!options) options = {};\n  // Initialize parent\n  var elt = document.createElement(\"div\");\n  elt.className = (!options.target ? \"ol-control \":\"\") +\"ol-gridreference ol-unselectable \"+(options.className||\"\");\n  options.style = options.style || new ol.style.Style({\n    stroke: new ol.style.Stroke({ color:\"#000\", width:1 }),\n    text: new ol.style.Text({\n      font: \"bold 14px Arial\",\n      stroke: new ol.style.Stroke({ color:\"#fff\", width:2 }),\n      fill: new ol.style.Fill({ color:\"#000\" }),\n    })\n  });\n  ol.control.CanvasBase.call(this, {\n    element: elt,\n    target: options.target,\n    style: options.style\n  });\n  if (typeof (options.property)=='function') this.getFeatureName = options.property;\n  if (typeof (options.sortFeatures)=='function') this.sortFeatures = options.sortFeatures;\n  if (typeof (options.indexTitle)=='function') this.indexTitle = options.indexTitle;\n  // Set index using the source\n  this.source_ = options.source;\n  if (options.source) {\n    this.setIndex(options.source.getFeatures(), options);\n    // reload on ready\n    options.source.once('change',function() {\n      if (options.source.getState() === 'ready'){\n        this.setIndex(options.source.getFeatures(), options);\n      }\n    }.bind(this));\n  }\n  // Options\n  this.set('maxResolution', options.maxResolution || Infinity);\n  this.set('extent', options.extent);\n  this.set('size', options.size);\n  this.set('margin', options.margin || 0);\n  this.set('property', options.property || 'name');\n  this.set('filterLabel', options.filterLabel || 'filter');\n};\nol.ext.inherits(ol.control.GridReference, ol.control.CanvasBase);\n/** Returns the text to be displayed in the index\n * @param {ol.Feature} f the feature\n * @return {string} the text to be displayed in the index\n * @api\n */\nol.control.GridReference.prototype.getFeatureName = function (f) {\n  return f.get(this.get('property')||'name');\n};\n/** Sort function\n * @param {ol.Feature} a first feature\n * @param {ol.Feature} b second feature\n * @return {Number} 0 if a==b, -1 if a<b, 1 if a>b\n * @api\n */\nol.control.GridReference.prototype.sortFeatures = function (a,b) {\n  return (this.getFeatureName(a) == this.getFeatureName(b)) ? 0 : (this.getFeatureName(a) < this.getFeatureName(b)) ? -1 : 1; \n};\n/** Get the feature title\n * @param {ol.Feature} f\n * @return the first letter of the eature name (getFeatureName)\n * @api\n */\nol.control.GridReference.prototype.indexTitle = function (f) {\n  return this.getFeatureName(f).charAt(0);\n};\n/** Display features in the index\n * @param { Array<ol.Feature> | ol.Collection<ol.Feature> } features\n */\nol.control.GridReference.prototype.setIndex = function (features) {\n  if (!this.getMap()) return;\n  var self = this;\n  if (features.getArray) features = features.getArray();\n  features.sort ( function(a,b) { return self.sortFeatures(a,b); } );\n  this.element.innerHTML = \"\";\n  var elt = this.element;\n  var search = document.createElement(\"input\");\n  search.setAttribute('type', 'search');\n  search.setAttribute('placeholder', this.get('filterLabel') || 'filter');\n  var searchKeyupFunction = function() {\n    var v = this.value.replace(/^\\*/,'');\n    // console.log(v)\n    var r = new RegExp (v, 'i');\n    ul.querySelectorAll('li').forEach(function(li) {\n      if (li.classList.contains('ol-title')) {\n        li.style.display = '';\n      } else {\n        if (r.test(li.querySelector('.ol-name').textContent)) li.style.display = '';\n        else li.style.display = 'none';\n      }\n    });\n    ul.querySelectorAll(\"li.ol-title\").forEach(function(li) {\n      var nextAll = false;\n      nextAll = [].filter.call(li.parentNode.children, function (htmlElement) {\n        return (htmlElement.previousElementSibling === li) ? nextAll = true : nextAll;\n      });\n      console.log(nextAll);\n      var nextVisible = nextAll[0];\n      if (nextVisible.length && !nextVisible.classList.contains('ol-title')) li.style.display = '';\n      else li.style.display = 'none';\n    });\n  };\n  search.addEventListener('search', searchKeyupFunction);\n  search.addEventListener('keyup', searchKeyupFunction);\n  elt.appendChild(search);\n  var ul = document.createElement(\"ul\");\n  elt.appendChild(ul);\n  var r, title;\n  for (var i=0, f; f=features[i]; i++) {\n    (function(feat) {\n      r = self.getReference(feat.getGeometry().getFirstCoordinate());\n      if (r) {\n        var name = self.getFeatureName(feat);\n        var c = self.indexTitle(feat);\n        if (c != title) {\n          var li_title = document.createElement(\"li\");\n          li_title.classList.add('ol-title');\n          li_title.textContent = c;\n          ul.appendChild(li_title);\n        }\n        title = c;\n        var li_ref_name = document.createElement(\"li\");\n        var span_name = document.createElement(\"span\");\n            span_name.classList.add(\"ol-name\");\n            span_name.textContent = name;\n        li_ref_name.appendChild(span_name);\n        var span_ref = document.createElement(\"span\");\n            span_ref.classList.add(\"ol-ref\");\n            span_ref.textContent = r;\n        li_ref_name.appendChild(span_ref);\n        var feature = feat;\n        li_ref_name.addEventListener(\"click\", function() {\n          self.dispatchEvent({ type:\"select\", feature: feature });\n        });\n        ul.appendChild(li_ref_name);\n      }\n    })(f);\n  }\n};\n/** Get reference for a coord\n*\t@param {ol.coordinate} coords\n*\t@return {string} the reference\n*/\nol.control.GridReference.prototype.getReference = function (coords) {\n  if (!this.getMap()) return;\n  var extent = this.get('extent');\n  var size = this.get('size');\n  var dx = Math.floor ( (coords[0] - extent[0]) / (extent[2]- extent[0]) * size[0] );\n  if (dx<0 || dx>=size[0]) return \"\";\n  var dy = Math.floor ( (extent[3] - coords[1]) / (extent[3]- extent[1]) * size[1] );\n  if (dy<0 || dy>=size[1]) return \"\";\n  return String.fromCharCode(65+dx)+dy;\n};\n/** Draw the grid\n* @param {ol.event} e postcompose event\n* @private\n*/\nol.control.GridReference.prototype._draw = function (e) {\n  if (this.get('maxResolution')<e.frameState.viewState.resolution) return;\n  var ctx = this.getContext(e);\n  var canvas = ctx.canvas;\n  var ratio = e.frameState.pixelRatio;\n  var w = canvas.width/ratio;\n  var h = canvas.height/ratio;\n  var extent = this.get('extent');\n  var size = this.get('size');\n  var map = this.getMap();\n  var ex = ol.extent.boundingExtent([map.getPixelFromCoordinate([extent[0],extent[1]]), map.getPixelFromCoordinate([extent[2],extent[3]])]);\n  var p0 = [ex[0],ex[1]];\n  var p1 = [ex[2],ex[3]];\n  var dx = (p1[0]-p0[0])/size[0];\n  var dy = (p1[1]-p0[1])/size[1];\n  ctx.save();\n    var margin = this.get('margin');\n    ctx.scale(ratio,ratio);\n    ctx.strokeStyle = this.getStroke().getColor();\n    ctx.lineWidth = this.getStroke().getWidth();\n    // Draw grid\n    ctx.beginPath();\n    var i;\n    for (i=0; i<=size[0]; i++) {\n      ctx.moveTo(p0[0]+i*dx, p0[1]);\n      ctx.lineTo(p0[0]+i*dx, p1[1]);\n    }\n    for (i=0; i<=size[1]; i++) {\n      ctx.moveTo(p0[0], p0[1]+i*dy);\n      ctx.lineTo(p1[0], p0[1]+i*dy);\n    }\n    ctx.stroke();\n    // Draw text\n    ctx.font = this.getTextFont();\n    ctx.fillStyle = this.getTextFill().getColor();\n    ctx.strokeStyle = this.getTextStroke().getColor();\n    var lw = ctx.lineWidth = this.getTextStroke().getWidth();\n    var spacing = margin +lw;\n    ctx.textAlign = 'center';\n    var letter, x, y;\n    for (i=0; i<size[0]; i++) {\n      letter = String.fromCharCode(65+i);\n      x = p0[0]+i*dx+dx/2;\n      y = p0[1]-spacing;\n      if (y<0) {\n        y = spacing;\n        ctx.textBaseline = 'hanging';\n      }\n      else ctx.textBaseline = 'alphabetic';\n      ctx.strokeText(letter, x, y);\n      ctx.fillText(letter, x, y);\n      y = p1[1]+spacing;\n      if (y>h) {\n        y = h-spacing;\n        ctx.textBaseline = 'alphabetic';\n      }\n      else ctx.textBaseline = 'hanging';\n      ctx.strokeText(letter, x, y);\n      ctx.fillText(letter, x, y);\n    }\n    ctx.textBaseline = 'middle';\n    for (i=0; i<size[1]; i++) {\n      y = p0[1]+i*dy+dy/2;\n      ctx.textAlign = 'right';\n      x = p0[0] - spacing;\n      if (x<0) {\n        x = spacing;\n        ctx.textAlign = 'left';\n      }\n      else ctx.textAlign = 'right';\n      ctx.strokeText(i, x, y);\n      ctx.fillText(i, x, y);\n      x = p1[0] + spacing;\n      if (x>w) {\n        x = w-spacing;\n        ctx.textAlign = 'right';\n      }\n      else ctx.textAlign = 'left';\n      ctx.strokeText(i, x, y);\n      ctx.fillText(i, x, y);\n    }\n  ctx.restore();\n};\n\n/** Image line control\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires collapse\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {ol.source.Vector} options.source a vector source that contains the images\n *\t@param {function} options.getImage a function that gets a feature and return the image url, default return the img propertie\n *\t@param {function} options.getTitle a function that gets a feature and return the title, default return an empty string\n *\t@param {boolean} options.collapsed the line is collapse, default false\n *\t@param {boolean} options.collapsible the line is collapsible, default false\n *\t@param {number} options.maxFeatures the maximum image element in the line, default 100\n *\t@param {boolean} options.hover select image on hover, default false\n *\t@param {string|boolean} options.linkColor link color or false if no link, default false\n */\nol.control.Imageline = function(options) {\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-imageline'\n      + (options.target ? '': ' ol-unselectable ol-control')\n      + (options.collapsed && options.collapsible ? 'ol-collapsed' : '')\n      + ('ontouchstart' in window ? ' ol-touch' : '')\n  });\n  if (!options.target && options.collapsible) {\n    ol.ext.element.create('BUTTON', {\n      type: 'button',\n      click: function() {\n        this.toggle();\n      }.bind(this),\n      parent: element\n    });\n  }\n  // Source \n  this._source = options.source;\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Scroll imageline\n  this._setScrolling();\n  this._scrolldiv.addEventListener(\"scroll\", function() {\n    if (this.getMap()) this.getMap().render();\n  }.bind(this));\n  // Parameters\n  if (typeof(options.getImage)==='function') this._getImage =  options.getImage;\n  if (typeof(options.getTitle)==='function') this._getTitle =  options.getTitle;\n  this.set('maxFeatures', options.maxFeatures || 100);\n  this.set('linkColor', options.linkColor || false);\n  this.set('hover', options.hover || false);\n  this.set('useExtent', options.useExtent || false);\n  this.refresh();\n};\nol.ext.inherits(ol.control.Imageline, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.Imageline.prototype.setMap = function (map) {\n\tif (this._listener) {\n    this._listener.forEach(function(l) {\n      ol.Observable.unByKey(l);\n    }.bind(this));\n  }\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (map) {\t\n    this._listener = [\n      map.on('postcompose', this._drawLink.bind(this)),\n      map.on('moveend', function() { \n        if (this.get('useExtent')) this.refresh();\n      }.bind(this))\n    ]\n\t}\n};\n/** Set useExtent param and refresh the line\n * @param {boolean} b\n */\nol.control.Imageline.prototype.useExtent = function(b) {\n  this.set('useExtent', b);\n  this.refresh();\n};\n/** Is the line collapsed\n * @return {boolean}\n */\nol.control.Imageline.prototype.isCollapsed = function() {\n  return this.element.classList.contains('ol-collapsed');\n};\n/** Collapse the line\n * @param {boolean} b\n */\nol.control.Imageline.prototype.collapse = function(b) {\n  if (b) this.element.classList.add('ol-collapsed');\n  else this.element.classList.remove('ol-collapsed');\n  if (this.getMap()) {\n    setTimeout ( function() {\n      this.getMap().render();\n    }.bind(this), this.isCollapsed() ? 0 : 250);\n  }\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Collapse the line\n */\nol.control.Imageline.prototype.toggle = function() {\n  this.element.classList.toggle('ol-collapsed');\n  if (this.getMap()) {\n    setTimeout ( function() {\n      this.getMap().render();\n    }.bind(this), this.isCollapsed() ? 0 : 250);\n  }\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Default function to get an image of a feature\n * @param {ol.Feature} f\n * @private\n */\nol.control.Imageline.prototype._getImage = function(f) {\n  return f.get('img');\n};\n/** Default function to get an image title\n * @param {ol.Feature} f\n * @private\n */\nol.control.Imageline.prototype._getTitle = function(/* f */) {\n  return '';\n};\n/**\n * Get features\n * @return {Array<ol.Feature>}\n */\nol.control.Imageline.prototype.getFeatures = function() {\n  var map = this.getMap();\n  if (!this.get('useExtent') || !map) {\n    return this._source.getFeatures();\n  } else {\n    var extent = map.getView().calculateExtent(map.getSize());\n    return this._source.getFeaturesInExtent(extent);\n  }\n};\n/** Set element scrolling with a acceleration effect on desktop\n * (on mobile it uses the scroll of the browser)\n * @private\n */\nol.control.Imageline.prototype._setScrolling = function() {\n  var elt = this._scrolldiv = ol.ext.element.create('DIV', {\n    parent: this.element\n  });\n  ol.ext.element.scrollDiv(elt, {\n    // Prevent selection when moving\n    onmove: function(b) {\n      this._moving=b; \n    }.bind(this)\n  });\n};\n/**\n * Refresh the imageline with new data\n */\nol.control.Imageline.prototype.refresh = function() {\n  this._scrolldiv.innerHTML = '';\n  var features = this.getFeatures();\n  var current = this._select ? this._select.feature : null;\n  if (this._select) this._select.elt = null;\n  this._iline = [];\n  if (this.getMap()) this.getMap().render();\n  // Add a new image\n  var addImage = function(f) {\n    if (this._getImage(f)) {\n      var img = ol.ext.element.create('DIV', {\n        className: 'ol-image',\n        parent: this._scrolldiv\n      });\n      ol.ext.element.create('IMG', {\n        src: this._getImage(f),\n        parent: img\n      }).addEventListener('load', function(){\n        this.classList.add('ol-loaded');\n      });\n      ol.ext.element.create('SPAN', {\n        html: this._getTitle(f),\n        parent: img\n      });\n      // Current image\n      var sel = { elt: img, feature: f };\n      // On click > dispatch event\n      img.addEventListener('click', function(){\n        if (!this._moving) {\n          this.dispatchEvent({type: 'select', feature: f });\n          this._scrolldiv.scrollLeft = img.offsetLeft \n            + ol.ext.element.getStyle(img, 'width')/2\n            - ol.ext.element.getStyle(this.element, 'width')/2;\n            if (this._select) this._select.elt.classList.remove('select');\n            this._select = sel;\n            this._select.elt.classList.add('select');\n          }\n      }.bind(this));\n      // Show link\n      img.addEventListener('mouseover', function(e) {\n        if (this.get('hover')) {\n          if (this._select) this._select.elt.classList.remove('select');\n          this._select = sel;\n          this._select.elt.classList.add('select');\n          this.getMap().render();\n          e.stopPropagation();\n        }\n      }.bind(this));\n      // Remove link\n      img.addEventListener('mouseout', function(e) {\n        if (this.get('hover')) {\n          if (this._select) this._select.elt.classList.remove('select');\n          this._select = false;\n          this.getMap().render();\n          e.stopPropagation();\n        }\n      }.bind(this));\n      // Prevent image dragging\n      img.ondragstart = function(){ return false; };\n      // Add image\n      this._iline.push(sel);\n      if (current===f) {\n        this._select = sel;\n        sel.elt.classList.add('select');\n      }\n    }\n  }.bind(this);\n  // Add images \n  var nb = this.get('maxFeatures');\n  for (var i=0, f; f=features[i]; i++) {\n    if (nb--<0) break;\n    addImage(f);\n  }\n  // Add the selected one\n  if (this._select && this._select.feature && !this._select.elt) {\n    addImage(this._select.feature);\n  }\n};\n/** Center image line on a feature\n * @param {ol.feature} feature\n * @param {boolean} scroll scroll the line to center on the image, default true\n * @api\n */\nol.control.Imageline.prototype.select = function(feature, scroll) {\n  this._select = false;\n  // Find the image\n  this._iline.forEach(function (f) {\n    if (f.feature === feature) {\n      f.elt.classList.add('select');\n      this._select = f;\n      if (scroll!==false) {\n        this._scrolldiv.scrollLeft = f.elt.offsetLeft \n          + ol.ext.element.getStyle(f.elt, 'width')/2\n          - ol.ext.element.getStyle(this.element, 'width')/2;\n      }\n    } else {\n      f.elt.classList.remove('select');\n    }\n  }.bind(this));\n};\n/** Draw link on the map\n * @private\n */\nol.control.Imageline.prototype._drawLink = function(e) {\n  if (!this.get('linkColor') | this.isCollapsed()) return;\n  var map = this.getMap();\n  if (map && this._select && this._select.elt) {\n    var ctx = e.context;\n    var ratio = e.frameState.pixelRatio;\n    var pt = [ \n      this._select.elt.offsetLeft \n      - this._scrolldiv.scrollLeft\n      + ol.ext.element.getStyle(this._select.elt, 'width')/2, \n      parseFloat(ol.ext.element.getStyle(this.element, 'top')) || this.getMap().getSize()[1]\n    ];\n    var geom = this._select.feature.getGeometry().getFirstCoordinate();\n    geom = this.getMap().getPixelFromCoordinate(geom);\n    ctx.save();\n    ctx.fillStyle = this.get('linkColor');\n    ctx.beginPath();\n      if (geom[0]>pt[0]) {\n        ctx.moveTo((pt[0]-5)*ratio, pt[1]*ratio);\n        ctx.lineTo((pt[0]+5)*ratio, (pt[1]+5)*ratio);\n      } else {\n        ctx.moveTo((pt[0]-5)*ratio, (pt[1]+5)*ratio);\n        ctx.lineTo((pt[0]+5)*ratio, pt[1]*ratio);\n      }\n      ctx.lineTo(geom[0]*ratio, geom[1]*ratio);\n    ctx.fill();\n    ctx.restore();\n  }\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Geoportail isochrone Control.\n * @see https://geoservices.ign.fr/documentation/geoservices/isochrones.html\n * @constructor\n * @extends {ol.control.Control}\n * @fires isochrone\n * @fires error\n * @param {Object=} options\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {string | undefined} options.inputLabel label for the input, default none\n *\t@param {string | undefined} options.noCollapse prevent collapsing on input blur, default false\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms) use -1 to prevent autocompletion, default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\t@param {integer | undefined} options.maxHistory maximum number of items to display in history. Set -1 if you don't want history, default maxItems\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index.\n *\t@param {function} options.autocomplete a function that take a search string and callback function to send an array\n *\n *  @param {string} options.exclusions Exclusion list separate with a comma 'Toll,Tunnel,Bridge'\n */\nol.control.IsochroneGeoportail = function(options) {\n  var self = this;\n\tif (!options) options = {};\n\tif (options.typing == undefined) options.typing = 300;\n\tvar classNames = (options.className ? options.className : '')+ ' ol-isochrone ol-routing';\n\tif (!options.target) classNames += ' ol-unselectable ol-control';\n\tvar element = ol.ext.element.create('DIV', { className: classNames })\n\tif (!options.target) {\n    var bt = ol.ext.element.create('BUTTON', { parent: element })\n    bt.addEventListener('click', function(){\n      element.classList.toggle('ol-collapsed');\n    });\n  }\n  // Inherits\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('iter', 1);\n  var content = ol.ext.element.create('DIV', { className: 'content', parent: element } )\n  // Search control\n  this._addSearchCtrl(content, options);\n  // Method buttons\n  ol.ext.element.create('BUTTON', { className: 'ol-button ol-method-time selected', title:'isochrone', parent: content })\n    .addEventListener('click', function(){\n      this.setMethod('time');\n    }.bind(this));\n  ol.ext.element.create('I', { className: 'ol-button ol-method-distance', title:'isodistance', parent: content })\n    .addEventListener('click', function(){\n      this.setMethod('distance');\n    }.bind(this));\n  // Mode buttons\n  ol.ext.element.create('I', { className: 'ol-button ol-car selected', title:'by car', parent: content })\n    .addEventListener('click', function(){\n      this.setMode('car');\n    }.bind(this));\n  ol.ext.element.create('I', { className: 'ol-button ol-pedestrian', title:'by foot', parent: content })\n    .addEventListener('click', function(){\n      this.setMode('pedestrian');\n    }.bind(this));\n  // Direction buttons\n  ol.ext.element.create('I', { className: 'ol-button ol-direction-direct selected', title:'direct', parent: content })\n    .addEventListener('click', function(){\n      this.setDirection('direct');\n    }.bind(this));\n  ol.ext.element.create('I', { className: 'ol-button ol-direction-reverse', title:'reverse', parent: content })\n    .addEventListener('click', function(){\n      this.setDirection('reverse');\n    }.bind(this));\n  // Input \n  var div = ol.ext.element.create('DIV', { className: 'ol-time', parent: content })\n  ol.ext.element.create('DIV', { html:'isochrone:', parent: div });\n  ol.ext.element.create('INPUT', { type: 'number', parent: div, min: 0 })\n    .addEventListener('change', function(){\n      self.set('hour', Number(this.value));\n    });\n  ol.ext.element.create('TEXT', { parent: div, html: 'h' });\n  ol.ext.element.create('INPUT', { type: 'number', parent: div, min: 0 })\n    .addEventListener('change', function(){\n      self.set('minute', Number(this.value));\n    });\n  ol.ext.element.create('TEXT', { parent: div, html: 'mn' });\n  div = ol.ext.element.create('DIV', { className: 'ol-distance', parent: content });\n  ol.ext.element.create('DIV', { html:'isodistance:', parent: div });\n  ol.ext.element.create('INPUT', { type: 'number', step: 'any', parent: div, min: 0 })\n    .addEventListener('change', function(){\n      self.set('distance', Number(this.value));\n    });\n  ol.ext.element.create('TEXT', { parent: div, html: 'km' });\n  div = ol.ext.element.create('DIV', { className: 'ol-iter', parent: content })\n  ol.ext.element.create('DIV', { html:'Iteration:', parent: div });\n  ol.ext.element.create('INPUT', { type: 'number', parent: div, value: 1, min: 1 })\n    .addEventListener('change', function(){\n      self.set('iter', Number(this.value));\n    });\n  // OK button\n  ol.ext.element.create('I', { className:'ol-ok', html:'ok', parent: content })\n    .addEventListener('click', function() {\n      var val = 0;\n      switch (this.get('method')) {\n        case 'distance':  {\n          val = this.get('distance')*1000;\n          break;\n        }\n        default: {\n          val = (this.get('hour')||0)*3600 + (this.get('minute')||0)*60;\n          break;\n        }\n      }\n      if (val && this.get('coordinate')) {\n        this.search(this.get('coordinate'), val);\n      }\n    }.bind(this));\n  this.set('url', 'https://wxs.ign.fr/'+options.apiKey+'/isochrone/isochrone.json');\n  this._ajax = new ol.ext.Ajax({ \n    dataType: 'JSON',\n    auth: options.auth\n  });\n  this._ajax.on('success', this._success.bind(this));\n  this._ajax.on('error', this._error.bind(this));\n  // searching\n  this._ajax.on('loadstart', function() {\n    this.element.classList.add('ol-searching');\n  }.bind(this));\n  this._ajax.on('loadend', function() {\n    this.element.classList.remove('ol-searching');\n  }.bind(this));\n  this.setMethod(options.method);\n};\nol.ext.inherits(ol.control.IsochroneGeoportail, ol.control.Control);\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.IsochroneGeoportail.prototype.setMap = function (map) {\n\tol.control.Control.prototype.setMap.call(this, map);\n\tthis._search.setMap(map);\n};\n/** Add a new search input\n * @private\n */\nol.control.IsochroneGeoportail.prototype._addSearchCtrl = function (element, options) {\n\tvar div = ol.ext.element.create(\"DIV\", { parent: element });\n  var search = this._search = new ol.control.SearchGeoportail({\n    className: 'IGNF ol-collapsed',\n\t\tapiKey: options.apiKey,\n\t\ttarget: div\n\t});\n\tsearch.on('select', function(e){\n    search.setInput(e.search.fulltext);\n    this.set('coordinate', e.coordinate);\n  }.bind(this));\n  search.on('change:input', function(){\n    this.set('coordinate', false);\n  }.bind(this));\n};\n/** Set the travel method\n * @param [string] method The method (time or distance)\n */\nol.control.IsochroneGeoportail.prototype.setMethod = function(method) {7\n  method = (/distance/.test(method) ? 'distance' : 'time');\n  this.element.querySelector(\".ol-method-time\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-method-distance\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-method-\"+method).classList.add(\"selected\");\n  this.element.querySelector(\"div.ol-time\").classList.remove(\"selected\");\n  this.element.querySelector(\"div.ol-distance\").classList.remove(\"selected\");\n  this.element.querySelector(\"div.ol-\"+method).classList.add(\"selected\");\n  this.set('method', method);\n};\n/** Set mode\n * @param {string} mode The mode: 'car' or 'pedestrian', default 'car'\n */\nol.control.IsochroneGeoportail.prototype.setMode = function (mode) {\n  this.set('mode', mode);\n  this.element.querySelector(\".ol-car\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-pedestrian\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-\"+mode).classList.add(\"selected\");\n};\n/** Set direction\n * @param {string} direction The direction: 'direct' or 'reverse', default direct\n */\nol.control.IsochroneGeoportail.prototype.setDirection = function (direction) {\n  this.set('direction', direction);\n  this.element.querySelector(\".ol-direction-direct\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-direction-reverse\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-direction-\"+direction).classList.add(\"selected\");\n};\n/** Calculate an isochrone\n * @param {ol.coordinate} coord\n * @param {number|string} option A number as time (in second) or distance (in meter), depend on method propertie\n * or a string with a unit (s, mn, h for time or km, m)\n */\nol.control.IsochroneGeoportail.prototype.search = function(coord, option, iter) {\n  var proj = this.getMap() ? this.getMap().getView().getProjection() : 'EPSG:3857';\n  var method = /distance/.test(this.get('method')) ? 'distance' : 'time';\n  if (typeof(option)==='string') {\n    var unit = option.replace(/([0-9|.]*)([a-z]*)$/,'$2');\n    method = 'time';\n    option = parseFloat(option);\n    // convert unit\n    switch (unit) {\n      case 'mn': {\n        option = option*60;\n        break;\n      }\n      case 'h': {\n        option = option*3600;\n        break;\n      }\n      case 'm': {\n        method = 'distance';\n        break;\n      }\n      case 'km': {\n        method = 'distance';\n        option = option*1000;\n        break;\n      }\n    }\n  }\n  var dt = Math.round(option * (this.get('iter')-(iter||0)) / this.get('iter'));\n  if (typeof option === 'number') {\n    // Send data\n    var data = {\n      'gp-access-lib': '2.1.0',\n      location: ol.proj.toLonLat(coord, proj),\n      graphName: (this.get('mode')==='pedestrian' ?  'Pieton' : 'Voiture'),\n      exclusions: this.get('exclusions') || undefined,\n      method: method,\n      time: method==='time' ? dt : undefined,\n      distance: method==='distance' ? dt : undefined,\n      reverse: (this.get('direction') === 'reverse'),\n      smoothing: this.get('smoothing') || true,\n      holes: this.get('holes') || false\n    };\n    this._ajax.send(this.get('url'), data, { \n      coord: coord, \n      option: option,\n      iteration: (iter||0)+1 \n    });\n  }\n};\n/** Trigger result\n * @private\n */\nol.control.IsochroneGeoportail.prototype._success = function(e) {\n  var proj = this.getMap() ? this.getMap().getView().getProjection() : 'EPSG:3857';\n  // Convert to features\n  var format = new ol.format.WKT();\n  var evt = e.response;\n\tevt.feature = format.readFeature(evt.wktGeometry, {\n    dataProjection: 'EPSG:4326',\n    featureProjection: proj\n  });\n  delete evt.wktGeometry;\n  evt.type = 'isochrone';\n  evt.iteration = e.options.iteration-1;\n  this.dispatchEvent (evt);\n  if (e.options.iteration < this.get('iter')) {\n    this.search(e.options.coord, e.options.option, e.options.iteration);\n  }\n};\n/** Trigger error\n * @private\n */\nol.control.IsochroneGeoportail.prototype._error = function() {\n  this.dispatchEvent ({ type:'error' });\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers Layer Switcher Control.\n *\n * @constructor\n * @extends {ol.control.LayerSwitcher}\n * @param {Object=} options Control options.\n */\nol.control.LayerPopup = function(options) {\n  options = options || {};\n\toptions.switcherClass=\"ol-layerswitcher-popup\";\n\tif (options.mouseover!==false) options.mouseover=true;\n\tol.control.LayerSwitcher.call(this, options);\n};\nol.ext.inherits(ol.control.LayerPopup, ol.control.LayerSwitcher);\n/** Disable overflow\n*/\nol.control.LayerPopup.prototype.overflow = function(){};\n/** Render a list of layer\n * @param {elt} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol.control.LayerPopup.prototype.drawList = function(ul, layers) {\t\n  var self=this;\n\tvar setVisibility = function(e) {\n    e.preventDefault(); \n\t\tvar l = self._getLayerForLI(this);\n\t\tself.switchLayerVisibility(l,layers);\n\t\tif (e.type==\"touchstart\") self.element.classList.add(\"ol-collapsed\");\n\t};\n\tlayers.forEach(function(layer) {\n    if (self.displayInLayerSwitcher(layer)) {\n      var d = ol.ext.element.create('LI', {\n        html: layer.get(\"title\") || layer.get(\"name\"),\n        on: { 'click touchstart': setVisibility },\n        parent: ul\n      });\n      self._setLayerForLI(d, layer);\n\t\t\tif (self.testLayerVisibility(layer)) d.classList.add(\"ol-layer-hidden\");\n\t\t\tif (layer.getVisible()) d.classList.add(\"select\");\n\t\t}\n\t});\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc OpenLayers Layer Switcher Control.\n * @require layer.getPreview\n *\n * @constructor\n * @extends {ol.control.LayerSwitcher}\n * @param {Object=} options Control options.\n */\nol.control.LayerSwitcherImage = function(options) {\n  options = options || {};\n\toptions.switcherClass = \"ol-layerswitcher-image\";\n\tif (options.mouseover!==false) options.mouseover=true;\n\tol.control.LayerSwitcher.call(this, options);\n};\nol.ext.inherits(ol.control.LayerSwitcherImage, ol.control.LayerSwitcher);\n/** Render a list of layer\n * @param {elt} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol.control.LayerSwitcherImage.prototype.drawList = function(ul, layers) {\n  var self = this;\n\tvar setVisibility = function(e) {\n    e.preventDefault(); \n\t\tvar l = self._getLayerForLI(this);\n\t\tself.switchLayerVisibility(l,layers);\n\t\tif (e.type==\"touchstart\") self.element.classList.add(\"ol-collapsed\");\n\t};\n\tol.ext.element.setStyle(ul, { height: 'auto' });\n\tlayers.forEach(function(layer) {\n    if (self.displayInLayerSwitcher(layer)) {\n      var preview = layer.getPreview ? layer.getPreview() : [\"none\"];\n      var d = ol.ext.element.create('LI', {\n        className: 'ol-imgcontainer' + (layer.getVisible() ? ' select':''),\n        on: { 'touchstart click': setVisibility },\n        parent: ul\n      });\n      self._setLayerForLI(d, layer);\n      preview.forEach(function(img){\n        ol.ext.element.create('IMG', {\n          src: img,\n          parent: d\n        })\n      });\n\t\t\tol.ext.element.create('p', {\n        html: layer.get(\"title\") || layer.get(\"name\"),\n        parent: d\n      });\n\t\t\tif (self.testLayerVisibility(layer)) d.classList.add('ol-layer-hidden');\n\t\t}\n\t});\n};\n/** Disable overflow\n*/\nol.control.LayerSwitcherImage.prototype.overflow = function(){};\n\n/** Create a legend for styles\n * @constructor\n * @fires select\n * @param {*} options\n *  @param {String} options.className class of the control\n *  @param {String} options.title Legend title\n *  @param {ol.size | undefined} options.size Size of the symboles in the legend, default [40, 25]\n *  @param {int | undefined} options.margin Size of the symbole's margin, default 10\n *  @param {boolean | undefined} options.collapsed Specify if attributions should be collapsed at startup. Default is true.\n *  @param {boolean | undefined} options.collapsible Specify if attributions can be collapsed, default true.\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param { ol.style.Style | Array<ol.style.Style> | ol.StyleFunction | undefined\t} options.style a style or a style function to use with features\n * @extends {ol.control.Control}\n */\nol.control.Legend = function(options) {\n  options = options || {};\n  var element = document.createElement('div');\n  if (options.target) {\n    element.className = options.className || \"ol-legend\";\n  } else {\n    element.className = (options.className || \"ol-legend\")\n      +\" ol-unselectable ol-control ol-collapsed\"\n      +(options.collapsible===false ? ' ol-uncollapsible': '');\n    // Show on click\n    var button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.addEventListener('click', function() {\n      element.classList.toggle('ol-collapsed');\n    });\n    element.appendChild(button);\n    // Hide on click\n    button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.className = 'ol-closebox';\n    button.addEventListener('click', function() {\n      element.classList.toggle('ol-collapsed');\n    });\n    element.appendChild(button);\n  }\n  // The legend\n  this._imgElement = document.createElement('div');\n  this._imgElement.className = 'ol-legendImg';\n  element.appendChild(this._imgElement);\n  this._tableElement = document.createElement('ul');\n  element.appendChild(this._tableElement);\n\tol.control.Control.call(this, {\n    element: element,\n\t\ttarget: options.target\n\t});\n  this._rows = [];\n  this.set('size', options.size || [40, 25]);\n  this.set('margin', options.margin===0 ? 0 : options.margin || 10);\n  this.set('title', options.title || '');\n  // Set the style\n  this._style = options.style;\n  if (options.collapsed===false) this.show();\n  this.refresh();\n};\nol.ext.inherits(ol.control.Legend, ol.control.Control);\n/** Set the style\n * @param { ol.style.Style | Array<ol.style.Style> | ol.StyleFunction | undefined\t} style a style or a style function to use with features\n */\nol.control.Legend.prototype.setStyle = function(style) {\n  this._style = style;\n  this.refresh();\n};\n/** Add a new row to the legend\n *  * You can provide in options:\n * - a feature width a style \n * - or a feature that will use the legend style function\n * - or properties ans a geometry type that will use the legend style function\n * - or a style and a geometry type\n * @param {*} options a list of parameters \n *  @param {ol.Feature} options.feature a feature to draw\n *  @param {ol.style.Style} options.style the style to use if no feature is provided\n *  @param {*} options.properties properties to use with a style function\n *  @param {string} options.typeGeom type geom to draw with the style or the properties\n */\nol.control.Legend.prototype.addRow = function(row) {\n  this._rows.push(row||{});\n  this.refresh();\n};\n/** Remove a row from the legend\n *  @param {int} index\n */\nol.control.Legend.prototype.removeRow = function(index) {\n  this._rows.splice(index,1);\n  this.refresh();\n};\n/** Get a legend row\n * @param {int} index\n * @return {*}\n */\nol.control.Legend.prototype.getRow = function(index) {\n  return this._rows[index];\n};\n/** Get a legend row\n * @return {int}\n */\nol.control.Legend.prototype.getLength = function() {\n  return this._rows.length;\n};\n/** Refresh the legend\n */\nol.control.Legend.prototype.refresh = function() {\n  var self = this;\n  var table = this._tableElement\n  table.innerHTML = '';\n  var width = this.get('size')[0] + 2*this.get('margin');\n  var height = this.get('size')[1] + 2*this.get('margin');\n  // Add a new row\n  function addRow(str, title, r, i){\n    var row = document.createElement('li');\n    row.style.height = height + 'px';\n    row.addEventListener('click', function() {\n      self.dispatchEvent({ type:'select', title: str, row: r, index: i });\n    });\n    var col = document.createElement('div');\n    row.appendChild(col);\n    col.style.height = height + 'px';\n    col = document.createElement('div');\n    if (title) {\n      row.className = 'ol-title';\n    } else {\n      col.style.paddingLeft = width + 'px';\n    }\n    col.innerHTML = str || '';\n    row.appendChild(col);\n    table.appendChild(row);\n  }\n  if (this.get('title')) {\n    addRow(this.get('title'), true, {}, -1);\n  }\n  var canvas = document.createElement('canvas');\n  canvas.width = 5*width;\n  canvas.height = (this._rows.length+1) * height * ol.has.DEVICE_PIXEL_RATIO;\n  this._imgElement.innerHTML = '';\n  this._imgElement.append(canvas);\n  this._imgElement.style.height = (this._rows.length+1)*height + 'px';\n  for (var i=0, r; r = this._rows[i]; i++) {\n    addRow(r.title, false, r, i);\n    canvas = this.getStyleImage(r, canvas, i+(this.get('title')?1:0));\n  }\n};\n/** Show control\n */\nol.control.Legend.prototype.show = function() {\n  this.element.classList.remove('ol-collapsed');\n};\n/** Hide control\n */\nol.control.Legend.prototype.hide = function() {\n  this.element.classList.add('ol-collapsed');\n};\n/** Toggle control\n */\nol.control.Legend.prototype.toggle = function() {\n  this.element.classList.toggle('ol-collapsed');\n};\n/** Get the image for a style \n * You can provide in options:\n * - a feature width a style \n * - or a feature that will use the legend style function\n * - or properties and a geometry type that will use the legend style function\n * - or a style and a geometry type\n * @param {*} options\n *  @param {ol.Feature} options.feature a feature to draw\n *  @param {ol.style.Style} options.style the style to use if no feature is provided\n *  @param {*} options.properties properties to use with a style function\n *  @param {string} options.typeGeom type geom to draw with the style or the properties\n * @param {Canvas|undefined} canvas a canvas to draw in\n * @param {int|undefined} row row number to draw in canvas\n * @return {CanvasElement}\n */\nol.control.Legend.prototype.getStyleImage = function(options, theCanvas, row) {\n  options = options || {};\n  var size = this.get('size');\n  var width = size[0] + 2*this.get('margin');\n  var height = size[1] + 2*this.get('margin');\n  var canvas = theCanvas;\n  var ratio = ol.has.DEVICE_PIXEL_RATIO;\n  if (!canvas) {\n    canvas = document.createElement('canvas');\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n  }\n  var ctx = canvas.getContext('2d');\n  ctx.save();\n  var vectorContext = ol.render.toContext(ctx);\n  var typeGeom = options.typeGeom;\n  var style;\n  var feature = options.feature;\n  if (!feature && options.properties && typeGeom) {\n    if (/Point/.test(typeGeom)) feature = new ol.Feature(new ol.geom.Point([0,0]));\n    else if (/LineString/.test(typeGeom)) feature = new ol.Feature(new ol.geom.LineString([0,0]));\n    else feature = new ol.Feature(new ol.geom.Polygon([[0,0]]));\n    feature.setProperties(options.properties);\n  }\n  if (feature) {\n    style = feature.getStyle();\n    if (typeof(style)==='function') style = style(feature);\n    if (!style) {\n      style = typeof(this._style) === 'function' ? this._style(feature) : this._style || [];\n    }\n    typeGeom = feature.getGeometry().getType();\n  } else {\n    style = options.style;\n  }\n  if (!(style instanceof Array)) style = [style];\n  var cx = width/2;\n  var cy = height/2;\n  var sx = size[0]/2;\n  var sy = size[1]/2;\n  var i, s;\n  // Get point offset\n  if (typeGeom === 'Point') {\n    var extent = null;\n    for (i=0; s= style[i]; i++) {\n      var img = s.getImage();\n      if (img && img.getAnchor) {\n        var anchor = img.getAnchor();\n        var si = img.getSize();\n        var dx = anchor[0] - si[0];\n        var dy = anchor[1] - si[1];\n        if (!extent) {\n          extent = [dx, dy, dx+si[0], dy+si[1]];\n        } else {\n          ol.extent.extend(extent, [dx, dy, dx+si[0], dy+si[1]]);\n        }\n      }\n    }\n    if (extent) {\n      cx = cx + (extent[2] + extent[0])/2;\n      cy = cy + (extent[3] + extent[1])/2;\n    }\n  }\n  // Draw image\n  cy += (theCanvas ? row*height : 0);\n  for (i=0; s= style[i]; i++) {\n    vectorContext.setStyle(s);\n    switch (typeGeom) {\n      case ol.geom.Point:\n      case 'Point':\n        vectorContext.drawGeometry(new ol.geom.Point([cx, cy]));\n        break;\n      case ol.geom.LineString:\n      case 'LineString':\n        ctx.save();\n          ctx.rect(this.get('margin') * ratio, 0, size[0] *  ratio, canvas.height);\n          ctx.clip();\n          vectorContext.drawGeometry(new ol.geom.LineString([[cx-sx, cy], [cx+sx, cy]]));\n        ctx.restore();\n        break;\n      case ol.geom.Polygon:\n      case 'Polygon':\n        vectorContext.drawGeometry(new ol.geom.Polygon([[[cx-sx, cy-sy], [cx+sx, cy-sy], [cx+sx, cy+sy], [cx-sx, cy+sy], [cx-sx, cy-sy]]]));\n        break;\n    }\n  }\n  ctx.restore();\n  return canvas;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n//\n/** A control to jump from one zone to another.\n *\n * @constructor\n * @fires select\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t@param {string} options.className class name\n *\t@param {ol.layer.Layer} options.layer layer to display in the control\n *\t@param {ol.ProjectionLike} options.projection projection of the control, Default is EPSG:3857 (Spherical Mercator).\n *  @param {Array<any>} options.zone an array of zone: { name, extent (in EPSG:4326) }\n *  @param {bolean} options.centerOnClick center on click when click on zones, default true\n */\nol.control.MapZone = function(options) {\n  if (!options) options={};\n  var element = document.createElement(\"div\");\n  if (options.target) {\n    element = ol.ext.element.create('DIV', {\n      className: options.className || \"ol-mapzone\"\n    });\n  } else {\n    element = ol.ext.element.create('DIV', {\n      className: (options.className || \"ol-mapzone\") +' ol-unselectable ol-control ol-collapsed'\n    });\n    var bt = ol.ext.element.create('BUTTON', {\n      type: 'button',\n      on: {\n        'click': function() {\n          element.classList.toggle(\"ol-collapsed\");\n          maps.forEach(function (m) {\n            m.updateSize();\n          });\n        }.bind(this)\n      },\n      parent: element\n    });\n    ol.ext.element.create('I', {\n      parent: bt\n    });\n  }\n  // Parent control\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Create maps\n  var maps = [];\n  options.zones.forEach(function(z) {\n    var view = new ol.View({ zoom: 6, center: [0,0], projection: options.projection });\n    var extent = ol.proj.transformExtent(z.extent, 'EPSG:4326', view.getProjection());\n    console.log(extent, z.extent)\n    var div = ol.ext.element.create('DIV', {\n      className: 'ol-mapzonezone',\n      parent: element,\n      click : function() {\n        this.dispatchEvent({\n          type: 'select',\n          coordinate: ol.extent.getCenter(extent),\n          extent: extent\n        });\n        if (options.centerOnClick !== false) {\n          this.getMap().getView().fit(extent);\n        }\n        this.setVisible(false);\n      }.bind(this)\n    });\n    var layer = new options.layer.constructor({\n      source: options.layer.getSource()\n    });\n    var map = new ol.Map({\n      target: div,\n      view: view,\n      controls: [],\n      interactions:[],\n      layers: [layer]\n    });\n    maps.push(map);\n    view.fit(extent);\n    // Nmae\n    ol.ext.element.create('P', {\n      html: z.title,\n      parent: div\n    });\n  }.bind(this));\n  // Refresh the maps\n  setTimeout(function() {\n    maps.forEach(function (m) {\n      m.updateSize();\n    });\n  });\n};\nol.ext.inherits(ol.control.MapZone, ol.control.Control);\n/** Set the control visibility\n* @param {boolean} b\n*/\nol.control.MapZone.prototype.setVisible = function (b) {\n  if (b) this.element.classList.remove('ol-collapsed');\n  else this.element.classList.add('ol-collapsed');\n};\n/** Pre-defined zones */\nol.control.MapZone.zones = {};\n/** French overseas departments  */\nol.control.MapZone.zones.DOM = [{\n  \"title\": \"Guadeloupe\",\n  \"extent\": [ -61.898594315312444, 15.75623038647845, -60.957887532935324, 16.575317670979473 ]\n},{\n  \"title\": \"Guyane\",\n  \"extent\": [ -54.72525931072715, 2.1603763430019, -51.528236062921344, 5.7984307809552575 ]\n},{\n  \"title\": \"Martinique\",\n  \"extent\": [ -61.257556528564756, 14.387506317407514, -60.76934912110432, 14.895067461729951 ]\n},{\n  \"title\": \"Mayotte\",\n  \"extent\": [ 44.959844536967815, -13.01674138212816, 45.35328866510648, -12.65521942207829 ]\n},{\n  \"title\": \"La runion\",\n  \"extent\": [ 55.17059012967656, -21.407680069231688, 55.88195702001797, -20.85560221637526 ]\n}];\n/** French overseas territories */\nol.control.MapZone.zones.TOM = [{\n  \"title\": \"Polynsie Franaise\",\n  \"extent\": [ 206.23664226630862, -22.189040615809787, 221.85920743981987, -10.835039595040698 ]\n},{\n  \"title\": \"Nouvelle Caldonie\",\n  \"extent\": [ 163.76420580160925, -22.581641092751838, 167.66984709498706, -19.816411635668445 ]\n},{\n  \"title\": \"St-Pierre et Miquelon\",\n  \"extent\": [ -56.453698765748676, 46.74449858188555, -56.0980198121544, 47.14669874229787 ]\n},{\n  \"title\": \"Wallis et Futuna\",\n  \"extent\": [ 181.7588623143665, -14.7341169873267, 183.95612353301715, -13.134720799175085 ]\n},{\n  \"title\": \"St-Martin St-Barthlemy\",\n  \"extent\": [ -63.1726389501678, 17.806097291313506, -62.7606535945649, 18.13267688837938 ]\n}];\n/** French overseas departments and territories */\nol.control.MapZone.zones.DOMTOM = [{\n  title: 'Mtropole',\n  extent: [ -5.318421740712579, 41.16082274292913, 9.73284186155716, 51.21957336557702 ]\n}].concat(ol.control.MapZone.zones.DOM,ol.control.MapZone.zones.TOM);\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control overlay for OL3\n * The overlay control is a control that display an overlay over the map\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fire change:visible\n * @param {Object=} options Control options.\n *  @param {string} className class of the control\n *  @param {boolean} hideOnClick hide the control on click, default false\n *  @param {boolean} closeBox add a closeBox to the control, default false\n */\nol.control.Notification = function(options) {\n  options = options || {};\n\tvar element = document.createElement(\"DIV\");\n  this.contentElement = document.createElement(\"DIV\");\n  element.appendChild(this.contentElement);\n  var classNames = (options.className||\"\")+ \" ol-notification\";\n\tif (!options.target) {\n    classNames += \" ol-unselectable ol-control ol-collapsed\";\n  }\n\telement.setAttribute('class', classNames);\n\tol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n};\nol.ext.inherits(ol.control.Notification, ol.control.Control);\n/**\n * Display a notification on the map\n * @param {string|node|undefined} what the notification to show, default get the last one\n * @param {number} [duration=3000] duration in ms, if -1 never hide\n */\nol.control.Notification.prototype.show = function(what, duration) {\n  var self = this;\n  var elt = this.element;\n  if (what) {\n    if (what instanceof Node) {\n      this.contentElement.innerHTML = '';\n      this.contentElement.appendChild(what);\n    } else {\n      this.contentElement.innerHTML = what;\n    }\n  }\n  if (this._listener) {\n    clearTimeout(this._listener);\n    this._listener = null;\n  }\n  elt.classList.add('ol-collapsed');\n  this._listener = setTimeout(function() {\n    elt.classList.remove('ol-collapsed');\n    if (!duration || duration >= 0) {\n      self._listener = setTimeout(function() {\n        elt.classList.add('ol-collapsed');\n        self._listener = null;\n      }, duration || 3000);\n    } else {\n      self._listener = null;\n    }\n  }, 100);\n};\n/**\n * Remove a notification on the map\n */\nol.control.Notification.prototype.hide = function() {\n  if (this._listener) {\n    clearTimeout(this._listener);\n    this._listener = null;\n  }\n  this.element.classList.add('ol-collapsed');\n};\n/**\n * Toggle a notification on the map\n * @param {number} [duration=3000] duration in ms\n */\nol.control.Notification.prototype.toggle = function(duration) {\n  if (this.element.classList.contains('ol-collapsed')) {\n    this.show(null, duration);\n  } else {\n    this.hide();\n  }\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control overlay for OL3\n * The overlay control is a control that display an overlay over the map\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fire change:visible\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n*\t@param {String|Element} options.content\n*\t@param {bool} options.hideOnClick hide the control on click, default false\n*\t@param {bool} options.closeBox add a closeBox to the control, default false\n*/\nol.control.Overlay = function(options) {\n  if (!options) options={};\n/*\n  var element = document.createElement(\"div\");\n  element.classList.add('ol-unselectable', 'ol-overlay');\n  //if (options.className) element.classList.add(options.className);\n*/\n  var element = ol.ext.element.create('DIV', {\n    className: 'ol-unselectable ol-overlay '+(options.className||''),\n    html: options.content\n  });\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  var self = this;\n  if (options.hideOnClick) element.addEventListener(\"click\", function(){self.hide();});\n  this.set(\"closeBox\", options.closeBox);\n  this._timeout = false;\n  this.setContent (options.content);\n};\nol.ext.inherits(ol.control.Overlay, ol.control.Control);\n/** Set the content of the overlay\n* @param {string|Element} html the html to display in the control\n*/\nol.control.Overlay.prototype.setContent = function (html) {\n  var self = this;\n  if (html) {\n    var elt = this.element;\n    if (html instanceof Element) {\n      elt.innerHTML='';\n      elt.appendChild(html)\n    }\n    else if (html!==undefined) elt.innerHTML = html;\n    if (this.get(\"closeBox\")) {\n      var cb = document.createElement(\"div\");\n      cb.classList.add(\"ol-closebox\");\n      cb.addEventListener(\"click\", function(){self.hide();});\n      elt.insertBefore(cb, elt.firstChild);\n    }\n  }\n};\n/** Set the control visibility\n* @param {string|Element} html the html to display in the control\n* @param {ol.coordinate} coord coordinate of the top left corner of the control to start from\n*/\nol.control.Overlay.prototype.show = function (html, coord) {\n  var self = this;\n  var elt = this.element;\n  elt.style.display = 'block';\n  if (coord) {\n    this.center_ = this.getMap().getPixelFromCoordinate(coord);\n    elt.style.top = this.center_[1]+'px';\n    elt.style.left = this.center_[0]+'px';\n  } else {\n    //TODO: Do fix from  hkollmann pull request\n    this.center_ = false;\n    elt.style.top = \"\";\n    elt.style.left = \"\";\n  }\n  if (html) this.setContent(html);\n  if (this._timeout) clearTimeout(this._timeout);\n  this._timeout = setTimeout(function() {\n    elt.classList.add(\"ol-visible\")\n    elt.style.top = \"\";\n    elt.style.left = \"\";\n    self.dispatchEvent({ type:'change:visible', visible:true, element: self.element });\n  }, 10);\n};\n/** Show an image\n * @param {string} src image url\n * @param {*} options\n *  @param {string} options.title\n *  @param {ol.coordinate} coordinate\n */\nol.control.Overlay.prototype.showImage = function (src, options) {\n  options = options || {};\n  var content = ol.ext.element.create('DIV', {\n    className: 'ol-fullscreen-image'\n  });\n  ol.ext.element.create('IMG', {\n    src: src,\n    parent: content\n  });\n  if (options.title) {\n    content.classList.add('ol-has-title');\n    ol.ext.element.create('P', { \n      html: options.title,\n      parent: content\n    });\n  }\n  this.show(content, options.coordinate);\n};\n/** Set the control visibility hidden\n*/\nol.control.Overlay.prototype.hide = function () {\n  var elt = this.element;\n  this.element.classList.remove(\"ol-visible\");\n  if (this.center_) {\n    elt.style.top = this.center_[1]+'px';\n    elt.style.left = this.center_[0]+'px';\n    this.center_ = false;\n  }\n  if (this._timeout) clearTimeout(this._timeout);\n  this._timeout = setTimeout(function(){ elt.style.display = 'none'; }, 500);\n  this.dispatchEvent({ type:'change:visible', visible:false, element: this.element });\n};\n/** Toggle control visibility\n*/\nol.control.Overlay.prototype.toggle = function () {\t\n  if (this.getVisible()) this.hide();\n  else this.show();\n}\n/** Get the control visibility\n* @return {boolean} b\n*/\nol.control.Overlay.prototype.getVisible = function () {\n  return ol.ext.element.getStyle(this.element, 'display') !== 'none';\n};\n/** Change class name\n* @param {String} className a class name or a list of class names separated by a space\n*/\nol.control.Overlay.prototype.setClass = function (className) {\n  var vis = this.element.classList.contains('ol-visible');\n  this.element.className = ('ol-unselectable ol-overlay '+(vis ? 'ol-visible ' : '')+className).trim();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers 3 Layer Overview Control.\n * The overview can rotate with map. \n * Zoom levels are configurable.\n * Click on the overview will center the map.\n * Change width/height of the overview trough css.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *  @param {ol.ProjectionLike} options.projection The projection. Default is EPSG:3857 (Spherical Mercator).\n *  @param {Number} options.minZoom default 0\n *  @param {Number} options.maxZoom default 18\n *  @param {boolean} options.rotation enable rotation, default false\n *  @param {top|bottom-left|right} options.align position\n *  @param {Array<ol.layer>} options.layers list of layers\n *  @param {ol.style.Style | Array.<ol.style.Style> | undefined} options.style style to draw the map extent on the overveiw\n *  @param {bool|elastic} options.panAnimation use animation to center map on click, default true\n */\nol.control.Overview = function(options)\n{\toptions = options || {};\n  var self = this;\n  // API\n  this.minZoom = options.minZoom || 0;\n  this.maxZoom = options.maxZoom || 18;\n  this.rotation = options.rotation;\n  var element;\n  if (options.target) {\n    element = document.createElement(\"div\");\n    this.panel_ = options.target;\n  } else {\n    element = document.createElement(\"div\");\n    element.classList.add('ol-overview', 'ol-unselectable', 'ol-control', 'ol-collapsed');\n    if (/top/.test(options.align)) element.classList.add('ol-control-top');\n    if (/right/.test(options.align)) element.classList.add('ol-control-right');\n    var button = document.createElement(\"button\");\n        button.setAttribute('type','button');\n        button.addEventListener(\"touchstart\", function(e){ self.toggleMap(); e.preventDefault(); });\n        button.addEventListener(\"click\", function(){self.toggleMap()});\n        element.appendChild(button);\n    this.panel_ = document.createElement(\"div\");\n    this.panel_.classList.add(\"panel\");\n    element.appendChild(this.panel_);\n  }\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Create a overview map\n  this.ovmap_ = new ol.Map({\n    controls: new ol.Collection(),\n    interactions: new ol.Collection(),\n    target: this.panel_,\n    view: new ol.View ({\n      zoom: 2,\n      center: [0,0],\n      projection: options.projection\n    }),\n    layers: options.layers\n  });\n  this.oview_ = this.ovmap_.getView();\n  // Cache extent\n  this.extentLayer = new ol.layer.Vector({\n    name: 'Cache extent',\n    source: new ol.source.Vector(),\n    style: options.style || [new ol.style.Style({\n      image: new ol.style.Circle({\n        fill: new ol.style.Fill({\n          color: 'rgba(255,0,0, 1)'\n        }),\n        stroke: new ol.style.Stroke({\n          width: 7,\n            color: 'rgba(255,0,0, 0.8)'\n          }),\n          radius: 5\n        }),\n        stroke: new ol.style.Stroke({\n          width: 5,\n          color: \"rgba(255,0,0,0.8)\"\n        })\n      }\n    )]\n  })\n  this.ovmap_.addLayer(this.extentLayer);\n  /** Elastic bounce\n  *\t@param {Int} bounce number of bounce\n  *\t@param {Number} amplitude amplitude of the bounce [0,1] \n  *\t@return {Number}\n  * /\n  var bounceFn = function (bounce, amplitude){\n    var a = (2*bounce+1) * Math.PI/2;\n    var b = amplitude>0 ? -1/amplitude : -100;\n    var c = - Math.cos(a) * Math.pow(2, b);\n    return function(t) {\n      t = 1-Math.cos(t*Math.PI/2);\n      return 1 + Math.abs( Math.cos(a*t) ) * Math.pow(2, b*t) + c*t;\n    }\n  }\n  /** Elastic bounce\n  *\t@param {Int} bounce number of bounce\n  *\t@param {Number} amplitude amplitude of the bounce [0,1] \n  *\t@return {Number}\n  */\n  var elasticFn = function (bounce, amplitude) {\n    var a = 3*bounce * Math.PI/2;\n    var b = amplitude>0 ? -1/amplitude : -100;\n    var c = Math.cos(a) * Math.pow(2, b);\n    return function(t){\n      t = 1-Math.cos(t*Math.PI/2);\n      return 1 - Math.cos(a*t) * Math.pow(2, b*t) + c*t;\n    }\n  }\n  // Click on the preview center the map\n  this.ovmap_.addInteraction (new ol.interaction.Pointer({\n    handleDownEvent: function(evt) {\n      if (options.panAnimation !==false) {\n        if (options.panAnimation==\"elastic\" || options.elasticPan) {\n          self.getMap().getView().animate({\n            center: evt.coordinate,\n            easing: elasticFn(2,0.3),\n            duration: 1000\n          });\n        } else {\n          self.getMap().getView().animate({\n            center: evt.coordinate,\n            duration: 300\n          });\n        }\n      }\n      else self.getMap().getView().setCenter(evt.coordinate);\n      return false;\n    }\n  }));\n};\nol.ext.inherits(ol.control.Overview, ol.control.Control);\n/** Get overview map\n*\t@return {ol.Map}\n*/\nol.control.Overview.prototype.getOverviewMap = function(){\n  return this.ovmap_;\n};\n/** Toggle overview map\n*/\nol.control.Overview.prototype.toggleMap = function(){\n  this.element.classList.toggle(\"ol-collapsed\");\n  this.ovmap_.updateSize();\n  this.setView();\n};\n/** Set overview map position\n*\t@param {top|bottom-left|right}\n*/\nol.control.Overview.prototype.setPosition = function(align){\n  if (/top/.test(align)) this.element.classList.add(\"ol-control-top\");\n  else this.element.classList.remove(\"ol-control-top\");\n  if (/right/.test(align)) this.element.classList.add(\"ol-control-right\");\n  else this.element.classList.remove(\"ol-control-right\");\n};\n/**\n * Set the map instance the control associated with.\n * @param {ol.Map} map The map instance.\n */\nol.control.Overview.prototype.setMap = function(map) {\n  if (this._listener) ol.Observable.unByKey(this._listener);\n  this._listener = null;\n  ol.control.Control.prototype.setMap.call(this, map);\n  if (map) {\n    this._listener = map.getView().on('propertychange', this.setView.bind(this));\n    this.setView();\n  }\n};\n/** Calculate the extent of the map and draw it on the overview\n*/\nol.control.Overview.prototype.calcExtent_ = function(extent){\n  var map = this.getMap();\n  if (!map) return;\n  var source = this.extentLayer.getSource();\n  source.clear();\n  var f = new ol.Feature();\n  var size = map.getSize();\n  var resolution = map.getView().getResolution();\n  var rotation = map.getView().getRotation();\n  var center = map.getView().getCenter();\n  if (!resolution) return;\n  var dx = resolution * size[0] / 2;\n  var dy = resolution * size[1] / 2;\n  var res2 = this.oview_.getResolution();\n  if (dx/res2>5 || dy/res2>5) {\n    var cos = Math.cos(rotation);\n    var sin = Math.sin(rotation);\n    var i, x, y;\n    extent=[[-dx,-dy],[-dx,dy],[dx,dy],[dx,-dy]];\n    for (i = 0; i < 4; ++i) {\n      x = extent[i][0];\n      y = extent[i][1];\n      extent[i][0] = center[0] + x * cos - y * sin;\n      extent[i][1] = center[1] + x * sin + y * cos;\n    }\n    f.setGeometry (new ol.geom.Polygon( [ extent ]));\n  } else {\n    f.setGeometry (new ol.geom.Point( center ));\n  }\n  source.addFeature(f);\n};\n/**\n*\t@private\n*/\nol.control.Overview.prototype.setView = function(e){\n  if (!e) {\n    // refresh all\n    this.setView({key:'rotation'});\n    this.setView({key:'resolution'});\n    this.setView({key:'center'});\n    return;\n  }\n  // Set the view params\n  switch (e.key){\n    case 'rotation': {\n      if (this.rotation) this.oview_.setRotation(this.getMap().getView().getRotation());\n      else if (this.oview_.getRotation()) this.oview_.setRotation(0);\n      break;\n    }\n    case 'center': {\n      var mapExtent = this.getMap().getView().calculateExtent(this.getMap().getSize());\n      var extent = this.oview_.calculateExtent(this.ovmap_.getSize());\n      if (mapExtent[0]<extent[0] || mapExtent[1]<extent[1] \n      || mapExtent[2]>extent[2] || mapExtent[3]>extent[3]){\n        this.oview_.setCenter(this.getMap().getView().getCenter()); \n      }\n      break;\n    }\t\n    case 'resolution': {\n      //var z = Math.round(this.getMap().getView().getZoom()/2)*2-4;\n      var z = Math.round(this.oview_.getZoomForResolution(this.getMap().getView().getResolution())/2)*2-4;\n      z = Math.min ( this.maxZoom, Math.max(this.minZoom, z) );\n      this.oview_.setZoom(z);\n      break;\n    }\n    default: break;\n  }\n  this.calcExtent_();\n};\n\n/*\tCopyright (c) 2015-2018 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Set an hyperlink that will return the user to the current map view.\n * Just add a `permalink`property to layers to be handled by the control (and added in the url). \n * The layer's permalink property is used to name the layer in the url.\n * The control must be added after all layer are inserted in the map to take them into acount.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options\n *  @param {bool} options.urlReplace replace url or not, default true\n *  @param {bool} options.localStorage save current map view in localStorage, default false\n *  @param {integer} options.fixed number of digit in coords, default 6\n *  @param {bool} options.anchor use \"#\" instead of \"?\" in href\n *  @param {bool} options.hidden hide the button on the map, default false\n *  @param {function} options.onclick a function called when control is clicked\n*/\nol.control.Permalink = function(opt_options) {\n  var options = opt_options || {};\n  var self = this;\n  var button = document.createElement('button');\n  this.replaceState_ = (options.urlReplace!==false);\n  this.fixed_ = options.fixed || 6;\n  this.hash_ = options.anchor ? \"#\" : \"?\";\n  this._localStorage = options.localStorage;\n  if (!this._localStorage) localStorage.removeItem('ol@parmalink');\n  function linkto() {\n    if (typeof(options.onclick) == 'function') options.onclick(self.getLink());\n    else self.setUrlReplace(!self.replaceState_);\n  }\n  button.addEventListener('click', linkto, false);\n  button.addEventListener('touchstart', linkto, false);\n  var element = document.createElement('div');\n  element.className = (options.className || \"ol-permalink\") + \" ol-unselectable ol-control\";\n  element.appendChild(button);\n  if (options.hidden) ol.ext.element.hide(element);\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.on ('change', this.viewChange_.bind(this));\n  // Save search params\n  this.search_ = {};\n  var hash = this.replaceState_ ? document.location.hash || document.location.search : '';\n  console.log('hash', hash)\n  if (!hash && this._localStorage) {\n    hash = localStorage['ol@parmalink'];\n  }\n  if (hash) {\n    hash = hash.replace(/(^#|^\\?)/,\"\").split(\"&\");\n    for (var i=0; i<hash.length;  i++) {\n      var t = hash[i].split(\"=\");\n      switch(t[0]) {\n        case 'lon':\n        case 'lat':\n        case 'z':\n        case 'r':\n        case 'l': break;\n        default: this.search_[t[0]] = t[1];\n      }\n    }\n  }\n  // Decode permalink\n  this.setPosition();\n};\nol.ext.inherits(ol.control.Permalink, ol.control.Control);\n/**\n * Set the map instance the control associated with.\n * @param {ol.Map} map The map instance.\n */\nol.control.Permalink.prototype.setMap = function(map) {\n  if (this._listener) {\n    ol.Observable.unByKey(this._listener.change);\n    ol.Observable.unByKey(this._listener.moveend);\n  }\n  this._listener = null;\n  ol.control.Control.prototype.setMap.call(this, map);\n  // Get change \n  if (map) {\n    this._listener = {\n      change: map.getLayerGroup().on('change', this.layerChange_.bind(this)),\n      moveend: map.on('moveend', this.viewChange_.bind(this))\n    };\n    this.setPosition();\n  }\n};\n/** Get layer given a permalink name (permalink propertie in the layer)\n*\t@param {string} the permalink to search for\n*\t@param {Array<ol.layer>|undefined} an array of layer to search in\n*\t@return {ol.layer|false}\n*/\nol.control.Permalink.prototype.getLayerByLink =  function (id, layers) {\n  if (!layers && this.getMap()) layers = this.getMap().getLayers().getArray();\n  for (var i=0; i<layers.length; i++) {\n    if (layers[i].get('permalink') == id) return layers[i];\n    // Layer Group\n    if (layers[i].getLayers) {\n      var li = this.getLayerByLink ( id, layers[i].getLayers().getArray() );\n      if (li) return li;\n    }\n  }\n  return false;\n};\n/** Set map position according to the current link \n*/\nol.control.Permalink.prototype.setPosition = function() {\n  var map = this.getMap();\n  if (!map) return;\n  var hash = this.replaceState_ ? document.location.hash || document.location.search : '';\n  if (!hash && this._localStorage) {\n    hash = localStorage['ol@parmalink'];\n  }\n  if (!hash) return;\n  var i, t, param = {};\n  hash = hash.replace(/(^#|^\\?)/,\"\").split(\"&\");\n  for (i=0; i<hash.length;  i++) {\n    t = hash[i].split(\"=\");\n    param[t[0]] = t[1];\n  }\n  var c = ol.proj.transform([Number(param.lon),Number(param.lat)], 'EPSG:4326', map.getView().getProjection());\n  if (c[0] && c[1]) map.getView().setCenter(c);\n  if (param.z) map.getView().setZoom(Number(param.z));\n  if (param.r) map.getView().setRotation(Number(param.r));\n  // Reset layers visibility\n  function resetLayers(layers) {\n    if (!layers) layers = map.getLayers().getArray();\n    for (var i=0; i<layers.length; i++){\n      if (layers[i].get('permalink')) {\n        layers[i].setVisible(false);\n        // console.log(\"hide \"+layers[i].get('permalink'));\n      }\n      if (layers[i].getLayers) {\n        resetLayers (layers[i].getLayers().getArray());\n      }\n    }\n  }\n  if (param.l) {\n    resetLayers();\n    var l = param.l.split(\"|\");\n    for (i=0; i<l.length; i++) {\n      t = l[i].split(\":\");\n      var li = this.getLayerByLink(t[0]);\n      var op = Number(t[1]);\n      if (li) {\n        li.setOpacity(op);\n        li.setVisible(true);\n      }\n    }\n  }\n};\n/**\n * Get the parameters added to the url. The object can be changed to add new values.\n * @return {Object} a key value object added to the url as &key=value\n * @api stable\n */\nol.control.Permalink.prototype.getUrlParams = function() {\n  return this.search_;\n};\n/**\n * Set a parameter to the url.\n * @param {string} key the key parameter\n * @param {string|undefined} value the parameter's value, if undefined or empty string remove the parameter\n * @api stable\n */\nol.control.Permalink.prototype.setUrlParam = function(key, value) {\n  if (key) {\n    if (value===undefined || value==='') delete (this.search_[encodeURIComponent(key)])\n    else this.search_[encodeURIComponent(key)] = encodeURIComponent(value);\n  }\n  this.viewChange_();\n};\n/**\n * Get a parameter url.\n * @param {string} key the key parameter\n * @return {string} the parameter's value or empty string if not set\n * @api stable\n */\nol.control.Permalink.prototype.getUrlParam = function(key) {\n  return decodeURIComponent (this.search_[encodeURIComponent(key)] || '');\n};\n/**\n * Has a parameter url.\n * @param {string} key the key parameter\n * @return {boolean} \n * @api stable\n */\nol.control.Permalink.prototype.hasUrlParam = function(key) {\n  return this.search_.hasOwnProperty(encodeURIComponent(key));\n};\n/**\n * Get the permalink\n * @return {permalink}\n */\nol.control.Permalink.prototype.getLink = function(param) {\n  var map = this.getMap();\n  var c = ol.proj.transform(map.getView().getCenter(), map.getView().getProjection(), 'EPSG:4326');\n  var z = map.getView().getZoom();\n  var r = map.getView().getRotation();\n  var l = this.layerStr_;\n  // Change anchor\n  var anchor = \"lon=\"+c[0].toFixed(this.fixed_)+\"&lat=\"+c[1].toFixed(this.fixed_)+\"&z=\"+z+(r?\"&r=\"+(Math.round(r*10000)/10000):\"\")+(l?\"&l=\"+l:\"\");\n  for (var i in this.search_) anchor += \"&\"+i+\"=\"+this.search_[i];\n  if (param) return anchor;\n  //return document.location.origin+document.location.pathname+this.hash_+anchor;\n  return document.location.protocol+\"//\"+document.location.host+document.location.pathname+this.hash_+anchor;\n};\n/**\n * Enable / disable url replacement (replaceSate)\n *\t@param {bool}\n*/\nol.control.Permalink.prototype.setUrlReplace = function(replace) {\n  try {\n    this.replaceState_ = replace;\n    if (!replace) {\n      var s = \"\";\n      for (var i in this.search_) {\n        s += (s==\"\"?\"?\":\"&\") + i+\"=\"+this.search_[i];\n      }\n      window.history.replaceState (null,null, document.location.origin+document.location.pathname+s);\n    }\n    else window.history.replaceState (null,null, this.getLink());\n  } catch(e) {/* ok */}\n  /*\n  if (this._localStorage) {\n    localStorage['ol@parmalink'] = this.getLink(true);\n  }\n  */\n};\n/**\n * On view change refresh link\n * @param {ol.event} The map instance.\n * @private\n */\nol.control.Permalink.prototype.viewChange_ = function() {\n  try {\n    if (this.replaceState_) window.history.replaceState (null,null, this.getLink());\n  } catch(e) {/* ok */}\n  if (this._localStorage) {\n    localStorage['ol@parmalink'] = this.getLink(true);\n  }\n};\n/**\n * Layer change refresh link\n * @private\n */\nol.control.Permalink.prototype.layerChange_ = function() {\n  // Get layers\n  var l = \"\";\n  function getLayers(layers) {\n    for (var i=0; i<layers.length; i++) {\n      if (layers[i].getVisible() && layers[i].get(\"permalink\")) {\n        if (l) l += \"|\";\n        l += layers[i].get(\"permalink\")+\":\"+layers[i].get(\"opacity\");\n      }\n      // Layer Group\n      if (layers[i].getLayers) getLayers(layers[i].getLayers().getArray());\n    }\n  }\n  getLayers(this.getMap().getLayers().getArray());\n  this.layerStr_ = l;\n  this.viewChange_();\n};\n\n/*\n  Copyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Print control to get an image of the map\n *\n * @constructor\n * @fire print\n * @fire error\n * @fire printing\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {string} options.imageType A string indicating the image format, default image/jpeg\n *\t@param {number} options.quality Number between 0 and 1 indicating the image quality to use for image formats that use lossy compression such as image/jpeg and image/webp\n *\t@param {string} options.orientation Page orientation (landscape/portrait), default guest the best one\n */\nol.control.Print = function(options) {\n  if (!options) options = {};\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || 'ol-print')\n  });\n  if (!options.target) {\n    element.classList.add('ol-unselectable', 'ol-control');\n    ol.ext.element.create('BUTTON', {\n      type: 'button',\n      click: function() { this.print(); }.bind(this),\n      parent: element\n    });\n  }\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('imageType', options.imageType || 'image/jpeg');\n  this.set('quality', options.quality || .8);\n  this.set('orientation', options.orientation);\n};\nol.ext.inherits(ol.control.Print, ol.control.Control);\n/** Print the map\n * @param {function} cback a callback function that take a string containing the requested data URI.\n * @param {Object} options\n *\t@param {string} options.imageType A string indicating the image format, default the control one\n *\t@param {number} options.quality Number between 0 and 1 indicating the image quality to use for image formats that use lossy compression such as image/jpeg and image/webp\n *  @param {boolean} options.immediate true to prevent delay for printing\n *  @param {*} options.any any options passed to the print event when fired\n * @api\n */\nol.control.Print.prototype.print = function(options) {\n  options = options || {};\n  var imageType = options.imageType || this.get('imageType');\n  var quality = options.quality || this.get('quality');\n  if (this.getMap()) {\n    if (options.immediate !== 'silent') {\n      this.dispatchEvent(Object.assign({ \n        type: 'printing',\n      }, options));\n    }\n    // Start printing after delay to var user show info in the DOM\n    if (!options.immediate) {\n      setTimeout (function () {\n        options = Object.assign({}, options);\n        options.immediate = 'silent';\n        this.print(options);\n      }.bind(this), 200);\n      return;\n    }\n    // Run printing\n    this.getMap().once('rendercomplete', function(event) {\n      var canvas, ctx;\n      // ol <= 5 : get the canvas\n      if (event.context) {\n        canvas = event.context.canvas;\n      } else {\n        // ol6+ : create canvas using layer canvas\n        this.getMap().getViewport().querySelectorAll('.ol-layer canvas, canvas.ol-fixedoverlay').forEach(function(c) {\n          if (c.width) {\n            // Create a canvas if none\n            if (!canvas) {\n              canvas = document.createElement('canvas');\n              var size = this.getMap().getSize();\n              canvas.width = size[0];\n              canvas.height = size[1];\n              ctx = canvas.getContext('2d');\n              if (/jp.*g$/.test(imageType)) {\n                ctx.fillStyle = this.get('bgColor') || 'white';\n                ctx.fillRect(0,0,canvas.width,canvas.height);\t\t\n              }\n            }\n            ctx.save();\n            // opacity\n            ctx.globalAlpha = c.style.opacity || 1;\n            // transform\n            var tr = ol.ext.element.getStyle(c,'transform') || ol.ext.element.getStyle(c,'-webkit-transform');\n            if (/^matrix/.test(tr)) {\n              tr = tr.replace(/^matrix\\(|\\)$/g,'').split(',');\n              tr.forEach(function(t,i) { tr[i] = parseFloat(t); });\n              ctx.transform(tr[0],tr[1],tr[2],tr[3],tr[4],tr[5]);\n              ctx.drawImage(c, 0, 0);\n            } else {\n              ctx.drawImage(c, 0, 0, ol.ext.element.getStyle(c,'width'), ol.ext.element.getStyle(c,'height'));\n            }\n            ctx.restore();\n          }\n        }.bind(this));\n      }\n      // Calculate print format\n      var size = [210,297], format = 'a4';\n      var w, h, position;\n      var orient = options.orient || this.get('orientation');\n      var margin = options.margin || 10;\n      if (canvas) {\n        // Calculate size\n        if (orient!=='landscape' && orient!=='portrait') {\n          orient = (canvas.width > canvas.height) ? 'landscape' : 'portrait';\n        }\n        if (orient === 'landscape') size = [size[1],size[0]];\n        var sc = Math.min ((size[0]-2*margin)/canvas.width,(size[1]-2*margin)/canvas.height);\n        w = sc * canvas.width;\n        h = sc * canvas.height;\n        // Image position\n        position = [(size[0] - w)/2, (size[1] - h)/2];\n      }\n      // get the canvas image\n      var image;\n      try { \n        image = canvas ? canvas.toDataURL(imageType, quality) : null;\n      } catch(e) {\n        // Fire error event\n        this.dispatchEvent({\n          type: 'error',\n          canvas: canvas\n        });\n        return;\n      }\n      // Fire print event\n      var e = Object.assign({ \n        type: 'print',\n        print: {\n          format: format,\n          orientation: orient,\n          unit: 'mm',\n          size: size,\n          position: position,\n          imageWidth: w,\n          imageHeight: h\n        },\n        image: image,\n        imageType: imageType,\n        canvas: canvas\n      }, options);\n      this.dispatchEvent(e);\n    }.bind(this));\n    this.getMap().render();\n  }\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/**\n * @classdesc OpenLayers 3 Profil Control.\n *\tDraw a profil of a feature (with a 3D geometry)\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires  over, out, show\n * @param {Object=} _ol_control_ opt_options.\n *\n */\nol.control.Profil = function(opt_options)\n{\tvar options = opt_options || {};\n\tthis.info = options.info || ol.control.Profil.prototype.info;\n\tvar self = this;\n\tvar element;\n\tif (options.target)\n\t{\telement = document.createElement(\"div\");\n\t\telement.classList.add(options.className || \"ol-profil\");\n\t}\n\telse\n\t{\telement = document.createElement(\"div\");\n\t\telement.className = ((options.className || 'ol-profil') +' ol-unselectable ol-control ol-collapsed').trim();\n\t\tthis.button = document.createElement(\"button\");\n\t\tthis.button.setAttribute('type','button');\n\t\tvar click_touchstart_function = function(e)\n\t\t{\tself.toggle();\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis.button.addEventListener(\"click\", click_touchstart_function);\n\t\tthis.button.addEventListener(\"touchstart\", click_touchstart_function);\n\t\telement.appendChild(this.button);\n\t}\n\tvar div_inner = document.createElement(\"div\");\n\t\t\tdiv_inner.classList.add(\"ol-inner\");\n\t\t\telement.appendChild(div_inner);\n\tvar div = document.createElement(\"div\");\n\t\t\tdiv.style.position = \"relative\";\n\t\t\tdiv_inner.appendChild(div);\n\tvar ratio = this.ratio = 2;\n\tthis.canvas_ = document.createElement('canvas');\n\tthis.canvas_.width = (options.width || 300)*ratio;\n\tthis.canvas_.height = (options.height || 150)*ratio;\n\tvar styles = {\n\t\t\"msTransform\":\"scale(0.5,0.5)\", \"msTransformOrigin\":\"0 0\",\n\t\t\"webkitTransform\":\"scale(0.5,0.5)\", \"webkitTransformOrigin\":\"0 0\",\n\t\t\"mozTransform\":\"scale(0.5,0.5)\", \"mozTransformOrigin\":\"0 0\",\n\t\t\"transform\":\"scale(0.5,0.5)\", \"transformOrigin\":\"0 0\"\n\t};\n\tObject.keys(styles).forEach(function(style) {\n\t\tif (style in self.canvas_.style) {\n\t\t\tself.canvas_.style[style] = styles[style];\n\t\t}\n\t});\n\tvar div_to_canvas = document.createElement(\"div\");\n\tdiv.appendChild(div_to_canvas);\n\tdiv_to_canvas.style.width = this.canvas_.width/ratio + \"px\";\n\tdiv_to_canvas.style.height = this.canvas_.height/ratio + \"px\";\n\tdiv_to_canvas.appendChild(this.canvas_);\n\tdiv_to_canvas.addEventListener(\"click\", function(e){ self.onMove(e); });\n\tdiv_to_canvas.addEventListener(\"mousemove\", function(e){ self.onMove(e); });\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\t// Offset in px\n\tthis.margin_ = { top:10*ratio, left:40*ratio, bottom:30*ratio, right:10*ratio };\n\tif (!this.info.ytitle) this.margin_.left -= 20*ratio;\n\tif (!this.info.xtitle) this.margin_.bottom -= 20*ratio;\n\t// Cursor\n\tthis.bar_ = document.createElement(\"div\");\n\tthis.bar_.classList.add(\"ol-profilbar\");\n\tthis.bar_.style.top = (this.margin_.top/ratio)+\"px\";\n\tthis.bar_.style.height = (this.canvas_.height-this.margin_.top-this.margin_.bottom)/ratio+\"px\";\n\tdiv.appendChild(this.bar_);\n\tthis.cursor_ = document.createElement(\"div\");\n\tthis.cursor_.classList.add(\"ol-profilcursor\");\n\tdiv.appendChild(this.cursor_);\n\tthis.popup_ = document.createElement(\"div\");\n\tthis.popup_.classList.add(\"ol-profilpopup\");\n\tthis.cursor_.appendChild(this.popup_);\n\t// Track information\n\tvar t = document.createElement(\"table\");\n\t\t\tt.cellPadding = '0';\n\t\t\tt.cellSpacing = '0';\n\t\t\tt.style.clientWidth = this.canvas_.width/ratio + \"px\";\n\t\tdiv.appendChild(t);\n\tvar firstTr = document.createElement(\"tr\");\n\t\t\tfirstTr.classList.add(\"track-info\");\n\t\t\tt.appendChild(firstTr);\n\tvar div_zmin = document.createElement(\"td\");\n\tdiv_zmin.innerHTML = (this.info.zmin||\"Zmin\")+': <span class=\"zmin\">';\n\tfirstTr.appendChild(div_zmin);\n\tvar div_zmax = document.createElement(\"td\");\n\tdiv_zmax.innerHTML = (this.info.zmax||\"Zmax\")+': <span class=\"zmax\">';\n\tfirstTr.appendChild(div_zmax);\n\tvar div_distance = document.createElement(\"td\");\n\tdiv_distance.innerHTML = (this.info.distance||\"Distance\")+': <span class=\"dist\">';\n\tfirstTr.appendChild(div_distance);\n\tvar div_time = document.createElement(\"td\");\n\tdiv_time.innerHTML = (this.info.time||\"Time\")+': <span class=\"time\">';\n\tfirstTr.appendChild(div_time);\n\tvar secondTr = document.createElement(\"tr\");\n\t\t\tsecondTr.classList.add(\"point-info\")\n\t\t\tt.appendChild(secondTr);\n\tvar div_altitude = document.createElement(\"td\");\n\tdiv_altitude.innerHTML = (this.info.altitude||\"Altitude\")+': <span class=\"z\">';\n\tsecondTr.appendChild(div_altitude);\n\tvar div_distance2 = document.createElement(\"td\");\n\tdiv_distance2.innerHTML = (this.info.distance||\"Distance\")+': <span class=\"dist\">';\n\tsecondTr.appendChild(div_distance2);\n\tvar div_time2 = document.createElement(\"td\");\n\tdiv_time2.innerHTML = (this.info.time||\"Time\")+': <span class=\"time\">';\n\tsecondTr.appendChild(div_time2);\n\t// Array of data\n\tthis.tab_ = [];\n\t// Show feature\n\tif (options.feature)\n\t{\tthis.setGeometry (options.feature);\n\t}\n};\nol.ext.inherits(ol.control.Profil, ol.control.Control);\n/** Custom infos list\n* @api stable\n*/\nol.control.Profil.prototype.info =\n{\t\"zmin\": \"Zmin\",\n\t\"zmax\": \"Zmax\",\n\t\"ytitle\": \"Altitude (m)\",\n\t\"xtitle\": \"Distance (km)\",\n\t\"time\": \"Time\",\n\t\"altitude\": \"Altitude\",\n\t\"distance\": \"Distance\",\n\t\"altitudeUnits\": \"m\",\n\t\"distanceUnitsM\": \"m\",\n\t\"distanceUnitsKM\": \"km\",\n};\n/** Show popup info\n* @param {string} info to display as a popup\n* @api stable\n*/\nol.control.Profil.prototype.popup = function(info)\n{\tthis.popup_.innerHTML = info;\n}\n/** Mouse move over canvas\n*/\nol.control.Profil.prototype.onMove = function(e)\n{\tif (!this.tab_.length) return;\n\tvar box_canvas = this.canvas_.getBoundingClientRect();\n\tvar pos = {\n    top: box_canvas.top + window.pageYOffset - document.documentElement.clientTop,\n    left: box_canvas.left + window.pageXOffset - document.documentElement.clientLeft\n  };\n\tvar dx = e.pageX -pos.left;\n\tvar dy = e.pageY -pos.top;\n\tvar ratio = this.ratio;\n\tif (dx>this.margin_.left/ratio && dx<(this.canvas_.width-this.margin_.right)/ratio\n\t\t&& dy>this.margin_.top/ratio && dy<(this.canvas_.height-this.margin_.bottom)/ratio)\n\t{\tthis.bar_.style.left = dx+\"px\";\n\t\tthis.bar_.style.display = \"block\";\n\t\tvar d = (dx*ratio-this.margin_.left)/this.scale_[0];\n\t\tvar p0 = this.tab_[0];\n\t\tfor (var i=1, p; p=this.tab_[i]; i++)\n\t\t{\tif (p[0]>=d)\n\t\t\t{\tif (d < (p[0]+p0[0])/2) p = p0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (p) {\n\t\t\tthis.cursor_.style.left = dx+\"px\";\n\t\t\tthis.cursor_.style.top = (this.canvas_.height-this.margin_.bottom+p[1]*this.scale_[1]+this.dy_)/ratio+\"px\";\n\t\t\tthis.cursor_.style.display = \"block\";\n\t\t}\n\t\telse {\n\t\t\tthis.cursor_.style.display = \"none\";\n\t\t}\n\t\tthis.bar_.parentElement.classList.add(\"over\");\n\t\tthis.element.querySelector(\".point-info .z\").textContent = p[1]+this.info.altitudeUnits;\n\t\tthis.element.querySelector(\".point-info .dist\").textContent = (p[0]/1000).toFixed(1)+this.info.distanceUnitsKM;\n\t\tthis.element.querySelector(\".point-info .time\").textContent = p[2];\n\t\tif (dx>this.canvas_.width/ratio/2) this.popup_.classList.add('ol-left');\n\t\telse this.popup_.classList.remove('ol-left');\n\t\tthis.dispatchEvent({ type:'over', click:e.type==\"click\", coord: p[3], time: p[2], distance: p[0] });\n\t}\n\telse\n\t{\tif (this.bar_.parentElement.classList.contains(\"over\"))\n\t\t{\tthis.bar_.style.display = 'none';\n\t\t\tthis.cursor_.style.display = 'none';\n\t\t\tthis.bar_.parentElement.classList.remove(\"over\");\n\t\t\tthis.dispatchEvent({ type:'out' });\n\t\t}\n\t}\n}\n/** Show panel\n* @api stable\n*/\nol.control.Profil.prototype.show = function()\n{\tthis.element.classList.remove(\"ol-collapsed\");\n\tthis.dispatchEvent({ type:'show', show: true });\n}\n/** Hide panel\n* @api stable\n*/\nol.control.Profil.prototype.hide = function()\n{\tthis.element.classList.add(\"ol-collapsed\");\n\tthis.dispatchEvent({ type:'show', show: false });\n}\n/** Toggle panel\n* @api stable\n*/\nol.control.Profil.prototype.toggle = function()\n{\tthis.element.classList.toggle(\"ol-collapsed\");\n\tvar b = this.element.classList.contains(\"ol-collapsed\");\n\tthis.dispatchEvent({ type:'show', show: !b });\n}\n/** Is panel visible\n*/\nol.control.Profil.prototype.isShown = function()\n{\treturn (!this.element.classList.contains(\"ol-collapsed\"));\n}\n/**\n * Set the geometry to draw the profil.\n * @param {ol.Feature|ol.geom} f the feature.\n * @param {Object=} options\n *\t\t- projection {ol.ProjectionLike} feature projection, default projection of the map\n *\t\t- zunit {m|km} default m\n *\t\t- unit {m|km} default km\n *\t\t- zmin {Number|undefined} default 0\n *\t\t- zmax {Number|undefined} default max Z of the feature\n *\t\t- graduation {Number|undefined} z graduation default 100\n *\t\t- amplitude {integer|undefined} amplitude of the altitude, default zmax-zmin\n * @api stable\n */\nol.control.Profil.prototype.setGeometry = function(g, options)\n{\tif (!options) options = {};\n\tif (g instanceof ol.Feature) g = g.getGeometry();\n\tvar canvas = this.canvas_;\n\tvar ctx = canvas.getContext('2d');\n\tvar w = canvas.width;\n\tvar h = canvas.height;\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.clearRect(0,0, w, h);\n\t// No Z\n\tif (!/Z/.test(g.getLayout())) return;\n\t// No time\n\tif(/M/.test(g.getLayout())) this.element.querySelector(\".time\").parentElement.style.display = 'block';\n\telse this.element.querySelector(\".time\").parentElement.style.display = 'none';\n\t// Coords\n\tvar c = g.getCoordinates();\n\tswitch (g.getType())\n\t{\tcase \"LineString\": break;\n\t\tcase \"MultiLineString\": c = c[0]; break;\n\t\tdefault: return;\n\t}\n\t// Distance beetween 2 coords\n\tvar proj = options.projection || this.getMap().getView().getProjection();\n\tfunction dist2d(p1,p2)\n\t{\treturn ol.sphere.getDistance(\n\t\t\tol.proj.transform(p1, proj, 'EPSG:4326'),\n\t\t\tol.proj.transform(p2, proj, 'EPSG:4326'));\n\t}\n\tfunction getTime(t0, t1)\n\t{\tif (!t0 || !t1) return \"-\"\n\t\tvar dt = (t1-t0) / 60; // mn\n\t\tvar ti = Math.trunc(dt/60);\n\t\tvar mn = Math.trunc(dt-ti*60);\n\t\treturn ti+\"h\"+(mn<10?\"0\":\"\")+mn+\"mn\";\n\t}\n\t// Margin\n\tctx.setTransform(1, 0, 0, 1, this.margin_.left, h-this.margin_.bottom);\n\tvar ratio = this.ratio;\n\tw -= this.margin_.right + this.margin_.left;\n\th -= this.margin_.top + this.margin_.bottom;\n\t// Draw axes\n\tctx.strokeStyle = \"#000\";\n\tctx.lineWidth = 0.5*ratio;\n\tctx.beginPath();\n\tctx.moveTo(0,0); ctx.lineTo(0,-h);\n\tctx.moveTo(0,0); ctx.lineTo(w, 0);\n\tctx.stroke();\n\t//\n\tvar zmin=Infinity, zmax=-Infinity;\n\tvar i, p, d, z, ti, t = this.tab_ = [];\n\tfor (i=0, p; p=c[i]; i++)\n\t{\tz = p[2];\n\t\tif (z<zmin) zmin=z;\n\t\tif (z>zmax) zmax=z;\n\t\tif (i==0) d = 0;\n\t\telse d += dist2d(c[i-1], p);\n\t\tti = getTime(c[0][3],p[3]);\n\t\tt.push ([d, z, ti, p]);\n\t}\n\t// Info\n\tthis.element.querySelector(\".track-info .zmin\").textContent = zmin.toFixed(2)+this.info.altitudeUnits;\n\tthis.element.querySelector(\".track-info .zmax\").textContent = zmax.toFixed(2)+this.info.altitudeUnits;\n\tif (d>1000)\n\t{\tthis.element.querySelector(\".track-info .dist\").textContent = (d/1000).toFixed(1)+this.info.distanceUnitsKM;\n\t}\n\telse\n\t{\tthis.element.querySelector(\".track-info .dist\").textContent= (d).toFixed(1)+this.info.distanceUnitsM;\n\t}\n\tthis.element.querySelector(\".track-info .time\").textContent = ti;\n\t// Set graduation\n\tvar grad = options.graduation || 100;\n\twhile (true)\n\t{\tzmax = Math.ceil(zmax/grad)*grad;\n\t\tzmin = Math.floor(zmin/grad)*grad;\n\t\tvar nbgrad = (zmax-zmin)/grad;\n\t\tif (h/nbgrad < 15*ratio)\n\t\t{\tgrad *= 2;\n\t\t}\n\t\telse break;\n\t}\n\t// Set amplitude\n\tif (typeof(options.zmin)=='number' && zmin > options.zmin) zmin = options.zmin;\n\tif (typeof(options.zmax)=='number' && zmax < options.zmax) zmax = options.zmax;\n\tvar amplitude = options.amplitude;\n\tif (amplitude)\n\t{\tzmax = Math.max (zmin + amplitude, zmax);\n\t}\n\t// Scales lines\n\tvar scx = w/d;\n\tvar scy = -h/(zmax-zmin);\n\tvar dy = this.dy_ = -zmin*scy;\n\tthis.scale_ = [scx,scy];\n\t// Draw\n\tctx.font = (10*ratio)+\"px arial\";\n\tctx.textAlign = \"right\";\n\tctx.textBaseline = \"middle\";\n\tctx.fillStyle=\"#000\";\n\t// Scale Z\n\tctx.beginPath();\n\tfor (i=zmin; i<=zmax; i+=grad)\n\t{\tif (options.zunit!=\"km\") ctx.fillText(i, -4*ratio, i*scy+dy);\n\t\telse ctx.fillText((i/1000).toFixed(1), -4*ratio, i*scy+dy);\n\t\tctx.moveTo (-2*ratio, i*scy+dy);\n\t\tif (i!=0) ctx.lineTo (d*scx, i*scy+dy);\n\t\telse ctx.lineTo (0, i*scy+dy);\n\t}\n\t// Scale X\n\tctx.textAlign = \"center\";\n\tctx.textBaseline = \"top\";\n\tctx.setLineDash([ratio,3*ratio]);\n\tvar unit = options.unit ||\"km\";\n\tvar step;\n\tif (d>1000)\n\t{\tstep = Math.round(d/1000)*100;\n\t\tif (step > 1000) step = Math.ceil(step/1000)*1000;\n\t}\n\telse\n\t{\tunit = \"m\";\n\t\tif (d>100) step = Math.round(d/100)*10;\n\t\telse if (d>10) step = Math.round(d/10);\n\t\telse if (d>1) step = Math.round(d)/10;\n\t\telse step = d;\n\t}\n\tfor (i=0; i<=d; i+=step)\n\t{\tvar txt = (unit==\"m\") ? i : (i/1000);\n\t\t//if (i+step>d) txt += \" \"+ (options.zunits || \"km\");\n\t\tctx.fillText(Math.round(txt*10)/10, i*scx, 4*ratio);\n\t\tctx.moveTo (i*scx, 2*ratio); ctx.lineTo (i*scx, 0);\n\t}\n\tctx.font = (12*ratio)+\"px arial\";\n\tctx.fillText(this.info.xtitle.replace(\"(km)\",\"(\"+unit+\")\"), w/2, 18*ratio);\n\tctx.save();\n\tctx.rotate(-Math.PI/2);\n\tctx.fillText(this.info.ytitle, h/2, -this.margin_.left);\n\tctx.restore();\n\tctx.stroke();\n\t// \n\tctx.strokeStyle = \"#369\";\n\tctx.lineWidth = 1;\n\tctx.setLineDash([]);\n\tctx.beginPath();\n\tfor (i=0; p=t[i]; i++)\n\t{\tif (i==0) ctx.moveTo(p[0]*scx,p[1]*scy+dy);\n\t\telse ctx.lineTo(p[0]*scx,p[1]*scy+dy);\n\t}\n\tctx.stroke();\n};\n/** Get profil image\n* @param {string|undefined} type image format or 'canvas' to get the canvas image, default image/png.\n* @param {Number|undefined} encoderOptions between 0 and 1 indicating image quality image/jpeg or image/webp, default 0.92.\n* @return {string} requested data uri\n* @api stable\n*/\nol.control.Profil.prototype.getImage = function(type, encoderOptions)\n{\tif (type===\"canvas\") return this.canvas_;\n\treturn this.canvas_.toDataURL(type, encoderOptions);\n}\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Geoportail routing Control.\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires change:input\n * @param {Object=} options\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {string | undefined} options.inputLabel label for the input, default none\n *\t@param {string | undefined} options.noCollapse prevent collapsing on input blur, default false\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms) use -1 to prevent autocompletion, default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\t@param {integer | undefined} options.maxHistory maximum number of items to display in history. Set -1 if you don't want history, default maxItems\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index.\n *\t@param {function} options.autocomplete a function that take a search string and callback function to send an array\n */\nol.control.RoutingGeoportail = function(options) {\n  var self = this;\n  if (!options) options = {};\n  if (options.typing == undefined) options.typing = 300;\n  // Class name for history\n  this._classname = options.className || 'search';\n  var element = document.createElement(\"DIV\");\n  var classNames = (options.className||\"\")+ \" ol-routing\";\n  if (!options.target) {\n    classNames += \" ol-unselectable ol-control\";\n  }\n  element.setAttribute('class', classNames);\n\tif (!options.target) {\n    var bt = ol.ext.element.create('BUTTON', { parent: element })\n    bt.addEventListener('click', function(){\n      element.classList.toggle('ol-collapsed');\n    });\n  }\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('url', 'https://wxs.ign.fr/'+options.apiKey+'/itineraire/rest/route.json');\n  this._search = [];\n  var content = ol.ext.element.create('DIV', { className: 'content', parent: element } )\n  var listElt = ol.ext.element.create('DIV', { className: 'search-input', parent: content });\n  this._search = [];\n  this.addSearch(listElt, options);\n  this.addSearch(listElt, options);\n  ol.ext.element.create('I', { className: 'ol-car', title: options.carlabel||'by car', parent: content })\n    .addEventListener(\"click\", function() {\n      self.setMode('car');\n    });\n  ol.ext.element.create('I', { className: 'ol-pedestrian', title: options.pedlabel||'pedestrian', parent: content })\n    .addEventListener(\"click\", function() {\n      self.setMode('pedestrian');\n    });\n  ol.ext.element.create('I', { className: 'ol-ok', title: options.runlabel||'search', html:'OK', parent: content })\n    .addEventListener(\"click\", function() {\n      self.calculate();\n    });\n  ol.ext.element.create('I', { className: 'ol-cancel', html:'cancel', parent: content })\n    .addEventListener(\"click\", function() {\n      this.resultElement.innerHTML = '';\n    }.bind(this));\n  this.resultElement = document.createElement(\"DIV\");\n  this.resultElement.setAttribute('class', 'ol-result');\n  element.appendChild(this.resultElement);\n  this.setMode(options.mode || 'car');\n};\nol.ext.inherits(ol.control.RoutingGeoportail, ol.control.Control);\nol.control.RoutingGeoportail.prototype.setMode = function (mode) {\n  this.set('mode', mode);\n  this.element.querySelector(\".ol-car\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-pedestrian\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-\"+mode).classList.add(\"selected\");\n  this.calculate();\n};\nol.control.RoutingGeoportail.prototype.addButton = function (className, title, info) {\n  var bt = document.createElement(\"I\");\n  bt.setAttribute(\"class\", className);\n  bt.setAttribute(\"type\", \"button\");\n  bt.setAttribute(\"title\", title);\n  bt.innerHTML = info||'';\n  this.element.appendChild(bt);\n  return bt;\n};\n/** Remove a new search input\n * @private\n */\nol.control.RoutingGeoportail.prototype.removeSearch = function (element, options, after) {\n  element.removeChild(after);\n  if (this.getMap()) this.getMap().removeControl(after.olsearch);\n  this._search = [];\n  element.querySelectorAll('div').forEach(function(d) {\n    if (d.olsearch) this._search.push(d.olsearch);\n  }.bind(this));\n};\n/** Add a new search input\n * @private\n */\nol.control.RoutingGeoportail.prototype.addSearch = function (element, options, after) {\n  var self = this;\n  var div = ol.ext.element.create('DIV');\n  if (after) element.insertBefore(div, after.nextSibling);\n  else element.appendChild(div);\n  ol.ext.element.create ('BUTTON', { title: options.startlabel||\"add/remove\", parent: div})\n    .addEventListener('click', function(e) {\n      if (e.ctrlKey) {\n        if (this._search.length>2) this.removeSearch(element, options, div);\n      } else if (e.shiftKey) {\n        this.addSearch(element, options, div);\n      }\n    }.bind(this));\n  var search = div.olsearch = new ol.control.SearchGeoportail({\n    className: 'IGNF ol-collapsed',\n    apiKey: options.apiKey,\n    target: div,\n    reverse: true\n  });\n  this._search = [];\n  element.querySelectorAll('div').forEach(function(d) {\n    if (d.olsearch) this._search.push(d.olsearch);\n  }.bind(this));\n  search.on('select', function(e){\n    search.setInput(e.search.fulltext);\n    search.set('selection', e.search);\n  });\n  search.element.querySelector('input').addEventListener('change', function(){\n    search.set('selection', null);\n    self.resultElement.innerHTML = '';\n  });\n  if (this.getMap()) this.getMap().addControl(search);\n};\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.RoutingGeoportail.prototype.setMap = function (map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  for (var i=0; i<this._search.length; i++) {\n    var c = this._search[i];\n    c.setMap(map);\n  }\n};\n/** Get request data\n * @private\n */\nol.control.RoutingGeoportail.prototype.requestData = function (steps) {\n  var start = steps[0];\n  var end = steps[steps.length-1];\n  var waypoints = '';\n  for (var i=1; i<steps.length-1; i++) {\n    waypoints += (waypoints ? ';':'') + steps[i].x+','+steps[i].y;\n  }\n  return {\n    'gp-access-lib': '1.1.0',\n    origin: start.x+','+start.y,\n    destination: end.x+','+end.y,\n    method: 'time', // 'distance'\n    graphName: this.get('mode')==='pedestrian' ? 'Pieton' : 'Voiture',\n    waypoints: waypoints,\n    format: 'STANDARDEXT'\n  };\n};\n/** Show routing as a list\n * @private\n */\nol.control.RoutingGeoportail.prototype.listRouting = function (routing) {\n  var time = routing.duration/60;\n  this.resultElement.innerHTML = '';\n  var t = '';\n  if (time<60) {\n    t += time.toFixed(0)+' min';\n  } else {\n    t+= (time/60).toFixed(0)+' h '+(time%60).toFixed(0)+' min';\n  }\n  var dist = routing.distance;\n  if (dist<1000) {\n    t += ' ('+dist.toFixed(0)+' m)';\n  } else {\n    t += ' ('+(dist/1000).toFixed(2)+' km)';\n  }\n  var iElement = document.createElement('i');\n  iElement.textContent = t;\n  this.resultElement.appendChild(iElement)\n  var ul = document.createElement('ul');\n  this.resultElement.appendChild(ul);\n  var info = {\n    'none': 'Prendre sur ',\n    'R': 'Tourner  droite sur ',\n    'FR': 'Tourner lgrement  droite sur ',\n    'L': 'Tourner  gauche sur ',\n    'FL': 'Tourner lgrement  gauche sur ',\n    'F': 'Continuer tout droit sur ',\n  }\n  for (var i=0, f; f=routing.features[i]; i++) {\n    var d = f.get('distance');\n    d = (d<1000) ? d.toFixed(0)+' m' : (d/1000).toFixed(2)+' km';\n    t = f.get('durationT')/60;\n    console.log(f.get('duration'),t)\n    t = (f.get('duration')<40) ? '' : (t<60) ? t.toFixed(0)+' min' : (t/60).toFixed(0)+' h '+(t%60).toFixed(0)+' min';\n    var li = document.createElement('li');\n        li.classList.add(f.get('instruction'));\n        li.innerHTML = (info[f.get('instruction')||'none']||'#')\n      + ' ' + f.get('name')\n      + '<i>' + d + (t ? ' - ' + t : '') +'</i>'\n    ul.appendChild(li);\n  }\n};\n/** Handle routing response\n * @private\n */\nol.control.RoutingGeoportail.prototype.handleResponse = function (data, start, end) {\n  var routing = { type:'routing' };\n/*\n  var format = new ol.format.WKT();\n  routing.features = [ format.readFeature(data.geometryWkt, {\n    dataProjection: 'EPSG:4326',\n    featureProjection: this.getMap().getView().getProjection()\n  }) ];\n*/\n  routing.features = [];\n  var distance = 0;\n  var duration = 0;\n  var f, route = [];\n  for (var i=0, l; l=data.legs[i]; i++) {\n    for (var j=0, s; s=l.steps[j]; j++) {\n      var geom = [];\n      for (var k=0, p; p=s.points[k]; k++){\n        p = p.split(',');\n        geom.push([parseFloat(p[0]),parseFloat(p[1])]);\n        if (i===0 || k!==0) route.push(geom[k]);\n      }\n      geom = new ol.geom.LineString(geom);\n      var options = {\n        geometry: geom.transform('EPSG:4326',this.getMap().getView().getProjection()),\n        name: s.name,\n        instruction: s.navInstruction,\n        distance: parseFloat(s.distanceMeters),\n        duration: parseFloat(s.durationSeconds)\n      }\n      //console.log(duration, options.duration, s)\n      distance += options.distance;\n      duration += options.duration;\n      options.distanceT = distance;\n      options.durationT = duration;\n      f = new ol.Feature(options);\n      routing.features.push(f);\n    }\n  }\n  routing.distance = parseFloat(data.distanceMeters);\n  routing.duration = parseFloat(data.durationSeconds);\n  // Full route\n  route = new ol.geom.LineString(route);\n  routing.feature = new ol.Feature ({\n    geometry: route.transform('EPSG:4326',this.getMap().getView().getProjection()),\n    start: this._search[0].getTitle(start),\n    end: this._search[0].getTitle(end), \n    distance: routing.distance,\n    duration: routing.duration\n  });\n  // console.log(data, routing);\n  this.dispatchEvent(routing);\n  this.path = routing;\n  return routing;\n};\n/** Calculate route\n * \n */\nol.control.RoutingGeoportail.prototype.calculate = function () {\n  console.log('calculate')\n  this.resultElement.innerHTML = '';\n  var steps = []\n  for (var i=0; i<this._search.length; i++) {\n    if (this._search[i].get('selection')) steps.push(this._search[i].get('selection'));\n  }\n  if (steps.length<2) return;\n  var start = steps[0];\n  var end = steps[steps.length-1];\n  var data = this.requestData(steps);\n  var url = encodeURI(this.get('url'));\n  var parameters = '';\n  for (var index in data) {\n    parameters += (parameters) ? '&' : '?';\n    if (data.hasOwnProperty(index)) parameters += index + '=' + data[index];\n  }\n  var self = this;\n  this.ajax(url + parameters, \n    function (resp) {\n      if (resp.status >= 200 && resp.status < 400) {\n        self.listRouting(self.handleResponse (JSON.parse(resp.response), start, end));\n      } else {\n        console.log(url + parameters, arguments);\n      }\n    }, function(){\n      console.log(url + parameters, arguments);\n    });\n};\t\n/** Send an ajax request (GET)\n * @param {string} url\n * @param {function} onsuccess callback\n * @param {function} onerror callback\n */\nol.control.RoutingGeoportail.prototype.ajax = function (url, onsuccess, onerror){\n  var self = this;\n  // Abort previous request\n  if (this._request) {\n    this._request.abort();\n  }\n  // New request\n  var ajax = this._request = new XMLHttpRequest();\n  ajax.open('GET', url, true);\n  if (this._auth) {\n    ajax.setRequestHeader(\"Authorization\", \"Basic \" + this._auth);\n  }\n  this.element.classList.add('ol-searching');\n  // Load complete\n  ajax.onload = function() {\n    self._request = null;\n    self.element.classList.remove('ol-searching');\n    onsuccess.call(self, this);\n  };\n  // Oops, TODO do something ?\n  ajax.onerror = function() {\n    self._request = null;\n    self.element.classList.remove('ol-searching');\n    if (onerror) onerror.call(self);\n  };\n  // GO!\n  ajax.send();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Scale Control.\n * A control to display the scale of the center on the map\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires change:input\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {string} options.ppi screen ppi, default 96\n * \t@param {string} options.editable make the control editable, default true\n */\nol.control.Scale = function(options) {\n  if (!options) options = {};\n  if (options.typing == undefined) options.typing = 300;\n  var element = document.createElement(\"DIV\");\n  var classNames = (options.className||\"\")+ \" ol-scale\";\n  if (!options.target) {\n  classNames += \" ol-unselectable ol-control\";\n  }\n  this._input = document.createElement(\"INPUT\");\n  this._input.value = '-';\n  element.setAttribute('class', classNames);\n  if (options.editable===false) this._input.readOnly = true;\n  element.appendChild(this._input);\n  ol.control.Control.call(this, {\n  element: element,\n  target: options.target\n  });\n  this._input.addEventListener(\"change\", this.setScale.bind(this));\n  this.set('ppi', options.ppi || 96)\n};\nol.ext.inherits(ol.control.Scale, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.Scale.prototype.setMap = function (map) {\n  if (this._listener) ol.Observable.unByKey(this._listener);\n  this._listener = null;\n  ol.control.Control.prototype.setMap.call(this, map);\n  // Get change (new layer added or removed)\n  if (map) {\n    this._listener = map.on('moveend', this._showScale.bind(this));\n  }\n};\n/** Display the scale\n */\nol.control.Scale.prototype._showScale = function () {\n  var map = this.getMap();\n  if (map) {\n    var view = map.getView();\n    var proj = view.getProjection();\n    var center = view.getCenter();\n    var px = map.getPixelFromCoordinate(center);\n    px[1] += 1;\n    var coord = map.getCoordinateFromPixel(px);\n    var d = ol.sphere.getDistance(\n      ol.proj.transform(center, proj, 'EPSG:4326'),\n      ol.proj.transform(coord, proj, 'EPSG:4326'));\n    d *= this.get('ppi')/.0254\n    this._input.value = this.formatScale(d);\n  }\n};\n/** Format the scale 1/d\n * @param {Number} d\n * @return {string} formated string\n */\nol.control.Scale.prototype.formatScale = function (d) {\n  if (d>100) d = Math.round(d/100) * 100;\n  else d = Math.round(d);\n  return '1 / '+ d.toLocaleString();\n};\n/** Set the current scale (will change the scale of the map)\n * @param {Number} value the scale factor\n */\nol.control.Scale.prototype.setScale = function (value) {\n  var map = this.getMap();\n  if (map && value) {\n    if (value.target) value = value.target.value;\n    var fac = value;\n    if (typeof(value)==='string') {\n      fac = value.split('/')[1];\n      if (!fac) fac = value;\n      fac = fac.replace(/[^\\d]/g,'');\n      fac = parseInt(fac);\n    }\n    // Calculate new resolution\n    var view = map.getView();\n    var proj = view.getProjection();\n    var center = view.getCenter();\n    var px = map.getPixelFromCoordinate(center);\n    px[1] += 1;\n    var coord = map.getCoordinateFromPixel(px);\n    var d = ol.sphere.getDistance(\n      ol.proj.transform(center, proj, 'EPSG:4326'),\n      ol.proj.transform(coord, proj, 'EPSG:4326'));\n    d *= this.get('ppi')/.0254\n    view.setResolution(view.getResolution()*fac/d);\n  }\n  this._showScale();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options.\n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 3\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *  @param {string|undefined} options.url Url to BAN api, default \"https://api-adresse.data.gouv.fr/search/\"\n *  @param {boolean} options.position Search, with priority to geo position, default false\n *  @param {function} options.getTitle a function that takes a feature and return the text to display in the menu, default return label attribute\n * @see {@link https://adresse.data.gouv.fr/api/}\n */\nol.control.SearchBAN = function(options) {\n  options = options || {};\n  options.typing = options.typing || 500;\n  options.url = options.url || 'https://api-adresse.data.gouv.fr/search/';\n  options.className = options.className || 'BAN';\n  options.copy = '<a href=\"https://adresse.data.gouv.fr/\" target=\"new\">&copy; BAN-data.gouv.fr</a>';\n  ol.control.SearchPhoton.call(this, options);\n};\nol.ext.inherits(ol.control.SearchBAN, ol.control.SearchPhoton);\n/** Returns the text to be displayed in the menu\n * @param {ol.Feature} f the feature\n * @return {string} the text to be displayed in the index\n * @api\n */\nol.control.SearchBAN.prototype.getTitle = function (f) {\n  var p = f.properties;\n  return (p.label);\n};\n/** A ligne has been clicked in the menu > dispatch event\n * @param {any} f the feature, as passed in the autocomplete\n * @api\n */\nol.control.SearchBAN.prototype.select = function (f){\n  var c = f.geometry.coordinates;\n  // Add coordinate to the event\n  try {\n    c = ol.proj.transform (f.geometry.coordinates, 'EPSG:4326', this.getMap().getView().getProjection());\n  } catch(e) { /* ok */ }\n  this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search on DFCI grid.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options. \n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {string | undefined} options.property a property to display in the index, default 'name'.\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index, default return the property \n *\t@param {function | undefined} options.getSearchString a function that take a feature and return a text to be used as search string, default geTitle() is used as search string\n */\nol.control.SearchDFCI = function(options) {\n  if (!options) options = {};\n  options.className = options.className || 'dfci';\n  options.placeholder = options.placeholder || 'Code DFCI';\n  ol.control.Search.call(this, options);\n};\nol.ext.inherits(ol.control.SearchDFCI, ol.control.Search);\n/** Autocomplete function\n* @param {string} s search string\n* @return {Array<any>|false} an array of search solutions or false if the array is send with the cback argument (asnchronous)\n* @api\n*/\nol.control.SearchDFCI.prototype.autocomplete = function (s) {\n  s = s.toUpperCase();\n  s = s.replace(/[^0-9,^A-H,^K-N]/g,'');\n  if (s.length<2) {\n    this.setInput(s);\n    return [];\n  }\n  var i;\n  var proj = this.getMap().getView().getProjection();\n  var result = [];\n  var c = ol.coordinate.fromDFCI(s, proj);\n  var level = Math.floor(s.length/2)-1;\n  var dfci = ol.coordinate.toDFCI(c, level, proj);\n  dfci = dfci.replace(/[^0-9,^A-H,^K-N]/g,'');\n  // Valid DFCI ?\n  if (!/NaN/.test(dfci) && dfci) {\n    console.log('ok', dfci)\n    this.setInput(dfci + s.substring(dfci.length, s.length));\n    result.push({ coordinate: ol.coordinate.fromDFCI(dfci, proj), name: dfci });\n    if (s.length===5) {\n      c = ol.coordinate.fromDFCI(s+0, proj);\n      dfci = (ol.coordinate.toDFCI(c, level+1, proj)).substring(0,5);\n      for (i=0; i<10; i++) {\n        result.push({ coordinate: ol.coordinate.fromDFCI(dfci+i, proj), name: dfci+i });\n      }\n    }\n    if (level === 2) {\n      for (i=0; i<6; i++) {\n        result.push({ coordinate: ol.coordinate.fromDFCI(dfci+'.'+i, proj), name: dfci+'.'+i });\n      }\n    }\n  }\n  return result;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search features.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options. \n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {string | undefined} options.property a property to display in the index, default 'name'.\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index, default return the property \n *\t@param {function | undefined} options.getSearchString a function that take a feature and return a text to be used as search string, default geTitle() is used as search string\n */\nol.control.SearchFeature = function(options) {\n  if (!options) options = {};\n  options.className = options.className || 'feature';\n  ol.control.Search.call(this, options);\n  if (typeof(options.getSearchString)==\"function\") this.getSearchString = options.getSearchString;\n  this.set('property', options.property || 'name');\n  this.source_ = options.source;\n};\nol.ext.inherits(ol.control.SearchFeature, ol.control.Search);\n/** No history avaliable on features\n */\nol.control.SearchFeature.prototype.restoreHistory = function () {\n  this.set('history', []);\n};\n/** No history avaliable on features\n */\nol.control.SearchFeature.prototype.saveHistory = function () {\n  localStorage.removeItem(\"ol@search-\"+this._classname);\n}\n/** Returns the text to be displayed in the menu\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.SearchFeature.prototype.getTitle = function (f) {\n  return f.get(this.get('property')||'name');\n};\n/** Return the string to search in\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be used as search string\n*\t@api\n*/\nol.control.SearchFeature.prototype.getSearchString = function (f) {\n  return this.getTitle(f);\n};\n/** Get the source\n*\t@return {ol.source.Vector}\n*\t@api\n*/\nol.control.SearchFeature.prototype.getSource = function () {\n  return this.source_;\n}\n/** Get the source\n*\t@param {ol.source.Vector} source\n*\t@api\n*/\nol.control.SearchFeature.prototype.setSource = function (source) {\n  this.source_ =  source;\n};\n/** Autocomplete function\n* @param {string} s search string\n* @param {int} max max \n* @param {function} cback a callback function that takes an array to display in the autocomplete field (for asynchronous search)\n* @return {Array<any>|false} an array of search solutions or false if the array is send with the cback argument (asnchronous)\n* @api\n*/\nol.control.SearchFeature.prototype.autocomplete = function (s) {\n  var result = [];\n  if (this.source_) {\n    // regexp\n    s = s.replace(/^\\*/,'');\n    var rex = new RegExp(s, 'i');\n    // The source\n    var features = this.source_.getFeatures();\n    var max = this.get('maxItems')\n    for (var i=0, f; f=features[i]; i++) {\n      var att = this.getSearchString(f);\n      if (att !== undefined && rex.test(att)) {\n        result.push(f);\n        if ((--max)<=0) break;\n      }\n    }\n  }\n  return result;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search on GPS coordinate.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options. \n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 300.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 1\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n */\nol.control.SearchGPS = function(options) {\n  if (!options) options = {};\n  options.className = (options.className || '') + ' ol-searchgps';\n  options.placeholder = options.placeholder || 'lon,lat';\n  ol.control.Search.call(this, options);\n  // Geolocation\n  this.geolocation = new ol.Geolocation({\n    projection: \"EPSG:4326\",\n    trackingOptions: {\n      maximumAge: 10000,\n      enableHighAccuracy: true,\n      timeout: 600000\n    }\n  });\n  ol.ext.element.create ('BUTTON', {\n    className: 'ol-geoloc',\n    title: 'Locate with GPS',\n    parent: this.element,\n    click: function(){\n      this.geolocation.setTracking(true);\n    }.bind(this)\n  })\n  // DMS switcher\n  var dms = ol.ext.element.create('LABEL', {\n    className: 'ol-switch',\n    parent: this.element\n  });\n  ol.ext.element.create('TEXT', {\n    html: 'decimal',\n    parent: dms\n  });\n  ol.ext.element.create('INPUT', {\n    type: 'checkbox',\n    parent: dms,\n    on: {\n      'change': function(e) {\n        if (e.target.checked) this.element.classList.add('ol-dms');\n        else this.element.classList.remove('ol-dms');\n      }.bind(this)\n    }\n  });\n  ol.ext.element.create ('SPAN', {\n    parent: dms\n  });\n  ol.ext.element.create('TEXT', {\n    html: 'DMS',\n    parent: dms\n  });\n  this._createForm();\n  // Move list to the end\n  var ul = this.element.querySelector(\"ul.autocomplete\");\n  this.element.appendChild(ul);\n};\nol.ext.inherits(ol.control.SearchGPS, ol.control.Search);\n/** Create input form\n * @private\n */\nol.control.SearchGPS.prototype._createForm = function () {\n  // Value has change\n  var onchange = function(e) {\n    if (e.target.classList.contains('ol-dms')) {\n      lon.value = (lond.value<0 ? -1:1) * Number(lond.value) + Number(lonm.value)/60 + Number(lons.value)/3600;\n      lon.value = (lond.value<0 ? -1:1) * Math.round(lon.value*10000000)/10000000;\n      lat.value = (latd.value<0 ? -1:1) * Number(latd.value) + Number(latm.value)/60 + Number(lats.value)/3600;\n      lat.value = (latd.value<0 ? -1:1) * Math.round(lat.value*10000000)/10000000;\n    }\n    if (lon.value||lat.value) {\n      this._input.value = lon.value+','+lat.value;\n    } else {\n      this._input.value = '';\n    }\n    if (!e.target.classList.contains('ol-dms')) {\n      var s = ol.coordinate.toStringHDMS([Number(lon.value), Number(lat.value)]);\n      var c = s.replace(/(N|S|E|W)/g,'').split('');\n      c[1] = c[1].trim().split(' ');\n      lond.value = (/W/.test(s) ? -1 : 1) * parseInt(c[1][0]);\n      lonm.value = parseInt(c[1][1]);\n      lons.value = parseInt(c[1][2]);\n      c[0] = c[0].trim().split(' ');\n      latd.value = (/W/.test(s) ? -1 : 1) * parseInt(c[0][0]);\n      latm.value = parseInt(c[0][1]);\n      lats.value = parseInt(c[0][2]);\n    }\n    this._input.dispatchEvent(new Event('search'));\n  }.bind(this);\n  function createInput(className, unit) {\n    var input = ol.ext.element.create('INPUT', {\n      className: className,\n      type:'number',\n      step:'any',\n      lang: 'en',\n      parent: div,\n      on: {\n        'change keyup': onchange\n      }\n    });\n    if (unit) {\n      ol.ext.element.create('SPAN', {\n        className: 'ol-dms',\n        html: unit,\n        parent: div,\n      });\n    }\n    return input;\n  }\n  // Longitude\n  var div = ol.ext.element.create('DIV', {\n    className: 'ol-longitude',\n    parent: this.element\n  });\n  ol.ext.element.create('LABEL', {\n    html: 'Longitude',\n    parent: div\n  });\n  var lon = createInput('ol-decimal');\n  var lond = createInput('ol-dms','');\n  var lonm = createInput('ol-dms','\\'');\n  var lons = createInput('ol-dms','\"');\n  // Latitude\n  div = ol.ext.element.create('DIV', {\n    className: 'ol-latitude',\n    parent: this.element\n  })\n  ol.ext.element.create('LABEL', {\n    html: 'Latitude',\n    parent: div\n  });\n  var lat = createInput('ol-decimal');\n  var latd = createInput('ol-dms','');\n  var latm = createInput('ol-dms','\\'');\n  var lats = createInput('ol-dms','\"');\n  // Focus\n  this.button.addEventListener(\"click\", function() {\n    lon.focus();\n  });\n  // Change value on click\n  this.on('select', function(e){\n    lon.value = e.search.gps[0];\n    lat.value = e.search.gps[1];\n  }.bind(this));\n  // Change value on geolocation\n  this.geolocation.on('change', function(){\n    this.geolocation.setTracking(false);\n    var coord = this.geolocation.getPosition();\n    lon.value = coord[0];\n    lat.value = coord[1];\n    lon.dispatchEvent(new Event('keyup'));\n  }.bind(this));\n};\n/** Autocomplete function\n* @param {string} s search string\n* @return {Array<any>|false} an array of search solutions\n* @api\n*/\nol.control.SearchGPS.prototype.autocomplete = function (s) {\n  var result = [];\n  var c = s.split(',');\n  c[0] = Number(c[0]);\n  c[1] = Number(c[1]);\n  // Name\n  s = ol.coordinate.toStringHDMS(c)\n  if (s) s= s.replace(/(||) /g,'$1');\n  // \n  var coord = ol.proj.transform ([c[0], c[1]], 'EPSG:4326', this.getMap().getView().getProjection());\n  result.push({ gps: c, coordinate: coord, name: s });\n  return result;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {any} options extend ol.control.SearchJSON options\n *\t@param {string} options.className control class name\n *\t@param {boolean | undefined} options.apiKey the service api key.\n *\t@param {string | undefined} options.authentication: basic authentication for the service API as btoa(\"login:pwd\")\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {Number} options.pageSize item per page for parcelle list paging, use -1 for no paging, default 5\n * @see {@link https://geoservices.ign.fr/documentation/geoservices/geocodage.html}\n */\nol.control.SearchGeoportailParcelle = function(options) {\n  var self = this;\n  options.type = \"Commune\";\n  options.className = (options.className ? options.className:\"\")+\" IGNF-parcelle ol-collapsed-list ol-collapsed-num\";\n  options.inputLabel = \"Commune\";\n  options.noCollapse = true;\n  options.placeholder = options.placeholder || \"Choisissez une commune...\";\n  ol.control.SearchGeoportail.call(this, options);\n  this.set('copy', null);\n  var element = this.element;\n  // Add parcel form\n  var div = document.createElement(\"DIV\");\n  element.appendChild(div);\n  var label = document.createElement(\"LABEL\");\n  label.innerText = 'Prfixe'\n  div.appendChild(label);\n  label = document.createElement(\"LABEL\");\n  label.innerText = 'Section'\n  div.appendChild(label);\n  label = document.createElement(\"LABEL\");\n  label.innerText = 'Numro'\n  div.appendChild(label);\n  div.appendChild(document.createElement(\"BR\"));\n  // Input\n  this._inputParcelle = {\n    prefix: document.createElement(\"INPUT\"),\n    section: document.createElement(\"INPUT\"),\n    numero: document.createElement(\"INPUT\")\n  };\n  this._inputParcelle.prefix.setAttribute('maxlength',3);\n  this._inputParcelle.section.setAttribute('maxlength',2);\n  this._inputParcelle.numero.setAttribute('maxlength',4);\n  // Delay search\n  var tout;\n  var doSearch = function() {\n    if (tout) clearTimeout(tout);\n    tout = setTimeout(function() {\n        self.autocompleteParcelle();\n    }, options.typing || 0);\n  }\n  // Add inputs\n  for (var i in this._inputParcelle) {\n    div.appendChild(this._inputParcelle[i]);\n    this._inputParcelle[i].addEventListener(\"keyup\", doSearch);\n    this._inputParcelle[i].addEventListener('blur', function() {\n      tout = setTimeout(function(){ element.classList.add('ol-collapsed-num'); }, 200);\n    });\n    this._inputParcelle[i].addEventListener('focus', function() {\n      clearTimeout(tout);\n      element.classList.remove('ol-collapsed-num');\n    });\n  }\n  this.activateParcelle(false);\n  // Autocomplete list\n  var auto = document.createElement('DIV');\n  auto.className = 'autocomplete-parcelle';\n  element.appendChild(auto);\n  var ul = document.createElement('UL');\n  ul.classList.add('autocomplete-parcelle');\n  auto.appendChild(ul);\n  ul = document.createElement('UL');\n  ul.classList.add('autocomplete-page');\n  auto.appendChild(ul);\n  // Show/hide list on fcus/blur\t\n  this._input.addEventListener('blur', function() {\n    setTimeout(function(){ element.classList.add('ol-collapsed-list') }, 200);\n  });\n  this._input.addEventListener('focus', function() {\n    element.classList.remove('ol-collapsed-list');\n    self._listParcelle([]);\n    if (self._commune) {\n      self._commune = null;\n      self._input.value = '';\n      self.drawList_();\n    }\n    self.activateParcelle(false);\n  });\n  this.on('select', this.selectCommune.bind(this));\n  this.set('pageSize', options.pageSize || 5);\n};\nol.ext.inherits(ol.control.SearchGeoportailParcelle, ol.control.SearchGeoportail);\n/** Select a commune => start searching parcelle  \n * @param {any} e \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype.selectCommune = function(e) {\n  this._commune = e.search.insee;\n  this._input.value = e.search.insee + ' - ' + e.search.fulltext;\n  this.activateParcelle(true);\n  this._inputParcelle.numero.focus();\n  this.autocompleteParcelle();\n};\n/** Set the input parcelle\n * @param {*} p parcel\n * \t@param {string} p.Commune\n * \t@param {string} p.CommuneAbsorbee\n * \t@param {string} p.Section\n * \t@param {string} p.Numero\n * @param {boolean} search start a search\n */\nol.control.SearchGeoportailParcelle.prototype.setParcelle = function(p, search) {\n  this._inputParcelle.prefix.value = (p.Commune||'') + (p.CommuneAbsorbee||'');\n  this._inputParcelle.section.value = p.Section||'';\n  this._inputParcelle.numero.value = p.Numero||'';\n  if (search) this._triggerCustomEvent(\"keyup\", this._inputParcelle.prefix);\n};\n/** Activate parcelle inputs\n * @param {bolean} b\n */\nol.control.SearchGeoportailParcelle.prototype.activateParcelle = function(b) {\n  for (var i in this._inputParcelle) {\n    this._inputParcelle[i].readOnly = !b;\n  }\n  if (b) {\n    this._inputParcelle.section.parentElement.classList.add('ol-active');\n  } else {\n    this._inputParcelle.section.parentElement.classList.remove('ol-active');\t\t\n  }\n};\n/** Send search request for the parcelle  \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype.autocompleteParcelle = function() {\n  // Add 0 to fit the format\n  function complete (s, n, c) {\n    if (!s) return s;\n    c = c || \"0\";\n    while (s.length < n) s = c+s;\n    return s.replace(/\\*/g,'_');\n  }\n  // The selected commune\n  var commune = this._commune;\n  var prefix = complete (this._inputParcelle.prefix.value, 3);\n  if (prefix === '000') {\n    prefix = '___';\n  }\n  // Get parcelle number\n  var section = complete (this._inputParcelle.section.value, 2);\n  var numero = complete (this._inputParcelle.numero.value, 4, \"0\");\n  var search = commune + (prefix||'___') + (section||\"__\") + (numero ?  numero : section ? \"____\":\"0001\");\n  this.searchParcelle(search, \n    function(jsonResp) {\n      this._listParcelle(jsonResp);\n    }.bind(this),\n    function() {\n      console.log('oops')\n    })\n};\n/** Send search request for a parcelle number\n * @param {string} search search parcelle number\n * @param {function} success callback function called on success\n * @param {function} error callback function called on error\n */\nol.control.SearchGeoportailParcelle.prototype.searchParcelle = function(search, success /*, error */) {\n  // Request\n  var request = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\n  +'<XLS xmlns:xls=\"http://www.opengis.net/xls\" xmlns:gml=\"http://www.opengis.net/gml\" xmlns=\"http://www.opengis.net/xls\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.2\" xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\">'\n    +'<RequestHeader/>'\n    +'<Request requestID=\"1\" version=\"1.2\" methodName=\"LocationUtilityService\">'\n      +'<GeocodeRequest returnFreeForm=\"false\">'\n        +'<Address countryCode=\"CadastralParcel\">'\n        +'<freeFormAddress>'+search+'+</freeFormAddress>'\n        +'</Address>'\n      +'</GeocodeRequest>'\n    +'</Request>'\n  +'</XLS>'\n  // Geocode\n  this.ajax(\n    this.get('url').replace('ols/apis/completion','geoportail/ols'), \n    { xls: request },\n    function(xml) {\n      // XML to JSON\n      var parser = new DOMParser();\n      var xmlDoc = parser.parseFromString(xml,\"text/xml\");\n      var parcelles = xmlDoc.getElementsByTagName('GeocodedAddress');\n      var jsonResp = []\n      for (var i=0, parc; parc= parcelles[i]; i++) {\n        var node = parc.getElementsByTagName('gml:pos')[0] || parc.getElementsByTagName('pos')[0];\n        var p = node.childNodes[0].nodeValue.split(' ');\n        var att = parc.getElementsByTagName('Place');\n        var json = { \n          lon: Number(p[1]), \n          lat: Number(p[0])\n        };\n        for (var k=0, a; a=att[k]; k++) {\n          json[a.attributes.type.value] = a.childNodes[0].nodeValue;\n        }\n        jsonResp.push(json);\n      }\n      success(jsonResp);\n    }, \n    { dataType: 'XML' }\n  );\n};\n/**\n * Draw the autocomplete list\n * @param {*} resp \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype._listParcelle = function(resp) {\n  var self = this;\n  var ul = this.element.querySelector(\"ul.autocomplete-parcelle\");\n  ul.innerHTML='';\n  var page = this.element.querySelector(\"ul.autocomplete-page\");\n  page.innerHTML='';\n  this._listParc = [];\n  // Show page i\n  function showPage(i) {\n    var l = ul.children;\n    var visible = \"ol-list-\"+i;\n    var k;\n    for (k=0; k<l.length; k++) {\n      l[k].style.display = (l[k].className===visible) ? '' : 'none';\n    }\n    l = page.children;\n    for (k=0; k<l.length; k++) {\n      l[k].className = (l[k].innerText==i) ? 'selected' : '';\n    }\n    page.style.display = l.length>1 ? '' : 'none';\n  }\n  // Sort table\n  resp.sort(function(a,b) {\n    var na = a.INSEE+a.CommuneAbsorbee+a.Section+a.Numero;\n    var nb = b.INSEE+b.CommuneAbsorbee+b.Section+b.Numero;\n    return na===nb ? 0 : na<nb ? -1 : 1;\n  });\n  // Show list\n  var n = this.get('pageSize');\n  for (var i=0, r; r = resp[i]; i++) {\n    var li = document.createElement(\"LI\");\n    li.setAttribute(\"data-search\", i);\n    if (n>0) li.classList.add(\"ol-list-\"+Math.floor(i/n));\n    this._listParc.push(r);\n    li.addEventListener(\"click\", function(e) {\n      self._handleParcelle(self._listParc[e.currentTarget.getAttribute(\"data-search\")]);\n    });\n    li.innerHTML = r.INSEE+r.CommuneAbsorbee+r.Section+r.Numero;\n    ul.appendChild(li);\n    //\n    if (n>0 && !(i%n)) {\n      li = document.createElement(\"LI\");\n      li.innerText = Math.floor(i/n);\n      li.addEventListener(\"click\", function(e) {\n        showPage(e.currentTarget.innerText);\n      });\n      page.appendChild(li);\n    }\n  }\n  if (n>0) showPage(0);\n};\n/**\n * Handle parcelle section\n * @param {*} parc \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype._handleParcelle = function(parc) {\n  this.dispatchEvent({ \n    type:\"parcelle\", \n    search: parc, \n    coordinate: ol.proj.fromLonLat([parc.lon, parc.lat], this.getMap().getView().getProjection())\n  });\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the Nominatim geocoder from the OpenStreetmap project.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options.\n *  @param {string} options.className control class name\n *  @param {boolean | undefined} options.polygon To get output geometry of results (in geojson format), default false.\n *  @param {Array<Number> | undefined} options.viewbox The preferred area to find search results. Any two corner points of the box are accepted in any order as long as they span a real box, default none.\n *  @param {boolean | undefined} options.bounded Restrict the results to only items contained with the bounding box. Restricting the results to the bounding box also enables searching by amenity only. default false\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 3\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *  @param {string|undefined} options.url URL to Nominatim API, default \"https://nominatim.openstreetmap.org/search\"\n * @see {@link https://wiki.openstreetmap.org/wiki/Nominatim}\n */\nol.control.SearchNominatim = function(options) {\n  options = options || {};\n  options.className = options.className || 'nominatim';\n  options.typing = options.typing || 500;\n  options.url = options.url || 'https://nominatim.openstreetmap.org/search';\n  options.copy = '<a href=\"http://www.openstreetmap.org/copyright\" target=\"new\">&copy; OpenStreetMap contributors</a>';\n  ol.control.SearchJSON.call(this, options);\n  this.set('polygon', options.polygon);\n  this.set('viewbox', options.viewbox);\n  this.set('bounded', options.bounded);\n};\nol.ext.inherits(ol.control.SearchNominatim, ol.control.SearchJSON);\n/** Returns the text to be displayed in the menu\n *\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.SearchNominatim.prototype.getTitle = function (f) {\n  var info = [];\n  if (f.class) info.push(f.class);\n  if (f.type) info.push(f.type);\n  var title = f.display_name+(info.length ? \"<i>\"+info.join(' - ')+\"</i>\" : '');\n  if (f.icon) title = \"<img src='\"+f.icon+\"' />\" + title;\n  return (title);\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchNominatim.prototype.requestData = function (s) {\n  var data = { \n    format: \"json\", \n    addressdetails: 1, \n    q: s, \n    polygon_geojson: this.get('polygon') ? 1:0,\n    bounded: this.get('bounded') ? 1:0,\n    limit: this.get('maxItems')\n  };\n  if (this.get('viewbox')) data.viewbox = this.get('viewbox');\n  return data;\n};\n/** A ligne has been clicked in the menu > dispatch event\n *\t@param {any} f the feature, as passed in the autocomplete\n*\t@api\n*/\nol.control.SearchNominatim.prototype.select = function (f){\n  var c = [Number(f.lon), Number(f.lat)];\n  // Add coordinate to the event\n  try {\n    c = ol.proj.transform (c, 'EPSG:4326', this.getMap().getView().getProjection());\n  } catch(e) { /* ok */}\n  this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n};\n/** Reverse geocode\n * @param {ol.coordinate} coord\n * @api\n */\nol.control.SearchNominatim.prototype.reverseGeocode = function (coord, cback) {\n  var lonlat = ol.proj.transform (coord, this.getMap().getView().getProjection(), 'EPSG:4326');\n  this.ajax(\n    this.get('url').replace('search', 'reverse'),\n    { lon: lonlat[0], lat: lonlat[1], format: 'json' },\n    function(resp) {\n      if (cback) {\n        cback.call(this, [resp]);\n      } else {\n        this._handleSelect(resp, true);\n        //this.setInput('', true);\n      }\n    }.bind(this)\n  );\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the MediaWiki API.\n * @see https://www.mediawiki.org/wiki/API:Main_page\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {Object=} Control options.\n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 1000.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 3\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {function | undefined} options.handleResponse Handle server response to pass the features array to the list\n * \n *  @param {string|undefined} options.lang API language, default none\n */\nol.control.SearchWikipedia = function(options){\n  options = options || {};\n  options.lang = options.lang||'en';\n  options.className = options.className || 'ol-search-wikipedia';\n  options.url = 'https://'+options.lang+'.wikipedia.org/w/api.php';\n  options.placeholder = options.placeholder || 'search string, File:filename';\n  options.copy = '<a href=\"https://'+options.lang+'.wikipedia.org/\" target=\"new\">Wikipedia&reg; - CC-By-SA</a>';\n  ol.control.SearchJSON.call(this, options);\n  this.set('lang', options.lang);\n};\nol.ext.inherits(ol.control.SearchWikipedia, ol.control.SearchJSON);\n/** Returns the text to be displayed in the menu\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.SearchWikipedia.prototype.getTitle = function (f){\n  return ol.ext.element.create('DIV', {\n    html: f.title,\n    title: f.desc\n  });\n  //return f.desc;\n};\n/** Set the current language\n * @param {string} lang the current language as ISO string (en, fr, de, es, it, ja, ...)\n */\nol.control.SearchWikipedia.prototype.setLang = function (lang){\n  this.set('lang', lang)\n  this.set('url', 'https://'+lang+'.wikipedia.org/w/api.php');\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchWikipedia.prototype.requestData = function (s) {\n  var data = {\n    action: 'opensearch',\n    search: s,\n    lang: this.get('lang'),\n    format: 'json',\n    origin: '*',\n    limit: this.get('maxItems')\n  }\n  return data;\n};\n/**\n * Handle server response to pass the features array to the list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n */\nol.control.SearchWikipedia.prototype.handleResponse = function (response) {\n  var features = [];\n  for (var i=0; i<response[1].length; i++) {\n    features.push({\n      title: response[1][i],\n      desc: response[2][i],\n      uri: response[3][i]\n    })\n  }\n  return features;\n};\n/** A ligne has been clicked in the menu query for more info and disatch event\n*\t@param {any} f the feature, as passed in the autocomplete\n*\t@api\n*/\nol.control.SearchWikipedia.prototype.select = function (f){\n  var title = decodeURIComponent(f.uri.split('/').pop()).replace(/'/,'%27');\n  // Search for coords\n  ol.ext.Ajax.get({\n    url: f.uri.split('wiki/')[0]+'w/api.php',\n    data: {\n      action: 'query',\n      prop: 'pageimages|coordinates|extracts',\n      exintro: 1,\n      explaintext: 1,\n      piprop: 'original',\n      origin: '*',\n      format: 'json',\n      redirects: 1,\n      titles: title\n    },\n    options: {\n      encode: false\n    },\n    success: function (e) {\n      var page = e.query.pages[Object.keys(e.query.pages).pop()];\n      console.log(page);\n      var feature = {\n        title: f.title,\n        desc: page.extract || f.desc,\n        url: f.uri,\n        img: page.original ? page.original.source : undefined,\n        pageid: page.pageid\n      }\n      var c;\n      if (page.coordinates) {\n        feature.lon = page.coordinates[0].lon;\n        feature.lat = page.coordinates[0].lat;\n        c = [feature.lon, feature.lat];\n        c = ol.proj.transform (c, 'EPSG:4326', this.getMap().getView().getProjection());\n      }\n      this.dispatchEvent({ type:\"select\", search:feature, coordinate: c });\n    }.bind(this)\n  })\n};\n/** */\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Select Control.\n * A control to select features by attributes\n *\n * @constructor\n * @extends {ol.control.SelectBase}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol.source.Vector | Array<ol.source.Vector>} options.source the source to search in\n *  @param {string} [options.selectLabel=select] select button label\n *  @param {string} [options.addLabel=add] add button label\n *  @param {string} [options.caseLabel=case sensitive] case checkbox label\n *  @param {string} [options.allLabel=match all] match all checkbox label\n *  @param {string} [options.attrPlaceHolder=attribute]\n *  @param {string} [options.valuePlaceHolder=value]\n */\nol.control.Select = function(options) {\n  var self = this;\n  if (!options) options = {};\n  // Container\n  var div = options.content = document.createElement(\"div\");\n  // Autocompletion list\n  this._ul = ol.ext.element.create('UL', {\n    parent: div\n  });\n  // All conditions\n  this._all = ol.ext.element.create('INPUT', {\n    type: 'checkbox',\n    checked: true\n  });\n  var label_match_all = ol.ext.element.create('LABEL',{\n    html: this._all,\n    parent: div\n  });\n  ol.ext.element.appendText(label_match_all, options.allLabel || 'match all');\n  // Use case\n  this._useCase = ol.ext.element.create('INPUT', {\n    type: 'checkbox'\n  });\n  var label_case_sensitive = ol.ext.element.create('LABEL',{\n    html: this._useCase,\n    parent: div\n  });\n  ol.ext.element.appendText(label_case_sensitive, options.caseLabel || 'case sensitive');\n  ol.control.SelectBase.call(this, options);\n  // Add button\n  ol.ext.element.create('BUTTON', {\n    className: 'ol-append',\n    html: options.addLabel\t|| 'add rule',\n    click: function(){\n      self.addCondition();\n    },\n    parent: div\n  });\n  this._conditions = [];\n  this.set('attrPlaceHolder', options.attrPlaceHolder || 'attribute');\n  this.set('valuePlaceHolder', options.valuePlaceHolder || 'value');\n  this.addCondition();\n};\nol.ext.inherits(ol.control.Select, ol.control.SelectBase);\n/** Add a new condition\n * @param {*} options\n * \t@param {string} options.attr attribute name\n * \t@param {string} options.op\toperator\n * \t@param {string} options.val attribute value\n */\nol.control.Select.prototype.addCondition = function (options) {\n  options = options || {};\n  this._conditions.push({\n    attr: options.attr || '',\n    op: options.op || '=',\n    val: options.val || ''\n  });\n  this._drawlist();\n};\n/** Get the condition list\n */\nol.control.Select.prototype.getConditions = function () {\n  return {\n    usecase: this._useCase.checked,\n    all: this._all.checked,\n    conditions: this._conditions\n  }\n};\n/** Set the condition list\n */\nol.control.Select.prototype.setConditions = function (cond) {\n  this._useCase.checked = cond.usecase;\n  this._all.checked = cond.all;\n  this._conditions = cond.conditions;\n  this._drawlist();\n};\n/** Get the conditions as string\n */\nol.control.Select.prototype.getConditionsString = function (cond) {\n  var st = '';\n  for (var i=0,c; c=cond.conditions[i]; i++) {\n    if (c.attr) {\n      st += (st ? (cond.all ? ' AND ' : ' OR ') : '')\n        + c.attr\n        + this.operationsList[c.op]\n        + c.val;\n    }\n  }\n  return st\n};\n/** Draw the liste\n * @private\n */\nol.control.Select.prototype._drawlist = function () {\n  this._ul.innerHTML = '';\n  for (var i=0; i < this._conditions.length; i++) {\n    this._ul.appendChild(this._getLiCondition(i));\n  }\n};\n/** Get a line\n * @return {*}\n * @private\n */\nol.control.Select.prototype._autocomplete = function (val, ul) {\n  ul.classList.remove('ol-hidden');\n  ul.innerHTML = '';\n  var attributes = {};\n  var sources = this.get('source');\n  for (var i=0, s; s=sources[i]; i++) {\n    var features = s.getFeatures();\n    for (var j=0, f; f=features[j]; j++) {\n      Object.assign(attributes, f.getProperties());\n      if (j>100) break;\n    }\n  }\n  var rex = new RegExp(val, 'i');\n  for (var a in attributes) {\n    if (a==='geometry') continue;\n    if (rex.test(a)) {\n      var li = document.createElement('li');\n    li.textContent = a;\n    li.addEventListener(\"click\", function() {\n          ul.previousElementSibling.value = this.textContent;\n      var event = document.createEvent('HTMLEvents');\n      event.initEvent('change', true, false);\n      ul.previousElementSibling.dispatchEvent(event);\n          ul.classList.add('ol-hidden');\n        });\n        ul.appendChild(li);\n    }\n  }\n};\n/** Get a line\n * @return {*}\n * @private\n */\nol.control.Select.prototype._getLiCondition = function (i) {\n  var self = this;\n  var li = document.createElement('li');\n  // Attribut\n  var autocomplete = document.createElement('div');\n      autocomplete.classList.add('ol-autocomplete');\n      autocomplete.addEventListener(\"mouseleave\", function() {\n        this.querySelector('ul'). classList.add('ol-hidden');\n      });\n      li.appendChild(autocomplete);\n  var input_attr = document.createElement('input');\n      input_attr.classList.add('ol-attr');\n      input_attr.setAttribute('type', 'text');\n      input_attr.setAttribute('placeholder', this.get('attrPlaceHolder'));\n      input_attr.addEventListener('keyup', function () {\n        self._autocomplete( this.value, this.nextElementSibling );\n      })\n      input_attr.addEventListener('click', function(){\n        self._autocomplete( this.value, this.nextElementSibling );\n        this.nextElementSibling.classList.remove('ol-hidden')\n      })\n      input_attr.addEventListener('change', function() {\n        self._conditions[i].attr = this.value;\n      })\n      input_attr.value = self._conditions[i].attr;\n      autocomplete.appendChild(input_attr);\n  // Autocomplete list\n  var ul_autocomplete = document.createElement('ul');\n      ul_autocomplete.classList.add('ol-hidden')\n      autocomplete.appendChild(ul_autocomplete);\n  // Operation\n  var select = document.createElement('select');\n  li.appendChild(select);\n  for (var k in this.operationsList) {\n    var option = document.createElement('option');\n        option.value = k;\n        option.textContent = this.operationsList[k];\n        select.appendChild(option);\n  }\n  select.value = self._conditions[i].op;\n  select.addEventListener('change', function() {\n    self._conditions[i].op = this.value;\n  });\n  // Value\n  var input_value = document.createElement('input');\n  input_value.setAttribute('type', 'text');\n      input_value.setAttribute('placeholder', this.get('valuePlaceHolder'));\n    input_value.addEventListener('change', function() {\n      self._conditions[i].val = this.value;\n    })\n    input_value.value = self._conditions[i].val;\n    li.appendChild(input_value);\n  if (this._conditions.length > 1) {\n    var div_delete = document.createElement('div');\n    div_delete.classList.add('ol-delete');\n      div_delete.addEventListener(\"click\", function(){ self.removeCondition(i); })\n      li.appendChild(div_delete);\n  }\n  //\n  return li;\n};\n/** Remove the ith condition\n * @param {int} i condition index\n */\nol.control.Select.prototype.removeCondition = function (i) {\n  this._conditions.splice(i,1);\n  this._drawlist();\n};\n/** Select features by attributes\n * @param {*} options\n *  @param {Array<ol.source.Vector>|undefined} options.sources source to apply rules, default the select sources\n *  @param {bool} options.useCase case sensitive, default checkbox state\n *  @param {bool} options.matchAll match all conditions, , default checkbox state\n *  @param {Array<conditions>} options.conditions array of conditions\n * @fires select\n */\nol.control.Select.prototype.doSelect = function (options) {\n  options = options || {};\n  options.useCase = options.useCase || this._useCase.checked;\n  options.matchAll = options.matchAll || this._all.checked;\n  options.conditions = options.conditions || this._conditions\n  return ol.control.SelectBase.prototype.doSelect.call(this, options);\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Select features by property using a popup \n *\n * @constructor\n * @extends {ol.control.SelectBase}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol/source/Vector | Array<ol/source/Vector>} options.source the source to search in\n *  @param {string} options.property property to select on\n *  @param {string} options.label control label\n *  @param {number} options.max max feature to test to get the values, default 10000\n *  @param {number} options.selectAll select all features if no option selected\n *  @param {string} options.type check type: checkbox or radio, default checkbox\n *  @param {number} options.defaultLabel label for the default radio button\n *  @param {function|undefined} options.onchoice function triggered when an option is clicked, default doSelect\n */\nol.control.SelectCheck = function(options) {\n  if (!options) options = {};\n  // Container\n  var div = options.content = ol.ext.element.create('DIV');\n  if (options.label) {\n    ol.ext.element.create('LABEL', {\n      html: options.label,\n      parent: div\n    });\n  }\n  // Input div\n  this._input = ol.ext.element.create('DIV', {\n    parent: div\n  });\n  options.className = options.className || 'ol-select-check';\n  ol.control.SelectBase.call(this, options);\n  this.set('property', options.property || 'name');\n  this.set('max', options.max || 10000);\n  this.set('defaultLabel', options.defaultLabel);\n  this.set('type', options.type);\n  this._selectAll = options.selectAll;\n  this._onchoice = options.onchoice;\n  // Set select options\n  this.setValues();\n};\nol.ext.inherits(ol.control.SelectCheck, ol.control.SelectBase);\n/**\n* Set the map instance the control associated with.\n* @param {o.Map} map The map instance.\n*/\nol.control.SelectCheck.prototype.setMap = function(map) {\n  ol.control.SelectBase.prototype.setMap.call(this, map);\n  this.setValues();\n};\n/** Select features by attributes\n */\nol.control.SelectCheck.prototype.doSelect = function(options) {\n  options = options || {};\n  var conditions = [];\n  this._checks.forEach(function(c) {\n    if (c.checked) {\n      if (c.value) {\n        conditions.push({\n          attr: this.get('property'),\n          op: '=',\n          val: c.value\n        });\n      }\n    }\n  }.bind(this));\n  if (!conditions.length) {\n    return ol.control.SelectBase.prototype.doSelect.call(this, { \n      features: options.features, \n      matchAll: this._selectAll \n    });\n  } else {\n    return ol.control.SelectBase.prototype.doSelect.call(this, {\n      features: options.features, \n      conditions: conditions\n    })\n  }\n};\n/** Set the popup values\n * @param {Object} options\n *  @param {Object} options.values a key/value list with key = property value, value = title shown in the popup, default search values in the sources\n *  @param {boolean} options.sort sort values\n */\nol.control.SelectCheck.prototype.setValues = function(options) {\n  options = options || {};\n  console.log(options)\n  var values, vals;\n  if (options.values) {\n    if (options.values instanceof Array) {\n      vals = {};\n      options.values.forEach(function(v) { vals[v] = v; });\n    } else {\n      vals = options.values;\n    }\n  } else {\n    vals = {};\n    var prop = this.get('property');\n    this.getSources().forEach(function(s){\n      var features = s.getFeatures();\n      var max = Math.min(features.length, this.get('max'))\n      for (var i=0; i<max; i++) {\n        var p = features[i].get(prop);\n        if (p) vals[p] = p;\n      }\n    }.bind(this));\n  }\n  if (!Object.keys(vals).length) return;\n  if (options.sort) {\n    values = {};\n    Object.keys(vals).sort().forEach(function(key) {\n      values[key] = vals[key];\n    });\n  } else {\n    values = vals;\n  }\n  ol.ext.element.setHTML(this._input, '');\n  this._checks = [];\n  var id = 'radio_'+(new Date().getTime());\n  var addCheck = function(val, info) {\n    var label = ol.ext.element.create('LABEL', {\n      className: (this.get('type')==='radio' ? 'ol-radio' : 'ol-checkbox'),\n      parent: this._input\n    });\n    this._checks.push( ol.ext.element.create('INPUT', {\n      name: id,\n      type: (this.get('type')==='radio' ? 'radio' : 'checkbox'),\n      value: val,\n      change: function () { \n        if (this._onchoice) this._onchoice()\n        else this.doSelect();\n      }.bind(this),\n      parent: label\n    }));\n    ol.ext.element.create('DIV', {\n      html: info,\n      parent: label\n    });\n  }.bind(this);\n  if (this.get('defaultLabel') && this.get('type')==='radio') addCheck('', this.get('defaultLabel'));\n  for (var k in values) addCheck(k, values[k]);\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Select features by property using a condition \n *\n * @constructor\n * @extends {ol.control.SelectBase}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol/source/Vector | Array<ol/source/Vector>} options.source the source to search in\n *  @param {string} options.label control label, default 'condition'\n *  @param {number} options.selectAll select all features if no option selected\n *  @param {condition|Array<condition>} options.condition conditions \n *  @param {function|undefined} options.onchoice function triggered when an option is clicked, default doSelect\n */\nol.control.SelectCondition = function(options) {\n  if (!options) options = {};\n  // Container\n  var div = options.content = ol.ext.element.create('DIV');\n  var label = ol.ext.element.create('LABEL', {\n    parent: div\n  });\n  this._check = ol.ext.element.create('INPUT', {\n    type: 'checkbox',\n    change: function () { \n      if (this._onchoice) this._onchoice()\n      else this.doSelect();\n    }.bind(this),\n    parent: label\n  });\n  ol.ext.element.create('DIV', {\n    html: options.label || 'condition',\n    parent: label\n  });\n  // Input div\n  this._input = ol.ext.element.create('DIV', {\n    parent: div\n  });\n  options.className = options.className || 'ol-select-condition';\n  ol.control.SelectBase.call(this, options);\n  this.setCondition(options.condition);\n  this._selectAll = options.selectAll;\n  this._onchoice = options.onchoice;\n};\nol.ext.inherits(ol.control.SelectCondition, ol.control.SelectBase);\n/** Set condition to select on\n * @param {condition | Array<condition>} condition\n *  @param {string} attr property to select on\n *  @param {string} op operator (=, !=, <; <=, >, >=, contain, !contain, regecp)\n *  @param {*} val value to select on\n */\nol.control.SelectCondition.prototype.setCondition = function(condition) {\n  if (!condition) this._conditions = [];\n  else this._conditions = (condition instanceof Array ?  condition : [condition]);\n};\n/** Add a condition to select on\n * @param {condition} condition\n *  @param {string} attr property to select on\n *  @param {string} op operator (=, !=, <; <=, >, >=, contain, !contain, regecp)\n *  @param {*} val value to select on\n */\nol.control.SelectCondition.prototype.addCondition = function(condition) {\n  this._conditions.push(condition);\n};\n/** Select features by condition\n */\nol.control.SelectCondition.prototype.doSelect = function(options) {\n  options = options || {};\n  var conditions = this._conditions;\n  if (!this._check.checked) {\n    return ol.control.SelectBase.prototype.doSelect.call(this, { features: options.features, matchAll: this._selectAll });\n  } else {\n    return ol.control.SelectBase.prototype.doSelect.call(this, {\n      features: options.features,\n      conditions: conditions\n    })\n  }\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Select features by property using a simple text input\n *\n * @constructor\n * @extends {ol.control.SelectBase}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol/source/Vector | Array<ol/source/Vector>} options.source the source to search in\n *  @param {string} options.property property to select on\n *  @param {function|undefined} options.onchoice function triggered the text change, default nothing\n */\nol.control.SelectFulltext = function(options) {\n  if (!options) options = {};\n  // Container\n  var div = options.content =ol.ext.element.create('DIV');\n  if (options.label) {\n    ol.ext.element.create('LABEL', {\n      html: options.label,\n      parent: div\n    });\n  }\n  this._input = ol.ext.element.create('INPUT', {\n    placeHolder: options.placeHolder || 'search...',\n    change: function() {\n      if (this._onchoice) this._onchoice();\n    }.bind(this),\n    parent: div\n  });\n  ol.control.SelectBase.call(this, options);\n  this._onchoice = options.onchoice;\n  this.set('property', options.property || 'name');\n};\nol.ext.inherits(ol.control.SelectFulltext, ol.control.SelectBase);\n/** Select features by condition\n */\nol.control.SelectFulltext.prototype.doSelect= function(options) {\n  options = options || {};\n  return ol.control.SelectBase.prototype.doSelect.call(this, {\n    features: options.features,\n    useCase: false,\n    conditions: [{\n      attr: this.get('property'),\n      op: 'contain',\n      val: this._input.value\n    }]\n  });\n}\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * A multiselect control. \n * A container that manage other control Select \n *\n * @constructor\n * @extends {ol.control.SelectBase}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol/source/Vector | Array<ol/source/Vector>} options.source the source to search in\n *  @param {Array<ol.control.SelectBase>} options.controls an array of controls\n */\nol.control.SelectMulti = function(options) {\n  if (!options) options = {};\n  // Container\n  options.content = ol.ext.element.create('DIV');\n  this._container = ol.ext.element.create('UL', {\n    parent: options.content\n  });\n  options.className = options.className || 'ol-select-multi';\n  ol.control.SelectBase.call(this, options);\n  this._controls = [];\n  options.controls.forEach(this.addControl.bind(this));\n};\nol.ext.inherits(ol.control.SelectMulti, ol.control.SelectBase);\n/**\n* Set the map instance the control associated with.\n* @param {o.Map} map The map instance.\n*/\nol.control.SelectMulti.prototype.setMap = function(map) {\n  if (this.getMap()) {\n    this._controls.forEach(function(c) {\n      this.getMap().remveControl(c);\n    }.bind(this));\n  }\n  ol.control.SelectBase.prototype.setMap.call(this, map);\n  if (this.getMap()) {\n    this._controls.forEach(function(c) {\n      this.getMap().addControl(c);\n    }.bind(this));\n  }\n};\n/** Add a new control\n * @param {ol.control.SelectBase} c\n */\nol.control.SelectMulti.prototype.addControl = function(c) {\n  if (c instanceof ol.control.SelectBase) {\n    this._controls.push(c);\n    c.setTarget(ol.ext.element.create('LI', {\n      parent: this._container\n    }));\n    c._selectAll = true;\n    c._onchoice = this.doSelect.bind(this);\n    if (this.getMap()) {\n      this.getMap().addControl(c);\n    }\n  }\n};\n/** Get select controls\n * @return {Aray<ol.control.SelectBase>}\n */\nol.control.SelectMulti.prototype.getControls = function() {\n  return this._controls;\n};\n/** Select features by condition\n */\nol.control.SelectMulti.prototype.doSelect = function() {\n  var features = [];\n  this.getSources().forEach(function(s) {\n    features = features.concat(s.getFeatures());\n  });\n  this._controls.forEach(function(c) {\n    features = c.doSelect({ features: features });\n  });\n  this.dispatchEvent({ type:\"select\", features: features });\n  return features;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Select features by property using a popup \n *\n * @constructor\n * @extends {ol.control.SelectBase}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol/source/Vector | Array<ol/source/Vector>} options.source the source to search in\n *  @param {string} options.property property to select on\n *  @param {number} options.max max feature to test to get the values, default 10000\n *  @param {number} options.selectAll select all features if no option selected\n *  @param {string} options.defaultLabel label for the default selection\n *  @param {function|undefined} options.onchoice function triggered when an option is clicked, default doSelect\n */\nol.control.SelectPopup = function(options) {\n  if (!options) options = {};\n  // Container\n  var div = options.content = ol.ext.element.create('DIV');\n  if (options.label) {\n    ol.ext.element.create('LABEL', {\n      html: options.label,\n      parent: div\n    });\n  }\n  this._input = ol.ext.element.create('SELECT', {\n    on: { change: function () { \n      if (this._onchoice) this._onchoice();\n      else this.doSelect();\n    }.bind(this) },\n    parent: div\n  });\n  options.className = options.className || 'ol-select-popup';\n  ol.control.SelectBase.call(this, options);\n  this.set('property', options.property || 'name');\n  this.set('max', options.max || 10000);\n  this.set('defaultLabel', options.defaultLabel);\n  this._selectAll = options.selectAll;\n  this._onchoice = options.onchoice;\n  // Set select options\n  this.setValues();\n};\nol.ext.inherits(ol.control.SelectPopup, ol.control.SelectBase);\n/**\n* Set the map instance the control associated with.\n* @param {o.Map} map The map instance.\n*/\nol.control.SelectPopup.prototype.setMap = function(map) {\n  ol.control.SelectBase.prototype.setMap.call(this, map);\n  this.setValues();\n};\n/** Select features by attributes\n */\nol.control.SelectPopup.prototype.doSelect = function(options) {\n  options = options || {};\n  if (!this._input.value) {\n    return ol.control.SelectBase.prototype.doSelect.call(this, { features: options.features, matchAll: this._selectAll });\n  } else {\n    return ol.control.SelectBase.prototype.doSelect.call(this, {\n      features: options.features, \n      conditions: [{\n        attr: this.get('property'),\n        op: '=',\n        val: this._input.value\n      }]\n    })\n  }\n};\n/** Set the popup values\n * @param {Object} values a key/value list with key = property value, value = title shown in the popup, default search values in the sources\n */\nol.control.SelectPopup.prototype.setValues = function(options) {\n  options = options || {};\n  var values, vals;\n  if (options.values) {\n    if (options.values instanceof Array) {\n      vals = {};\n      options.values.forEach(function(v) { vals[v] = v; });\n    } else {\n      vals = options.values;\n    }\n  } else {\n    vals = {};\n    var prop = this.get('property');\n    this.getSources().forEach(function(s){\n      var features = s.getFeatures();\n      var max = Math.min(features.length, this.get('max'))\n      for (var i=0; i<max; i++) {\n        var p = features[i].get(prop);\n        if (p) vals[p] = p;\n      }\n    }.bind(this));\n  }\n  if (options.sort) {\n    values = {};\n    Object.keys(vals).sort().forEach(function(key) {\n      values[key] = vals[key];\n    });\n  } else {\n    values = vals;\n  }\n  ol.ext.element.setHTML(this._input, '');\n  ol.ext.element.create('OPTION', {\n    className: 'ol-default',\n    html: this.get('defaultLabel') || '',\n    value: '',\n    parent: this._input\n  });\n  for (var k in values) {\n    ol.ext.element.create('OPTION', {\n      html: values[k],\n      value: k,\n      parent: this._input\n    });\n  }\n};\n\n/** A control with scroll-driven navigation to create narrative maps\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *  @param {string} options.status status, default none\n *  @param {string} options.position position of the status 'top', 'left', 'bottom' or 'right', default top\n */\nol.control.Status = function(options) {\n  options = options || {};\n  // New element\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-status'\n      + (options.target ? '': ' ol-unselectable ol-control')\n  });\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  if (options.position) this.setPosition(options.position);\n  this.status(options.status || '');\n};\nol.ext.inherits(ol.control.Status, ol.control.Control);\n/** Show status on the map\n * @param {string|Element} html status text or DOM element\n */\nol.control.Status.prototype.status = function(html) {\n  var s = html || '';\n  if (s) {\n    ol.ext.element.show(this.element);\n    if (typeof(s)==='object' && !(s instanceof String)) {\n      s = '';\n      for (var i in html) {\n        s += '<label>'+i+':</label> '+html[i]+'<br/>';\n      }\n    }\n    ol.ext.element.setHTML(this.element, s);\n  } else {\n    ol.ext.element.hide(this.element);\n  }\n};\n/** Set status position\n * @param {string} position position of the status 'top', 'left', 'bottom' or 'right', default top\n */\nol.control.Status.prototype.setPosition = function(position) {\n  this.element.classList.remove('ol-left');\n  this.element.classList.remove('ol-right');\n  this.element.classList.remove('ol-bottom');\n  this.element.classList.remove('ol-center');\n  if (/^left$|^right$|^bottom$|^center$/.test(position)) {\n    this.element.classList.add('ol-'+position);\n  }\n};\n/** Show the status\n * @param {boolean} show show or hide the control, default true\n */\nol.control.Status.prototype.show = function(show) {\n  if (show===false) ol.ext.element.hide(this.element);\n  else ol.ext.element.show(this.element);\n};\n/** Hide the status\n */\nol.control.Status.prototype.hide = function() {\n  ol.ext.element.hide(this.element);\n};\n/** Toggle the status\n */\nol.control.Status.prototype.toggle = function() {\n  ol.ext.element.toggle(this.element);\n};\n/** Is status visible\n */\nol.control.Status.prototype.isShown = function() {\n  return this.element.style.display==='none';\n};\n\n/** A control with scroll-driven navigation to create narrative maps\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires scrollto\n * @fires clickimage\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {Element | string | undefined} options.html The storymap content\n *\t@param {Element | string | undefined} options.target The target element to place the story. If no html is provided the content of the target will be used.\n */\nol.control.Storymap = function(options) {\n  // Remove or get target content \n  if (options.target) {\n    if (!options.html) {\n      options.html = options.target.innerHTML;\n    } else if (options.html instanceof Element) {\n      options.html = options.html.innerHTML;\n    }\n    options.target.innerHTML = '';\n  }\n  // New element\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-storymap'\n      + (options.target ? '': ' ol-unselectable ol-control')\n      + ('ontouchstart' in window ? ' ol-touch' : ''),\n    html: options.html\n  });\n  element.querySelectorAll('.chapter').forEach(function(c) {\n    c.addEventListener('click', function(e) {\n      if (!c.classList.contains('select')) {\n        this.element.scrollTop = c.offsetTop - 30;\n        e.preventDefault();\n      } else {\n        if (e.target.tagName==='IMG' && e.target.dataset.title) {\n          console.log(e);\n          this.dispatchEvent({ \n            coordinate: this.getMap() ? this.getMap().getCoordinateFromPixel([e.layerX,e.layerY]) : null,\n            type: 'clickimage', \n            img: e.target, \n            title: e.target.dataset.title, \n            element: c, \n            name: c.getAttribute('name'),\n            originalEvent: e\n          });\n        }\n      }\n    }.bind(this));\n  }.bind(this));\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Make a scroll div\n  ol.ext.element.scrollDiv (this.element, {\n    vertical: true,\n    mousewheel: true\n  });\n  // Scroll to the next chapter\n  var sc = this.element.querySelectorAll('.ol-scroll-next');\n  sc.forEach(function(s) {\n    s.addEventListener('click', function(){ \n      var chapter = this.element.querySelectorAll('.chapter');\n      var scrollto = s.offsetTop;\n      for (var i=0, c; c=chapter[i]; i++) {\n        if (c.offsetTop > scrollto) {\n          scrollto = c.offsetTop;\n          break;\n        }\n      }\n      this.element.scrollTop = scrollto - 30;\n    }.bind(this));\n  }.bind(this));\n  // Scroll top \n  sc = this.element.querySelectorAll('.ol-scroll-top');\n  sc.forEach(function(i) {\n    i.addEventListener('click', function(){ \n      this.element.scrollTop = 0;\n    }.bind(this));\n  }.bind(this));\n  // Handle scrolling\n  var currentDiv = this.element.querySelectorAll('.chapter')[0];\n  setTimeout (function (){\n    this.dispatchEvent({ type: 'scrollto', start: true, element: currentDiv, name: currentDiv.getAttribute('name') });\n  }.bind(this));\n  // Trigger change event on scroll\n  this.element.addEventListener(\"scroll\", function() {\n    var current, chapter = this.element.querySelectorAll('.chapter');\n    var height = ol.ext.element.getStyle(this.element, 'height');\n    if (!this.element.scrollTop) {\n      current = chapter[0];\n    } else {\n      for (var i=0, s; s=chapter[i]; i++) {\n        var p = s.offsetTop - this.element.scrollTop;\n        if (p > height/3) break;\n        current = s;\n      }\n    }\n    if (current && current!==currentDiv) {\n      currentDiv = current;\n      this.dispatchEvent({ type: 'scrollto', element: currentDiv, name: currentDiv.getAttribute('name') });\n    }\n  }.bind(this));\n};\nol.ext.inherits(ol.control.Storymap, ol.control.Control);\n/** Scroll to a chapter\n * @param {string} name Name of the chapter to scroll to\n */\nol.control.Storymap.prototype.setChapter = function (name) {\n  var chapter = this.element.querySelectorAll('.chapter');\n  for (var i=0, s; s=chapter[i]; i++) {\n    if (s.getAttribute('name')===name) {\n      this.element.scrollTop = s.offsetTop - 30;\n    }\n  }\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc Swipe Control.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} Control options.\n *\t@param {ol.layer} options.layers layer to swipe\n *\t@param {ol.layer} options.rightLayer layer to swipe on right side\n *\t@param {string} options.className control class name\n *\t@param {number} options.position position propertie of the swipe [0,1], default 0.5\n *\t@param {string} options.orientation orientation propertie (vertical|horizontal), default vertical\n */\nol.control.Swipe = function(options) {\n\toptions = options || {};\n\tvar button = document.createElement('button');\n\tvar element = document.createElement('div');\n  element.className = (options.className || \"ol-swipe\") + \" ol-unselectable ol-control\";\n  element.appendChild(button);\n\telement.addEventListener(\"mousedown\", this.move.bind(this));\n\telement.addEventListener(\"touchstart\", this.move.bind(this));\n\tol.control.Control.call(this, {\n    element: element\n\t});\n\t// An array of listener on layer postcompose\n\tthis.precomposeRight_ = this.precomposeRight.bind(this);\n\tthis.precomposeLeft_ = this.precomposeLeft.bind(this);\n\tthis.postcompose_ = this.postcompose.bind(this);\n\tthis.layers = [];\n\tif (options.layers) this.addLayer(options.layers, false);\n\tif (options.rightLayers) this.addLayer(options.rightLayers, true);\n\tthis.on('propertychange', function() {\n    if (this.getMap()) this.getMap().renderSync();\n\t\tif (this.get('orientation') === \"horizontal\") {\n      this.element.style.top = this.get('position')*100+\"%\";\n\t\t\tthis.element.style.left = \"\";\n\t\t} else {\n      if (this.get('orientation') !== \"vertical\") this.set('orientation', \"vertical\");\n\t\t\tthis.element.style.left = this.get('position')*100+\"%\";\n\t\t\tthis.element.style.top = \"\";\n\t\t}\n\t\tthis.element.classList.remove(\"horizontal\", \"vertical\");\n\t\tthis.element.classList.add(this.get('orientation'));\n\t}.bind(this));\n\tthis.set('position', options.position || 0.5);\n\tthis.set('orientation', options.orientation || 'vertical');\n};\nol.ext.inherits(ol.control.Swipe, ol.control.Control);\n/**\n * Set the map instance the control associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Swipe.prototype.setMap = function(map) {\n\tvar i;\n\tvar l;\n\tif (this.getMap()) {\n\t\tfor (i=0; i<this.layers.length; i++) {\n\t\t\tl = this.layers[i];\n\t\t\tif (l.right) l.layer.un(['precompose','prerender'], this.precomposeRight_);\n\t\t\telse l.layer.un(['precompose','prerender'], this.precomposeLeft_);\n\t\t\tl.layer.un(['postcompose','postrender'], this.postcompose_);\n\t\t}\n\t\tthis.getMap().renderSync();\n\t}\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (map) {\n    this._listener = [];\n\t\tfor (i=0; i<this.layers.length; i++) {\n      l = this.layers[i];\n\t\t\tif (l.right) l.layer.on(['precompose','prerender'], this.precomposeRight_);\n\t\t\telse l.layer.on(['precompose','prerender'], this.precomposeLeft_);\n\t\t\tl.layer.on(['postcompose','postrender'], this.postcompose_);\n\t\t}\n\t\tmap.renderSync();\n\t}\n};\n/** @private\n*/\nol.control.Swipe.prototype.isLayer_ = function(layer){\n  for (var k=0; k<this.layers.length; k++) {\n    if (this.layers[k].layer === layer) return k;\n\t}\n\treturn -1;\n};\n/** Add a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*\t@param {bool} add layer in the right part of the map, default left.\n*/\nol.control.Swipe.prototype.addLayer = function(layers, right) {\n  if (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++) {\n\t\tvar l = layers[i];\n\t\tif (this.isLayer_(l) < 0) {\n      this.layers.push({ layer:l, right:right });\n\t\t\tif (this.getMap()) {\n        if (right) l.on(['precompose','prerender'], this.precomposeRight_);\n\t\t\t\telse l.on(['precompose','prerender'], this.precomposeLeft_);\n\t\t\t\tl.on(['postcompose','postrender'], this.postcompose_);\n\t\t\t\tthis.getMap().renderSync();\n\t\t\t}\n\t\t}\n\t}\n};\n/** Remove a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n */\nol.control.Swipe.prototype.removeLayer = function(layers) {\n  if (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++) {\n    var k = this.isLayer_(layers[i]);\n\t\tif (k >=0 && this.getMap()) {\n      if (this.layers[k].right) layers[i].un(['precompose','prerender'], this.precomposeRight_);\n\t\t\telse layers[i].un(['precompose','prerender'], this.precomposeLeft_);\n\t\t\tlayers[i].un(['postcompose','postrender'], this.postcompose_);\n\t\t\tthis.layers.splice(k,1);\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t}\n};\n/** @private\n*/\nol.control.Swipe.prototype.move = function(e) {\n\tvar self = this;\n\tvar l;\n\tswitch (e.type) {\n    case 'touchcancel':\n\t\tcase 'touchend':\n\t\tcase 'mouseup': {\n      self.isMoving = false;\n\t\t\t[\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n\t\t\t\t.forEach(function(eventName) {\n\t\t\t\t\tdocument.removeEventListener(eventName, self.move);\n\t\t\t\t});\n\t\t\tbreak;\n\t\t}\n\t\tcase 'mousedown':\n\t\tcase 'touchstart': {\n\t\t\tself.isMoving = true;\n\t\t\t[\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n\t\t\t\t.forEach(function(eventName) {\n\t\t\t\t\tdocument.addEventListener(eventName, self.move.bind(self));\n\t\t\t\t});\n\t\t}\n\t\t// fallthrough\n\t\tcase 'mousemove':\n\t\tcase 'touchmove': {\n      if (self.isMoving) {\n        if (self.get('orientation') === \"vertical\") {\n          var pageX = e.pageX\n\t\t\t\t\t\t|| (e.touches && e.touches.length && e.touches[0].pageX)\n\t\t\t\t\t\t|| (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n          if (!pageX) break;\n          pageX -= self.getMap().getTargetElement().getBoundingClientRect().left +\n            window.pageXOffset - document.documentElement.clientLeft;\n\t\t\t\t\tl = self.getMap().getSize()[0];\n\t\t\t\t\tl = Math.min(Math.max(0, 1-(l-pageX)/l), 1);\n\t\t\t\t\tself.set('position', l);\n\t\t\t\t} else {\n          var pageY = e.pageY\n\t\t\t\t\t\t|| (e.touches && e.touches.length && e.touches[0].pageY)\n\t\t\t\t\t\t|| (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n\t\t\t\t\tif (!pageY) break;\n\t\t\t\t\tpageY -= self.getMap().getTargetElement().getBoundingClientRect().top +\n\t\t\t\t\t\twindow.pageYOffset - document.documentElement.clientTop;\n\t\t\t\t\tl = self.getMap().getSize()[1];\n\t\t\t\t\tl = Math.min(Math.max(0, 1-(l-pageY)/l), 1);\n\t\t\t\t\tself.set('position', l);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n};\n/** @private\n*/\nol.control.Swipe.prototype.precomposeLeft = function(e) {\n  var ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\tctx.beginPath();\n\tif (this.get('orientation') === \"vertical\") ctx.rect (0,0, canvas.width*this.get('position'), canvas.height);\n\telse ctx.rect (0,0, canvas.width, canvas.height*this.get('position'));\n\tctx.clip();\n};\n/** @private\n*/\nol.control.Swipe.prototype.precomposeRight = function(e) {\n  var ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\tctx.beginPath();\n\tif (this.get('orientation') === \"vertical\") ctx.rect (canvas.width*this.get('position'), 0, canvas.width, canvas.height);\n\telse ctx.rect (0,canvas.height*this.get('position'), canvas.width, canvas.height);\n\tctx.clip();\n};\n/** @private\n*/\nol.control.Swipe.prototype.postcompose = function(e) {\n  e.context.restore();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** ol.control.Target draw a target at the center of the map.\n * @constructor\n * @extends {ol.control.CanvasBase}\n * @param {Object} options\n *  @param {ol.style.Style|Array<ol.style.Style>} options.style\n *  @param {string} options.composite composite operation = difference|multiply|xor|screen|overlay|darken|lighter|lighten|...\n */\nol.control.Target = function(options) {\n  options = options || {};\n\tthis.style = options.style || [\n    new ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#fff\", width:3 }) }) }),\n    new ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#000\", width:1 }) }) })\n  ];\n\tif (!(this.style instanceof Array)) this.style = [this.style];\n\tthis.composite = options.composite || '';\n\tvar div = document.createElement('div');\n\tdiv.className = \"ol-target ol-unselectable ol-control\";\n\tol.control.CanvasBase.call(this, {\n    element: div,\n\t\ttarget: options.target\n\t});\n\tthis.setVisible(options.visible!==false);\n};\nol.ext.inherits(ol.control.Target, ol.control.CanvasBase);\n/** Set the control visibility\n * @paraam {boolean} b \n */\nol.control.Target.prototype.setVisible = function (b) {\n  this.set(\"visible\",b);\n\tif (this.getMap()) this.getMap().renderSync();\n};\n/** Get the control visibility\n * @return {boolean} b \n */\nol.control.Target.prototype.getVisible = function () {\n  return this.get(\"visible\");\n};\n/** Draw the target\n * @private\n */\nol.control.Target.prototype._draw = function (e) {\n  var ctx = this.getContext(e);\n  if (!ctx || !this.getMap() || !this.getVisible()) return;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\t\tctx.scale(ratio,ratio);\n\t\tvar cx = ctx.canvas.width/(2*ratio);\n\t\tvar cy = ctx.canvas.height/(2*ratio);\n\t\tvar geom = new ol.geom.Point (this.getMap().getCoordinateFromPixel([cx,cy]));\n\t\tif (this.composite) ctx.globalCompositeOperation = this.composite;\n    for (var i=0; i<this.style.length; i++) {\n      var style = this.style[i];\n      if (style instanceof ol.style.Style) {\n        var vectorContext = e.vectorContext;\n        if (!vectorContext) {\n          var event = {\n            inversePixelTransform: [ratio,0,0,ratio,0,0],\n            context: ctx,\n            frameState: {\n              pixelRatio: ratio,\n              extent: e.frameState.extent,\n              coordinateToPixelTransform: e.frameState.coordinateToPixelTransform,\n              viewState: e.frameState.viewState\n            }\n          }\n          vectorContext = ol.render.getVectorContext(event);\n        } \n        vectorContext.setStyle(style);\n        vectorContext.drawGeometry(geom);\n      }\n    }\n\tctx.restore();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple push button control drawn as text\n * @constructor\n * @extends {ol.control.Button}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.title title of the control\n *\t@param {String} options.html html to insert in the control\n *\t@param {function} options.handleClick callback when control is clicked (or use change:active event)\n */\nol.control.TextButton = function(options)\n{\toptions = options || {};\n    options.className = (options.className||\"\") + \" ol-text-button\";\n    ol.control.Button.call(this, options);\n};\nol.ext.inherits(ol.control.TextButton, ol.control.Button);\n\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/** Timeline control\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires scroll\n * @fires collapse\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {Array<ol.Feature>} options.features Features to show in the timeline\n *\t@param {ol.SourceImageOptions.vector} options.source class of the control\n *\t@param {Number} options.interval time interval length in ms or a text with a format d, h, mn, s (31 days = '31d'), default none\n *\t@param {String} options.maxWidth width of the time line in px, default 2000px\n *\t@param {String} options.minDate minimum date \n *\t@param {String} options.maxDate maximum date \n *\t@param {Number} options.minZoom Minimum zoom for the line, default .2\n *\t@param {Number} options.maxZoom Maximum zoom for the line, default 4\n *\t@param {boolean} options.zoomButton Are zoom buttons avaliable, default false\n *\t@param {function} options.getHTML a function that takes a feature and returns the html to display\n *\t@param {function} options.getFeatureDate a function that takes a feature and returns its date, default the date propertie\n *\t@param {function} options.endFeatureDate a function that takes a feature and returns its end date, default no end date\n *\t@param {String} options.graduation day|month to show month or day graduation, default show only years\n *\t@param {String} options.scrollTimeout Time in milliseconds to get a scroll event, default 15ms\n */\nol.control.Timeline = function(options) {\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-timeline'\n      + (options.target ? '': ' ol-unselectable ol-control')\n      + (options.zoomButton ? ' ol-hasbutton':'')\n      + ('ontouchstart' in window ? ' ol-touch' : '')\n  });\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Scroll div\n  this._scrollDiv = ol.ext.element.create('DIV', {\n    className: 'ol-scroll',\n    parent: this.element\n  });\n  // Add a button bar\n  this._buttons = ol.ext.element.create('DIV', {\n    className: 'ol-buttons',\n    parent: this.element\n  });\n  // Zoom buttons\n  if (options.zoomButton) {\n    // Zoom in\n    this.addButton({\n      className: 'ol-zoom-in',\n      handleClick: function(){\n        var zoom = this.get('zoom');\n        if (zoom>=1) {\n          zoom++;\n        } else {\n          zoom = Math.min(1, zoom + 0.1);\n        }\n        zoom = Math.round(zoom*100)/100;\n        this.refresh(zoom);\n      }.bind(this)\n    });\n    // Zoom out\n    this.addButton({\n      className: 'ol-zoom-out',\n      handleClick: function(){\n        var zoom = this.get('zoom');\n        if (zoom>1) {\n          zoom--;\n        } else {\n          zoom -= 0.1;\n        }\n        zoom = Math.round(zoom*100)/100;\n        this.refresh(zoom);\n      }.bind(this)\n    });\n  }\n  // Draw center date\n  this._intervalDiv = ol.ext.element.create('DIV', {\n    className: 'ol-center-date',\n    parent: this.element\n  });\n  // Remove selection\n  this.element.addEventListener('mouseover', function(){\n    if (this._select) this._select.elt.classList.remove('ol-select');\n  }.bind(this));\n  // Trigger scroll event\n  var scrollListener = null;\n  this._scrollDiv.addEventListener('scroll', function() {\n    if (scrollListener) {\n      clearTimeout(scrollListener);\n      scrollListener = null;\n    }\n    scrollListener = setTimeout(function() {\n      this.dispatchEvent({ \n        type: 'scroll', \n        date: this.getDate(), \n        dateStart: this.getDate('start'), \n        dateEnd: this.getDate('end')\n      });\n    }.bind(this), options.scrollTimeout || 15);\n  }.bind(this));\n  // Magic to give \"live\" scroll events on touch devices\n  this._scrollDiv.addEventListener('gesturechange', function() {});\n  // Scroll timeline\n  ol.ext.element.scrollDiv(this._scrollDiv, {\n    onmove: function(b) {\n      // Prevent selection on moving\n      this._moving = b; \n    }.bind(this)\n  });\n  this._tline = [];\n  // Parameters\n  this.set('maxWidth', options.maxWidth || 2000);\n  this.set('minDate', options.minDate || Infinity);\n  this.set('maxDate', options.maxDate || -Infinity);\n  this.set('graduation', options.graduation);\n  this.set('minZoom', options.minZoom || .2);\n  this.set('maxZoom', options.maxZoom || 4);\n  this.setInterval(options.interval);\n  if (options.getHTML) this._getHTML =  options.getHTML;\n  if (options.getFeatureDate) this._getFeatureDate =  options.getFeatureDate;\n  if (options.endFeatureDate) this._endFeatureDate =  options.endFeatureDate;\n  // Feature source \n  this.setFeatures(options.features || options.source, options.zoom);\n};\nol.ext.inherits(ol.control.Timeline, ol.control.Control);\n/**\n * Set the map instance the control is associated with\n * and add interaction attached to it to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Timeline.prototype.setMap = function(map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  this.refresh(this.get('zoom')||1, true);\n};\n/** Add a button on the timeline\n * @param {*} button\n *  @param {string} button.className\n *  @param {title} button.className\n *  @param {Element|string} button.html Content of the element\n *  @param {function} button.click a function called when the button is clicked\n */\nol.control.Timeline.prototype.addButton = function(button) {\n  this.element.classList.add('ol-hasbutton');\n  ol.ext.element.create('BUTTON', {\n    className: button.className || undefined,\n    title: button.title,\n    html : button.html,\n    click: button.handleClick,\n    parent: this._buttons\n  })\n};\n/** Set an interval\n * @param {number|string} length the interval length in ms or a farmatted text ie. end with y, 1d, h, mn, s (31 days = '31d'), default none\n */\nol.control.Timeline.prototype.setInterval = function(length) {\n  if (typeof(length)==='string') {\n    if (/s$/.test(length)) {\n      length = parseFloat(length) * 1000;\n    } else if (/mn$/.test(length)) {\n      length = parseFloat(length) * 1000 * 60;\n    } else if (/h$/.test(length)) {\n      length = parseFloat(length) * 1000 * 3600;\n    } else if (/d$/.test(length)) {\n      length = parseFloat(length) * 1000 * 3600 * 24;\n    } else if (/y$/.test(length)) {\n      length = parseFloat(length) * 1000 * 3600 * 24 * 365;\n    } else {\n      length = 0;\n    }\n  }\n  this.set('interval', length || 0);\n  if (length) this.element.classList.add('ol-interval');\n  else this.element.classList.remove('ol-interval');\n  this.refresh(this.get('zoom'));\n}\n/** Default html to show in the line\n * @param {ol.Feature} feature\n * @return {DOMElement|string}\n * @private\n */\nol.control.Timeline.prototype._getHTML = function(feature) {\n  return feature.get('name') || '';\n};\n/** Default function to get the date of a feature, returns the date attribute\n * @param {ol.Feature} feature\n * @return {Data|string}\n * @private\n */\nol.control.Timeline.prototype._getFeatureDate = function(feature) {\n  return (feature && feature.get) ? feature.get('date') : null;\n};\n/** Default function to get the end date of a feature, return undefined\n * @param {ol.Feature} feature\n * @return {Data|string}\n * @private\n */\nol.control.Timeline.prototype._endFeatureDate = function(/* feature */) {\n  return undefined;\n};\n/** Is the line collapsed\n * @return {boolean}\n */\nol.control.Timeline.prototype.isCollapsed = function() {\n  return this.element.classList.contains('ol-collapsed');\n};\n/** Collapse the line\n * @param {boolean} b\n */\nol.control.Timeline.prototype.collapse = function(b) {\n  if (b) this.element.classList.add('ol-collapsed');\n  else this.element.classList.remove('ol-collapsed');\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Collapse the line\n */\nol.control.Timeline.prototype.toggle = function() {\n  this.element.classList.toggle('ol-collapsed');\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Set the features to display in the timeline\n * @param {Array<ol.Features>|ol.source.Vector} features An array of features or a vector source\n * @param {number} zoom zoom to draw the line default 1\n */\nol.control.Timeline.prototype.setFeatures = function(features, zoom) {\n  this._features = this._source = null;\n  if (features instanceof ol.source.Vector) this._source = features;\n  else if (features instanceof Array) this._features = features;\n  else this._features = [];\n  this.refresh(zoom);\n};\n/**\n * Get features\n * @return {Array<ol.Feature>}\n */\nol.control.Timeline.prototype.getFeatures = function() {\n  return this._features || this._source.getFeatures();\n}\n/**\n * Refresh the timeline with new data\n * @param {Number} zoom Zoom factor from 0.25 to 10, default 1\n */\nol.control.Timeline.prototype.refresh = function(zoom, first) {\n  if (!this.getMap()) return;\n  if (!zoom) zoom = this.get('zoom');\n  zoom = Math.min(this.get('maxZoom'), Math.max(this.get('minZoom'), zoom || 1));\n  this.set('zoom', zoom);\n  this._scrollDiv.innerHTML = '';\n  var features = this.getFeatures();\n  var d, d2;\n  // Get features sorted by date\n  var tline = this._tline = [];\n  features.forEach(function(f) {\n    if (d = this._getFeatureDate(f)) {\n      if (!(d instanceof Date)) {\n        d = new Date(d)\n      }\n      if (this._endFeatureDate) {\n        d2 = this._endFeatureDate(f);\n        if (!(d2 instanceof Date)) {\n          d2 = new Date(d2)\n        }\n      }\n      if (!isNaN(d)) {\n        tline.push({\n          date: d,\n          end: isNaN(d2) ? null : d2,\n          feature: f\n        });\n      }\n    }\n  }.bind(this));\n  tline.sort(function(a,b) { \n    return (a.date < b.date ? -1 : (a.date===b.date ? 0: 1))\n  });\n  // Draw\n  var div = ol.ext.element.create('DIV', {\n    parent: this._scrollDiv\n  });\n  // Calculate width\n  var min = this._minDate = Math.min(this.get('minDate'), tline.length ? tline[0].date : Infinity);\n  var max = this._maxDate = Math.max(this.get('maxDate'), tline.length ? tline[tline.length-1].date : -Infinity);\n  if (!isFinite(min)) this._minDate = min = new Date();\n  if (!isFinite(max)) this._maxDate = max = new Date();\n  var delta = (max-min);\n  var maxWidth = this.get('maxWidth');\n  var scale = this._scale = (delta > maxWidth ? maxWidth/delta : 1) * zoom;\n  // Leave 10px on right\n  min = this._minDate = this._minDate - 10/scale;\n  delta = (max-min) * scale;\n  ol.ext.element.setStyle(div, {\n    width: delta,\n    maxWidth: 'unset'\n  });\n  // Draw time's bar\n  this._drawTime(div, min, max, scale);\n  // Set interval\n  if (this.get('interval')) {\n    ol.ext.element.setStyle (this._intervalDiv, { width: this.get('interval') * scale });\n  } else {\n    ol.ext.element.setStyle (this._intervalDiv, { width: '' });\n  }\n  // Draw features\n  var line = [];\n  var lineHeight = ol.ext.element.getStyle(this._scrollDiv, 'lineHeight');\n  // Wrapper\n  var fdiv = ol.ext.element.create('DIV', {\n      className: 'ol-features',\n      parent: div\n  });\n  // Add features on the line\n  tline.forEach(function(f) {\n    var d = f.date;\n    var t = f.elt = ol.ext.element.create('DIV', {\n      className: 'ol-feature',\n      style: {\n        left: Math.round((d-min)*scale),\n      },\n      html: this._getHTML(f.feature),\n      parent: fdiv\n    });\n    // Prevent image dragging\n    var img = t.querySelectorAll('img');\n    for (var i=0; i<img.length; i++) {\n      img[i].ondragstart = function(){ return false; };\n    }\n    // Calculate image width\n    if (f.end) {\n      ol.ext.element.setStyle(t, { \n        minWidth: (f.end-d) * scale, \n        width: (f.end-d) * scale, \n        maxWidth: 'unset'\n      });\n    }\n    var left = ol.ext.element.getStyle(t, 'left');\n    // Select on click\n    t.addEventListener('click', function(){\n      if (!this._moving) {\n        this.dispatchEvent({type: 'select', feature: f.feature });\n      }\n    }.bind(this));\n    // Find first free Y position\n    var pos, l;\n    for (pos=0; l=line[pos]; pos++) {\n      if (left > l) {\n        break;\n      }\n    }\n    line[pos] = left + ol.ext.element.getStyle(t, 'width');\n    ol.ext.element.setStyle(t, { top: pos*lineHeight });\n  }.bind(this));\n  this._nbline = line.length;\n  if (first) this.setDate(this._minDate, { anim: false, position: 'start' });\n  // Dispatch scroll event\n  this.dispatchEvent({ \n    type: 'scroll', \n    date: this.getDate(), \n    dateStart: this.getDate('start'), \n    dateEnd: this.getDate('end')\n  });\n};\n/**\n * Draw dates on line\n * @private\n */\nol.control.Timeline.prototype._drawTime = function(div, min, max, scale) {\n  // Times div\n  var tdiv = ol.ext.element.create('DIV', {\n    className: 'ol-times',\n    parent: div\n  });\n  var d, dt, month, dmonth;\n  var dx = ol.ext.element.getStyle(tdiv, 'left');\n  var heigth = ol.ext.element.getStyle(tdiv, 'height');\n  // Year\n  var year = (new Date(this._minDate)).getFullYear();\n  dt = ((new Date(0)).setFullYear(String(year)) - new Date(0).setFullYear(String(year-1))) * scale;\n  var dyear = Math.round(2*heigth/dt)+1;\n  while(true) {\n    d = new Date(0).setFullYear(year);\n    if (d > this._maxDate) break;\n    ol.ext.element.create('DIV', {\n      className: 'ol-time ol-year',\n      style: {\n        left: Math.round((d-this._minDate)*scale) - dx\n      },\n      html: year,\n      parent: tdiv\n    });\n    year += dyear;\n  }\n  // Month\n  if (/day|month/.test(this.get('graduation'))) {\n    dt = ((new Date(0)).setFullYear(String(year)) - new Date(0).setFullYear(String(year-1))) * scale;\n    dmonth = Math.max(1, Math.round(12 / Math.round(dt/heigth/2)));\n    if (dmonth < 12) {\n      year = (new Date(this._minDate)).getFullYear();\n      month = dmonth+1;\n      while(true) {\n        d = new Date('0/01/01');\n        d.setFullYear(year);\n        d.setMonth(month-1);\n        if (d > this._maxDate) break;\n        ol.ext.element.create('DIV', {\n          className: 'ol-time ol-month',\n          style: {\n            left: Math.round((d-this._minDate)*scale) - dx\n          },\n          html: d.toLocaleDateString(undefined, { month: 'short'}),\n          parent: tdiv\n        });\n        month += dmonth;\n        if (month > 12) {\n          year++;\n          month = dmonth+1;\n        }\n      }\n    }\n  }\n  // Day\n  if (this.get('graduation')==='day') {\n    dt = (new Date('2000/02/01') - new Date('2000/01/01')) * scale;\n    var dday = Math.max(1, Math.round(31 / Math.round(dt/heigth/2)));\n    if (dday < 31) {\n      year = (new Date(this._minDate)).getFullYear();\n      month = 0;\n      var day = dday;\n      while(true) {\n        d = new Date(0);\n        d.setFullYear(year);\n        d.setMonth(month);\n        d.setDate(day);\n        if (isNaN(d)) {\n          month++;\n          if (month>12) {\n            month = 1;\n            year++;\n          }\n          day = dday;\n        } else {\n          if (d > this._maxDate) break;\n          ol.ext.element.create('DIV', {\n            className: 'ol-time ol-day',\n            style: {\n              left: Math.round((d-this._minDate)*scale) - dx\n            },\n            html: day,\n            parent: tdiv\n          });\n          year = d.getFullYear();\n          month = d.getMonth();\n          day = d.getDate() + dday;\n          if (day+dday/2>31) {\n            month++;\n            day = dday;\n          }\n        }\n      }\n    }\n  }\n};\n/** Center timeline on a date\n * @param {Date|String|ol.feature} feature a date or a feature with a date\n * @param {Object} options\n *  @param {boolean} options.anim animate scroll\n *  @param {string} options.position start, end or middle, default middle\n */\nol.control.Timeline.prototype.setDate = function(feature, options) {\n  var date;\n  options = options || {};\n  // It's a date\n  if (feature instanceof Date) {\n    date = feature;\n  } else {\n    // Get date from Feature\n    if (this.getFeatures().indexOf(feature) >= 0) {\n      date = this._getFeatureDate(feature);\n    }\n    if (date && !(date instanceof Date)) {\n      date = new Date(date);\n    }\n    if (!date || isNaN(date)) {\n      date = new Date(String(feature));\n    }\n  }\n  if (!isNaN(date)) {\n    if (options.anim === false) this._scrollDiv.classList.add('ol-move');\n    var scrollLeft = (date-this._minDate)*this._scale;\n    if (options.position==='start') {\n      scrollLeft += ol.ext.element.outerWidth(this._scrollDiv)/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n    } else if (options.position==='end') {\n      scrollLeft -= ol.ext.element.outerWidth(this._scrollDiv)/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n    }\n    this._scrollDiv.scrollLeft = scrollLeft;\n    if (options.anim === false) this._scrollDiv.classList.remove('ol-move');\n    if (feature) {\n      for (var i=0, f; f = this._tline[i]; i++) {\n        if (f.feature === feature) {\n          f.elt.classList.add('ol-select');\n          this._select = f;\n        } else {\n          f.elt.classList.remove('ol-select');\n        }\n      }\n    }\n  }\n};\n/** Get the date of the center\n * @param {string} position start, end or middle, default middle\n * @return {Date}\n */\nol.control.Timeline.prototype.getDate = function(position) {\n  var pos;\n  switch (position) {\n    case 'start': {\n      if (this.get('interval')) {\n        pos = - ol.ext.element.getStyle(this._intervalDiv, 'width')/2 + ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      } else {\n        pos = - ol.ext.element.outerWidth(this._scrollDiv)/2 + ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      }\n      break;\n    }\n    case 'end': {\n      if (this.get('interval')) {\n        pos = ol.ext.element.getStyle(this._intervalDiv, 'width')/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      } else {\n        pos = ol.ext.element.outerWidth(this._scrollDiv)/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      }\n      break;\n    }\n    default: {\n      pos = 0;\n      break;\n    }\n  }\n  var d = (this._scrollDiv.scrollLeft + pos)/this._scale + this._minDate;\n  return new Date(d);\n};\n/** Get the start date of the control\n * @return {Date}\n */\nol.control.Timeline.prototype.getStartDate = function() {\n  return new Date(this.get('minDate'));\n}\n/** Get the end date of the control\n * @return {Date}\n */\nol.control.Timeline.prototype.getEndDate = function() {\n  return new Date(this.get('maxDate'));\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple toggle control\n * The control can be created with an interaction to control its activation.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires change:active, change:disable\n * @param {Object=} options Control options.\n *  @param {String} options.className class of the control\n *  @param {String} options.title title of the control\n *  @param {String} options.html html to insert in the control\n *  @param {ol.interaction} options.interaction interaction associated with the control\n *  @param {bool} options.active the control is created active, default false\n *  @param {bool} options.disable the control is created disabled, default false\n *  @param {ol.control.Bar} options.bar a subbar associated with the control (drawn when active if control is nested in a ol.control.Bar)\n *  @param {bool} options.autoActive the control will activate when shown in an ol.control.Bar, default false\n *  @param {function} options.onToggle callback when control is clicked (or use change:active event)\n */\nol.control.Toggle = function(options) {\n  options = options || {};\n  var self = this;\n  this.interaction_ = options.interaction;\n  if (this.interaction_) {\n    this.interaction_.setActive(options.active);\n    this.interaction_.on(\"change:active\", function() {\n      self.setActive(self.interaction_.getActive());\n    });\n  }\n  if (options.toggleFn) options.onToggle = options.toggleFn; // compat old version\n  options.handleClick = function() {\n    self.toggle();\n    if (options.onToggle) options.onToggle.call(self, self.getActive());\n  };\n  options.className = (options.className||\"\") + \" ol-toggle\";\n  ol.control.Button.call(this, options);\n  this.set(\"title\", options.title);\n  this.set (\"autoActivate\", options.autoActivate);\n  if (options.bar) {\n    this.subbar_ = options.bar;\n    this.subbar_.setTarget(this.element);\n    this.subbar_.element.classList.add(\"ol-option-bar\");\n  }\n  this.setActive (options.active);\n  this.setDisable (options.disable);\n};\nol.ext.inherits(ol.control.Toggle, ol.control.Button);\n/**\n * Set the map instance the control is associated with\n * and add interaction attached to it to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Toggle.prototype.setMap = function(map) {\n  if (!map && this.getMap()) {\n    if (this.interaction_) {\n      this.getMap().removeInteraction (this.interaction_);\n    }\n    if (this.subbar_) this.getMap().removeControl (this.subbar_);\n  }\n  ol.control.Control.prototype.setMap.call(this, map);\n  if (map) {\n    if (this.interaction_) map.addInteraction (this.interaction_);\n    if (this.subbar_) map.addControl (this.subbar_);\n  }\n};\n/** Get the subbar associated with a control\n * @return {ol.control.Bar}\n */\nol.control.Toggle.prototype.getSubBar = function () {\n  return this.subbar_;\n};\n/**\n * Test if the control is disabled.\n * @return {bool}.\n * @api stable\n */\nol.control.Toggle.prototype.getDisable = function() {\n  var button = this.element.querySelector(\"button\");\n  return button && button.disabled;\n};\n/** Disable the control. If disable, the control will be deactivated too.\n* @param {bool} b disable (or enable) the control, default false (enable)\n*/\nol.control.Toggle.prototype.setDisable = function(b) {\n  if (this.getDisable()==b) return;\n  this.element.querySelector(\"button\").disabled = b;\n  if (b && this.getActive()) this.setActive(false);\n  this.dispatchEvent({ type:'change:disable', key:'disable', oldValue:!b, disable:b });\n};\n/**\n * Test if the control is active.\n * @return {bool}.\n * @api stable\n */\nol.control.Toggle.prototype.getActive = function() {\n  return this.element.classList.contains(\"ol-active\");\n};\n/** Toggle control state active/deactive\n */\nol.control.Toggle.prototype.toggle = function() {\n  if (this.getActive()) this.setActive(false);\n  else this.setActive(true);\n};\n/** Change control state\n * @param {bool} b activate or deactivate the control, default false\n */\nol.control.Toggle.prototype.setActive = function(b) {\t\n  if (this.interaction_) this.interaction_.setActive (b);\n  if (this.subbar_) this.subbar_.setActive(b);\n  if (this.getActive()===b) return;\n  if (b) this.element.classList.add(\"ol-active\");\n  else this.element.classList.remove(\"ol-active\");\n  this.dispatchEvent({ type:'change:active', key:'active', oldValue:!b, active:b });\n};\n/** Set the control interaction\n* @param {_ol_interaction_} i interaction to associate with the control\n*/\nol.control.Toggle.prototype.setInteraction = function(i) {\n  this.interaction_ = i;\n};\n/** Get the control interaction\n* @return {_ol_interaction_} interaction associated with the control\n*/\nol.control.Toggle.prototype.getInteraction = function() {\n  return this.interaction_;\n};\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Feature animation base class\n * Use the {@link _ol_Map_#animateFeature} or {@link _ol_layer_Vector_#animateFeature} to animate a feature\n * on postcompose in a map or a layer\n* @constructor\n* @fires animationstart|animationend\n* @param {ol.featureAnimationOptions} options\n*\t@param {Number} options.duration duration of the animation in ms, default 1000\n*\t@param {bool} options.revers revers the animation direction\n*\t@param {Number} options.repeat number of time to repeat the animation, default 0\n*\t@param {oo.style.Style} options.hiddenStyle a style to display the feature when playing the animation\n*\t\tto be used to make the feature selectable when playing animation \n*\t\t(@see {@link ../examples/map.featureanimation.select.html}), default the feature \n*\t\twill be hidden when playing (and niot selectable)\n*\t@param {ol.easing.Function} options.fade an easing function used to fade in the feature, default none\n*\t@param {ol.easing.Function} options.easing an easing function for the animation, default ol.easing.linear\n*/\nol.featureAnimation = function(options)\n{\toptions = options || {};\n\tthis.duration_ = typeof (options.duration)=='number' ? (options.duration>=0 ? options.duration : 0) : 1000;\n\tthis.fade_ = typeof(options.fade) == 'function' ? options.fade : null;\n\tthis.repeat_ = Number(options.repeat);\n\tvar easing = typeof(options.easing) =='function' ? options.easing : ol.easing.linear;\n\tif (options.revers) this.easing_ = function(t) { return (1 - easing(t)); };\n\telse this.easing_ = easing;\n\tthis.hiddenStyle = options.hiddenStyle;\n\tol.Object.call(this);\n};\nol.ext.inherits(ol.featureAnimation, ol.Object);\n/** Draw a geometry \n* @param {olx.animateFeatureEvent} e\n* @param {ol.geom} geom geometry for shadow\n* @param {ol.geom} shadow geometry for shadow (ie. style with zIndex = -1)\n* @private\n*/\nol.featureAnimation.prototype.drawGeom_ = function (e, geom, shadow)\n{\tif (this.fade_) \n\t{\te.context.globalAlpha = this.fade_(1-e.elapsed);\n\t}\n\tvar style = e.style;\n\tfor (var i=0; i<style.length; i++)\n\t{\tvar sc=0;\n\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : style[i].getImage();\n\t\tif (imgs) \n\t\t{\tsc = imgs.getScale(); \n\t\t\timgs.setScale(e.frameState.pixelRatio*sc);\n\t\t}\n\t\t// Prevent crach if the style is not ready (image not loaded)\n\t\ttry {\n\t\t\tvar vectorContext = e.vectorContext || ol.render.getVectorContext(e);\n\t\t\tvectorContext.setStyle(style[i]);\n\t\t\tif (style[i].getZIndex()<0) vectorContext.drawGeometry(shadow||geom);\n\t\t\telse vectorContext.drawGeometry(geom);\n\t\t} catch(e) { /* ok */ }\n\t\tif (imgs) imgs.setScale(sc);\n\t}\n};\n/** Function to perform manipulations onpostcompose. \n * This function is called with an ol.featureAnimationEvent argument.\n * The function will be overridden by the child implementation.    \n * Return true to keep this function for the next frame, false to remove it.\n * @param {ol.featureAnimationEvent} e\n * @return {bool} true to continue animation.\n * @api \n */\nol.featureAnimation.prototype.animate = function (/* e */)\n{\treturn false;\n};\n/** An animation controler object an object to control animation with start, stop and isPlaying function.    \n * To be used with {@link olx.Map#animateFeature} or {@link ol.layer.Vector#animateFeature}\n * @typedef {Object} ol.animationControler\n * @property {function} start - start animation.\n * @property {function} stop - stop animation option arguments can be passed in animationend event.\n * @property {function} isPlaying - return true if animation is playing.\n */\n/** Animate feature on a map\n * @function \n * @fires animationstart, animationend\n * @param {ol.Feature} feature Feature to animate\n * @param {ol.featureAnimation|Array<ol.featureAnimation>} fanim the animation to play\n * @return {olx.animationControler} an object to control animation with start, stop and isPlaying function\n */\nol.Map.prototype.animateFeature = function(feature, fanim) {\n\t// Animate on last visible layer\n\tfunction animLayer(layers) {\n\t\tfor (var l, i=layers.length-1; l=layers[i]; i--) {\n\t\t\tif (l.getVisible()) {\n\t\t\t\tif (l.getLayers) {\n\t\t\t\t\tif (animLayer(l.getLayers().getArray())) return true;\n\t\t\t\t} else {\n\t\t\t\t\tl.animateFeature(feature, fanim);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tanimLayer(this.getLayers().getArray());\n};\n/** Animate feature on a vector layer \n * @fires animationstart, animationend\n * @param {ol.Feature} feature Feature to animate\n * @param {ol.featureAnimation|Array<ol.featureAnimation>} fanim the animation to play\n * @param {boolean} useFilter use the filters of the layer\n * @return {olx.animationControler} an object to control animation with start, stop and isPlaying function\n */\nol.layer.Base.prototype.animateFeature = function(feature, fanim, useFilter)\n{\tvar self = this;\n\tvar listenerKey;\n\t// Save style\n\tvar style = feature.getStyle();\n\tvar flashStyle = style || (this.getStyleFunction ? this.getStyleFunction()(feature) : null);\n\tif (!flashStyle) flashStyle=[];\n\tif (!(flashStyle instanceof Array)) flashStyle = [flashStyle];\n\t// Structure pass for animating\n\tvar event = \n\t\t{\t// Frame context\n\t\t\tvectorContext: null,\n\t\t\tframeState: null,\n\t\t\tstart: 0,\n\t\t\ttime: 0,\n\t\t\telapsed: 0,\n\t\t\textent: false,\n\t\t\t// Feature information\n\t\t\tfeature: feature,\n\t\t\tgeom: feature.getGeometry(),\n\t\t\ttypeGeom: feature.getGeometry().getType(),\n\t\t\tbbox: feature.getGeometry().getExtent(),\n\t\t\tcoord: ol.extent.getCenter(feature.getGeometry().getExtent()),\n\t\t\tstyle: flashStyle\n\t\t};\n\tif (!(fanim instanceof Array)) fanim = [fanim];\n\t// Remove null animations\n\tfor (var i=fanim.length-1; i>=0; i--)\n\t{\tif (fanim[i].duration_===0) fanim.splice(i,1);\n\t}\n\tvar nb=0, step = 0;\n\t// Filter availiable on the layer\n\tvar filters = (useFilter && this.getFilters) ? this.getFilters() : [];\n\tfunction animate(e) {\n\t\ttry {\n\t\t\tevent.vectorContext = e.vectorContext || ol.render.getVectorContext(e);\n\t\t} catch(e) { /* nothing todo */ }\n\t\tevent.frameState = e.frameState;\n\t\tif (!event.extent) \n\t\t{\tevent.extent = e.frameState.extent;\n\t\t\tevent.start = e.frameState.time;\n\t\t\tevent.context = e.context;\n\t\t}\n\t\tevent.time = e.frameState.time - event.start;\n\t\tevent.elapsed = event.time / fanim[step].duration_;\n\t\tif (event.elapsed > 1) event.elapsed = 1;\n\t\t// Filter\n\t\te.context.save();\n\t\tfilters.forEach(function(f) {\n\t\t\tif (f.get('active')) f.precompose(e);\n\t\t});\n\t\tif (this.getOpacity) {\n\t\t\te.context.globalAlpha = this.getOpacity();\n\t\t}\n\t\t// Stop animation?\n\t\tif (!fanim[step].animate(event))\n\t\t{\tnb++;\n\t\t\t// Repeat animation\n\t\t\tif (nb < fanim[step].repeat_)\n\t\t\t{\tevent.extent = false;\n\t\t\t}\n\t\t\t// newt step\n\t\t\telse if (step < fanim.length-1)\n\t\t\t{\tfanim[step].dispatchEvent({ type:'animationend', feature: feature });\n\t\t\t\tstep++;\n\t\t\t\tnb=0;\n\t\t\t\tevent.extent = false;\n\t\t\t}\n\t\t\t// the end\n\t\t\telse \n\t\t\t{\tstop();\n\t\t\t}\n\t\t}\n\t\tfilters.forEach(function(f) {\n\t\t\tif (f.get('active')) f.postcompose(e);\n\t\t});\n\t\te.context.restore();\n\t\t// tell OL3 to continue postcompose animation\n\t\te.frameState.animate = true;\n\t}\n\t// Stop animation\n\tfunction stop(options)\n\t{\tol.Observable.unByKey(listenerKey);\n\t\tlistenerKey = null;\n\t\tfeature.setStyle(style);\n\t\t// Send event\n\t\tvar event = { type:'animationend', feature: feature };\n\t\tif (options) \n\t\t{\tfor (var i in options) if (options.hasOwnProperty(i))\n\t\t\t{ \tevent[i] = options[i]; \n\t\t\t}\n\t\t}\n\t\tfanim[step].dispatchEvent(event);\n\t\tself.dispatchEvent(event);\n\t}\n\t// Launch animation\n\tfunction start(options){\n\t\tif (fanim.length && !listenerKey)\n\t\t{\tlistenerKey = self.on(['postcompose','postrender'], animate.bind(self));\n\t\t\t// map or layer?\n\t\t\tif (self.renderSync) self.renderSync();\n\t\t\telse self.changed();\n\t\t\t// Hide feature while animating\n\t\t\tfeature.setStyle(fanim[step].hiddenStyle || new ol.style.Style({ image: new ol.style.Circle({}) }));\n\t\t\t// Send event\n\t\t\tvar event = { type:'animationstart', feature: feature };\n\t\t\tif (options) \n\t\t\t{\tfor (var i in options) if (options.hasOwnProperty(i))\n\t\t\t\t{ \tevent[i] = options[i]; \n\t\t\t\t}\n\t\t\t}\n\t\t\tfanim[step].dispatchEvent(event);\n\t\t\tself.dispatchEvent(event);\n\t\t}\n\t}\n\tstart();\n\t// Return animation controler\n\treturn {\n\t\tstart: start,\n\t\tstop: stop,\n\t\tisPlaying: function() { return (!!listenerKey); }\n\t};\n};\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Bounce animation: \n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationBounceOptions} options\n *\t@param {Integer} options.bounce number of bounce, default 3\n *\t@param {Integer} options.amplitude bounce amplitude,default 40\n *\t@param {ol.easing} options.easing easing used for decaying amplitude, use function(){return 0} for no decay, default ol.easing.linear\n *\t@param {Integer} options.duration duration in ms, default 1000\n */\nol.featureAnimation.Bounce = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.amplitude_ = options.amplitude || 40;\n\tthis.bounce_ = -Math.PI*(options.bounce || 3);\n}\nol.ext.inherits(ol.featureAnimation.Bounce, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Bounce.prototype.animate = function (e)\n{\t// Animate\n\tvar flashGeom = e.geom.clone();\n\t/*\n\tvar t = this.easing_(e.elapsed)\n\tt = Math.abs(Math.sin(this.bounce_*t)) * this.amplitude_ * (1-t) * e.frameState.viewState.resolution;\n\t*/\n\tvar t = Math.abs(Math.sin(this.bounce_*e.elapsed)) * this.amplitude_ * (1-this.easing_(e.elapsed)) * e.frameState.viewState.resolution;\n\tflashGeom.translate(0, t);\n\tthis.drawGeom_(e, flashGeom, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Drop animation: drop a feature on the map\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationDropOptions} options\n *  @param {Number} options.speed speed of the feature if 0 the duration parameter will be used instead, default 0\n *  @param {Number} options.side top or bottom, default top\n */\nol.featureAnimation.Drop = function(options)\n{\toptions = options || {};\n\tthis.speed_ = options.speed || 0;\n\tol.featureAnimation.call(this, options);\n\tthis.side_ = options.side || 'top';\n}\nol.ext.inherits(ol.featureAnimation.Drop, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Drop.prototype.animate = function (e)\n{\t// First time > calculate duration / speed\n\tif (!e.time) \n\t{\tvar angle = e.frameState.viewState.rotation;\n\t\tvar s = e.frameState.size[1] * e.frameState.viewState.resolution;\n\t\tif (this.side_!='top') s *= -1;\n\t\tthis.dx = -Math.sin(angle)*s;\n\t\tthis.dy = Math.cos(angle)*s;\n\t\tif (this.speed_) \n\t\t{\tthis.duration_ = s/this.speed_/e.frameState.viewState.resolution;\n\t\t}\n\t}\n\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tflashGeom.translate(\n\t\tthis.dx*(1-this.easing_(e.elapsed)),  \n\t\tthis.dy*(1-this.easing_(e.elapsed))\n\t);\n\tthis.drawGeom_(e, flashGeom, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Fade animation: feature fade in\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationOptions} options\n */\nol.featureAnimation.Fade = function(options)\n{\toptions = options || {};\n\tthis.speed_ = options.speed || 0;\n\tol.featureAnimation.call(this, options);\n}\nol.ext.inherits(ol.featureAnimation.Fade, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Fade.prototype.animate = function (e)\n{\te.context.globalAlpha = this.easing_(e.elapsed);\n\tthis.drawGeom_(e, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Do nothing for a given duration\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationShowOptions} options\n * \n */\nol.featureAnimation.None = function(options)\n{\tol.featureAnimation.call(this, options);\n};\nol.ext.inherits(ol.featureAnimation.None, ol.featureAnimation);\n/** Animate: do nothing during the laps time\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.None.prototype.animate = function (e)\n{\t\n\treturn (e.time <= this.duration_);\n};\n\n/*\n  Copyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL license (http://www.cecill.info/).\n*/\n/** Do nothing \n * @constructor\n * @extends {ol.featureAnimation}\n */\nol.featureAnimation.Null = function() {\n  ol.featureAnimation.call(this, { duration:0 });\n};\nol.ext.inherits(ol.featureAnimation.Null, ol.featureAnimation);\n\n/*\n\tCopyright (c) 2016-2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Path animation: feature follow a path\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationPathOptions} options extend ol.featureAnimation options\n *  @param {Number} options.speed speed of the feature, if 0 the duration parameter will be used instead, default 0\n *  @param {Number|boolean} options.rotate rotate the symbol when following the path, true or the initial rotation, default false\n *  @param {ol.geom.LineString|ol.Feature} options.path the path to follow\n */\nol.featureAnimation.Path = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.speed_ = options.speed || 0;\n\tthis.path_ = options.path;\n\tswitch (options.rotate) {\n\t\tcase true: \n\t\tcase 0:\n\t\t\tthis.rotate_ = 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.rotate_ = options.rotate || false;\n\t\t\tbreak;\n\t}\n\tif (this.path_ && this.path_.getGeometry) this.path_ = this.path_.getGeometry();\n\tif (this.path_ && this.path_.getLineString) this.path_ = this.path_.getLineString();\n\tif (this.path_.getLength)\n\t{\tthis.dist_ = this.path_.getLength()\n\t\tif (this.path_ && this.path_.getCoordinates) this.path_ = this.path_.getCoordinates();\n\t}\n\telse this.dist_ = 0;\n\tif (this.speed_>0) this.duration_ = this.dist_/this.speed_;\n}\nol.ext.inherits(ol.featureAnimation.Path, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Path.prototype.animate = function (e)\n{\t// First time \n\tif (!e.time) \n\t{\tif (!this.dist_) return false;\n\t}\n\tvar dmax = this.dist_*this.easing_(e.elapsed);\n\tvar p0, p, s, dx,dy, dl, d = 0;\n\tp = this.path_[0];\n\t// Linear interpol\n\tfor (var i = 1; i<this.path_.length; i++)\n\t{\tp0 = p;\n\t\tp = this.path_[i];\n\t\tdx = p[0]-p0[0];\n\t\tdy = p[1]-p0[1];\n\t\tdl = Math.sqrt(dx*dx+dy*dy);\n\t\tif (dl && d+dl>=dmax) \n\t\t{\ts = (dmax-d)/dl;\n\t\t\tp = [ p0[0] + (p[0]-p0[0])*s, p0[1] + (p[1]-p0[1])*s];\n\t\t\tbreak;\n\t\t}\n\t\td += dl;\n\t}\n\t// Rotate symbols\n\tif (this.rotate_!==false) {\n\t\tvar angle = this.rotate_ - Math.atan2(p0[1] - p[1], p0[0] - p[0]);\n\t\tfor (var k=0; s=e.style[k]; k++) {\n\t\t\tif (s.getImage()) {\n\t\t\t\ts.getImage().setRotation(angle)\n\t\t\t}\n\t\t}\n\t}\n\te.geom.setCoordinates(p);\n\t// Animate\n\tthis.drawGeom_(e, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Shakee animation: \n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationShakeOptions} options\n *\t@param {Integer} options.bounce number o bounds, default 6\n *\t@param {Integer} options.amplitude amplitude of the animation, default 40\n *\t@param {bool} options.horizontal shake horizontally default false (vertical)\n */\nol.featureAnimation.Shake = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n//\tthis.easing_ = options.easing_ || function(t){return (0.5+t)*t -0.5*t ;};\n\tthis.amplitude_ = options.amplitude || 40;\n\tthis.bounce_ = -Math.PI*(options.bounce || 6);\n\tthis.horizontal_ = options.horizontal;\n}\nol.ext.inherits(ol.featureAnimation.Shake, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Shake.prototype.animate = function (e)\n{\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tvar shadow = e.geom.clone();\n\tvar t = this.easing_(e.elapsed)\n\tt = Math.sin(this.bounce_*t) * this.amplitude_ * (1-t) * e.frameState.viewState.resolution;\n\tif (this.horizontal_) \n\t{\tflashGeom.translate(t, 0);\n\t\tshadow.translate(t, 0);\n\t}\n\telse flashGeom.translate(0, t);\n\tthis.drawGeom_(e, flashGeom, shadow);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Show an object for a given duration\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationOptions} options\n */\nol.featureAnimation.Show = function(options)\n{\tol.featureAnimation.call(this, options);\n}\nol.ext.inherits(ol.featureAnimation.Show, ol.featureAnimation);\n/** Animate: just show the object during the laps time\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Show.prototype.animate = function (e)\n{\t\n\tthis.drawGeom_(e, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Slice animation: feature enter from left\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationSlideOptions} options\n *  @param {Number} options.speed speed of the animation, if 0 the duration parameter will be used instead, default 0\n */\nol.featureAnimation.Slide = function(options)\n{\toptions = options || {};\n\tthis.speed_ = options.speed || 0;\n\tol.featureAnimation.call(this, options);\n\tthis.side_ = options.side || 'left';\n}\nol.ext.inherits(ol.featureAnimation.Slide, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Slide.prototype.animate = function (e)\n{\t// First time > calculate duration / speed\n\tif (!e.time) \n\t{\tif (this.side_=='left') this.dx = (e.extent[0]-e.bbox[2])\n\t\telse this.dx = (e.extent[2]-e.bbox[0])\n\t\tif (this.speed_) this.duration_ = Math.abs(this.dx)/this.speed_/e.frameState.viewState.resolution;\n\t}\n\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tflashGeom.translate(this.dx*(1-this.easing_(e.elapsed)), 0);\n\tthis.drawGeom_(e, flashGeom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Teleport a feature at a given place\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationOptions} options\n */\nol.featureAnimation.Teleport = function(options)\n{\tol.featureAnimation.call(this, options);\n}\nol.ext.inherits(ol.featureAnimation.Teleport, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Teleport.prototype.animate = function (e)\n{\tvar sc = this.easing_(e.elapsed);\n\tif (sc)\n\t{\te.context.save()\n\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\te.context.globalAlpha = sc;\n\t\t\te.context.scale(sc,1/sc);\n\t\t\tvar m = e.frameState.coordinateToPixelTransform;\n\t\t\tvar dx = (1/sc-1) * ratio * (m[0]*e.coord[0] + m[1]*e.coord[1] +m[4]);\n\t\t\tvar dy = (sc-1) * ratio * (m[2]*e.coord[0] + m[3]*e.coord[1] +m[5]);\n\t\t\te.context.translate(dx,dy);\n\t\t\tthis.drawGeom_(e, e.geom);\n\t\te.context.restore()\n\t}\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Slice animation: feature enter from left\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationThrowOptions} options\n *  @param {left|right} options.side side of the animation, default left\n */\nol.featureAnimation.Throw = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.speed_ = options.speed || 0;\n\tthis.side_ = options.side || 'left';\n}\nol.ext.inherits(ol.featureAnimation.Throw, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Throw.prototype.animate = function (e)\n{\t// First time > calculate duration / speed\n\tif (!e.time && this.speed_) \n\t{\tvar dx, dy;\n\t\tif (this.side_=='left')\n\t\t{\tdx = this.dx = e.extent[0]-e.bbox[2];\n\t\t\tdy = this.dy = e.extent[3]-e.bbox[1];\n\t\t}\n\t\telse\n\t\t{\tdx = this.dx = e.extent[2]-e.bbox[0];\n\t\t\tdy = this.dy = e.extent[3]-e.bbox[1];\n\t\t}\n\t\tthis.duration_ = Math.sqrt(dx*dx+dy*dy)/this.speed_/e.frameState.viewState.resolution;\n\t}\n\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tvar shadow = e.geom.clone();\n\tflashGeom.translate(this.dx*(1-this.easing_(e.elapsed)), \n\t\tthis.dy*Math.cos(Math.PI/2*this.easing_(e.elapsed)));\n\tshadow.translate(this.dx*(1-this.easing_(e.elapsed)), 0);\n\tthis.drawGeom_(e, flashGeom, shadow);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Zoom animation: feature zoom in (for points)\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationZoomOptions} options\n *  @param {bool} options.zoomOut to zoom out\n */\nol.featureAnimation.Zoom = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.set('zoomout', options.zoomOut);\n}\nol.ext.inherits(ol.featureAnimation.Zoom, ol.featureAnimation);\n/** Zoom animation: feature zoom out (for points)\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationZoomOptions} options\n */\nol.featureAnimation.ZoomOut = function(options)\n{\toptions = options || {};\n\toptions.zoomOut = true;\n\tol.featureAnimation.Zoom.call(this, options);\n}\nol.ext.inherits(ol.featureAnimation.ZoomOut, ol.featureAnimation.Zoom);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Zoom.prototype.animate = function (e)\n{\tvar fac = this.easing_(e.elapsed);\n\tif (fac)\n\t{\tif (this.get('zoomout')) fac  = 1/fac;\n\t\tvar style = e.style;\n\t\tvar i, imgs, sc=[]\n\t\tfor (i=0; i<style.length; i++)\n\t\t{\timgs = style[i].getImage();\n\t\t\tif (imgs) \n\t\t\t{\tsc[i] = imgs.getScale(); \n\t\t\t\timgs.setScale(sc[i]*fac);\n\t\t\t}\n\t\t}\n\t\te.context.save()\n\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\tvar m = e.frameState.coordinateToPixelTransform;\n\t\t\tvar dx = (1/fac-1)* ratio * (m[0]*e.coord[0] + m[1]*e.coord[1] +m[4]);\n\t\t\tvar dy = (1/fac-1)* ratio * (m[2]*e.coord[0] + m[3]*e.coord[1] +m[5]);\n\t\t\te.context.scale(fac,fac);\n\t\t\te.context.translate(dx,dy);\n\t\t\tthis.drawGeom_(e, e.geom);\n\t\te.context.restore()\n\t\tfor (i=0; i<style.length; i++)\n\t\t{\timgs = style[i].getImage();\n\t\t\tif (imgs) imgs.setScale(sc[i]);\n\t\t}\n\t}\n/*\n\tvar sc = this.easing_(e.elapsed);\n\tif (sc)\n\t{\te.context.save()\n\t\tconsole.log(e)\n\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\tvar m = e.frameState.coordinateToPixelTransform;\n\t\t\tvar dx = (1/(sc)-1)* ratio * (m[0]*e.coord[0] + m[1]*e.coord[1] +m[4]);\n\t\t\tvar dy = (1/(sc)-1)*ratio * (m[2]*e.coord[0] + m[3]*e.coord[1] +m[5]);\n\t\t\te.context.scale(sc,sc);\n\t\t\te.context.translate(dx,dy);\n\t\t\tthis.drawGeom_(e, e.geom);\n\t\te.context.restore()\n\t}\n*/\n\treturn (e.time <= this.duration_);\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/* Namespace */\nol.filter = {};\n/**\n * @classdesc \n * Abstract base class; normally only used for creating subclasses and not instantiated in apps.    \n * Used to create filters    \n * Use {@link _ol_Map_#addFilter}, {@link _ol_Map_#removeFilter} or {@link _ol_Map_#getFilters} to handle filters on a map.\n * Use {@link ol.layer.Base#addFilter}, {@link ol.layer.Base#removeFilter} or {@link ol.layer.Base#getFilters}\n * to handle filters on layers.\n *\n * @constructor\n * @extends {ol.Object}\n * @param {Object} options Extend {@link _ol_control_Control_} options.\n *  @param {boolean} [options.active]\n */\nol.filter.Base = function(options) {\n  ol.Object.call(this);\n  // Array of postcompose listener\n  this._listener = [];\n  if (options && options.active===false) this.set('active', false);\n  else this.set('active', true);\n};\nol.ext.inherits(ol.filter.Base, ol.Object);\n/** Activate / deactivate filter\n*\t@param {boolean} b\n*/\nol.filter.Base.prototype.setActive = function (b) {\n  this.set('active', b===true);\n};\n/** Get filter active\n*\t@return {boolean}\n*/\nol.filter.Base.prototype.getActive = function () {\n  return this.get('active');\n};\n(function(){\n/** Internal function\n* @this {ol.filter} this the filter\n* @private\n*/\nfunction precompose_(e) {\n  if (this.get('active') && e.context) this.precompose(e);\n}\n/** Internal function\n* @this {ol.filter} this the filter\n* @private\n*/\nfunction postcompose_(e) {\n  if (this.get('active') && e.context) this.postcompose(e);\n}\n/** Force filter redraw / Internal function\n* @this {ol.Map|ol.layer.Layer} this: the map or layer the filter is added to\n* @private\n*/\nfunction filterRedraw_() {\n  if (this.renderSync) this.renderSync();\n  else this.changed(); \n}\n/** Add a filter to an ol object\n* @this {ol.Map|ol.layer.Layer} this: the map or layer the filter is added to\n* @private\n*/\nfunction addFilter_(filter) {\n  if (!this.filters_) this.filters_ = [];\n  this.filters_.push(filter);\n  if (filter.precompose) filter._listener.push ( { listener: this.on(['precompose','prerender'], precompose_.bind(filter)), target: this });\n  if (filter.postcompose) filter._listener.push ( { listener: this.on(['postcompose','postrender'], postcompose_.bind(filter)), target: this });\n  filter._listener.push ( { listener: filter.on('propertychange', filterRedraw_.bind(this)), target: this });\n  filterRedraw_.call (this);\n}\n/** Remove a filter to an ol object\n* @this {ol.Map|ol.layer.Layer} this: the map or layer the filter is added to\n* @private\n*/\nfunction removeFilter_(filter) {\n  var i\n  if (!this.filters_) this.filters_ = [];\n  for (i=this.filters_.length-1; i>=0; i--) {\n    if (this.filters_[i]===filter) this.filters_.splice(i,1);\n  }\n  for (i=filter._listener.length-1; i>=0; i--) {\n    // Remove listener on this object\n    if (filter._listener[i].target === this) {\n      ol.Observable.unByKey(filter._listener[i].listener);\n      filter._listener.splice(i,1);\n    }\n  }\n  filterRedraw_.call (this);\n}\n/** Add a filter to an ol.Map\n*\t@param {ol.filter}\n*/\nol.Map.prototype.addFilter = function (filter) {\n  console.warn('[OL-EXT] addFilter deprecated on map.')\n  addFilter_.call (this, filter);\n};\n/** Remove a filter to an ol.Map\n*\t@param {ol.filter}\n*/\nol.Map.prototype.removeFilter = function (filter) {\n  removeFilter_.call (this, filter);\n};\n/** Get filters associated with an ol.Map\n*\t@return {Array<ol.filter>}\n*/\nol.Map.prototype.getFilters = function () {\n  return this.filters_ || [];\n};\n/** Add a filter to an ol.Layer\n*\t@param {ol.filter}\n*/\nol.layer.Base.prototype.addFilter = function (filter) {\n  addFilter_.call (this, filter);\n};\n/** Remove a filter to an ol.Layer\n*\t@param {ol.filter}\n*/\nol.layer.Base.prototype.removeFilter = function (filter) {\n  removeFilter_.call (this, filter);\n};\n/** Get filters associated with an ol.Map\n*\t@return {Array<ol.filter>}\n*/\nol.layer.Base.prototype.getFilters = function () {\n  return this.filters_ || [];\n};\n})();\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Mask drawing using an ol.Feature\n * @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @param {Object} [options]\n *  @param {ol.Feature} [options.feature] feature to mask with\n *  @param {ol.style.Fill} [options.fill] style to fill with\n *  @param {boolean} [options.inner] mask inner, default false\n */\nol.filter.Mask = function(options)\n{\toptions = options || {};\n\tol.filter.Base.call(this, options);\n\tif (options.feature)\n\t{\tswitch (options.feature.getGeometry().getType())\n\t\t{\tcase \"Polygon\":\n\t\t\tcase \"MultiPolygon\":\n\t\t\t\tthis.feature_ = options.feature;\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tthis.set(\"inner\", options.inner);\n\tthis.fillColor_ = options.fill ? ol.color.asString(options.fill.getColor()) || \"rgba(0,0,0,0.2)\" : \"rgba(0,0,0,0.2)\";\n}\nol.ext.inherits(ol.filter.Mask, ol.filter.Base);\n/** Draw the feature into canvas */\nol.filter.Mask.prototype.drawFeaturePath_ = function(e, out)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar ratio = e.frameState.pixelRatio;\n\t// Transform\n\tvar m = e.frameState.coordinateToPixelTransform;\n\tvar tr = function(pt)\n\t{\treturn [\n\t\t\t(pt[0]*m[0]+pt[1]*m[1]+m[4])*ratio,\n\t\t\t(pt[0]*m[2]+pt[1]*m[3]+m[5])*ratio\n\t\t];\n\t}\n\t// Old ol version\n\tif (!m)\n\t{\tm = e.frameState.coordinateToPixelMatrix;\n\t\ttr = function(pt)\n\t\t{\treturn [\n\t\t\t\t(pt[0]*m[0]+pt[1]*m[1]+m[12])*ratio,\n\t\t\t\t(pt[0]*m[4]+pt[1]*m[5]+m[13])*ratio\n\t\t\t];\n\t\t}\n\t}\n\t// Geometry\n\tvar ll = this.feature_.getGeometry().getCoordinates();\n\tif (this.feature_.getGeometry().getType()==\"Polygon\") ll = [ll];\n\tctx.beginPath();\n        if (out)\n\t\t{\tctx.moveTo (0,0);\n\t\t\tctx.lineTo (canvas.width, 0);\n\t\t\tctx.lineTo (canvas.width, canvas.height);\n\t\t\tctx.lineTo (0, canvas.height);\n\t\t\tctx.lineTo (0, 0);\n\t\t}\n\t\tfor (var l=0; l<ll.length; l++)\n\t\t{\tvar c = ll[l];\n\t\t\tfor (var i=0; i<c.length; i++) \n\t\t\t{\tvar pt = tr(c[i][0]);\n\t\t\t\tctx.moveTo (pt[0], pt[1]);\n\t\t\t\tfor (var j=1; j<c[i].length; j++) \n\t\t\t\t{\tpt = tr(c[i][j]);\n\t\t\t\t\tctx.lineTo (pt[0], pt[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n}\nol.filter.Mask.prototype.postcompose = function(e)\n{\tif (!this.feature_) return;\n\tvar ctx = e.context;\n\tctx.save();\n\t\tthis.drawFeaturePath_(e, !this.get(\"inner\"));\n\t\tctx.fillStyle = this.fillColor_;\n\t\tctx.fill(\"evenodd\");\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Clip layer or map\n*  @constructor\n* @requires ol.filter\n* @extends {ol.filter.Base}\n* @param {Object} [options]\n*  @param {Array<ol.Coordinate>} [options.coords]\n*  @param {ol.Extent} [options.extent]\n*  @param {string} [options.units] coords units percent (%) or pixel (px)\n*  @param {boolean} [options.keepAspectRatio] keep aspect ratio\n*  @param {string} [options.color] backgroundcolor\n*/\nol.filter.Clip = function(options)\n{\toptions = options || {};\n\tol.filter.Base.call(this, options);\n\tthis.set(\"coords\", options.coords);\n\tthis.set(\"units\", options.units);\n\tthis.set(\"keepAspectRatio\", options.keepAspectRatio);\n\tthis.set(\"extent\", options.extent || [0,0,1,1]);\n\tthis.set(\"color\", options.color);\n\tif (!options.extent && options.units!=\"%\" && options.coords)\n\t{\tvar xmin = Infinity;\n\t\tvar ymin = Infinity;\n\t\tvar xmax = -Infinity;\n\t\tvar ymax = -Infinity;\n\t\tfor (var i=0, p; p=options.coords[i]; i++)\n\t\t{\tif (xmin > p[0]) xmin = p[0];\n\t\t\tif (xmax < p[0]) xmax = p[0];\n\t\t\tif (ymin > p[1]) ymin = p[1];\n\t\t\tif (ymax < p[1]) ymax = p[1];\n\t\t}\n\t\toptions.extent = [xmin,ymin,xmax,ymax];\n\t}\n}\nol.ext.inherits(ol.filter.Clip, ol.filter.Base);\nol.filter.Clip.prototype.clipPath_ = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar coords = this.get(\"coords\");\n\tif (!coords) return;\n\tvar ex = this.get('extent');\n\tvar scx = 1, scy = 1;\n\tif (this.get(\"units\")==\"%\") \n\t{\tscx = canvas.width/(ex[2]-ex[0]);\n\t\tscy = canvas.height/(ex[3]-ex[1]);\n\t}\n\tif (this.get(\"keepAspectRatio\")) \n\t{\tscx = scy = Math.min (scx, scy);\n\t}\n\tvar pos = this.get('position');\n\tvar dx=0, dy=0;\n\tif (/left/.test(pos)) \n\t{\tdx = -ex[0]*scx;\n\t}\n\telse if (/center/.test(pos)) \n\t{\tdx = canvas.width/2 - (ex[2]-ex[0])*scx/2;\n\t}\n\telse if (/right/.test(pos)) \n\t{\tdx = canvas.width - (ex[2]-ex[0])*scx;\n\t}\n\tvar fx = function(x) { return x*scx + dx };\n\tif (/top/.test(pos)) \n\t{\tdy = -ex[1]*scy;\n\t}\n\telse if (/middle/.test(pos)) \n\t{\tdy = canvas.height/2 - (ex[3]-ex[1])*scy/2;\n\t}\n\telse if (/bottom/.test(pos)) \n\t{\tdy = canvas.height - (ex[3]-ex[1])*scy;\n\t}\n\tvar fy = function(y) { return y*scy + dy; };\n\tctx.moveTo ( fx(coords[0][0]), fy(coords[0][1]) );\n\tfor (var i=1, p; p=coords[i]; i++) \n\t{\tctx.lineTo ( fx(p[0]), fy(p[1]) );\n\t}\n\tctx.lineTo ( fx(coords[0][0]), fy(coords[0][1]) );\n};\nol.filter.Clip.prototype.precompose = function(e)\n{\tif (!this.get(\"color\"))\n\t{\te.context.save();\n\t\te.context.beginPath();\n\t\tthis.clipPath_(e);\n\t\te.context.clip();\n\t}\n}\nol.filter.Clip.prototype.postcompose = function(e)\n{\tif (this.get(\"color\"))\n\t{\tvar ctx = e.context;\n\t\tvar canvas = e.context.canvas;\n\t\tctx.save();\n\t\tctx.beginPath();\n\t\tctx.moveTo(0,0);\n\t\tctx.lineTo(0,canvas.height);\n\t\tctx.lineTo(canvas.width, canvas.height);\n\t\tctx.lineTo(canvas.width, canvas.height);\n\t\tctx.lineTo(canvas.width, 0);\n\t\tctx.lineTo(0, 0);\n\t\tthis.clipPath_(e);\n\t\tctx.fillStyle = this.get(\"color\");\n\t\tctx.fill(\"evenodd\");\n\t}\n\te.context.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** @typedef {Object} FilterColorizeOptions\n *  @property {ol.Color} color style to fill with\n *  @property {string} operation 'enhance' or a CanvasRenderingContext2D.globalCompositeOperation\n *  @property {number} value a [0-1] value to modify the effect value\n *  @property {boolean} inner mask inner, default false\n */\n/** Colorize map or layer\n * @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @author Thomas Tilak https://github.com/thhomas\n * @author Jean-Marc Viglino https://github.com/viglino\n * @param {FilterColorizeOptions} options\n */\nol.filter.Colorize = function(options)\n{\tol.filter.Base.call(this, options);\n\tthis.setFilter(options);\n}\nol.ext.inherits(ol.filter.Colorize, ol.filter.Base);\n/** Set options to the filter\n * @param {FilterColorizeOptions} [options]\n */\nol.filter.Colorize.prototype.setFilter = function(options)\n{\toptions = options || {};\n\tswitch (options)\n\t{\tcase \"grayscale\": options = { operation:'hue', red:0, green:0, blue:0, value:1 }; break;\n\t\tcase \"invert\": options = { operation:'difference', red:255, green:255, blue:255, value:1 }; break;\n\t\tcase \"sepia\": options = { operation:'color', red:153, green:102, blue:51, value:0.6 }; break;\n\t\tdefault: break;\n\t}\n\tvar color = options.color ? ol.color.asArray(options.color) : [ options.red, options.green, options.blue, options.value];\n\tthis.set('color', ol.color.asString(color))\n\tthis.set ('value', color[3]||1);\n\tvar v;\n\tswitch (options.operation)\n\t{\tcase 'color':\n\t\tcase 'hue':\n\t\tcase 'difference':\n\t\tcase 'color-dodge':\n\t\tcase 'enhance':\n\t\t\tthis.set ('operation', options.operation);\n\t\t\tbreak;\n\t\tcase 'saturation':\n\t\t\tv = 255*(options.value || 0);\n\t\t\tthis.set('color', ol.color.asString([0,0,v,v||1]));\n\t\t\tthis.set ('operation', options.operation);\n\t\t\tbreak;\n\t\tcase 'luminosity':\n\t\t\tv = 255*(options.value || 0);\n\t\t\tthis.set('color', ol.color.asString([v,v,v,255]));\n\t\t\t//this.set ('operation', 'luminosity')\n\t\t\tthis.set ('operation', 'hard-light');\n\t\t\tbreak;\n\t\tcase 'contrast':\n\t\t\tv = 255*(options.value || 0);\n\t\t\tthis.set('color', ol.color.asString([v,v,v,255]));\n\t\t\tthis.set('operation', 'soft-light');\n\t\t\tbreak;\n\t\tdefault: \n\t\t\tthis.set ('operation', 'color');\n\t\t\tbreak;\n\t}\n}\n/** Set the filter value\n *  @param {ol.Color} options.color style to fill with\n */\nol.filter.Colorize.prototype.setValue = function(v)\n{\tthis.set ('value', v);\n\tvar c = ol.color.asArray(this.get(\"color\"));\n\tc[3] = v;\n\tthis.set(\"color\", ol.color.asString(c));\n}\n/** Set the color value\n *  @param {number} options.value a [0-1] value to modify the effect value\n */\nol.filter.Colorize.prototype.setColor = function(c)\n{\tc = ol.color.asArray(c);\n\tif (c)\n\t{\tc[3] = this.get(\"value\");\n\t\tthis.set(\"color\", ol.color.asString(c));\n\t}\n}\n/** @private \n */\nol.filter.Colorize.prototype.precompose = function(/* e */) {\n}\n/** @private \n */\nol.filter.Colorize.prototype.postcompose = function(e) {\n\t// Set back color hue\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\t\tif (this.get('operation')=='enhance')\n\t\t{\tvar v = this.get('value');\n\t\t\tif (v)\n\t\t\t{\tvar w = canvas.width;\n\t\t\t\tvar h = canvas.height;\n\t\t\t\tctx.globalCompositeOperation = 'color-burn'\n\t\t\t\tctx.globalAlpha = v;\n\t\t\t\tctx.drawImage (canvas, 0, 0, w, h);\n\t\t\t\tctx.drawImage (canvas, 0, 0, w, h);\n\t\t\t\tctx.drawImage (canvas, 0, 0, w, h);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\tctx.globalCompositeOperation = this.get('operation');\n\t\t\tctx.fillStyle = this.get('color');\n\t\t\tctx.fillRect(0,0,canvas.width,canvas.height);  \n\t\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Colorize map or layer\n* @constructor\n* @requires ol.filter\n* @extends {ol.filter.Base}\n* @param {Object} options\n*   @param {string} options.operation composite operation\n*/\nol.filter.Composite = function(options)\n{\tol.filter.Base.call(this, options);\n\tthis.set(\"operation\", options.operation || \"source-over\");\n}\nol.ext.inherits(ol.filter.Composite, ol.filter.Base);\n/** Change the current operation\n*\t@param {string} operation composite function\n*/\nol.filter.Composite.prototype.setOperation = function(operation)\n{\tthis.set('operation', operation || \"source-over\");\n}\nol.filter.Composite.prototype.precompose = function(e)\n{\tvar ctx = e.context;\n\tctx.save();\n\tctx.globalCompositeOperation = this.get('operation');\n}\nol.filter.Composite.prototype.postcompose = function(e)\n{\te.context.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Crop drawing using an ol.Feature\n* @constructor\n* @requires ol.filter\n* @requires ol.filter.Mask\n* @extends {ol.filter.Mask}\n* @param {Object} [options]\n*  @param {ol.Feature} [options.feature] feature to crop with\n*  @param {boolean} [options.inner=false] mask inner, default false\n*/\nol.filter.Crop = function(options) {\n  options = options || {};\n  ol.filter.Mask.call(this, options);\n}\nol.ext.inherits(ol.filter.Crop, ol.filter.Mask);\nol.filter.Crop.prototype.precompose = function(e) {\n  if (!this.feature_) return;\n  var ctx = e.context;\n  ctx.save();\n  this.drawFeaturePath_(e, this.get(\"inner\"));\n  ctx.clip(\"evenodd\");\n}\nol.filter.Crop.prototype.postcompose = function(e) {\n  if (this.feature_) e.context.restore();\n}\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Fold filer map\n* @constructor\n* @requires ol.filter\n* @extends {ol.filter.Base}\n* @param {Object} [options]\n*  @param {Array<number>} [options.fold] number of fold (horizontal and vertical)\n*  @param {number} [options.margin] margin in px, default 8\n*  @param {number} [options.padding] padding in px, default 8\n*  @param {number|number[]} [options.fsize] fold size in px, default 8,10\n*/\nol.filter.Fold = function(options) {\n  options = options || {};\n  ol.filter.Base.call(this, options);\n  this.set(\"fold\", options.fold || [8,4]);\n  this.set(\"margin\", options.margin || 8);\n  this.set(\"padding\", options.padding || 8);\n  if (typeof options.fsize == \"number\") options.fsize = [options.fsize,options.fsize];\n  this.set(\"fsize\", options.fsize || [8,10]);\n};\nol.ext.inherits(ol.filter.Fold, ol.filter.Base);\nol.filter.Fold.prototype.drawLine_ = function(ctx, d, m) {\n  var canvas = ctx.canvas;\n  var fold = this.get(\"fold\");\n  var w = canvas.width;\n  var h = canvas.height;\n  var x, y, i;\n  ctx.beginPath();\n  ctx.moveTo ( m, m );\n  for (i=1; i<=fold[0]; i++) {\n    x = i*w/fold[0] - (i==fold[0] ? m : 0);\n    y =  d[1]*(i%2) +m;\n    ctx.lineTo ( x, y );\n  }\n  for (i=1; i<=fold[1]; i++) {\n    x = w - d[0]*(i%2) - m;\n    y = i*h/fold[1] - (i==fold[1] ? d[0]*(fold[0]%2) + m : 0);\n    ctx.lineTo ( x, y );\n  }\n  for (i=fold[0]; i>0; i--) {\n    x = i*w/fold[0] - (i==fold[0] ? d[0]*(fold[1]%2) + m : 0);\n    y = h - d[1]*(i%2) -m;\n    ctx.lineTo ( x, y );\n  }\n  for (i=fold[1]; i>0; i--) {\n    x = d[0]*(i%2) + m;\n    y = i*h/fold[1] - (i==fold[1] ? m : 0);\n    ctx.lineTo ( x, y );\n  }\n  ctx.closePath();\n};\nol.filter.Fold.prototype.precompose = function(e) {\n  var ctx = e.context;\n  ctx.save();\n    ctx.shadowColor = \"rgba(0,0,0,0.3)\";\n    ctx.shadowBlur = 8;\n    ctx.shadowOffsetX = 2;\n    ctx.shadowOffsetY = 3;\n    this.drawLine_(ctx, this.get(\"fsize\"), this.get(\"margin\"));\n    ctx.fillStyle=\"#fff\";\n    ctx.fill();\n    ctx.strokeStyle = \"rgba(0,0,0,0.1)\";\n    ctx.stroke();\n  ctx.restore();\n  ctx.save();\n    this.drawLine_(ctx, this.get(\"fsize\"), this.get(\"margin\") + this.get(\"padding\"));\n    ctx.clip();\n};\nol.filter.Fold.prototype.postcompose = function(e) {\n  var ctx = e.context;\n  var canvas = ctx.canvas;\n  ctx.restore();\n  ctx.save();\n    this.drawLine_(ctx, this.get(\"fsize\"), this.get(\"margin\"));\n    ctx.clip();\n    var fold = this.get(\"fold\");\n    var w = canvas.width/fold[0];\n    var h = canvas.height/fold[1];\n    var grd = ctx.createRadialGradient(5*w/8,5*w/8,w/4,w/2,w/2,w);\n    grd.addColorStop(0,\"transparent\");\n    grd.addColorStop(1,\"rgba(0,0,0,0.2)\");\n    ctx.fillStyle = grd;\n    ctx.scale (1,h/w);\n    for (var i=0; i<fold[0]; i++) for (var j=0; j<fold[1]; j++) {\n      ctx.save()\n      ctx.translate(i*w, j*w);\n      ctx.fillRect(0,0,w,w);\n      ctx.restore()\n    }\n  ctx.restore();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Make a map or layer look like made of a set of Lego bricks.\n *  @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @param {Object} [options]\n *  @param {string} [options.img]\n *  @param {number} [options.brickSize] size of te brick, default 30\n *  @param {null | string | undefined} [options.crossOrigin] crossOrigin attribute for loaded images.\n */\nol.filter.Lego = function(options)\n{\tif (!options) options = {};\n\tol.filter.Base.call(this, options);\n\tvar img = new Image();\n\t// Default image\n\timg.src = this.img[options.img] || this.img.ol3;\n\timg.crossOrigin = options.crossOrigin || null;\n\t// and pattern \n\tthis.pattern = \n\t{\tcanvas: document.createElement('canvas')\n\t};\n\tthis.setBrick (options.brickSize, img);\n\tthis.internal_ = document.createElement('canvas');\n}\nol.ext.inherits(ol.filter.Lego, ol.filter.Base);\n/** Image definition\n*/\nol.filter.Lego.prototype.img =\n{\tbrick: \"data:image/png;base64,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\",\n\tol3: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAAD10AAA9dAah0GUAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAHtUlEQVRo3sWZTWxcVxXHf/d9zIztcTz+pE6cOHXiyLJJadKgKE2oCBLlQwIWSCxYI0WiGxZZIYRAArFAYoEEi0hIsGBBURd0g4iK2lJAaWlaojZVKkU0H26cxB8Zz/f7uPeweHdebDLPnqlQ5l2N5/mN7tz/+Z//OffcM4rPUKCPl0eBAqqfAEAt5Ia1LwCuAg93CyCnAzgj7TstEKMluW+/x0AsWmKBmFggTu4lIpYome2Qw0kA8I2xL9T2Bp5COY6ncJRSDkopFEolANowBEAEATGIGBEkFjEiYkQbI0ZrMaFobYwxkY51pOumpSNTiau6bm7oZX1NP4Ai+ylYADkmGqUPxwSUQsG2ZbcDsBAA2QoGkeSvSZ4kr/alDcRGSyyxbJqqvG5+pHAwbRegVMz+leTBY7qcbTee8vsmQycRmnL6CkD1G4DXFl0fGegvANfpnws8+947AwqFg2MDSjAYzJY80QuAHl2gcPDJF3PiDLiimtIQC0ETEhD3klE8AJeuASg8CgeHir7vLBVOjwypQK3plyoromRNtzSamJg6QbcgvJ7C0J0YnCweG/jek/Ozw5q6bEiFiIHz+wNWBv68+rPNmlQjYnKE1Ai6cYfXA/W5Q6Uvl84f3zel3vH+SIDYoVAeofOdqa9PvbHn/PoDHYZ4eDSpE3fJgLs79YXToz858uxJ5+/en4jQ6hHr5OPZlZHhpcM/4BUv9PFw8agQdQVg1+UHnx/75fG5Gf83lFWGVUrQsmmu/HBsbN8f3Mi1MVLeGUJ3Lig8P/a7s5MN97c01I5+VUIk91err0/fLqFwgBHKOzmimzyQPzX2q1OTZfeianUVKCLNr93EZxiFIOyhnB0Tu6vf/XTp54uzY+4r3S1veYj5CEPBjqFsA3cDoEaLXy199rj/Is0eM2XILXzy5MkzSO6TAvAOFF84qf5KRfWYYhE2aJCzI5MDbxf7B58pTpf89x8qX1yWGKXKFaUBZIF1tWo/KzJPiYi3VAgYbrFEnpiYiBzBTgx0ts99YvDcvHr7YSBJka/Q4k1u3jz5eQ/EYebkXvL241NUeZN/31gkDwibhHjk8PGzTh+OrWw7X/6g/+TB8nuJrQCc4Z/KU08rb+1f/1gCSqy9NUNoP72txtXRb40dfJ+nkgMEZTw78riZLhDRndNP3vGG9GBKnRzhrppmilfhmcWoRYkxyuxv86euUaT24h4W2WN53WQmheB1ygc7MaCKuc+N5LeW6wfOXeUorwFQZIV5RlnbNqcGjBMyaAFUcfHwcHHxOznBakA6JQq34B4dkXtt+8QjvnCQa/Z/jxpFCmdbpPSJI7NyhMVzK/j2UQuFi4OLkz57FECcIcGCU8yZeirQvdxjjuvpTKGAem2EcjpjkjnUC5cvfIm/bRG3Y4e7AwOmEwPKOJotfhvlPj61dGaBEChtAdD88Yeq9et1LqWOUTj2lYzOItSmcxi2ZDXUw+k0n0bqDoXDJBsMM8rHKeIKFbxgIV9nL3cSFlPpZQBoa6AjgCYXK2YkndbckkxmWWfu2D00ozzYNinOlagwbRct/k92zNJARxFK01yur/mX2wDWGE0jfuHyNfa+Y6hQYNsmJQ45hqwwFaPpOVo6s2zDsCMDgsBq2sBR9xj8ZvX70+LJc9w+scA1Sjz49rjMy7zMywE5IY64PMcNDlkHKCbt9xhMZwhOooGODGhMzVyqTUxIm4Pll9797ixnWFZ3WORdSqz//hI+Pv7LT5dXOcNZltUa49y3qplC0Hb5uBMAbwcGDKYS/eLu6YMfrSZCUhWY+QCfGZ7iZYRbarSdYMfd0bvXazh8ii/yF2vcAVwitB1hZirWnROREFLYjN4uLQ5QTZ/WmeA2VwDUHbBks351HRxK3OaqtTTHEQwxmpjkxJApQh111kBAvBH+9O7y/KveFsfcYyNj82qywqZdxmWBAjEREbHdkrNEqNE6o6qJiVeiC4UPHuqg20PvExxGE6YAWp2jwEvabmIyqpoGuTB4ozEwd6lKvYflRzgBBIQWQrQjAG2MZABoEeJH4UU3N8f1rC/psPyz+AQWQEhIK6s09wACk+EC0NTwcCM3KrDAf6ihd6ui2ccxcrRoEaQg6lnQPYDYSLZlAS1cXBzyLHGfW0SZPDgMscgBDK10BARUs48mVgNxtl2GKh6ObVpOM8Uy94hsZpe0nakoMMdhPGJreRtAg9YuJ6NIwp18G7OJsilVyHGIQ2yySZ0WIYocQ+xhknEUhiYRoQUQ0KJBbSfleAChjvQuh4wypbQLovEpMWHrnPY2K0RoG/eR5SCgQXVn1SQAJNpNWiFlhm0+i8jZIrMNoN0j0jbhJMoPaOwu2sQFJt69oRKyadNqTGQBOFsAiM34CQchIdVuwtYyEOgu4jumQosiEX5a6aq0S9Z2T2zTThfdkS0MRN21lISAiBwD5KwDnLReStp0MZomrc4bTyaAhql131gztAhw8cnhWxeIBRASEWbVPju5wAS9/VYgdnthGwPSe5uynYqlpun9EuCTzHt0O67r5uP8teRRAC25H/cXgNmQvgKomhXdLwB2M7pu0pTyeK70mJYUm251sLfo/T8AGEoKes8eIGZ43E5wk36BBwhO2mbqgwZa9C0CAP4LFLGzNDDzmrAAAAAASUVORK5CYII=\",\n\tlego: \"data:image/png;base64,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\"\n};\n/** Overwrite to handle brickSize\n* @param {string} key\n* @param {any} val\n*/\nol.filter.Lego.prototype.set = function (key, val)\n{\tol.filter.Base.prototype.set.call(this, key, val);\n\tif (key==\"brickSize\" && this.pattern.canvas.width!=val)\n\t{\tthis.setBrick(val);\n\t}\n}\n/** Set the current brick\n*\t@param {number} width the pattern width, default 30\n*\t@param {'brick'|'ol3'|'lego'|undefined} img the pattern, default ol3\n*\t@param {string} crossOrigin\n*/\nol.filter.Lego.prototype.setBrick = function (width, img, crossOrigin)\n{\twidth = Number(width) || 30;\n\tif (typeof(img) === 'string')\n\t{\tvar i = new Image;\n\t\ti.src = this.img[img] || this.img.ol3;\n\t\ti.crossOrigin = crossOrigin || null;\n\t\timg = i;\n\t}\n\tif (img) this.pattern.img = img;\n\tif (!this.pattern.img.width)\n\t{\tvar self = this;\n\t\tthis.pattern.img.onload = function()\n\t\t{\tself.setBrick(width,img);\n\t\t}\n\t\treturn;\n\t}\n\tthis.pattern.canvas.width = this.pattern.canvas.height = width;\n\tthis.pattern.ctx = this.pattern.canvas.getContext(\"2d\");\n\tthis.pattern.ctx.fillStyle = this.pattern.ctx.createPattern (this.pattern.img, 'repeat');\n\tthis.set(\"brickSize\", width);\n\tthis.set(\"img\", img.src);\n};\n/** Get translated pattern\n*\t@param {number} offsetX x offset\n*\t@param {number} offsetY y offset\n*/\nol.filter.Lego.prototype.getPattern = function (offsetX, offsetY)\n{\t\n\tif (!this.pattern.ctx) return \"transparent\";\n\t//return this.pattern.ctx.fillStyle\n\tvar c = this.pattern.canvas;\n\tvar ctx = this.pattern.ctx;\n\tvar sc = c.width / this.pattern.img.width;\n\tctx.save();\n\t\tctx.clearRect(0,0,c.width,c.height);\n\t\tctx.scale(sc,sc);\n\t\toffsetX /= sc;\n\t\toffsetY /= sc;\n\t\tctx.translate(offsetX, offsetY);\n\t\tctx.beginPath();\n\t\tctx.clearRect(-2*c.width, -2*c.height, 4*c.width, 4*c.height);\n\t\tctx.rect(-offsetX, -offsetY, 2*c.width/sc, 2*c.height/sc);\n\t\tctx.fill(); \n\tctx.restore();\n\treturn ctx.createPattern(c, 'repeat');\n};\n/** Postcompose operation\n*/\nol.filter.Lego.prototype.postcompose = function(e)\n{\t// Set back color hue\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\t\t// resize \n\t\tvar step = this.pattern.canvas.width*ratio;\n\t\tvar p = e.frameState.extent;\n\t\tvar res = e.frameState.viewState.resolution/ratio;\n\t\tvar offset = [ -Math.round((p[0]/res)%step), Math.round((p[1]/res)%step) ];\n\t\tvar ctx2 = this.internal_.getContext(\"2d\");\n\t\tvar w = this.internal_.width = canvas.width;\n\t\tvar h = this.internal_.height = canvas.height;\n\t\t// No smoothing please\n\t\tctx2.webkitImageSmoothingEnabled =\n\t\tctx2.mozImageSmoothingEnabled =\n\t\tctx2.msImageSmoothingEnabled =\n\t\tctx2.imageSmoothingEnabled = false;\n\t\tvar w2 = Math.floor((w-offset[0])/step);\n\t\tvar h2 = Math.floor((h-offset[1])/step);\n\t\tctx2.drawImage (canvas, offset[0], offset[1], w2*step, h2*step, 0, 0, w2, h2);\n\t\t//\n\t\tctx.webkitImageSmoothingEnabled =\n\t\tctx.mozImageSmoothingEnabled =\n\t\tctx.msImageSmoothingEnabled =\n\t\tctx.imageSmoothingEnabled = false;\n\t\tctx.clearRect (0, 0, w,h);\n\t\tctx.drawImage (this.internal_, 0,0, w2,h2, offset[0],offset[1], w2*step, h2*step);\n/*\n\t\tfor (var x=offset[0]; x<w; x+=step) for (var y=offset[1]; y<h; y+=step)\n\t\t{\tif (x>=0 && y<h) ctx2.drawImage (canvas, x, y, 1, 1, x, y, step, step);\n\t\t}\n\t\tctx.clearRect (0, 0, w,h);\n\t\tctx.drawImage (c, 0, 0);\n*/\n\t\t// Draw brick stud\n\t\tctx.scale(ratio,ratio);\n\t\tctx.fillStyle = this.getPattern (offset[0]/ratio, offset[1]/ratio);\n\t\tctx.rect(0,0, w, h);\n\t\tctx.fill(); \n\tctx.restore();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** @typedef {Object} FilterTextureOptions\n *  @property {Image | undefined} img Image object for the texture\n *  @property {string} src Image source URI\n *  @property {number} scale scale to draw the image. Default 1.\n *  @property {number} [opacity]\n *  @property {boolean} rotate Whether to rotate the texture with the view (may cause animation lags on mobile or slow devices). Default is true.\n *  @property {null | string | undefined} crossOrigin The crossOrigin attribute for loaded images.\n */\n/** Add texture effects on maps or layers\n * @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @param {FilterTextureOptions} options\n */\nol.filter.Texture = function(options)\n{\tol.filter.Base.call(this, options);\n\tthis.setFilter(options);\n}\nol.ext.inherits(ol.filter.Texture, ol.filter.Base);\n/** Set texture\n * @param {FilterTextureOptions} [options]\n */\nol.filter.Texture.prototype.setFilter = function(options)\n{\tvar img;\n\toptions = options || {};\n\tif (options.img) img = options.img;\n\telse \n\t{\timg = new Image();\n\t\tif (options.src) {\n\t\t\t// Look for a texture stored in ol.filter.Texture.Image\n\t\t\tif (ol.filter.Texture.Image && ol.filter.Texture.Image[options.src]) {\n\t\t\t\timg.src = ol.filter.Texture.Image[options.src];\n\t\t\t} \n\t\t\t// default source\n\t\t\telse {\n\t\t\t\tif (!img.src) img.src = options.src;\n\t\t\t}\n\t\t}\n\t\timg.crossOrigin = options.crossOrigin || null;\n\t}\n\tthis.set('rotateWithView', options.rotateWithView !== false);\n\tthis.set('opacity', typeof(options.opacity)=='number' ? options.opacity : 1);\n\tthis.set('ready', false);\n\tvar self = this;\n\tfunction setPattern(img)\n\t{\tself.pattern = {};\n\t\tself.pattern.scale = options.scale || 1;\n\t\tself.pattern.canvas = document.createElement('canvas');\n\t\tself.pattern.canvas.width = img.width * self.pattern.scale;\n\t\tself.pattern.canvas.height = img.height * self.pattern.scale;\n\t\tself.pattern.canvas.width = img.width;// * self.pattern.scale;\n\t\tself.pattern.canvas.height = img.height;// * self.pattern.scale;\n\t\tself.pattern.ctx = self.pattern.canvas.getContext(\"2d\");\n\t\tself.pattern.ctx.fillStyle = self.pattern.ctx.createPattern(img, 'repeat');\n\t\t// Force refresh\n\t\tself.set('ready', true);\n\t}\n\tif (img.width) \n\t{\tsetPattern(img);\n\t}\n\telse\n\t{\timg.onload = function()\n\t\t{\tsetPattern(img);\n\t\t}\n\t}\n}\n/** Get translated pattern\n *\t@param {number} offsetX x offset\n *\t@param {number} offsetY y offset\n */\nol.filter.Texture.prototype.getPattern = function (offsetX, offsetY)\n{\tvar c = this.pattern.canvas;\n\tvar ctx = this.pattern.ctx;\n\tctx.save();\n\t/*\n\t\toffsetX /= this.pattern.scale;\n\t\toffsetY /= this.pattern.scale;\n\t\tctx.scale(this.pattern.scale,this.pattern.scale);\n\t*/\n\t\tctx.translate(-offsetX, offsetY);\n\t\tctx.beginPath();\n\t\tctx.rect(offsetX, -offsetY, c.width, c.height);\n\t\tctx.fill();\n\tctx.restore();\n\treturn ctx.createPattern(c, 'repeat');\n}\n/** Draw pattern over the map on postcompose */\nol.filter.Texture.prototype.postcompose = function(e)\n{\t// not ready\n\tif (!this.pattern) return;\n\t// Set back color hue\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar m = 1.5 * Math.max(canvas.width, canvas.height);\n\tvar mt = e.frameState.pixelToCoordinateTransform;\n\t// Old version (matrix)\n\tif (!mt)\n\t{\tmt = e.frameState.pixelToCoordinateMatrix,\n\t\tmt[2] = mt[4];\n\t\tmt[3] = mt[5];\n\t\tmt[4] = mt[12];\n\t\tmt[5] = mt[13];\n\t}\n\tvar ratio = e.frameState.pixelRatio;\n\tvar res = e.frameState.viewState.resolution;\n\tvar w = canvas.width/2, \n\t\th = canvas.height/2;\n\tctx.save();\n\t\tctx.globalCompositeOperation = \"multiply\";\n\t\t//ctx.globalCompositeOperation = \"overlay\";\n\t\t//ctx.globalCompositeOperation = \"color\";\n\t\tctx.globalAlpha = this.get('opacity');\n\t\tctx.scale(ratio*this.pattern.scale,ratio*this.pattern.scale);\n\t\tif (this.get('rotateWithView'))\n\t\t{\t// Translate pattern\n\t\t\tres *= this.pattern.scale\n\t\t\tctx.fillStyle = this.getPattern ((w*mt[0] + h*mt[1] + mt[4])/res, (w*mt[2] + h*mt[3] + mt[5])/res);\n\t\t\t// Rotate on canvas center and fill\n\t\t\tctx.translate(w/this.pattern.scale, h/this.pattern.scale);\n\t\t\tctx.rotate(e.frameState.viewState.rotation);\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(-w-m, -h-m, 2*m, 2*m);\n\t\t\tctx.fill(); \n\t\t}\n\t\telse\n\t\t{\n\t\t\t/**/\n\t\t\t\tvar dx = -(w*mt[0] + h*mt[1] + mt[4])/res;\n\t\t\t\tvar dy = (w*mt[2] + h*mt[3] + mt[5])/res;\n\t\t\t\tvar cos = Math.cos(e.frameState.viewState.rotation);\n\t\t\t\tvar sin = Math.sin(e.frameState.viewState.rotation);\n\t\t\t\tvar offsetX = (dx*cos - dy*sin) / this.pattern.scale;\n\t\t\t\tvar offsetY = (dx*sin + dy*cos) / this.pattern.scale;\n\t\t\t\tctx.translate(offsetX, offsetY);\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.fillStyle = this.pattern.ctx.fillStyle;\n\t\t\t\tctx.rect(-offsetX -m , -offsetY -m, 2*m, 2*m);\n\t\t\t\tctx.fill(); \n\t\t\t/*\t//old version without centered rotation\n\t\t\t\tvar offsetX = -(e.frameState.extent[0]/res) % this.pattern.canvas.width;\n\t\t\t\tvar offsetY = (e.frameState.extent[1]/res) % this.pattern.canvas.height;\n\t\t\t\tctx.rotate(e.frameState.viewState.rotation);\n\t\t\t\tctx.translate(offsetX, offsetY);\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.fillStyle = this.pattern.ctx.fillStyle\n\t\t\t\tctx.rect(-offsetX -m , -offsetY -m, 2*m, 2*m);\n\t\t\t\tctx.fill(); \n\t\t\t*/\n\t\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Handles coordinates on the center of the viewport.\n * It can be used as abstract base class used for creating subclasses. \n * The CenterTouch interaction modifies map browser event coordinate and pixel properties to force pointer on the viewport center to any interaction that them.\n * Only pointermove pointerup are concerned with it.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.InteractionOptions} options Options\n *  - targetStyle {ol.style.Style|Array<ol.style.Style>} a style to draw the target point, default cross style\n *  - composite {string} composite operation : difference|multiply|xor|screen|overlay|darken|lighter|lighten|...\n */\nol.interaction.CenterTouch = function(options)\n{\toptions = options || {};\n\t// LIst of listerner on the object\n\tthis._listener = {};\n\t// Filter event\n\tvar rex = /^pointermove$|^pointerup$/;\n\t// Default style = cross\n\tthis.targetStyle = options.targetStyle ||\n\t\t[\tnew ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#fff\", width:3 }) }) }),\n\t\t\tnew ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#000\", width:1 }) }) })\n\t\t];\n\tif (!(this.targetStyle instanceof Array)) this.targetStyle = [this.targetStyle];\n\tthis.composite = options.composite || '';\n\t// Interaction to defer center on top of the interaction \n\t// this is done to enable other coordinates manipulation inserted after the interaction (snapping)\n\tthis.ctouch = new ol.interaction.Interaction(\n\t\t{\thandleEvent: function(e) \n\t\t\t\t{\tif (rex.test(e.type) && this.getMap()) \n\t\t\t\t\t{\te.coordinate = this.getMap().getView().getCenter();\n\t\t\t\t\t\te.pixel = this.getMap().getSize();\n\t\t\t\t\t\te.pixel = [ e.pixel[0]/2, e.pixel[1]/2 ];\n\t\t\t\t\t}\n\t\t\t\t\treturn true; \n\t\t\t\t}\n\t\t});\n\tol.interaction.Interaction.call(this,\n\t\t{\thandleEvent: function(e) \n\t\t\t{\tif (rex.test(e.type)) this.pos_ = e.coordinate;\n\t\t\t\tif (options.handleEvent) return options.handleEvent.call (this,e);\n\t\t\t\treturn true; \n\t\t\t}\n\t\t});\n};\nol.ext.inherits(ol.interaction.CenterTouch, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.interaction.CenterTouch.prototype.setMap = function(map)\n{\tif (this.getMap())\n\t{\tthis.getMap().removeInteraction(this.ctouch);\n\t}\n\tif (this._listener.drawtarget) ol.Observable.unByKey(this._listener.drawtarget);\n\tthis._listener.drawtarget = null;\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tif (this.getMap())\n\t{\tif (this.getActive()) this.getMap().addInteraction(this.ctouch);\n\t\tthis._listener.drawtarget = this.getMap().on('postcompose', this.drawTarget_.bind(this));\n\t}\n};\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.CenterTouch.prototype.setActive = function(b)\n{\tol.interaction.Interaction.prototype.setActive.call (this, b);\n\tthis.pos_ = null;\n\tif (this.getMap())\n\t{\tif (this.getActive()) \n\t\t{\tthis.getMap().addInteraction(this.ctouch);\n\t\t}\n\t\telse this.getMap().removeInteraction(this.ctouch);\n\t}\n};\n/** Get the position of the target\n * @return {ol.coordinate}\n */\nol.interaction.CenterTouch.prototype.getPosition = function ()\n{\tif (!this.pos_) \n\t{\tvar px =this.getMap().getSize();\n\t\tpx = [ px[0]/2, px[1]/2 ];\n\t\tthis.pos_ = this.getMap().getCoordinateFromPixel(px);\n\t}\n\treturn this.pos_; \n};\n/** Draw the target\n* @private\n*/\nol.interaction.CenterTouch.prototype.drawTarget_ = function (e)\n{\tif (!this.getMap() || !this.getActive()) return;\n\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\t\tvar cx = ctx.canvas.width/(2*ratio);\n\t\tvar cy = ctx.canvas.height/(2*ratio);\n\t\tvar geom = new ol.geom.Point (this.getMap().getCoordinateFromPixel([cx,cy]));\n\t\tif (this.composite) ctx.globalCompositeOperation = this.composite;\n\t\tfor (var i=0; i<this.targetStyle.length; i++)\n\t\t{\tvar style = this.targetStyle[i];\n\t\t\tif (style instanceof ol.style.Style)\n\t\t\t{\tvar sc=0;\n\t\t\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : style.getImage();\n\t\t\t\tif (imgs) \n\t\t\t\t{\tsc = imgs.getScale(); \n\t\t\t\t\timgs.setScale(ratio*sc);\n\t\t\t\t}\n\t\t\t\te.vectorContext.setStyle(style);\n\t\t\t\te.vectorContext.drawGeometry(geom);\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t}\n\t\t}\n\tctx.restore();\n};\n\n/** Clip interaction to clip layers in a circle\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @param {ol.interaction.Clip.options} options flashlight  param\n *  @param {number} options.radius radius of the clip, default 100\n *\t@param {ol.layer|Array<ol.layer>} options.layers layers to clip\n */\nol.interaction.Clip = function(options) {\n  this.layers_ = [];\n  ol.interaction.Pointer.call(this, {\n    handleDownEvent: this.setPosition,\n    handleMoveEvent: this.setPosition\n  });\n  this.precomposeBind_ = this.precompose_.bind(this);\n  this.postcomposeBind_ = this.postcompose_.bind(this);\n  // Default options\n  options = options || {};\n  this.pos = false;\n  this.radius = (options.radius||100);\n  if (options.layers) this.addLayer(options.layers);\n};\nol.ext.inherits(ol.interaction.Clip, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.Clip.prototype.setMap = function(map) {\n  var i;\n  if (this.getMap()) {\n    for (i=0; i<this.layers_.length; i++) {\n      this.layers_[i].un(['precompose','prerender'], this.precomposeBind_);\n      this.layers_[i].un(['postcompose','postrender'], this.postcomposeBind_);\n    }\n    this.getMap().renderSync();\n  }\n  ol.interaction.Pointer.prototype.setMap.call(this, map);\n  if (map) {\n    for (i=0; i<this.layers_.length; i++) {\n      this.layers_[i].on(['precompose','prerender'], this.precomposeBind_);\n      this.layers_[i].on(['postcompose','postrender'], this.postcomposeBind_);\n    }\n    map.renderSync();\n  }\n}\n/** Set clip radius\n *\t@param {integer} radius\n*/\nol.interaction.Clip.prototype.setRadius = function(radius) {\n  this.radius = radius;\n  if (this.getMap()) this.getMap().renderSync();\n}\n/** Add a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*/\nol.interaction.Clip.prototype.addLayer = function(layers)  {\n  if (!(layers instanceof Array)) layers = [layers];\n  for (var i=0; i<layers.length; i++) {\n    if (this.getMap()) {\n      layers[i].on(['precompose','prerender'], this.precomposeBind_);\n      layers[i].on(['postcompose','postrender'], this.postcomposeBind_);\n      this.getMap().renderSync();\n    }\n    this.layers_.push(layers[i]);\n  }\n};\n/** Remove a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*/\nol.interaction.Clip.prototype.removeLayer = function(layers) {\n  if (!(layers instanceof Array)) layers = [layers];\n  for (var i=0; i<layers.length; i++) {\n    var k;\n    for (k=0; k<this.layers_.length; k++) {\n      if (this.layers_[k]===layers[i]) {\n        break;\n      }\n    }\n    if (k!=this.layers_.length && this.getMap()) {\n      this.layers_[k].un(['precompose','prerender'], this.precomposeBind_);\n      this.layers_[k].un(['postcompose','postrender'], this.postcomposeBind_);\n      this.layers_.splice(k,1);\n      this.getMap().renderSync();\n    }\n  }\n};\n/** Set position of the clip\n*\t@param {ol.Pixel|ol.MapBrowserEvent}\n*/\nol.interaction.Clip.prototype.setPosition = function(e) {\n  if (e.pixel) this.pos = e.pixel;\n  else {\n    if (e && e instanceof Array) this.pos = e;\n    else e = [-10000000,-10000000];\n  }\n  if (this.getMap()) this.getMap().renderSync();\n};\n/* @private\n*/\nol.interaction.Clip.prototype.precompose_ = function(e) {\n  var ctx = e.context;\n  var ratio = e.frameState.pixelRatio;\n  ctx.save();\n  ctx.beginPath();\n  ctx.arc (this.pos[0]*ratio, this.pos[1]*ratio, this.radius*ratio, 0, 2*Math.PI);\n  ctx.clip();\n};\n/* @private\n*/\nol.interaction.Clip.prototype.postcompose_ = function(e) {\n  e.context.restore();\n};\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.Clip.prototype.setActive = function(b) {\n  if (b===this.getActive()) return;\n  ol.interaction.Pointer.prototype.setActive.call (this, b);\n  var i;\n  if (b) {\n    for(i=0; i<this.layers_.length; i++) {\n      this.layers_[i].on(['precompose','prerender'], this.precomposeBind_);\n      this.layers_[i].on(['postcompose','postrender'], this.postcomposeBind_);\n    }\n  } else {\n    for(i=0; i<this.layers_.length; i++) {\n      this.layers_[i].un(['precompose','prerender'], this.precomposeBind_);\n      this.layers_[i].un(['postcompose','postrender'], this.postcomposeBind_);\n    }\n  }\n  if (this.getMap()) this.getMap().renderSync();\n};\n\n/** An interaction to copy/paste features on a map\n * @constructor\n * @fires focus\n * @fires copy\n * @fires paste\n * @extends {ol.interaction.Interaction}\n * @param {Object} options Options\n *  @param {function} options.condition a function that take a mapBrowserEvent and return the actio nto perform: 'copy', 'cut' or 'paste', default Ctrl+C / Ctrl+V\n *  @param {ol.Collection<ol.Feature>} options.features list of features to copy\n *  @param {ol.source.Vector | Array<ol.source.Vector>} options.sources the source to copy from (used for cut), if not defined, it will use the destination\n *  @param {ol.source.Vector} options.destination the source to copy to\n */\nol.interaction.CopyPaste = function(options) {\n  options = options || {};\n  // Features to copy\n  this.features = [];\n  this._cloneFeature = true;\n  var condition = options.condition;\n  if (typeof (condition) !== 'function') {\n    condition = function (e) {\n      if (e.originalEvent.ctrlKey) {\n        if (/^c$/i.test(e.originalEvent.key)) return 'copy';\n        if (/^x$/i.test(e.originalEvent.key)) return 'cut';\n        if (/^v$/i.test(e.originalEvent.key)) return 'paste';\n      }\n      return false;\n    }\n  }\n  this._featuresSource = options.features || new ol.Collection();\n  this.setSources(options.sources);\n  this.setDestination(options.destination);\n  // Create intreaction\n  ol.interaction.Interaction.call(this, {\n    handleEvent: function(e) {\n      if (e.type==='keydown' && !/INPUT|TEXTAREA|SELECT/.test(document.activeElement.tagName)) {\n        switch (condition(e)) {\n          case 'copy': {\n            this.copy({ silent: false });\n            break;\n          }\n          case 'cut': {\n            this.copy({ cut: true, silent: false });\n            break;\n          }\n          case 'paste': {\n            this.paste({ silent: false });\n            break;\n          }\n          default: break;\n        }\n      }\n      return true;\n    }.bind(this)\n  });\n};\nol.ext.inherits(ol.interaction.CopyPaste, ol.interaction.Interaction);\n/** Sources to cut feature from\n * @param { ol.source.Vector | Array<ol.source.Vector> } sources\n */\nol.interaction.CopyPaste.prototype.setSources = function (sources) {\n  if (sources) {\n    this._source = [];\n    this._source = sources instanceof Array ? sources : [sources];\n  } else {\n    this._source = null;\n  }\n};\n/** Get sources to cut feature from\n * @return { Array<ol.source.Vector> } \n */\nol.interaction.CopyPaste.prototype.getSources = function () {\n  return this._source;\n};\n/** Source to paste features\n * @param { ol.source.Vector } source\n */\nol.interaction.CopyPaste.prototype.setDestination = function (destination) {\n  this._destination = destination;\n};\n/** Get source to paste features\n * @param { ol.source.Vector } \n */\nol.interaction.CopyPaste.prototype.getDestination = function () {\n  return this._destination;\n};\n/** Get current feature to copy\n * @return {Array<ol.Feature>}\n */\nol.interaction.CopyPaste.prototype.getFeatures = function() {\n  return this.features;\n};\n/** Set current feature to copy\n * @param {Object} options\n *  @param {Array<ol.Feature> | ol.Collection<ol.Feature>} options.features feature to copy, default get in the provided collection\n *  @param {boolean} options.cut try to cut feature from the sources, default false\n *  @param {boolean} options.silent true to send an event, default true\n */\nol.interaction.CopyPaste.prototype.copy = function (options) {\n  options = options || {};\n  var features = options.features || this._featuresSource.getArray();\n  // Try to remove feature from sources\n  if (options.cut) {\n    var sources = this._source || [this._destination];\n    // Remove feature from sources\n    features.forEach(function(f) {\n      sources.forEach(function(source) {\n        try {\n          source.removeFeature(f);\n        } catch(e) {/*ok*/}\n      });\n    });\n  }\n  if (this._cloneFeature) {\n    this.features = [];\n    features.forEach(function(f) {\n      this.features.push(f.clone());\n    }.bind(this));\n  } else {\n    this.features = features;\n  }\n  // Send an event\n  if (options.silent===false) this.dispatchEvent({ type: options.cut ? 'cut' : 'copy', time: (new Date).getTime() });\n};\n/** Paste features\n * @param {Object} options\n *  @param {Array<ol.Feature> | ol.Collection<ol.Feature>} features feature to copy, default get current features\n *  @param {ol.source.Vector} options.destination Source to paste to, default the current source\n *  @param {boolean} options.silent true to send an event, default true\n */\nol.interaction.CopyPaste.prototype.paste = function(options) {\n  options = options || {};\n  var features = options.features || this.features;\n  if (features) {\n    var destination = options.destination || this._destination;\n    if (destination) {\n      destination.addFeatures(this.features);\n      if (this._cloneFeature) this.copy({ features: this.features });\n    }\n  }\n  // Send an event\n  if (options.silent===false) this.dispatchEvent({ type:'paste', features: features, time: (new Date).getTime() });\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A Select interaction to delete features on click.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires deletestart\n * @fires deleteend\n * @param {*} options ol.interaction.Select options\n */\nol.interaction.Delete = function(options) {\n  ol.interaction.Select.call(this, options);\n  this.on('select', function(e) {\n    this.getFeatures().clear();\n    this.delete(e.selected);\n  }.bind(this));\n};\nol.ext.inherits(ol.interaction.Delete, ol.interaction.Select);\n/** Get vector source of the map\n * @return {Array<ol.source.Vector>}\n */\nol.interaction.Delete.prototype._getSources = function(layers) {\n  if (!this.getMap()) return [];\n  if (!layers) layers = this.getMap().getLayers();\n  var sources = [];\n  layers.forEach(function (l) {\n    // LayerGroup\n    if (l.getLayers) {\n      sources = sources.concat(this._getSources(l.getLayers()));\n    } else {\n      if (l.getSource && l.getSource() instanceof ol.source.Vector) {\n        sources.push(l.getSource());\n      }\n    }\n  }.bind(this));\n  return sources;\n};\n/** Delete features: remove the features from the map (from all layers in the map)\n * @param {ol.Collection<ol.Feature>|Array<ol.Feature>} features The features to delete\n * @api\n */\nol.interaction.Delete.prototype.delete = function(features) {\n  if (features && (features.length || features.getLength())) {\n    this.dispatchEvent({ type: 'deletestart', features: features });\n    var delFeatures = [];\n    // Get the sources concerned\n    this._getSources().forEach(function (source) {\n      try {\n        // Try to delete features in the source\n        features.forEach(function(f) {\n          source.removeFeature(f);\n          delFeatures.push(f);\n        });\n      } catch(e) { /* ok */ }\n    })\n    this.dispatchEvent({ type: 'deleteend', features: delFeatures });\n  }\n};\n\n/** Drag an overlay on the map\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires dragstart\n * @fires dragging\n * @fires dragend\n * @param {any} options\n *  @param {ol.Overlay|Array<ol.Overlay>} options.overlays the overlays to drag\n */\nol.interaction.DragOverlay = function(options) {\n  if (!options) options = {};\n  // Extend pointer\n  ol.interaction.Pointer.call(this, {\n    // start draging on an overlay\n    handleDownEvent: function(evt) {\n      // Click on a button (closeBox) or on a link: don't drag!\n      if (/^(BUTTON|A)$/.test(evt.originalEvent.target.tagName)) {\n        this._dragging = false;\n        return true;\n      }\n      // Start dragging\n      if (this._dragging) {\n        this._dragging.setPosition(evt.coordinate);\n        this.dispatchEvent({ \n          type: 'dragstart',\n          overlay: this._dragging,\n          coordinate: evt.coordinate\n        });\n        return true;\n      }\n      return false;\n    },\n    // Drag\n    handleDragEvent: function(evt) {\n      if (this._dragging) {\n        this._dragging.setPosition(evt.coordinate);\n        this.dispatchEvent({ \n          type: 'dragging',\n          overlay: this._dragging,\n          coordinate: evt.coordinate\n        });\n      }\n    },\n    // Stop dragging\n    handleUpEvent: function(evt) {\n      if (this._dragging) {\n        this.dispatchEvent({ \n          type: 'dragend',\n          overlay: this._dragging,\n          coordinate: evt.coordinate\n        });\n      }\n      return (this._dragging = false);\n    }\n  });\n  // List of overlays / listeners\n  this._overlays = [];\n  if (!(options.overlays instanceof Array)) options.overlays = [options.overlays];\n  options.overlays.forEach(this.addOverlay.bind(this));\n};\nol.ext.inherits(ol.interaction.DragOverlay, ol.interaction.Pointer);\n/** Add an overlay to the interacton\n * @param {ol.Overlay} ov\n */\nol.interaction.DragOverlay.prototype.addOverlay = function (ov) {\n  for (var i=0, o; o=this._overlays[i]; i++) {\n    if (o===ov) return;\n  }\n  // Stop event overlay\n  if (ov.element.parentElement && ov.element.parentElement.classList.contains('ol-overlaycontainer-stopevent')) {\n    console.warn('[DragOverlay.addOverlay] overlay must be created with stopEvent set to false!');\n    return;\n  }\n  // Add listener on overlay of the same map\n  var handler = function() {\n    if (this.getMap()===ov.getMap()) this._dragging = ov;\n  }.bind(this);\n  this._overlays.push({\n    overlay: ov,\n    listener: handler\n  });\n  ov.element.addEventListener('pointerdown', handler);\n};\n/** Remove an overlay from the interacton\n * @param {ol.Overlay} ov\n */\nol.interaction.DragOverlay.prototype.removeOverlay = function (ov) {\n  for (var i=0, o; o=this._overlays[i]; i++) {\n    if (o.overlay===ov) {\n      var l = this._overlays.splice(i,1)[0];\n      ov.element.removeEventListener('pointerdown', l.listener);\n      break;\n    }\n  }\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction to draw holes in a polygon.\n * It fires a drawstart, drawend event when drawing the hole\n * and a modifystart, modifyend event before and after inserting the hole in the feature geometry.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires drawstart\n * @fires drawend\n * @fires modifystart\n * @fires modifyend\n * @param {olx.interaction.DrawHoleOptions} options extend olx.interaction.DrawOptions\n * \t@param {Array<ol.layer.Vector> | function | undefined} options.layers A list of layers from which polygons should be selected. Alternatively, a filter function can be provided. default: all visible layers\n * \t@param { ol.style.Style | Array<ol.style.Style> | StyleFunction | undefined }\tStyle for the selected features, default: default edit style\n */\nol.interaction.DrawHole = function(options) {\n  if (!options) options = {};\n  var self = this;\n  // Select interaction for the current feature\n  this._select = new ol.interaction.Select({ style: options.style });\n  this._select.setActive(false);\n  // Geometry function that test points inside the current\n  var geometryFn, geomFn = options.geometryFunction;\n  if (geomFn) {\n    geometryFn = function(c,g) {\n      g = self._geometryFn (c, g);\n      return geomFn (c,g);\n    }\n  } else {\n    geometryFn = function(c,g) { return self._geometryFn (c, g); }\n  }\n  // Create draw interaction\n  options.type = \"Polygon\";\n  options.geometryFunction = geometryFn;\n  ol.interaction.Draw.call(this, options);\n  // Layer filter function\n  if (options.layers) {\n    if (typeof (options.layers) === 'function') {\n      this.layers_ = options.layers;\n    } else if (options.layers.indexOf) {\n      this.layers_ = function(l) {\n        return (options.layers.indexOf(l) >= 0); \n      };\n    }\n  }\n  // Start drawing if inside a feature\n  this.on('drawstart', this._startDrawing.bind(this));\n  // End drawing add the hole to the current Polygon\n  this.on('drawend', this._finishDrawing.bind(this));\n};\nol.ext.inherits(ol.interaction.DrawHole, ol.interaction.Draw);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.DrawHole.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeInteraction(this._select);\n  if (map) map.addInteraction(this._select);\n  ol.interaction.Draw.prototype.setMap.call (this, map);\n};\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol.interaction.DrawHole.prototype.setActive = function(b) {\n  this._select.getFeatures().clear();\n  ol.interaction.Draw.prototype.setActive.call (this, b);\n};\n/**\n * Remove last point of the feature currently being drawn \n * (test if points to remove before).\n */\nol.interaction.DrawHole.prototype.removeLastPoint = function() {\n  if (this._feature && this._feature.getGeometry().getCoordinates()[0].length>2) {\n    ol.interaction.Draw.prototype.removeLastPoint.call(this);\n  }\n};\n/** \n * Get the current polygon to hole\n * @return {ol.Feature}\n */\nol.interaction.DrawHole.prototype.getPolygon = function() {\n  return this._polygon;\n  // return this._select.getFeatures().item(0).getGeometry();\n};\n/**\n * Get current feature to add a hole and start drawing\n * @param {ol.interaction.Draw.Event} e\n * @private\n */\nol.interaction.DrawHole.prototype._startDrawing = function(e) {\n  var map = this.getMap();\n  var layersFilter = this.layers_;\n  this._feature = e.feature;\n  var coord = e.feature.getGeometry().getCoordinates()[0][0];\n  // Check object under the pointer\n  var features = map.getFeaturesAtPixel(\n    map.getPixelFromCoordinate(coord), {\n      layerFilter: layersFilter\n    }\n  );\n  this._current = null;\n  if (features) {\n    for (var k=0; k<features.length; k++) {\n      var poly = features[k].getGeometry();\n      if (poly.getType() === \"Polygon\"\n        && poly.intersectsCoordinate(coord)) {\n        this._polygonIndex = false;\n        this._polygon = poly;\n        this._current = features[k];\n      }\n      else if (poly.getType() === \"MultiPolygon\"\n        && poly.intersectsCoordinate(coord)) {\n        for (var i=0, p; p=poly.getPolygon(i); i++) {\n          if (p.intersectsCoordinate(coord)) {\n            this._polygonIndex = i;\n            this._polygon = p;\n            this._current = features[k];\n            break;\n          }\n        }\n      }\n      if (this._current) break;\n    }\n  }\n  this._select.getFeatures().clear();\n  if (!this._current) {\n    this.setActive(false);\n    this.setActive(true);\n  } else {\n    this._select.getFeatures().push(this._current);\n  }\n};\n/**\n * Stop drawing and add the sketch feature to the target feature. \n * @param {ol.interaction.Draw.Event} e\n * @private\n */\nol.interaction.DrawHole.prototype._finishDrawing = function(e) {\n  // The feature is the hole\n  e.hole = e.feature;\n  // Get the current feature\n  e.feature = this._select.getFeatures().item(0);\n  this.dispatchEvent({ type: 'modifystart', features: [ this._current ] });\n  // Create the hole\n  var c = e.hole.getGeometry().getCoordinates()[0];\n  if (c.length > 3) {\n    if (this._polygonIndex!==false) {\n      var geom = e.feature.getGeometry();\n      var newGeom = new ol.geom.MultiPolygon([]);\n      for (var i=0, pi; pi=geom.getPolygon(i); i++) {\n        if (i===this._polygonIndex) {\n          pi.appendLinearRing(new ol.geom.LinearRing(c));\n          newGeom.appendPolygon(pi);\n        } else {\n          newGeom.appendPolygon(pi);\n        }\n      }\n      e.feature.setGeometry(newGeom);\n    } else {\n      this.getPolygon().appendLinearRing(new ol.geom.LinearRing(c));\n    }\n  }\n  this.dispatchEvent({ type: 'modifyend', features: [ this._current ] });\n  // reset\n  this._feature = null;\n  this._select.getFeatures().clear();\n};\n/**\n * Function that is called when a geometry's coordinates are updated.\n * @param {Array<ol.coordinate>} coordinates\n * @param {ol.geom.Polygon} geometry\n * @return {ol.geom.Polygon}\n * @private\n */\nol.interaction.DrawHole.prototype._geometryFn = function(coordinates, geometry) {\n  var coord = coordinates[0].pop();\n  if (!this.getPolygon() || this.getPolygon().intersectsCoordinate(coord)) {\n    this.lastOKCoord = [coord[0],coord[1]];\n  }\n  coordinates[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]);\n  if (geometry) {\n    geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n  } else {\n    geometry = new ol.geom.Polygon(coordinates);\n  }\n  return geometry;\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction rotate\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires drawstart, drawing, drawend, drawcancel\n * @param {olx.interaction.TransformOptions} options\n *  @param {Array<ol.Layer>} source Destination source for the drawn features\n *  @param {ol.Collection<ol.Feature>} features Destination collection for the drawn features \n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\n *  @param {integer} sides number of sides, default 0 = circle\n *  @param { ol.events.ConditionType | undefined } squareCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw square features.\n *  @param { ol.events.ConditionType | undefined } centerCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw centered features.\n *  @param { bool } canRotate Allow rotation when centered + square, default: true\n *  @param { number } clickTolerance click tolerance on touch devices, default: 6\n *  @param { number } maxCircleCoordinates Maximum number of point on a circle, default: 100\n */\nol.interaction.DrawRegular = function(options) {\n  if (!options) options={};\n  this.squaredClickTolerance_ = options.clickTolerance ? options.clickTolerance * options.clickTolerance : 36;\n  this.maxCircleCoordinates_ = options.maxCircleCoordinates || 100;\n  // Collection of feature to transform \n  this.features_ = options.features;\n  // List of layers to transform \n  this.source_ = options.source;\n  // Square condition\n  this.squareFn_ = options.squareCondition;\n  // Centered condition\n  this.centeredFn_ = options.centerCondition;\n  // Allow rotation when centered + square\n  this.canRotate_ = (options.canRotate !== false);\n  // Specify custom geometry name\n  this.geometryName_ = options.geometryName\n  // Number of sides (default=0: circle)\n  this.setSides(options.sides);\n  // Style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var defaultStyle = [\n    new ol.style.Style({\n      stroke: new ol.style.Stroke({ color: white, width: width + 2 })\n    }),\n    new ol.style.Style({\n      image: new ol.style.Circle({\n        radius: width * 2,\n        fill: new ol.style.Fill({ color: blue }),\n        stroke: new ol.style.Stroke({ color: white, width: width / 2 })\n      }),\n      stroke: new ol.style.Stroke({ color: blue, width: width }),\n      fill: new ol.style.Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  // Create a new overlay layer for the sketch\n  this.sketch_ = new ol.Collection();\n  this.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      features: this.sketch_,\n      useSpatialIndex: false\n    }),\n    name:'DrawRegular overlay',\n    displayInLayerSwitcher: false,\n    style: options.style || defaultStyle\n  });\n  ol.interaction.Interaction.call(this, {\t\n      /*\n      handleDownEvent: this.handleDownEvent_,\n      handleMoveEvent: this.handleMoveEvent_,\n      handleUpEvent: this.handleUpEvent_,\n      */\n      handleEvent: this.handleEvent_\n    });\n};\nol.ext.inherits(ol.interaction.DrawRegular, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.DrawRegular.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol.interaction.DrawRegular.prototype.setActive = function(b) {\n  this.reset();\n  ol.interaction.Interaction.prototype.setActive.call (this, b);\n}\n/**\n * Reset the interaction\n * @api stable\n */\nol.interaction.DrawRegular.prototype.reset = function() {\n  this.overlayLayer_.getSource().clear();\n  this.started_ = false;\n}\n/**\n * Set the number of sides.\n * @param {int} number of sides.\n * @api stable\n */\nol.interaction.DrawRegular.prototype.setSides = function (nb) {\n  nb = parseInt(nb);\n  this.sides_ = nb>2 ? nb : 0;\n}\n/**\n * Allow rotation when centered + square\n * @param {bool} \n * @api stable\n */\nol.interaction.DrawRegular.prototype.canRotate = function (b) {\n  if (b===true || b===false) this.canRotate_ = b;\n  return this.canRotate_;\n}\n/**\n * Get the number of sides.\n * @return {int} number of sides.\n * @api stable\n */\nol.interaction.DrawRegular.prototype.getSides = function () {\n  return this.sides_;\n}\n/** Default start angle array for each sides\n*/\nol.interaction.DrawRegular.prototype.startAngle = {\n  'default':Math.PI/2,\n  3: -Math.PI/2,\n  4: Math.PI/4\n};\n/** Get geom of the current drawing\n* @return {ol.geom.Polygon | ol.geom.Point}\n*/\nol.interaction.DrawRegular.prototype.getGeom_ = function () {\n  this.overlayLayer_.getSource().clear();\n  if (!this.center_) return false;\n  var g;\n  if (this.coord_) {\n    var center = this.center_;\n    var coord = this.coord_;\n    // Specific case: circle\n    var d, dmax, r, circle, centerPx;\n    if (!this.sides_ && this.square_ && !this.centered_) {\n      center = [(coord[0] + center[0])/2, (coord[1] + center[1])/2];\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      circle = new ol.geom.Circle(center, r, 'XY');\n      // Optimize points on the circle\n      centerPx = this.getMap().getPixelFromCoordinate(center);\n      dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n      dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / 3 ));\n      return ol.geom.Polygon.fromCircle (circle, dmax, 0);\n    } else {\n      var hasrotation = this.canRotate_ && this.centered_ && this.square_;\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      if (this.square_ && !hasrotation) {\n        //var d = [coord[0] - center[0], coord[1] - center[1]];\n        var dm = Math.max (Math.abs(d[0]), Math.abs(d[1])); \n        coord = [ \n          center[0] + (d[0]>0 ? dm:-dm),\n          center[1] + (d[1]>0 ? dm:-dm)\n        ];\n      }\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      if (r>0) {\n        circle = new ol.geom.Circle(center, r, 'XY');\n        var a;\n        if (hasrotation) a = Math.atan2(d[1], d[0]);\n        else a = this.startAngle[this.sides_] || this.startAngle['default'];\n        if (this.sides_) {\n          g = ol.geom.Polygon.fromCircle (circle, this.sides_, a);\n        } else {\n          // Optimize points on the circle\n          centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n          dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n          dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / (this.centered_ ? 3:5) ));\n          g = ol.geom.Polygon.fromCircle (circle, dmax, 0);\n        }\n        if (hasrotation) return g;\n        // Scale polygon to fit extent\n        var ext = g.getExtent();\n        if (!this.centered_) center = this.center_;\n        else center = [ 2*this.center_[0]-this.coord_[0], 2*this.center_[1]-this.coord_[1] ];\n        var scx = (center[0] - coord[0]) / (ext[0] - ext[2]);\n        var scy = (center[1] - coord[1]) / (ext[1] - ext[3]);\n        if (this.square_) {\n          var sc = Math.min(Math.abs(scx),Math.abs(scy));\n          scx = Math.sign(scx)*sc;\n          scy = Math.sign(scy)*sc;\n        }\n        var t = [ center[0] - ext[0]*scx, center[1] - ext[1]*scy ];\n        g.applyTransform(function(g1, g2, dim) {\n          for (var i=0; i<g1.length; i+=dim) {\n            g2[i] = g1[i]*scx + t[0];\n            g2[i+1] = g1[i+1]*scy + t[1];\n          }\n          return g2;\n        });\n        return g;\n      }\n    }\n  }\n  // No geom => return a point\n  return new ol.geom.Point(this.center_);\n};\n/** Draw sketch\n* @return {ol.Feature} The feature being drawn.\n*/\nol.interaction.DrawRegular.prototype.drawSketch_ = function(evt) {\n  this.overlayLayer_.getSource().clear();\n  if (evt) {\n    this.square_ = this.squareFn_ ? this.squareFn_(evt) : evt.originalEvent.shiftKey;\n    this.centered_ = this.centeredFn_ ? this.centeredFn_(evt) : evt.originalEvent.metaKey || evt.originalEvent.ctrlKey;\n    var g = this.getGeom_();\n    if (g) {\n      var f = this.feature_;\n      if (this.geometryName_) f.setGeometryName(this.geometryName_)\n      //f.setGeometry (g);\n      if (g.getType()==='Polygon') f.getGeometry().setCoordinates(g.getCoordinates());\n      this.overlayLayer_.getSource().addFeature(f);\n      if (this.coord_ \n        && this.square_ \n        && ((this.canRotate_ && this.centered_ && this.coord_) || (!this.sides_ && !this.centered_))) {\n        this.overlayLayer_.getSource().addFeature(new ol.Feature(new ol.geom.LineString([this.center_,this.coord_])));\n      }\n      return f;\n    }\n  }\n};\n/** Draw sketch (Point)\n*/\nol.interaction.DrawRegular.prototype.drawPoint_ = function(pt, noclear) {\n  if (!noclear) this.overlayLayer_.getSource().clear();\n  this.overlayLayer_.getSource().addFeature(new ol.Feature(new ol.geom.Point(pt)));\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n */\nol.interaction.DrawRegular.prototype.handleEvent_ = function(evt) {\n  var dx, dy;\n  // Event date time\n  this._eventTime = new Date();\n  switch (evt.type) {\n    case \"pointerdown\": {\n      this.downPx_ = evt.pixel;\n      this.start_(evt);\n      // Test long touch\n      var dt = 500;\n      this._longTouch = false;\n      setTimeout(function() {\n        this._longTouch = (new Date() - this._eventTime > .9*dt);\n        if (this._longTouch) this.handleMoveEvent_(evt);\n      }.bind(this), dt);\n      break;\n    }\n    case \"pointerup\": {\n      // Started and fisrt move\n      if (this.started_ && this.coord_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          // The pointer has moved\n          if ( this.lastEvent == \"pointermove\" || this.lastEvent == \"keydown\" ) {\n            this.end_(evt);\n          }\n          // On touch device there is no move event : terminate = click on the same point\n          else {\n            dx = this.upPx_[0] - evt.pixel[0];\n            dy = this.upPx_[1] - evt.pixel[1];\n            if ( dx*dx + dy*dy <= this.squaredClickTolerance_) {\n              this.end_(evt);\n            } else  {\n              this.handleMoveEvent_(evt);\n              this.drawPoint_(evt.coordinate,true);\n            }\n          }\n        }\n      }\n      this.upPx_ = evt.pixel;\t\n      break;\n    }\n    case \"pointerdrag\": {\n      if (this.started_) {\n        var centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n        dx = centerPx[0] - evt.pixel[0];\n        dy = centerPx[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          this.reset();\n        }\n      }\n      return !this._longTouch;\n      // break;\n    }\n    case \"pointermove\": {\n      if (this.started_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy > this.squaredClickTolerance_) {\n          this.handleMoveEvent_(evt);\n          this.lastEvent = evt.type;\n        }\n      }\n      break;\n    }\n    default: {\n      this.lastEvent = evt.type;\n      // Prevent zoom in on dblclick\n      if (this.started_ && evt.type==='dblclick') {\n        //evt.stopPropagation();\n        return false;\n      }\n      break;\n    }\n  }\n  return true;\n}\n/** Stop drawing.\n */\nol.interaction.DrawRegular.prototype.finishDrawing = function() {\n  if (this.started_ && this.coord_) {\n    this.end_({ pixel: this.upPx_, coordinate: this.coord_});\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol.interaction.DrawRegular.prototype.handleMoveEvent_ = function(evt) {\n  if (this.started_) {\n    this.coord_ = evt.coordinate;\n    this.coordPx_ = evt.pixel;\n    var f = this.drawSketch_(evt);\n    this.dispatchEvent({ \n      type:'drawing', \n      feature: f, \n      pixel: evt.pixel, \n      startCoordinate: this.center_,\n      coordinate: evt.coordinate, \n      square: this.square_, \n      centered: this.centered_ \n    });\n  } else  {\n    this.drawPoint_(evt.coordinate);\n  }\n};\n/** Start an new draw\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol.interaction.DrawRegular.prototype.start_ = function(evt) {\n  if (!this.started_) {\n    this.started_ = true;\n    this.center_ = evt.coordinate;\n    this.coord_ = null;\n    var geom = new ol.geom.Polygon([[evt.coordinate,evt.coordinate,evt.coordinate]]);\n    var f = this.feature_ = new ol.Feature(geom);\n    this.drawSketch_(evt);\n    this.dispatchEvent({ type:'drawstart', feature: f, pixel: evt.pixel, coordinate: evt.coordinate });\n  } else {\n    this.coord_ = evt.coordinate;\n  }\n};\n/** End drawing\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol.interaction.DrawRegular.prototype.end_ = function(evt) {\n  this.coord_ = evt.coordinate;\n  this.started_ = false;\n  // Add new feature\n  if (this.coord_ && this.center_[0]!=this.coord_[0] && this.center_[1]!=this.coord_[1]) {\n    var f = this.feature_;\n    if (this.geometryName_) f.setGeometryName(this.geometryName_)\n    f.setGeometry(this.getGeom_());\n    if (this.source_) this.source_.addFeature(f);\n    else if (this.features_) this.features_.push(f);\n    this.dispatchEvent({ type:'drawend', feature: f, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  } else {\n    this.dispatchEvent({ type:'drawcancel', feature: null, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  }\n  this.center_ = this.coord_ = null;\n  this.drawSketch_();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction DrawTouch :\n * @constructor\n * @extends {ol.interaction.CenterTouch}\n * @param {olx.interaction.DrawOptions} options\n *\t- source {ol.source.Vector | undefined} Destination source for the drawn features.\n *\t- type {ol.geom.GeometryType} Drawing type ('Point', 'LineString', 'Polygon') not ('MultiPoint', 'MultiLineString', 'MultiPolygon' or 'Circle'). Required.\n *\t- tap {boolean} enable on tap, default true\n *\tInherited params\n *  - targetStyle {ol.style.Style|Array<ol.style.Style>} a style to draw the target point, default cross style\n *  - composite {string} composite operation : difference|multiply|xor|screen|overlay|darken|lighter|lighten|...\n */\nol.interaction.DrawTouch = function(options) {\n\toptions = options||{};\n\toptions.handleEvent = function(e) {\n\t\tif (this.get(\"tap\")) {\n\t\t\tswitch (e.type) {\n\t\t\t\tcase \"singleclick\": {\n\t\t\t\t\tthis.addPoint();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"dblclick\": {\n\t\t\t\t\tthis.addPoint();\n\t\t\t\t\tthis.finishDrawing();\n\t\t\t\t\treturn false;\n\t\t\t\t\t//break;\n\t\t\t\t}\n\t\t\t\tdefault: break;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tol.interaction.CenterTouch.call(this, options);\n\tthis.typeGeom_ = options.type;\n\tthis.source_ = options.source;\n\tthis.set(\"tap\", (options.tap!==false));\n\t// Style\n\tvar white = [255, 255, 255, 1];\n\tvar blue = [0, 153, 255, 1];\n\tvar width = 3;\n\tvar defaultStyle = [\n\t\tnew ol.style.Style({\n\t\t\tstroke: new ol.style.Stroke({ color: white, width: width + 2 })\n\t\t}),\n\t\tnew ol.style.Style({\n\t\t\timage: new ol.style.Circle({\n\t\t\t\tradius: width * 2,\n\t\t\t\tfill: new ol.style.Fill({ color: blue }),\n\t\t\t\tstroke: new ol.style.Stroke({ color: white, width: width / 2 })\n\t\t\t}),\n\t\t\tstroke: new ol.style.Stroke({ color: blue, width: width }),\n\t\t\tfill: new ol.style.Fill({\n\t\t\t\tcolor: [255, 255, 255, 0.5]\n\t\t\t})\n\t\t})\n\t];\n\tthis.overlay_ = new ol.layer.Vector(\n\t\t{\tsource: new ol.source.Vector({useSpatialIndex: false }),\n\t\t\tstyle: defaultStyle\n\t\t});\n\tthis.geom_ = [];\n};\nol.ext.inherits(ol.interaction.DrawTouch, ol.interaction.CenterTouch);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.DrawTouch.prototype.setMap = function(map) {\n\tif (this._listener.drawSketch) ol.Observable.unByKey(this._listener.drawSketch);\n\tthis._listener.drawSketch = null;\n\tol.interaction.CenterTouch.prototype.setMap.call (this, map);\n\tthis.overlay_.setMap(map);\n\tif (this.getMap())\n\t{\tthis._listener.drawSketch = this.getMap().on(\"postcompose\", this.drawSketchLink_.bind(this));\n\t}\n};\n/** Start drawing and add the sketch feature to the target layer. \n* The ol.interaction.Draw.EventType.DRAWSTART event is dispatched before inserting the feature.\n*/\nol.interaction.DrawTouch.prototype.startDrawing = function()\n{\tthis.geom_ = [];\n\tthis.addPoint();\n};\n/** Get geometry type\n* @return {ol.geom.GeometryType}\n*/\nol.interaction.DrawTouch.prototype.getGeometryType = function()\n{\treturn this.typeGeom_;\n};\n/** Start drawing and add the sketch feature to the target layer. \n* The ol.interaction.Draw.EventType.DRAWEND event is dispatched before inserting the feature.\n*/\nol.interaction.DrawTouch.prototype.finishDrawing = function()\n{\tif (!this.getMap()) return;\n\tvar f;\n\tswitch (this.typeGeom_)\n\t{\tcase \"LineString\":\n\t\t\tif (this.geom_.length > 1) f = new ol.Feature(new ol.geom.LineString(this.geom_));\n\t\t\tbreak;\n\t\tcase \"Polygon\":\n\t\t\t// Close polygon\n\t\t\tif (this.geom_[this.geom_.length-1] != this.geom_[0]) \n\t\t\t{\tthis.geom_.push(this.geom_[0]);\n\t\t\t}\n\t\t\t// Valid ?\n\t\t\tif (this.geom_.length > 3) \n\t\t\t{\tf = new ol.Feature(new ol.geom.Polygon([ this.geom_ ]));\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault: break;\n\t}\n\tif (f) this.source_.addFeature (f);\n\t// reset\n\tthis.geom_ = [];\n\tthis.drawSketch_();\n}\n/** Add a new Point to the drawing\n*/\nol.interaction.DrawTouch.prototype.addPoint = function()\n{\tif (!this.getMap()) return;\n\tthis.geom_.push(this.getPosition());\n\tswitch (this.typeGeom_)\n\t{\tcase \"Point\": \n\t\t\tvar f = new ol.Feature( new ol.geom.Point (this.geom_.pop()));\n\t\t\tthis.source_.addFeature(f);\n\t\t\tbreak;\n\t\tcase \"LineString\":\n\t\tcase \"Polygon\":\n\t\t\tthis.drawSketch_();\n\t\t\tbreak;\n\t\tdefault: break;\n\t}\n}\n/** Remove last point of the feature currently being drawn.\n*/\nol.interaction.DrawTouch.prototype.removeLastPoint = function()\n{\tif (!this.getMap()) return;\n\tthis.geom_.pop();\n\tthis.drawSketch_();\n}\n/** Draw sketch\n* @private\n*/\nol.interaction.DrawTouch.prototype.drawSketch_ = function()\n{\tif (!this.overlay_) return;\n\tthis.overlay_.getSource().clear();\n\tif (this.geom_.length)\n\t{\tvar f;\n\t\tif (this.typeGeom_ == \"Polygon\") \n\t\t{\tf = new ol.Feature(new ol.geom.Polygon([this.geom_]));\n\t\t\tthis.overlay_.getSource().addFeature(f);\n\t\t}\n\t\tvar geom = new ol.geom.LineString(this.geom_);\n\t\tf = new ol.Feature(geom);\n\t\tthis.overlay_.getSource().addFeature(f);\n\t\tf = new ol.Feature( new ol.geom.Point (this.geom_.slice(-1).pop()) );\n\t\tthis.overlay_.getSource().addFeature(f);\n\t}\n}\n/** Draw contruction lines on postcompose\n* @private\n*/\nol.interaction.DrawTouch.prototype.drawSketchLink_ = function(e)\n{\tif (!this.getActive() || !this.getPosition()) return;\n\tvar ctx = e.context;\n\tctx.save();\n\t\tvar p, pt = this.getMap().getPixelFromCoordinate(this.getPosition());\n\t\tvar ratio = e.frameState.pixelRatio || 1;\n\t\tctx.scale(ratio,ratio);\n\t\tctx.strokeStyle = \"rgba(0, 153, 255, 1)\";\n\t\tctx.lineWidth = 1;\n\t\tctx.beginPath();\n\t\tctx.arc (pt[0],pt[1], 5, 0, 2*Math.PI);\n\t\tctx.stroke();\n\t\tif (this.geom_.length)\n\t\t{\tp = this.getMap().getPixelFromCoordinate(this.geom_[this.geom_.length-1]);\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(p[0],p[1]);\n\t\t\tctx.lineTo(pt[0],pt[1]);\n\t\t\tif (this.typeGeom_ == \"Polygon\")\n\t\t\t{\tp = this.getMap().getPixelFromCoordinate(this.geom_[0]);\n\t\t\t\tctx.lineTo(p[0],p[1]);\n\t\t\t}\n\t\t\tctx.stroke();\n\t\t}\n\tctx.restore();\n}\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.DrawTouch.prototype.setActive = function(b)\n{\tol.interaction.CenterTouch.prototype.setActive.call (this, b);\n\tif (!b) this.geom_ = [];\n\tthis.drawSketch_();\n}\n\n/** Extend DragAndDrop choose drop zone + fires loadstart, loadend\n * @constructor\n * @extends {ol.interaction.DragAndDrop}\n *\t@fires loadstart, loadend, addfeatures\n *\t@param {ol.dropfile.options} flashlight options param\n *\t\t- zone {string} selector for the drop zone, default document\n *\t\t- projection {ol.projection} default projection of the map\n *\t\t- formatConstructors {Array<function(new:ol.format.Feature)>|undefined} Format constructors, default [ ol.format.GPX, ol.format.GeoJSON, ol.format.IGC, ol.format.KML, ol.format.TopoJSON ]\n *\t\t- accept {Array<string>|undefined} list of eccepted format, default [\"gpx\",\"json\",\"geojson\",\"igc\",\"kml\",\"topojson\"]\n */\nol.interaction.DropFile = function(options)\n{\toptions = options||{};\n\tol.interaction.DragAndDrop.call(this, {});\n\tvar zone = options.zone || document;\n\tzone.addEventListener('dragenter', this.onstop );\n\tzone.addEventListener('dragover', this.onstop );\n\tzone.addEventListener('dragleave', this.onstop );\n\t// Options\n\tthis.formatConstructors_ = options.formatConstructors || [ ol.format.GPX, ol.format.GeoJSON, ol.format.IGC, ol.format.KML, ol.format.TopoJSON ];\n\tthis.projection_ = options.projection;\n\tthis.accept_ = options.accept || [\"gpx\",\"json\",\"geojson\",\"igc\",\"kml\",\"topojson\"];\n\tvar self = this;\n\tzone.addEventListener('drop', function(e){ return self.ondrop(e);});\n};\nol.ext.inherits(ol.interaction.DropFile, ol.interaction.DragAndDrop);\n/** Set the map\n*/\nol.interaction.DropFile.prototype.setMap = function(map)\n{\tol.interaction.Interaction.prototype.setMap.call(this, map);\n};\n/** Do somthing when over\n*/\nol.interaction.DropFile.prototype.onstop = function(e)\n{\te.preventDefault();\n\te.stopPropagation();\n\treturn false;\n}\n/** Do something when over\n*/\nol.interaction.DropFile.prototype.ondrop = function(e)\n{\te.preventDefault();\n\tif (e.dataTransfer && e.dataTransfer.files.length)\n\t{\tvar self = this;\n\t\t// fetch FileList object\n\t\tvar files = e.dataTransfer.files; // e.originalEvent.target.files ?\n\t\t// process all File objects\n\t\tvar file;\n\t\tvar pat = /\\.([0-9a-z]+)(?=[?#])|(\\.)(?:[\\w]+)$/;\n\t\tfor (var i=0; file=files[i]; i++)\n\t\t{\tvar ex = file.name.match(pat)[0];\n\t\t\tself.dispatchEvent({ type:'loadstart', file: file, filesize: file.size, filetype: file.type, fileextension: ex, projection: projection, target: self });\n\t\t\t// Load file\n\t\t\tvar reader = new FileReader();\n\t\t\tvar projection = this.projection_ || this.getMap().getView().getProjection();\n\t\t\tvar formatConstructors = this.formatConstructors_\n\t\t\tif (!projection) return;\n\t\t\tvar tryReadFeatures = function (format, result, options)\n\t\t\t{\ttry\n\t\t\t\t{\treturn format.readFeatures(result, options);\n\t\t\t\t} catch (e) { /* ok */ }\n\t\t\t}\n\t\t\tvar theFile = file;\n\t\t\treader.onload = function(e)\n\t\t\t{\tvar result = e.target.result;\n\t\t\t\tvar features = [];\n\t\t\t\tvar i, ii;\n\t\t\t\tfor (i = 0, ii = formatConstructors.length; i < ii; ++i)\n\t\t\t\t{\tvar formatConstructor = formatConstructors[i];\n\t\t\t\t\tvar format = new formatConstructor();\n\t\t\t\t\tfeatures = tryReadFeatures(format, result, { featureProjection: projection });\n\t\t\t\t\tif (features && features.length > 0)\n\t\t\t\t\t{\tself.dispatchEvent({ type:'addfeatures', features: features, file: theFile, projection: projection, target: self });\n\t\t\t\t\t\tself.dispatchEvent({ type:'loadend', features: features, file: theFile, projection: projection, target: self });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.dispatchEvent({ type:'loadend', file: theFile, target: self });\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t}\n\t}\n    return false;\n};\n\n/** A Select interaction to fill feature's properties on click.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires setattributestart\n * @fires setattributeend\n * @param {*} options extentol.interaction.Select options\n *  @param {boolean} options.active activate the interaction on start, default true\n *  @param {boolean} options.cursor use a paint bucket cursor, default true\n * @param {*} properties The properties as key/value\n */\nol.interaction.FillAttribute = function(options, properties) {\n  options = options || {};\n  if (!options.condition) options.condition = ol.events.condition.click;\n  ol.interaction.Select.call(this, options);\n  this.setActive(options.active!==false)\n  this._attributes = properties;\n  this.on('select', function(e) {\n    this.getFeatures().clear();\n    this.fill(e.selected, this._attributes);\n  }.bind(this));\n  if (options.cursor!==false) {\n    var canvas = document.createElement('CANVAS');\n    canvas.width = canvas.height = 32;\n    var ctx = canvas.getContext(\"2d\");\n    ctx.beginPath();\n      ctx.moveTo(9,3);\n      ctx.lineTo(2,9);\n      ctx.lineTo(10,17);\n      ctx.lineTo(17,11);\n    ctx.closePath();\n    ctx.fillStyle = \"#fff\";\n    ctx.fill();\n    ctx.stroke();\n    ctx.beginPath();\n      ctx.moveTo(6,4);\n      ctx.lineTo(0,8);\n      ctx.lineTo(0,13);\n      ctx.lineTo(3,17);\n      ctx.lineTo(3,8);\n    ctx.closePath();\n    ctx.fillStyle = \"#000\";\n    ctx.fill();\n    ctx.stroke();\n    ctx.moveTo(8,8);\n    ctx.lineTo(10,0);\n    ctx.lineTo(11,0);\n    ctx.lineTo(13,3);\n    ctx.lineTo(13,7);\n    ctx.stroke();\n    this._cursor = 'url('+canvas.toDataURL()+') 0 13, auto';\n  }\n};\nol.ext.inherits(ol.interaction.FillAttribute, ol.interaction.Select);\n/** Activate the interaction\n * @param {boolean} active\n */\nol.interaction.FillAttribute.prototype.setActive = function(active) {\n  if(active === this.getActive()) return;\n  ol.interaction.Select.prototype.setActive.call(this, active);\n  if (this.getMap() && this._cursor) {\n    if (active) {\n      this._previousCursor = this.getMap().getTargetElement().style.cursor;\n      this.getMap().getTargetElement().style.cursor = this._cursor;\n//      console.log('setCursor',this._cursor)\n    } else {\n      this.getMap().getTargetElement().style.cursor = this._previousCursor;\n      this._previousCursor = undefined;\n    }\n  }\n};\n/** Set attributes\n * @param {*} properties The properties as key/value\n */\nol.interaction.FillAttribute.prototype.setAttributes = function(properties) {\n  this._attributes = properties;\n};\n/** Set an attribute\n * @param {string} key \n * @param {*} val \n */\nol.interaction.FillAttribute.prototype.setAttribute = function(key, val) {\n  this._attributes[key] = val;\n};\n/** get attributes\n * @return {*} The properties as key/value\n */\nol.interaction.FillAttribute.prototype.getAttributes = function() {\n  return this._attributes;\n};\n/** Get an attribute\n * @param {string} key \n * @return {*} val \n */\nol.interaction.FillAttribute.prototype.getAttribute = function(key) {\n  return this._attributes[key];\n};\n/** Fill feature attributes\n * @param {Array<ol.Feature>} features The features to modify\n * @param {*} properties The properties as key/value\n */\nol.interaction.FillAttribute.prototype.fill = function(features, properties) {\n  if (features.length && properties) {\n    this.dispatchEvent({ type: 'setattributestart', features: features, properties: properties });\n    features.forEach(function(f) {\n      for (var p in properties) {\n        f.set(p, properties[p]);\n      }\n    });\n    this.dispatchEvent({ type: 'setattributeend', features: features, properties: properties });\n  }\n};\n\n/**\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.flashlight.options} flashlight options param\n *\t\t- color {ol.Color} light color, default transparent\n *\t\t- fill {ol.Color} fill color, default rgba(0,0,0,0.8)\n *\t\t- radius {number} radius of the flash\n */\nol.interaction.Flashlight = function(options) {\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.setPosition,\n\t\thandleMoveEvent: this.setPosition\n\t});\n\t// Default options\n\toptions = options||{};\n\tthis.pos = false;\n\tthis.radius = (options.radius||100);\n\tthis.setColor(options);\n};\nol.ext.inherits(ol.interaction.Flashlight, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.Flashlight.prototype.setMap = function(map) {\n\tif (this.getMap()) {\n\t\tthis.getMap().render();\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.postcompose_.bind(this));\n\t}\n}\n/** Set flashlight radius\n *\t@param {integer} radius\n */\nol.interaction.Flashlight.prototype.setRadius = function(radius)\n{\tthis.radius = radius\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/** Set flashlight color\n *\t@param {ol.flashlight.options} flashlight options param\n *\t\t- color {ol.Color} light color, default transparent\n *\t\t- fill {ol.Color} fill color, default rgba(0,0,0,0.8)\n */\nol.interaction.Flashlight.prototype.setColor = function(options)\n{\t// Backcolor\n\tvar color = (options.fill ? options.fill : [0,0,0,0.8]);\n\tvar c = ol.color.asArray(color);\n\tthis.startColor = ol.color.asString(c);\n\t// Halo color\n\tif (options.color) {\n\t\tc = this.endColor = ol.color.asString(ol.color.asArray(options.color)||options.color);\n\t}\n\telse \n\t{\tc[3] = 0\n\t\tthis.endColor = ol.color.asString(c);\n\t}\n\tc[3] = 0.1;\n\tthis.midColor = ol.color.asString(c);\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/** Set position of the flashlight\n*\t@param {ol.Pixel|ol.MapBrowserEvent}\n*/\nol.interaction.Flashlight.prototype.setPosition = function(e)\n{\tif (e.pixel) this.pos = e.pixel;\n\telse this.pos = e;\n\tif (this.getMap()) \n\t{\tthis.getMap().renderSync();\n\t}\n}\n/** Postcompose function\n*/\nol.interaction.Flashlight.prototype.postcompose_ = function(e)\n{\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tvar w = ctx.canvas.width;\n\tvar h = ctx.canvas.height;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tif (!this.pos) \n\t{\tctx.fillStyle = this.startColor;\n\t\tctx.fillRect( 0,0,w,h );\n\t}\n\telse\n\t{\tvar d = Math.max(w, h);\n\t\t// reveal wherever we drag\n\t\tvar radGrd = ctx.createRadialGradient( this.pos[0], this.pos[1], w*this.radius/d, this.pos[0], this.pos[1], h*this.radius/d );\n\t\tradGrd.addColorStop(   0, this.startColor );\n\t\tradGrd.addColorStop( 0.8, this.midColor );\n\t\tradGrd.addColorStop(   1, this.endColor );\n\t\tctx.fillStyle = radGrd;\n\t\tctx.fillRect( this.pos[0] - d, this.pos[1] - d, 2*d, 2*d );\n\t}\n\tctx.restore();\n};\n\n/** An interaction to focus on the map on click. Usefull when using keyboard event on the map.\n * @constructor\n * @fires focus\n * @extends {ol.interaction.Interaction}\n */\nol.interaction.FocusMap = function() {\n  //\n  ol.interaction.Interaction.call(this, {});\n  // Focus (hidden) button to focus on the map when click on it \n  this.focusBt = ol.ext.element.create('BUTTON', {\n    on: {\n      focus: function() {\n        this.dispatchEvent({ type:'focus' });\n      }.bind(this)\n    },\n    style: {\n      position: 'absolute',\n      zIndex: -1,\n      top: 0,\n      opacity: 0\n    }\n  });\n};\nol.ext.inherits(ol.interaction.FocusMap, ol.interaction.Interaction);\n/** Set the map > add the focus button and focus on the map when pointerdown to enable keyboard events.\n */\nol.interaction.FocusMap.prototype.setMap = function(map) {\n  if (this._listener) ol.Observable.unByKey(this._listener);\n  this._listener = null;\n  if (this.getMap()) { this.getMap().getViewport().removeChild(this.focusBt); }\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  if (this.getMap()) {\n    // Force focus on the clicked map\n    this._listener = this.getMap().on('pointerdown', function() {\n      if (this.getActive()) this.focusBt.focus();\n    }.bind(this));\n    this.getMap().getViewport().appendChild(this.focusBt); \n  }\n};\n\n/** Interaction to draw on the current geolocation\n *\tIt combines a draw with a ol.Geolocation\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires drawstart, drawend, drawing, tracking, follow\n * @param {any} options\n *  @param { ol.Collection.<ol.Feature> | undefined } option.features Destination collection for the drawn features.\n *  @param { ol.source.Vector | undefined } options.source Destination source for the drawn features.\n *  @param {ol.geom.GeometryType} options.type Drawing type ('Point', 'LineString', 'Polygon'), default LineString.\n *  @param {Number | undefined} options.minAccuracy minimum accuracy underneath a new point will be register (if no condition), default 20\n *  @param {function | undefined} options.condition a function that take a ol.Geolocation object and return a boolean to indicate whether location should be handled or not, default return true if accuraty < minAccuraty\n *  @param {Object} options.attributes a list of attributes to register as Point properties: {accuracy:true,accuracyGeometry:true,heading:true,speed:true}, default none.\n *  @param {Number} options.tolerance tolerance to add a new point (in projection unit), use ol.geom.LineString.simplify() method, default 5\n *  @param {Number} options.zoom zoom for tracking, default 16\n *  @param {boolean|auto|position|visible} options.followTrack true if you want the interaction to follow the track on the map, default true\n *  @param { ol.style.Style | Array.<ol.style.Style> | ol.StyleFunction | undefined } options.style Style for sketch features.\n */\nol.interaction.GeolocationDraw = function(options) {\n  if (!options) options={};\n  // Geolocation\n  this.geolocation = new ol.Geolocation(({ \n    projection: \"EPSG:4326\",\n    trackingOptions: {\n      maximumAge: 10000,\n      enableHighAccuracy: true,\n      timeout: 600000\n    }\n  }));\n  this.geolocation.on('change', this.draw_.bind(this));\n  // Current path\n  this.path_ = [];\n  this.lastPosition_ = false;\n  // Default style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var circle = new ol.style.Circle({\n    radius: width * 2,\n    fill: new ol.style.Fill({ color: blue }),\n    stroke: new ol.style.Stroke({ color: white, width: width / 2 })\n  });\n  var style = [\n    new ol.style.Style({\n      stroke: new ol.style.Stroke({ color: white, width: width + 2 })\n    }),\n    new ol.style.Style({\n      stroke: new ol.style.Stroke({ color: blue, width: width }),\n      fill: new ol.style.Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  var triangle = new ol.style.RegularShape({\n    radius: width * 3.5,\n    points: 3,\n    rotation: 0,\n    fill: new ol.style.Fill({ color: blue }),\n    stroke: new ol.style.Stroke({ color: white, width: width / 2 })\n  });\n  // stretch the symbol\n  var c = triangle.getImage();\n  var ctx = c.getContext(\"2d\");\n  var c2 = document.createElement('canvas');\n  c2.width = c2.height = c.width;\n  c2.getContext(\"2d\").drawImage(c, 0,0);\n  ctx.clearRect(0,0,c.width,c.height);\n  ctx.drawImage(c2, 0,0, c.width, c.height, width, 0, c.width-2*width, c.height);\n  var defaultStyle = function(f) {\n    if (f.get('heading')===undefined) {\n      style[1].setImage(circle);\n    } else {\n      style[1].setImage(triangle);\n      triangle.setRotation( f.get('heading') || 0);\n    }\n    return style;\n  }\n  // Style for the accuracy geometry\n  this.locStyle = {\n    error: new ol.style.Style({ fill: new ol.style.Fill({ color: [255, 0, 0, 0.2] }) }),\n    warn: new ol.style.Style({ fill: new ol.style.Fill({ color: [255, 192, 0, 0.2] }) }),\n    ok: new ol.style.Style({ fill: new ol.style.Fill({ color: [0, 255, 0, 0.2] }) }),\n  };\n  // Create a new overlay layer for the sketch\n  this.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector(),\n    name:'GeolocationDraw overlay',\n    style: options.style || defaultStyle\n  });\n  this.sketch_ = [new ol.Feature(), new ol.Feature(), new ol.Feature()];\n  this.overlayLayer_.getSource().addFeatures(this.sketch_);\n  this.features_ = options.features;\n  this.source_ = options.source;\n  this.condition_ = options.condition || function(loc) { return loc.getAccuracy() < this.get(\"minAccuracy\") };\n  // Prevent interaction when tracking\n  ol.interaction.Interaction.call(this, {\n    handleEvent: function() {\n      return (!this.get('followTrack') || this.get('followTrack')=='auto');//  || !geoloc.getTracking());\n    }\n  });\n  this.set(\"type\", options.type||\"LineString\");\n  this.set(\"attributes\", options.attributes||{});\n  this.set(\"minAccuracy\", options.minAccuracy||20);\n  this.set(\"tolerance\", options.tolerance||5);\n  this.set(\"zoom\", options.zoom);\n  this.setFollowTrack (options.followTrack===undefined ? true : options.followTrack);\n  this.setActive(false);\n};\nol.ext.inherits(ol.interaction.GeolocationDraw, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.GeolocationDraw.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol.interaction.Pointer.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n  if (map) this.geolocation.setProjection(map.getView().getProjection());\n};\n/** Activate or deactivate the interaction.\n * @param {boolean} active\n */\nol.interaction.GeolocationDraw.prototype.setActive = function(active) {\n  if (active === this.getActive()) return;\n  ol.interaction.Interaction.prototype.setActive.call(this, active);\n  this.overlayLayer_.setVisible(active);\n  if (this.getMap()) {\n    this.geolocation.setTracking(active);\n    this.getMap().renderSync();\n  }\n  this.pause(!active);\n  if (active) {\n    // Start drawing\n    this.reset();\n    this.dispatchEvent({ type:'drawstart', feature: this.sketch_[1]});\n  } else {\n    var f = this.sketch_[1].clone();\n    if (f.getGeometry()) {\n      if (this.features_) this.features_.push(f);\n      if (this.source_) this.source_.addFeature(f);\n      this.dispatchEvent({ type:'drawend', feature: f});\n    }\n  }\n};\n/** Reset drawing\n*/\nol.interaction.GeolocationDraw.prototype.reset = function() {\n  this.sketch_[1].setGeometry();\n  this.path_ = [];\n  this.lastPosition_ = false;\n};\n/** Start tracking = setActive(true)\n */\nol.interaction.GeolocationDraw.prototype.start = function() {\n  this.setActive(true);\n};\n/** Stop tracking = setActive(false)\n */\nol.interaction.GeolocationDraw.prototype.stop = function() {\n  this.setActive(false);\n};\n/** Pause drawing\n * @param {boolean} b \n */\nol.interaction.GeolocationDraw.prototype.pause = function(b) {\n  this.pause_ = b!==false;\n};\n/** Is paused\n * @return {boolean} b \n */\nol.interaction.GeolocationDraw.prototype.isPaused = function() {\n  return this.pause_;\n};\n/** Enable following the track on the map\n* @param {boolean|auto|position|visible} follow, \n*\tfalse: don't follow, \n*\ttrue: follow (position+zoom), \n*\t'position': follow only position,\n*\t'auto': start following until user move the map,\n*\t'visible': center when position gets out of the visible extent\n*/\nol.interaction.GeolocationDraw.prototype.setFollowTrack = function(follow) {\n  this.set('followTrack', follow);\n  var map = this.getMap();\n  // Center if wanted\n  if (follow !== false && !this.lastPosition_ && map) {\n    var pos = this.path_[this.path_.length-1];\n    if (pos) {\n      map.getView().animate({\n        center: pos,\n        zoom: (follow!=\"position\" ? this.get(\"zoom\") : undefined)\n      });\n    }\n  }\n  this.lastPosition_ = false;\t\t\t\t\n  this.dispatchEvent({ type:'follow', following: follow!==false });\n};\n/** Add a new point to the current path\n * @private\n */\nol.interaction.GeolocationDraw.prototype.draw_ = function() {\n  var map = this.getMap();\n  if (!map) return;\n  // Current location\n  var loc = this.geolocation;\n  var accu = loc.getAccuracy();\n  var pos = loc.getPosition();\n  pos.push (Math.round((loc.getAltitude()||0)*100)/100);\n  pos.push (Math.round((new Date()).getTime()/1000));\n  var p = loc.getAccuracyGeometry();\n  // Center on point\n  // console.log(this.get('followTrack'))\n  switch (this.get('followTrack')) {\n    // Follow center + zoom\n    case true: {\n      // modify zoom\n      if (this.get('followTrack') == true) {\n        map.getView().setZoom( this.get(\"zoom\") || 16 );\n        if (!ol.extent.containsExtent(map.getView().calculateExtent(map.getSize()), p.getExtent())) {\n          map.getView().fit(p.getExtent());\n        }\n      }\n      map.getView().setCenter( pos );\n      break;\n    }\n    // Follow  position \n    case 'position': {\n      // modify center\n      map.getView().setCenter( pos );\n      break;\n    }\n    // Keep on following \n    case 'auto': {\n      if (this.lastPosition_) {\n        var center = map.getView().getCenter();\n        // console.log(center,this.lastPosition_)\n        if (center[0]!=this.lastPosition_[0] || center[1]!=this.lastPosition_[1]) {\n          //this.dispatchEvent({ type:'follow', following: false });\n          this.setFollowTrack (false);\n        } else {\n          map.getView().setCenter( pos );\t\n          this.lastPosition_ = pos;\n        }\n      } else {\n        map.getView().setCenter( pos );\t\n        if (this.get(\"zoom\")) map.getView().setZoom( this.get(\"zoom\") );\n        this.lastPosition_ = pos;\n      }\n      break;\n    }\n    // Force to stay on the map\n    case 'visible': {\n      if (!ol.extent.containsCoordinate(map.getView().calculateExtent(map.getSize()), pos)) {\n        map.getView().setCenter (pos);\n      }\n      break;\n    }\n    // Don't follow\n    default: break;\n  }\n  // Draw occuracy\n  var f = this.sketch_[0];\n  f.setGeometry(p);\n  if (accu < this.get(\"minAccuracy\")/2) f.setStyle(this.locStyle.ok);\n  else if (accu < this.get(\"minAccuracy\")) f.setStyle(this.locStyle.warn);\n  else f.setStyle(this.locStyle.error);\n  var geo;\n  if (!this.pause_ && this.condition_.call(this, loc)) {\n    f = this.sketch_[1];\n    this.path_.push(pos);\n    switch (this.get(\"type\")) {\n      case \"Point\":\n        this.path_ = [pos];\n        f.setGeometry(new ol.geom.Point(pos, 'XYZM'));\n        var attr = this.get('attributes');\n        if (attr.heading) f.set(\"heading\",loc.getHeading());\n        if (attr.accuracy) f.set(\"accuracy\",loc.getAccuracy());\n        if (attr.altitudeAccuracy) f.set(\"altitudeAccuracy\",loc.getAltitudeAccuracy());\n        if (attr.speed) f.set(\"speed\",loc.getSpeed());\n        break;\n      case \"LineString\":\n        if (this.path_.length>1) {\n          geo = new ol.geom.LineString(this.path_, 'XYZM');\n          geo.simplify (this.get(\"tolerance\"));\n          f.setGeometry(geo);\n        } else {\n          f.setGeometry();\n        }\n        break;\n      case \"Polygon\":\n        if (this.path_.length>2) {\n          geo = new ol.geom.Polygon([this.path_], 'XYZM');\n          geo.simplify (this.get(\"tolerance\"));\n          f.setGeometry(geo);\n        }\n        else f.setGeometry();\n        break;\n    }\n    this.dispatchEvent({ type:'drawing', feature: this.sketch_[1], geolocation: loc });\n  }\n  this.sketch_[2].setGeometry(new ol.geom.Point(pos));\n  this.sketch_[2].set(\"heading\",loc.getHeading());\n  // Drawing\n  this.dispatchEvent({ type:'tracking', feature: this.sketch_[1], geolocation: loc });\n};\n\n/** Interaction hover do to something when hovering a feature\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires hover, enter, leave\n * @param {olx.interaction.HoverOptions} \n *\t@param { string | undefined } options.cursor css cursor propertie or a function that gets a feature, default: none\n *\t@param {function | undefined} optionsfeatureFilter filter a function with two arguments, the feature and the layer of the feature. Return true to select the feature \n *\t@param {function | undefined} options.layerFilter filter a function with one argument, the layer to test. Return true to test the layer\n *\t@param {number | undefined} options.hitTolerance Hit-detection tolerance in pixels.\n *\t@param { function | undefined } options.handleEvent Method called by the map to notify the interaction that a browser event was dispatched to the map. The function may return false to prevent the propagation of the event to other interactions in the map's interactions chain.\n*/\nol.interaction.Hover = function(options)\n{\tif (!options) options={};\n\tvar self = this;\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t{\tif (e.type==\"pointermove\") { self.handleMove_(e); } \n\t\t\tif (options.handleEvent) return options.handleEvent(e);\n\t\t\treturn true; \n\t\t}\n\t});\n\tthis.setFeatureFilter (options.featureFilter);\n\tthis.setLayerFilter (options.layerFilter);\n\tthis.set('hitTolerance', options.hitTolerance)\n\tthis.setCursor (options.cursor);\n};\nol.ext.inherits(ol.interaction.Hover, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Hover.prototype.setMap = function(map)\n{\tif (this.previousCursor_!==undefined && this.getMap())\n\t{\tthis.getMap().getTargetElement().style.cursor = this.previousCursor_;\n\t\tthis.previousCursor_ = undefined;\n\t}\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n};\n/**\n * Set cursor on hover\n * @param { string } cursor css cursor propertie or a function that gets a feature, default: none\n * @api stable\n */\nol.interaction.Hover.prototype.setCursor = function(cursor)\n{\tif (!cursor && this.previousCursor_!==undefined && this.getMap())\n\t{\tthis.getMap().getTargetElement().style.cursor = this.previousCursor_;\n\t\tthis.previousCursor_ = undefined;\n\t}\n\tthis.cursor_ = cursor;\n};\n/** Feature filter to get only one feature\n* @param {function} filter a function with two arguments, the feature and the layer of the feature. Return true to select the feature \n*/\nol.interaction.Hover.prototype.setFeatureFilter = function(filter)\n{\tif (typeof (filter) == 'function') this.featureFilter_ = filter;\n\telse this.featureFilter_ = function(){ return true; };\n};\n/** Feature filter to get only one feature\n* @param {function} filter a function with one argument, the layer to test. Return true to test the layer\n*/\nol.interaction.Hover.prototype.setLayerFilter = function(filter)\n{\tif (typeof (filter) == 'function') this.layerFilter_ = filter;\n\telse this.layerFilter_ = function(){ return true; };\n};\n/** Get features whenmove\n* @param {ol.event} e \"move\" event\n*/\nol.interaction.Hover.prototype.handleMove_ = function(e)\n{\tvar map = this.getMap();\n\tif (map)\n\t{\t//var b = map.hasFeatureAtPixel(e.pixel);\n\t\tvar feature, layer;\n\t\tvar self = this;\n\t\tvar b = map.forEachFeatureAtPixel(e.pixel, \n\t\t\t\t\tfunction(f, l)\n\t\t\t\t\t{\tif (self.layerFilter_.call(null, l) \n\t\t\t\t\t\t&& self.featureFilter_.call(null,f,l))\n\t\t\t\t\t\t{\tfeature = f;\n\t\t\t\t\t\t\tlayer = l;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse \n\t\t\t\t\t\t{\tfeature = layer = null;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t},{ hitTolerance: this.get('hitTolerance') });\n\t\tif (b) this.dispatchEvent({ type:\"hover\", feature:feature, layer:layer, coordinate:e.coordinate, pixel: e.pixel, map: e.map, dragging:e.dragging });\n\t\tif (this.feature_===feature && this.layer_===layer)\n\t\t{\t/* ok */\n\t\t}\n\t\telse\n\t\t{\tthis.feature_ = feature;\n\t\t\tthis.layer_ = layer;\n\t\t\tif (feature) this.dispatchEvent({ type:\"enter\", feature:feature, layer:layer, coordinate:e.coordinate, pixel: e.pixel, map: e.map, dragging:e.dragging });\n\t\t\telse this.dispatchEvent({ type:\"leave\", coordinate:e.coordinate, pixel: e.pixel, map: e.map, dragging:e.dragging });\n\t\t}\n\t\tif (this.cursor_) \n\t\t{\tvar style = map.getTargetElement().style;\n\t\t\tif (b) \n\t\t\t{\tif (style.cursor != this.cursor_) \n\t\t\t\t{\tthis.previousCursor_ = style.cursor;\n\t\t\t\t\tstyle.cursor = this.cursor_;\n\t\t\t\t}\n\t\t\t} \n\t\t\telse if (this.previousCursor_ !== undefined) \n\t\t\t{\tstyle.cursor = this.previousCursor_;\n\t\t\t\tthis.previousCursor_ = undefined;\n\t\t\t}\n\t\t}\n\t}\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction to handle longtouch events\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.LongTouchOptions} \n * \t@param {function | undefined} options.handleLongTouchEvent Function handling \"longtouch\" events, it will receive a mapBrowserEvent.\n *\t@param {interger | undefined} options.delay The delay for a long touch in ms, default is 1000\n */\nol.interaction.LongTouch = function(options)\n{\tif (!options) options = {};\n\tthis.delay_ = options.delay || 1000;\n\tvar ltouch = options.handleLongTouchEvent || function(){};\n\tvar _timeout = null;\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t{\tif (this.getActive())\n\t\t\t{\tswitch (e.type)\n\t\t\t\t{\tcase 'pointerdown': \n\t\t\t\t\t\tif (_timeout) clearTimeout(_timeout);\n\t\t\t\t\t\t_timeout = setTimeout (function()\n\t\t\t\t\t\t\t{\te.type = \"longtouch\";\n\t\t\t\t\t\t\t\tltouch(e) \n\t\t\t\t\t\t\t}, this.delay_);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t/* case 'pointermove': */\n\t\t\t\t\tcase 'pointerdrag':\n\t\t\t\t\tcase 'pointerup':\n\t\t\t\t\t\tif (_timeout) \n\t\t\t\t\t\t{\tclearTimeout(_timeout);\n\t\t\t\t\t\t\t_timeout = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault: break;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\tif (_timeout) \n\t\t\t\t{\tclearTimeout(_timeout);\n\t\t\t\t\t_timeout = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t});\n};\nol.ext.inherits(ol.interaction.LongTouch, ol.interaction.Interaction);\n\n/* Extent the ol/interaction/Modify with a getModifyFeatures\n * Get the features modified by the interaction\n * @return {Array<ol.Feature>} the modified features\n */\nol.interaction.Modify.prototype.getModifiedFeatures = function() {\n  var featuresById = {};\n  this.dragSegments_.forEach( function(s) {\n    var feature = s[0].feature;\n    featuresById[ol.getUid(feature)] = feature;\n  });\n  var features = [];\n  for (var i in featuresById) features.push(featuresById[i]);\n  return features;\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction for modifying feature geometries. Similar to the core ol/interaction/Modify.\n * The interaction is more suitable to use to handle feature modification: only features concerned \n * by the modification are passed to the events (instead of all feature with ol/interaction/Modify)\n * - the modifystart event is fired before the feature is modified (no points still inserted)\n * - the modifyend event is fired after the modification\n * - it fires a modifying event\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires modifystart\n * @fires modifying\n * @fires modifyend\n * @param {*} options\n *\t@param {ol.source.Vector|Array<ol.source.Vector>} options.source a list of source to modify (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to modify\n *  @param {integer} options.pixelTolerance Pixel tolerance for considering the pointer close enough to a segment or vertex for editing. Default is 10.\n *  @param {function|undefined} options.filter a filter that takes a feature and return true if it can be modified, default always true.\n *  @param {ol.style.Style | Array<ol.style.Style> | undefined} options.style Style for the sketch features.\n *  @param {ol.EventsConditionType | undefined} options.condition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event will be considered to add or move a vertex to the sketch. Default is ol.events.condition.primaryAction.\n *  @param {ol.EventsConditionType | undefined} options.deleteCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. By default, ol.events.condition.singleClick with ol.events.condition.altKeyOnly results in a vertex deletion.\n *  @param {ol.EventsConditionType | undefined} options.insertVertexCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether a new vertex can be added to the sketch features. Default is ol.events.condition.always\n */\nol.interaction.ModifyFeature = function(options){\n  if (!options) options = {};\n  var dragging, modifying;\n  ol.interaction.Pointer.call(this,{\n    /*\n    handleDownEvent: this.handleDownEvent,\n    handleDragEvent: this.handleDragEvent,\n    handleMoveEvent: this.handleMoveEvent,\n    handleUpEvent: this.handleUpEvent,\n    */\n    handleEvent: function(e) {\n      switch(e.type) {\n        case 'pointerdown': {\n          dragging = this.handleDownEvent(e);\n          modifying = dragging || this._deleteCondition(e);\n          return !dragging;\n        }\n        case 'pointerup': {\n          dragging = false;\n          return this.handleUpEvent(e);\n        }\n        case 'pointerdrag': {\n          if (dragging) return this.handleDragEvent(e);\n          else return true;\n        }\n        case 'pointermove': {\n          if (!dragging) return this.handleMoveEvent(e);\n          else return true;\n        }\n        case 'singleclick':\n        case 'click': {\n          // Prevent click when modifying\n          return !modifying;\n        }\n        default: return true;\n      }\n    }\n  });\n  // Snap distance (in px)\n  this.snapDistance_ = options.pixelTolerance || 10;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n  if (options.features) {\n    this.sources_.push (new ol.source.Vector({ features: options.features }));\n  }\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n  this._condition = options.condition || ol.events.condition.primaryAction;\n  this._deleteCondition = options.deleteCondition || ol.events.condition.altKeyOnly;\n  this._insertVertexCondition = options.insertVertexCondition || ol.events.condition.always;\n  // Default style\n  var sketchStyle = function() {\n    return [ new ol.style.Style({\n        image: new ol.style.Circle({\n          radius: 6,\n          fill: new ol.style.Fill({ color: [0, 153, 255, 1] }),\n          stroke: new ol.style.Stroke({ color: '#FFF', width: 1.25 })\n        })\n      })\n    ];\n  }\n  // Custom style\n  if (options.style) {\n    if (typeof(options.style) === 'function') {\n      sketchStyle = options.style\n     } else {\n       sketchStyle = function() { return options.style; }\n     }\n  }\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      useSpatialIndex: false\n    }),\n    name:'Modify overlay',\n    displayInLayerSwitcher: false,\n    style: sketchStyle\n  });\n};\nol.ext.inherits(ol.interaction.ModifyFeature, ol.interaction.Pointer);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.ModifyFeature.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n/**\n * Activate or deactivate the interaction + remove the sketch.\n * @param {boolean} active.\n * @api stable\n */\nol.interaction.ModifyFeature.prototype.setActive = function(active) {\n  ol.interaction.Interaction.prototype.setActive.call (this, active);\n  if (this.overlayLayer_) this.overlayLayer_.getSource().clear();\n};\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {*} \n * @private\n */\nol.interaction.ModifyFeature.prototype.getClosestFeature = function(e) {\n  var f, c, d = this.snapDistance_+1;\n  for (var i=0; i<this.sources_.length; i++) {\n    var source = this.sources_[i];\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\n    if (f && this.filterSplit_(f)) {\n      var ci = f.getGeometry().getClosestPoint(e.coordinate);\n      var di = ol.coordinate.dist2d(e.coordinate,ci) / e.frameState.viewState.resolution;\n      if (di < d){\n        d = di;\n        c = ci;\n      }\n      break;\n    }\n  }\n  if (d > this.snapDistance_) {\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry());\n    if (coord) {\n      coord = coord.coord;\n      var p = this.getMap().getPixelFromCoordinate(coord);\n      if (ol.coordinate.dist2d(e.pixel, p) < this.snapDistance_) {\n        c = coord;\n      }\n      //\n      return { source:source, feature:f, coord: c };\n    }\n  }\n}\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {ol.geom} coords list of coordinates\n* @return {*} the nearest point with a coord (projected point), dist (distance to the geom), ring (if Polygon)\n*/\nol.interaction.ModifyFeature.prototype.getNearestCoord = function(pt, geom) {\n  var i, l, p, p0, dm;\n  switch (geom.getType()) {\n    case 'Point': {\n      return { coord: geom.getCoordinates(), dist: ol.coordinate.dist2d(geom.getCoordinates(), pt) };\n    }\n    case 'MultiPoint': {\n      return this.getNearestCoord (pt, new ol.geom.LineString(geom.getCoordinates()));\n    }\n    case 'LineString':\n    case 'LinearRing': {\n      var d;\n      dm = Number.MAX_VALUE;\n      var coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        d = ol.coordinate.dist2d (pt, coords[i]);\n        if (d < dm) {\n          dm = d;\n          p0 = coords[i];\n        }\n      }\n      return { coord: p0, dist: dm };\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      p0 = false, dm = Number.MAX_VALUE;\n      for (i=0; l=lstring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=lring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=poly[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.poly = i;\n        }\n      }\n      return p0;\n    }\n    case 'GeometryCollection': {\n      var g = geom.getGeometries();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=g[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.geom = i;\n        }\n      }\n      return p0;\n    }\n    default: return false;\n  }\n};\n/** Get arcs concerned by a modification \n * @param {ol.geom} geom the geometry concerned\n * @param {ol.coordinate} coord pointed coordinates\n */\nol.interaction.ModifyFeature.prototype.getArcs = function(geom, coord) {\n  var arcs = false;\n  var coords, i, s, l;\n  switch(geom.getType()) {\n    case 'Point': {\n      if (ol.coordinate.equal(coord, geom.getCoordinates())) {\n        arcs = { \n          geom: geom, \n          type: geom.getType(),\n          coord1: [],\n          coord2: [],\n          node: true\n        }\n      }\n      break;\n    }\n    case 'MultiPoint': {\n      coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        if (ol.coordinate.equal(coord, coords[i])) {\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            index: i,\n            coord1: [],\n            coord2: [],\n            node: true\n          }\n          break;\n        }\n      }\n      break;\n    }\n    case 'LinearRing': \n    case 'LineString': {\n      var p = geom.getClosestPoint(coord);\n      if (ol.coordinate.dist2d(p,coord) < 1.5*this.tolerance_) {\n        var split;\n        // Split the line in two\n        if (geom.getType() === 'LinearRing') {\n          var g = new ol.geom.LineString(geom.getCoordinates());\n          split = g.splitAt(coord, this.tolerance_);\n        } else {\n          split = geom.splitAt(coord, this.tolerance_);\n        }\n        // If more than 2\n        if (split.length>2) {\n          coords = split[1].getCoordinates();\n          for (i=2; s=split[i]; i++) {\n            var c = s.getCoordinates();\n            c.shift();\n            coords = coords.concat(c);\n          }\n          split = [ split[0], new ol.geom.LineString(coords) ];\n        }\n        // Split in two\n        if (split.length === 2) {\n          var c0 = split[0].getCoordinates();\n          var c1 = split[1].getCoordinates();\n          var nbpt = c0.length + c1.length -1;\n          c0.pop();\n          c1.shift();\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            coord1: c0, \n            coord2: c1,\n            node: (geom.getCoordinates().length === nbpt),\n            closed: false\n          }\n        } else if (split.length === 1) {\n          s = split[0].getCoordinates();\n          var start = ol.coordinate.equal(s[0], coord);\n          var end = ol.coordinate.equal(s[s.length-1], coord);\n          // Move first point\n          if (start) {\n            s.shift();\n            if (end) s.pop();\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: [], \n              coord2: s,\n              node: true,\n              closed: end\n            }\n          } else if (end) {\n            // Move last point\n            s.pop()\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: s, \n              coord2: [],\n              node: true,\n              closed: false\n            }\n          }\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      for (i=0; l=lstring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.lstring = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      for (i=0; l=lring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.index = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      for (i=0; l=poly[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.poly = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'GeometryCollection': {\n      for (i=0; l=g[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.g = i;\n          arcs.typeg = arcs.type;\n          arcs.type = geom.getType();\n          break;\n        }\n      }\n      break;\n    }\n    default: {\n      console.error('ol/interaction/ModifyFeature '+geom.getType()+' not supported!');\n      break;\n    }\n  }\n  return arcs;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol.interaction.ModifyFeature.prototype.handleDownEvent = function(evt) {\n  if (!this.getActive()) return false;\n  // Something to split ?\n  var current = this.getClosestFeature(evt);\n  if (current && (this._condition(evt) || this._deleteCondition(evt))) {\n    var features = [];\n    this.arcs = [];\n    // Get features concerned\n    this.sources_.forEach(function(s) {\n      var extent = ol.extent.buffer (ol.extent.boundingExtent([current.coord]), this.tolerance_);\n      features = features.concat(features, s.getFeaturesInExtent(extent));\n    }.bind(this));\n    // Get arcs concerned\n    this._modifiedFeatures = [];\n    features.forEach(function(f) {\n      var a = this.getArcs(f.getGeometry(), current.coord);\n      if (a) {\n        if (this._insertVertexCondition(evt) || a.node) {\n          a.feature = f;\n          this._modifiedFeatures.push(f);\n          this.arcs.push(a);\n        }\n      }\n    }.bind(this));\n    if (this._modifiedFeatures.length) {\n      if (this._deleteCondition(evt)) {\n        return !this._removePoint(current, evt); \n      } else {\n        this.dispatchEvent({ \n          type:'modifystart', \n          coordinate: current.coord,\n          originalEvent: evt.originalEvent,\n          features: this._modifiedFeatures\n        });\n        this.handleDragEvent({ coordinate: current.coord })\n        return true;\n      }\n    } else {\n      return true;\n    }\n  } else {\n    return false;\n  }\n};\n/** Get modified features\n * @return {Array<ol.Feature>} list of modified features\n */\nol.interaction.ModifyFeature.prototype.getModifiedFeatures = function() {\n  return this._modifiedFeatures || [];\n};\n/** Removes the vertex currently being pointed.\n */\nol.interaction.ModifyFeature.prototype.removePoint = function() {\n  this._removePoint({},{});\n};\n/**\n * @private\n */\nol.interaction.ModifyFeature.prototype._getModification = function(a) {\n  var coords = a.coord1.concat(a.coord2);\n  switch (a.type) {\n    case 'LineString': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>1) {\n        if (a.geom.getCoordinates().length != coords.length) {\n          a.coords = coords;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>1) {\n        var c = a.geom.getCoordinates();\n        if (c[a.lstring].length != coords.length) {\n          c[a.lstring] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>3) {\n        c = a.geom.getCoordinates();\n        if (c[a.index].length != coords.length) {\n          c[a.index] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>3) {\n        c = a.geom.getCoordinates();\n        if (c[a.poly][a.index].length != coords.length) {\n          c[a.poly][a.index] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'GeometryCollection': {\n      a.type = a.typeg;\n      var geom = a.geom;\n      var geoms = geom.getGeometries();\n      a.geom = geoms[a.g];\n      var found = this._getModification(a);\n      // Restore current arc\n      geom.setGeometries(geoms);\n      a.geom = geom;\n      a.type = 'GeometryCollection';\n      return found;\n    }\n    default: {\n      //console.error('ol/interaction/ModifyFeature '+a.type+' not supported!');\n      break;\n    }\n  }\n  return false;\n};\n/** Removes the vertex currently being pointed.\n * @private\n */\nol.interaction.ModifyFeature.prototype._removePoint = function(current, evt) {\n  if (!this.arcs) return false;\n  this.overlayLayer_.getSource().clear();\n  var found = false;\n  // Get all modifications\n  this.arcs.forEach(function(a) {\n    found = found || this._getModification(a);\n  }.bind(this));\n  // Almost one point is removed\n  if (found) {\n    this.dispatchEvent({ \n      type:'modifystart', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n    this.arcs.forEach(function(a) {\n      if (a.geom.getType() === 'GeometryCollection') {\n        if (a.coords) {\n          var geoms = a.geom.getGeometries();\n          geoms[a.g].setCoordinates(a.coords);\n          a.geom.setGeometries(geoms);\n        }\n      } else {\n        if (a.coords) a.geom.setCoordinates(a.coords);\n      }\n    }.bind(this));\n    this.dispatchEvent({ \n      type:'modifyend', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n  }\n  this.arcs = [];\n  return found;\n};\n/**\n * @private\n */\nol.interaction.ModifyFeature.prototype.handleUpEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs || !this.arcs.length) return true;\n  this.overlayLayer_.getSource().clear();\n  this.dispatchEvent({ \n    type:'modifyend', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n  return true;\n};\n/**\n * @private\n */\nol.interaction.ModifyFeature.prototype.setArcCoordinates = function(a, coords) {\n  var c;\n  switch (a.type) {\n    case 'Point': {\n      a.geom.setCoordinates(coords[0]);\n      break;\n    }\n    case 'MultiPoint': {\n      c = a.geom.getCoordinates();\n      c[a.index] = coords[0];\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'LineString': {\n      a.geom.setCoordinates(coords);\n      break;\n    }\n    case 'MultiLineString': {\n      c = a.geom.getCoordinates();\n      c[a.lstring] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'Polygon': {\n      c = a.geom.getCoordinates();\n      c[a.index] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'MultiPolygon': {\n      c = a.geom.getCoordinates();\n      c[a.poly][a.index] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'GeometryCollection': {\n      a.type = a.typeg;\n      var geom = a.geom;\n      var geoms = geom.getGeometries();\n      a.geom = geoms[a.g];\n      this.setArcCoordinates(a, coords);\n      geom.setGeometries(geoms);\n      a.geom = geom;\n      a.type = 'GeometryCollection';\n      break;\n    }\n  }\n};\n/**\n * @private\n */\nol.interaction.ModifyFeature.prototype.handleDragEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs) return true;\n  // Show sketch\n  this.overlayLayer_.getSource().clear();\n  var p = new ol.Feature(new ol.geom.Point(e.coordinate));\n  this.overlayLayer_.getSource().addFeature(p);\n  // Nothing to do\n  if (!this.arcs.length) return true;\n  // Move arcs\n  this.arcs.forEach(function(a) {\n    var coords = a.coord1.concat([e.coordinate], a.coord2);\n    if (a.closed) coords.push(e.coordinate);\n    this.setArcCoordinates(a, coords);\n  }.bind(this));\n  this.dispatchEvent({ \n    type:'modifying', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n  return true;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nol.interaction.ModifyFeature.prototype.handleMoveEvent = function(e) {\n  if (!this.getActive()) return false;\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n  // Draw sketch\n  if (current) {\n    var p = new ol.Feature(new ol.geom.Point(current.coord));\n    this.overlayLayer_.getSource().addFeature(p);\n  }\n  // Show cursor\n  var element = e.map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Modify interaction with a popup to delet a point on touch device\n * @constructor\n * @fires showpopup\n * @fires hidepopup\n * @extends {ol.interaction.Modify}\n * @param {olx.interaction.ModifyOptions} options\n *  @param {String|undefined} options.title title to display, default \"remove point\"\n *  @param {Boolean|undefined} options.usePopup use a popup, default true\n */\nol.interaction.ModifyTouch = function(options) {\n  var self = this;\n  if (!options) options = {};\n  this._popup = new ol.Overlay.Popup ({\n    popupClass: options.calssName || 'modifytouch',\n    positioning: 'bottom-rigth',\n    offsetBox: 10\n  });\n  this._source = options.source;\n  this._features = options.features;\n  // popup content\n  var a = document.createElement('a');\n  a.appendChild(document.createTextNode(options.title || \"remove point\"));\n  a.onclick = function() {\n    self.removePoint();\n  };\n  this.setPopupContent(a);\n  var pixelTolerance = options.pixelTolerance || 0;\n  var searchDist = pixelTolerance +5;\n  // Check if there is a feature to select\n  options.condition = function(e) {\n\t\tvar features = this.getMap().getFeaturesAtPixel(e.pixel,{\n      hitTolerance: searchDist\n    });\n    var p0, p1, found = false;\n\t\tif (features) {\n      var search = this._features;\n      if (!search) {\n        p0 = [e.pixel[0] - searchDist, e.pixel[1] - searchDist]\n        p1 = [e.pixel[0] + searchDist, e.pixel[1] + searchDist]\n        p0 = this.getMap().getCoordinateFromPixel(p0);\n        p1 = this.getMap().getCoordinateFromPixel(p1);\n        var ext = ol.extent.boundingExtent([p0,p1]);\n        search = this._source.getFeaturesInExtent(ext);\n      } \n      if (search.getArray) search = search.getArray();\n      for (var i=0, f; f=features[i]; i++) {\n        if (search.indexOf(f) >= 0) break;\n      }\n      if (f) {\n        p0 = e.pixel;\n        p1 = f.getGeometry().getClosestPoint(e.coordinate);\n        p1 = this.getMap().getPixelFromCoordinate(p1);\n        var dx = p0[0] - p1[0];\n        var dy = p0[1] - p1[1];\n        found = (Math.sqrt(dx*dx+dy*dy) < searchDist);\n      }\n    }\n    // Show popup if any\n    this.showDeleteBt(found ? { type:'show', feature:f, coordinate: e.coordinate } : { type:'hide' });\n    // Prevent click on the popup\n    e.preventDefault();\n    e.stopPropagation();\n\t\treturn true;\n  };\n  // Hide popup on insert\n\toptions.insertVertexCondition = function() {\n\t\tthis.showDeleteBt({ type:'hide' });\n\t\treturn true;\n  }\n  ol.interaction.Modify.call(this, options);\n  this.on(['modifystart','modifyend'], function(){\n\t\tthis.showDeleteBt({ type:'hide', modifying: true });\n  });\n  // Use a popup ?\n  this.set('usePopup', options.usePopup !== false);\n};\nol.ext.inherits(ol.interaction.ModifyTouch, ol.interaction.Modify);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.ModifyTouch.prototype.setMap = function(map) {\t\n  if (this.getMap()) {\n    this.getMap().removeOverlay(this._popup);\n  }\n\tol.interaction.Modify.prototype.setMap.call (this, map);\n  if (this.getMap()) {\n    this.getMap().addOverlay(this._popup);\n  }\n};\n/** Activate the interaction and remove popup\n * @param {Boolean} b\n */\nol.interaction.ModifyTouch.prototype.setActive = function(b) {\t\n  ol.interaction.Modify.prototype.setActive.call (this, b);\n  this.showDeleteBt({ type:'hide' });\n};\n/**\n * Remove the current point\n */\nol.interaction.ModifyTouch.prototype.removePoint = function() {\t\n  // Prevent touch + click on popup \n  if (new Date() - this._timeout < 200) return;\n  // Remove point\n  ol.interaction.Modify.prototype.removePoint.call (this);\n  this.showDeleteBt({ type:'hide' });\n}\n/**\n * Show the delete button (menu)\n * @param {Event} e\n * @api stable\n */\nol.interaction.ModifyTouch.prototype.showDeleteBt = function(e) {\n  if (this.get('usePopup') && e.type==='show') {\n    this._popup.show(e.coordinate, this._menu);\n  } else {\n    this._popup.hide();\n  }\n  e.type += 'popup';\n  this.dispatchEvent(e);\n  // Date if popup start a timeout to prevent touch + click on the popup\n  this._timeout = new Date();\n};\n/**\n * Change the popup content\n * @param {DOMElement} html \n */\nol.interaction.ModifyTouch.prototype.setPopupContent = function(html) {\n  this._menu = html;\n}\n/**\n * Get the popup content\n * @return {DOMElement}\n */\nol.interaction.ModifyTouch.prototype.getPopupContent = function() {\n  return this._menu;\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Offset interaction for offseting feature geometry\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires offsetstart\n * @fires offsetting\n * @fires offsetend\n * @param {any} options\n *\t@param {ol.layer.Vector | Array<ol.layer.Vector>} options.layers list of feature to transform \n *\t@param {ol.Collection.<ol.Feature>} options.features collection of feature to transform\n *\t@param {ol.source.Vector | undefined} options.source source to duplicate feature when ctrl key is down\n *\t@param {boolean} options.duplicate force feature to duplicate (source must be set)\n */\nol.interaction.Offset = function(options) {\n  if (!options) options = {};\n\t// Extend pointer\n\tol.interaction.Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n\t// Collection of feature to transform\n\tthis.features_ = options.features;\n\t// List of layers to transform\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n  // duplicate\n  this.set('duplicate', options.duplicate);\n  this.source_ = options.source;\n  // init\n  this.previousCursor_ = false;\n};\nol.ext.inherits(ol.interaction.Offset, ol.interaction.Pointer);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Offset.prototype.setMap = function(map) {\n\tol.interaction.Pointer.prototype.setMap.call (this, map);\n};\n/** Get Feature at pixel\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {any} a feature and the hit point\n * @private\n */\nol.interaction.Offset.prototype.getFeatureAtPixel_ = function(e) {\n  var self = this;\n\treturn this.getMap().forEachFeatureAtPixel(e.pixel,\n\t\tfunction(feature, layer) {\n      var current;\n\t\t\t// feature belong to a layer\n\t\t\tif (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) {\n            current = feature;\n            break;\n          }\n\t\t\t\t}\n\t\t\t}\n\t\t\t// feature in the collection\n\t\t\telse if (self.features_) {\n        self.features_.forEach (function(f) {\n          if (f===feature) {\n            current = feature \n          }\n        });\n\t\t\t}\n\t\t\t// Others\n\t\t\telse {\n        current = feature;\n      }\n      // Only poygon or linestring\n      var typeGeom = current.getGeometry().getType();\n      if (current && /Polygon|LineString/.test(typeGeom)) {\n        if (typeGeom==='Polygon' && current.getGeometry().getCoordinates().length>1) return false;\n        // test distance\n        var p = current.getGeometry().getClosestPoint(e.coordinate);\n        var dx = p[0]-e.coordinate[0];\n        var dy = p[1]-e.coordinate[1];\n        var d = Math.sqrt(dx*dx+dy*dy) / e.frameState.viewState.resolution;\n        if (d<5) {\n          return { \n            feature: current, \n            hit: p, \n            coordinates: current.getGeometry().getCoordinates(),\n            geom: current.getGeometry().clone(),\n            geomType: typeGeom\n          }\n        } else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n\t\t},  { hitTolerance: 5 });\n};\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n * @private\n */\nol.interaction.Offset.prototype.handleDownEvent_ = function(e) {\t\n  this.current_ = this.getFeatureAtPixel_(e);\n  if (this.source_ && (this.get('duplicate') || e.originalEvent.ctrlKey)) {\n    this.current_.feature = this.current_.feature.clone();\n    this.source_.addFeature(this.current_.feature);\n  } else {\n    // Modify the current feature\n    if (this.current_) {\n      this.dispatchEvent({ type:'modifystart', features: [ this.current_.feature ] });\n    }\n  }\n\tif (this.current_) {\n    this.dispatchEvent({ type:'offsetstart', feature: this.current_.feature, offset: 0 });\n    return true;\n  } else  {\n    return false;\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol.interaction.Offset.prototype.handleDragEvent_ = function(e) {\n  var p = this.current_.geom.getClosestPoint(e.coordinate);\n  var d = ol.coordinate.dist2d(p, e.coordinate);\n  var seg, v1, v2, offset;\n  switch (this.current_.geomType) {\n    case  'Polygon': {\n      seg = ol.coordinate.findSegment(p, this.current_.coordinates[0]).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n        offset = [];\n        for (var i=0; i<this.current_.coordinates.length; i++) {\n          offset.push( ol.coordinate.offsetCoords(this.current_.coordinates[i], i==0 ? d : -d) );\n        }\n        this.current_.feature.setGeometry(new ol.geom.Polygon(offset));\n      }\n      break;\n    }\n    case 'LineString': {\n      seg = ol.coordinate.findSegment(p, this.current_.coordinates).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n        offset = ol.coordinate.offsetCoords(this.current_.coordinates, d);\n        this.current_.feature.setGeometry(new ol.geom.LineString(offset));\n      }\n      break;\n    }\n    default: {\n      break;\n    }\n  }\n  this.dispatchEvent({ type:'offsetting', feature: this.current_.feature, offset: d, segment: [p, e.coordinate], coordinate: e.coordinate });  \n};\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol.interaction.Offset.prototype.handleUpEvent_ = function(e) {\n  this.dispatchEvent({ type:'offsetend', feature: this.current_.feature, coordinate: e.coordinate });  \n  this.current_ = false;\n};\n/**\n * @param {ol.MapBrowserEvent} e Event.\n * @private\n */\nol.interaction.Offset.prototype.handleMoveEvent_ = function(e) {\t\n  var f = this.getFeatureAtPixel_(e);\n  if (f) {\n    if (this.previousCursor_ === false) {\n      this.previousCursor_ = e.map.getTargetElement().style.cursor;\n    }\n    e.map.getTargetElement().style.cursor = 'pointer';\n  } else {\n    e.map.getTargetElement().style.cursor = this.previousCursor_;\n    this.previousCursor_ = false;\n  }\n};\n\n/*\t\n\tWater ripple effect.\n\tOriginal code (Java) by Neil Wallis \n\t@link http://www.neilwallis.com/java/water.html\n\tOriginal code (JS) by Sergey Chikuyonok (serge.che@gmail.com)\n\t@link http://chikuyonok.ru\n\t@link http://media.chikuyonok.ru/ripple/\n\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\t@link https://github.com/Viglino\n */\n/**\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.flashlight.options} flashlight options param\n *\t\t- color {ol.Color} light color, default transparent\n *\t\t- fill {ol.Color} fill color, default rgba(0,0,0,0.8)\n *\t\t- radius {number} radius of the flash\n */\nol.interaction.Ripple = function(options)\n{\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.rainDrop,\n\t\thandleMoveEvent: this.rainDrop\n\t});\n\t// Default options\n\toptions = options||{};\n\tthis.riprad = options.radius || 3;\n\tthis.ripplemap = [];\n    this.last_map = [];\n    // Generate random ripples\n    this.interval = options.interval;\n\tthis.rains (this.interval);\n};\nol.ext.inherits(ol.interaction.Ripple, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.Ripple.prototype.setMap = function(map)\n{\tif (this.oncompose)\n\t{\tol.Observable.unByKey(this.oncompose);\n\t\tif (this.getMap()) this.getMap().render();\n\t}\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map)\n\t{\tthis.oncompose = map.on('postcompose', this.postcompose_.bind(this));\n\t}\n}\n/** Generate random rain drop\n*\t@param {integer} interval\n*/\nol.interaction.Ripple.prototype.rains = function(interval)\n{\tif (this.onrain) clearTimeout (this.onrain);\n\tvar self = this;\n\tvar vdelay = (typeof(interval)==\"number\" ? interval : 1000)/2;\n\tvar delay = 3*vdelay/2;\n\tvar rnd = Math.random;\n\tfunction rain() \n\t{\tif (self.width) self.rainDrop([rnd() * self.width, rnd() * self.height]);\n\t\tself.onrain = setTimeout (rain, rnd()*vdelay + delay);\n\t}\n\t// Start raining\n\tif (delay) rain();\n}\n/** Disturb water at specified point\n*\t@param {ol.Pixel|ol.MapBrowserEvent}\n*/\nol.interaction.Ripple.prototype.rainDrop = function(e)\n{\tif (!this.width) return;\n\tvar dx,dy;\n\tif (e.pixel) \n\t{\tdx = e.pixel[0]*this.ratio;\n\t\tdy = e.pixel[1]*this.ratio;\n\t}\n\telse \n\t{\tdx = e[0]*this.ratio;\n\t\tdy = e[1]*this.ratio;\n\t}\n\tdx <<= 0;\n    dy <<= 0;\n    for (var j = dy - this.riprad*this.ratio; j < dy + this.riprad*this.ratio; j++) \n\t{   for (var k = dx - this.riprad*this.ratio; k < dx + this.riprad*this.ratio; k++) \n\t\t{   this.ripplemap[this.oldind + (j * this.width) + k] += 128;\n        }\n    }\n}\n/** Postcompose function\n*/\nol.interaction.Ripple.prototype.postcompose_ = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\t// Initialize when canvas is ready / modified\n\tif (this.width != canvas.width || this.height != canvas.height)\n\t{\tthis.width = canvas.width;\n\t\tthis.height = canvas.height;\n\t\tthis.ratio = e.frameState.pixelRatio;\n\t\tthis.half_width = this.width >> 1;\n\t\tthis.half_height = this.height >> 1;\n\t\tthis.size = this.width * (this.height + 2) * 2;\n\t\tthis.oldind = this.width;\n\t\tthis.newind = this.width * (this.height + 3);\n\t\tfor (var i = 0; i < this.size; i++) {\n\t\t\tthis.last_map[i] = this.ripplemap[i] = 0;\n\t\t}\n\t}\n\tthis.texture = ctx.getImageData(0, 0, this.width, this.height);\n\tthis.ripple = ctx.getImageData(0, 0, this.width, this.height);\t\n\t// Run animation\n\tvar a, b, data, cur_pixel, new_pixel;\n    var t = this.oldind; this.oldind = this.newind; this.newind = t;\n    i = 0;\n    var _rd = this.ripple.data,\n        _td = this.texture.data;\n    for (var y = 0; y < this.height; y++) {\n        for (var x = 0; x < this.width; x++) {\n            var _newind = this.newind + i,\n\t\t\t\t_mapind = this.oldind + i;\n            data = (\n                this.ripplemap[_mapind - this.width] + \n                this.ripplemap[_mapind + this.width] + \n                this.ripplemap[_mapind - 1] + \n                this.ripplemap[_mapind + 1]) >> 1;\n            data -= this.ripplemap[_newind];\n            data -= data >> 5;\n            this.ripplemap[_newind] = data;\n            //where data=0 then still, where data>0 then wave\n            data = 1024 - data;\n            if (this.last_map[i] != data) \n\t\t\t{   this.last_map[i] = data;\n\t\t\t\t//offsets\n                a = (((x - this.half_width) * data / 1024) << 0) + this.half_width;\n                b = (((y - this.half_height) * data / 1024) << 0) + this.half_height;\n                //bounds check\n                if (a >= this.width) a = this.width - 1;\n                if (a < 0) a = 0;\n                if (b >= this.height) b = this.height - 1;\n                if (b < 0) b = 0;\n                new_pixel = (a + (b * this.width)) * 4;\n                cur_pixel = i * 4;\n\t\t\t\t/**/\n                _rd[cur_pixel] = _td[new_pixel];\n                _rd[cur_pixel + 1] = _td[new_pixel + 1];\n                _rd[cur_pixel + 2] = _td[new_pixel + 2];\n\t\t\t\t/*/\n\t\t\t\t// only in blue pixels \n                if (_td[new_pixel + 2]>_td[new_pixel + 1]\n\t\t\t\t\t&& _td[new_pixel + 2]>_td[new_pixel])\n\t\t\t\t{\n                _rd[cur_pixel] = _td[new_pixel];\n                _rd[cur_pixel + 1] = _td[new_pixel + 1];\n                _rd[cur_pixel + 2] = _td[new_pixel + 2];\n\t\t\t\t}\n\t\t\t\telse this.ripplemap[_newind] = 0;\n\t\t\t\t/**/\n            }\n            ++i;\n        }\n    }\n\tctx.putImageData(this.ripple, 0, 0);\n\t// tell OL3 to continue postcompose animation\n\tthis.getMap().render(); \n};\n\n/*\n\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (http://www.cecill.info/).\n\tol.interaction.SelectCluster is an interaction for selecting vector features in a cluster.\n*/\n/**\n * @classdesc\n * Interaction for selecting vector features in a cluster. \n * It can be used as an ol.interaction.Select. \n * When clicking on a cluster, it springs apart to reveal the features in the cluster.\n * Revealed features are selectable and you can pick the one you meant.\n * Revealed features are themselves a cluster with an attribute features that contain the original feature.\n * \n * @constructor\n * @extends {ol.interaction.Select}\n * @param {olx.interaction.SelectOptions=} options SelectOptions.\n *  @param {ol.style} options.featureStyle used to style the revealed features as options.style is used by the Select interaction.\n * \t@param {boolean} options.selectCluster false if you don't want to get cluster selected\n * \t@param {Number} options.PointRadius to calculate distance between the features\n * \t@param {bool} options.spiral means you want the feature to be placed on a spiral (or a circle)\n * \t@param {Number} options.circleMaxObject number of object that can be place on a circle\n * \t@param {Number} options.maxObjects number of object that can be drawn, other are hidden\n * \t@param {bool} options.animation if the cluster will animate when features spread out, default is false\n * \t@param {Number} options.animationDuration animation duration in ms, default is 500ms\n * @fires ol.interaction.SelectEvent\n * @api stable\n */\nol.interaction.SelectCluster = function(options) \n{\toptions = options || {};\n\tvar fn; \n\tthis.pointRadius = options.pointRadius || 12;\n\tthis.circleMaxObjects = options.circleMaxObjects || 10;\n\tthis.maxObjects = options.maxObjects || 60;\n\tthis.spiral = (options.spiral !== false);\n\tthis.animate = options.animate;\n\tthis.animationDuration = options.animationDuration || 500;\n\tthis.selectCluster_ = (options.selectCluster !== false);\n\t// Create a new overlay layer for \n\tvar overlay = this.overlayLayer_ = new ol.layer.Vector(\n\t\t{\tsource: new ol.source.Vector({\n\t\t\t\tfeatures: new ol.Collection(),\n\t\t\t\twrapX: options.wrapX,\n\t\t\t\tuseSpatialIndex: true\n\t\t\t}),\n\t\t\tname:'Cluster overlay',\n\t\t\tupdateWhileAnimating: true,\n\t\t\tupdateWhileInteracting: true,\n\t\t\tdisplayInLayerSwitcher: false,\n\t\t\tstyle: options.featureStyle\n\t\t});\n\t// Add the overlay to selection\n\tif (options.layers)\n\t{\tif (typeof(options.layers) == \"function\")\n\t\t{\tfn = options.layers;\n\t\t\toptions.layers = function(layer)\n\t\t\t{\treturn (layer===overlay || fn(layer));\n\t\t\t};\n\t\t}\n\t\telse if (options.layers.push)\n\t\t{\toptions.layers.push(this.overlayLayer_);\n\t\t}\n\t}\n\t// Don't select links\n\tif (options.filter)\n\t{\tfn = options.filter;\n\t\toptions.filter = function(f,l)\n\t\t{\t//if (l===overlay && f.get(\"selectclusterlink\")) return false;\n\t\t\tif (!l && f.get(\"selectclusterlink\")) return false;\n\t\t\telse return fn(f,l);\n\t\t};\n\t}\n\telse options.filter = function(f,l) \n\t{\t//if (l===overlay && f.get(\"selectclusterlink\")) return false; \n\t\tif (!l && f.get(\"selectclusterlink\")) return false; \n\t\telse return true;\n\t};\n\tthis.filter_ = options.filter;\n\tol.interaction.Select.call(this, options);\n\tthis.on(\"select\", this.selectCluster.bind(this));\n};\nol.ext.inherits(ol.interaction.SelectCluster, ol.interaction.Select);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.SelectCluster.prototype.setMap = function(map) {\n\tif (this.getMap()) {\n\t\tthis.getMap().removeLayer(this.overlayLayer_);\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.interaction.Select.prototype.setMap.call (this, map);\n\tthis.overlayLayer_.setMap(map);\n\t// map.addLayer(this.overlayLayer_);\n\tif (map && map.getView()) {\n\t\tthis._listener = map.getView().on('change:resolution', this.clear.bind(this));\n\t}\n};\n/**\n * Clear the selection, close the cluster and remove revealed features\n * @api stable\n */\nol.interaction.SelectCluster.prototype.clear = function() \n{\tthis.getFeatures().clear();\n\tthis.overlayLayer_.getSource().clear();\n};\n/**\n * Get the layer for the revealed features\n * @api stable\n */\nol.interaction.SelectCluster.prototype.getLayer = function() \n{\treturn this.overlayLayer_;\n};\n/**\n * Select a cluster \n * @param {ol.Feature} a cluster feature ie. a feature with a 'features' attribute.\n * @api stable\n */\nol.interaction.SelectCluster.prototype.selectCluster = function (e) \n{\t// Nothing selected\n\tif (!e.selected.length)\n\t{\tthis.clear();\n\t\treturn;\n\t}\n\t// Get selection\n\tvar feature = e.selected[0];\n\t// It's one of ours\n\tif (feature.get('selectclusterfeature')) return;\n\t// Clic out of the cluster => close it\n\tvar source = this.overlayLayer_.getSource();\n\tsource.clear();\n\tvar cluster = feature.get('features');\n\t// Not a cluster (or just one feature)\n\tif (!cluster || cluster.length==1) return;\n\t// Remove cluster from selection\n\tif (!this.selectCluster_) this.getFeatures().clear();\n\tvar center = feature.getGeometry().getCoordinates();\n\t// Pixel size in map unit\n\tvar pix = this.getMap().getView().getResolution();\n\tvar r = pix * this.pointRadius * (0.5 + cluster.length / 4);\n\tvar a, i, max;\n\tvar p, cf, lk;\n\t// The features\n\tvar features = [];\n\t// Draw on a circle\n\tif (!this.spiral || cluster.length <= this.circleMaxObjects)\n\t{\tmax = Math.min(cluster.length, this.circleMaxObjects);\n\t\tfor (i=0; i<max; i++)\n\t\t{\ta = 2*Math.PI*i/max;\n\t\t\tif (max==2 || max == 4) a += Math.PI/4;\n\t\t\tp = [ center[0]+r*Math.sin(a), center[1]+r*Math.cos(a) ];\n\t\t\tcf = new ol.Feature({ 'selectclusterfeature':true, 'features':[cluster[i]], geometry: new ol.geom.Point(p) });\n\t\t\tcf.setStyle(cluster[i].getStyle());\n\t\t\tfeatures.push(cf);\n\t\t\tlk = new ol.Feature({ 'selectclusterlink':true, geometry: new ol.geom.LineString([center,p]) });\n\t\t\tfeatures.push(lk);\n\t\t}\n\t}\n\t// Draw on a spiral\n\telse\n\t{\t// Start angle\n\t\ta = 0;\n\t\tr;\n\t\tvar d = 2*this.pointRadius;\n\t\tmax = Math.min (this.maxObjects, cluster.length);\n\t\t// Feature on a spiral\n\t\tfor (i=0; i<max; i++)\n\t\t{\t// New radius => increase d in one turn\n\t\t\tr = d/2 + d*a/(2*Math.PI);\n\t\t\t// Angle\n\t\t\ta = a + (d+0.1)/r;\n\t\t\tvar dx = pix*r*Math.sin(a)\n\t\t\tvar dy = pix*r*Math.cos(a)\n\t\t\tp = [ center[0]+dx, center[1]+dy ];\n\t\t\tcf = new ol.Feature({ 'selectclusterfeature':true, 'features':[cluster[i]], geometry: new ol.geom.Point(p) });\n\t\t\tcf.setStyle(cluster[i].getStyle()); \n\t\t\tfeatures.push(cf);\n\t\t\tlk = new ol.Feature({ 'selectclusterlink':true, geometry: new ol.geom.LineString([center,p]) });\n\t\t\tfeatures.push(lk);\n\t\t}\n\t}\n\tsource.clear();\n\tif (this.animate) {\n\t\tthis.animateCluster_(center, features);\n\t} else {\n\t\tsource.addFeatures(features);\n\t}\n};\n/**\n * Animate the cluster and spread out the features\n * @param {ol.Coordinates} the center of the cluster\n */\nol.interaction.SelectCluster.prototype.animateCluster_ = function(center, features)\n{\t// Stop animation (if one is running)\n\tif (this.listenerKey_) {\n\t\tol.Observable.unByKey(this.listenerKey_);\n\t}\n\t// Features to animate\n\t// var features = this.overlayLayer_.getSource().getFeatures();\n\tif (!features.length) return;\n\tvar style = this.overlayLayer_.getStyle();\n\tvar stylefn = (typeof(style) == 'function') ? style : style.length ? function(){ return style; } : function(){ return [style]; } ;\n\tvar duration = this.animationDuration || 500;\n\tvar start = new Date().getTime();\n\t// Animate function\n\tfunction animate(event) {\n\t\tvar vectorContext = event.vectorContext || ol.render.getVectorContext(event);\n\t\t// Retina device\n\t\tvar ratio = event.frameState.pixelRatio;\n\t\tvar res = this.getMap().getView().getResolution();\n\t\tvar e = ol.easing.easeOut((event.frameState.time - start) / duration);\n\t\tfor (var i=0, feature; feature = features[i]; i++) if (feature.get('features'))\n\t\t{\tvar pt = feature.getGeometry().getCoordinates();\n\t\t\tpt[0] = center[0] + e * (pt[0]-center[0]);\n\t\t\tpt[1] = center[1] + e * (pt[1]-center[1]);\n\t\t\tvar geo = new ol.geom.Point(pt);\n\t\t\t// Image style\n\t\t\tvar st = stylefn(feature, res);\n\t\t\tfor (var s=0; s<st.length; s++)\n\t\t\t{\tvar sc;\n\t\t\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : st[s].getImage();\n\t\t\t\tif (imgs)\n\t\t\t\t{\tsc = imgs.getScale();\n\t\t\t\t\timgs.setScale(ratio); \n\t\t\t\t}\n\t\t\t\t// OL3 > v3.14\n\t\t\t\tif (vectorContext.setStyle)\n\t\t\t\t{\tvectorContext.setStyle(st[s]);\n\t\t\t\t\tvectorContext.drawGeometry(geo);\n\t\t\t\t}\n\t\t\t\t// older version\n\t\t\t\telse\n\t\t\t\t{\tvectorContext.setImageStyle(imgs);\n\t\t\t\t\tvectorContext.drawPointGeometry(geo);\n\t\t\t\t}\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t}\n\t\t}\n\t\t// Stop animation and restore cluster visibility\n\t\tif (e > 1.0) {\n\t\t\tol.Observable.unByKey(this.listenerKey_);\n\t\t\tthis.overlayLayer_.getSource().addFeatures(features);\n\t\t\tthis.overlayLayer_.changed();\n\t\t\treturn;\n\t\t}\n\t\t// tell OL3 to continue postcompose animation\n\t\tevent.frameState.animate = true;\n\t}\n\t// Start a new postcompose animation\n\tthis.listenerKey_ = this.overlayLayer_.on(['postcompose','postrender'], animate.bind(this));\n\t// Start animation with a ghost feature\n\tvar feature = new ol.Feature(new ol.geom.Point(this.getMap().getView().getCenter()));\n\tfeature.setStyle(new ol.style.Style({ image: new ol.style.Circle({}) }));\n\tthis.overlayLayer_.getSource().addFeature(feature);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction to snap to guidelines\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.SnapGuidesOptions} \n *\t- pixelTolerance {number | undefined} distance (in px) to snap to a guideline, default 10 px\n *  - enableInitialGuides {bool | undefined} whether to draw initial guidelines based on the maps orientation, default false.\n *\t- style {ol.style.Style | Array<ol.style.Style> | undefined} Style for the sektch features.\n */\nol.interaction.SnapGuides = function(options) {\n\tif (!options) options = {};\n\t// Intersect 2 guides\n\tfunction getIntersectionPoint (d1, d2)\n\t{\tvar d1x = d1[1][0] - d1[0][0];\n\t\tvar d1y = d1[1][1] - d1[0][1];\n\t\tvar d2x = d2[1][0] - d2[0][0];\n\t\tvar d2y = d2[1][1] - d2[0][1];\n\t\tvar det = d1x * d2y - d1y * d2x;\n\t\tif (det != 0)\n\t\t{\tvar k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\n\t\t\treturn [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\n\t\t}\n\t\telse return false;\n\t}\n\tfunction dist2D (p1,p2)\n\t{\tvar dx = p1[0]-p2[0];\n\t\tvar dy = p1[1]-p2[1];\n\t\treturn Math.sqrt(dx*dx+dy*dy);\n\t}\n\t// Snap distance (in px)\n\tthis.snapDistance_ = options.pixelTolerance || 10;\n\tthis.enableInitialGuides_ = options.enableInitialGuides || false;\n\t// Default style\n\tvar sketchStyle =\n\t[\tnew ol.style.Style({\n\t\t\tstroke: new ol.style.Stroke(\n\t\t\t{\tcolor: '#ffcc33',\n\t\t\t\tlineDash: [8,5],\n\t\t\t\twidth: 1.25\n\t\t\t})\n\t\t})\n\t];\n\t// Custom style\n\tif (options.style) sketchStyle = options.style instanceof Array ? options.style : [options.style];\n\t// Create a new overlay for the sketch\n\tthis.overlaySource_ = new ol.source.Vector(\n\t\t{\tfeatures: new ol.Collection(),\n\t\t\tuseSpatialIndex: false\n\t\t});\n\tthis.overlayLayer_ = new ol.layer.Vector({\n\t\t// render the snap guides as an image to improve performance on rerenders\n\t\trenderMode: 'image',\n\t\tsource: this.overlaySource_,\n\t\t\tstyle: function() {\n\t\t\t\treturn sketchStyle;\n\t\t\t},\n\t\t\tname:'Snap overlay',\n\t\t\tdisplayInLayerSwitcher: false\n\t\t});\n\t// Use snap interaction\n\tol.interaction.Interaction.call(this, {\n\t\thandleEvent: function(e) {\n\t\t\tif (this.getActive()) {\n\t\t\t\tvar features = this.overlaySource_.getFeatures();\n\t\t\t\tvar prev = null;\n\t\t\t\tvar p = null;\n\t\t\t\tvar res = e.frameState.viewState.resolution;\n\t\t\t\tfor (var i=0, f; f = features[i]; i++) {\n\t\t\t\t\tvar c = f.getGeometry().getClosestPoint(e.coordinate);\n\t\t\t\t\tif ( dist2D(c, e.coordinate) / res < this.snapDistance_) {\n\t\t\t\t\t\t// Intersection on 2 lines\n\t\t\t\t\t\tif (prev) {\n\t\t\t\t\t\t\tvar c2 = getIntersectionPoint(prev.getGeometry().getCoordinates(),  f.getGeometry().getCoordinates());\n\t\t\t\t\t\t\tif (c2) {\n\t\t\t\t\t\t\t\tif (dist2D(c2, e.coordinate) / res < this.snapDistance_) {\n\t\t\t\t\t\t\t\t\tp = c2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tp = c;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprev = f;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (p) e.coordinate = p;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t});\n};\nol.ext.inherits(ol.interaction.SnapGuides, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.SnapGuides.prototype.setMap = function(map) {\n\tif (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tthis.overlayLayer_.setMap(map);\n\tif (map) this.projExtent_ = map.getView().getProjection().getExtent();\n};\n/** Activate or deactivate the interaction.\n* @param {boolean} active\n*/\nol.interaction.SnapGuides.prototype.setActive = function(active)\n{\tthis.overlayLayer_.setVisible(active);\n\tol.interaction.Interaction.prototype.setActive.call (this, active);\n}\n/** Clear previous added guidelines\n* @param {Array<ol.Feature> | undefined} features a list of feature to remove, default remove all feature\n*/\nol.interaction.SnapGuides.prototype.clearGuides = function(features)\n{\tif (!features) this.overlaySource_.clear();\n\telse\n\t{\tfor (var i=0, f; f=features[i]; i++)\n\t\t{\ttry {\n\t\t\t\tthis.overlaySource_.removeFeature(f);\n\t\t\t} catch(e) {/* nothing to to */}\n\t\t}\n\t}\n}\n/** Get guidelines\n* @return {ol.Collection} guidelines features\n*/\nol.interaction.SnapGuides.prototype.getGuides = function()\n{\treturn this.overlaySource_.getFeaturesCollection();\n}\n/** Add a new guide to snap to\n* @param {Array<ol.coordinate>} v the direction vector\n* @return {ol.Feature} feature guide\n*/\nol.interaction.SnapGuides.prototype.addGuide = function(v, ortho) {\n\tif (v)\n\t{\tvar map = this.getMap();\n\t\t// Limit extent\n\t\tvar extent = map.getView().calculateExtent(map.getSize());\n\t\tvar guideLength = Math.max(\n\t\t\tthis.projExtent_[2] - this.projExtent_[0],\n\t\t\tthis.projExtent_[3] - this.projExtent_[1]\n\t\t);\n\t\textent = ol.extent.buffer(extent, guideLength * 1.5);\n\t\t//extent = ol.extent.boundingExtent(extent, this.projExtent_);\n\t\tif (extent[0]<this.projExtent_[0]) extent[0]=this.projExtent_[0];\n\t\tif (extent[1]<this.projExtent_[1]) extent[1]=this.projExtent_[1];\n\t\tif (extent[2]>this.projExtent_[2]) extent[2]=this.projExtent_[2];\n\t\tif (extent[3]>this.projExtent_[3]) extent[3]=this.projExtent_[3];\n\t\tvar dx = v[0][0] - v[1][0];\n\t\tvar dy = v[0][1] - v[1][1];\n\t\tvar d = 1 / Math.sqrt(dx*dx+dy*dy);\n\t\tvar generateLine = function(loopDir) {\n\t\t\tvar p, g = [];\n\t\t\tvar loopCond = guideLength*loopDir*2;\n\t\t\tfor (var i=0; loopDir > 0 ? i < loopCond : i > loopCond; i+=(guideLength * loopDir) / 100) {\n\t\t\t\tif (ortho) p = [ v[0][0] + dy*d*i, v[0][1] - dx*d*i];\n\t\t\t\telse p = [ v[0][0] + dx*d*i, v[0][1] + dy*d*i];\n\t\t\t\tif (ol.extent.containsCoordinate(extent, p)) g.push(p);\n\t\t\t\telse break;\n\t\t\t}\n\t\t\treturn new ol.Feature(new ol.geom.LineString([g[0], g[g.length-1]]));\n\t\t}\n\t\tvar f0 = generateLine(1);\n\t\tvar f1 = generateLine(-1);\n\t\tthis.overlaySource_.addFeature(f0);\n\t\tthis.overlaySource_.addFeature(f1);\n\t\treturn [f0, f1];\n\t}\n};\n/** Add a new orthogonal guide to snap to\n* @param {Array<ol.coordinate>} v the direction vector\n* @return {ol.Feature} feature guide\n*/\nol.interaction.SnapGuides.prototype.addOrthoGuide = function(v)\n{\treturn this.addGuide(v, true);\n};\n/** Listen to draw event to add orthogonal guidelines on the first and last point.\n* @param {_ol_interaction_Draw_} drawi a draw interaction to listen to\n* @api\n*/\nol.interaction.SnapGuides.prototype.setDrawInteraction = function(drawi) {\n\tvar self = this;\n\t// Number of points currently drawing\n\tvar nb = 0;\n\t// Current guidelines\n\tvar features = [];\n\tfunction setGuides(e) {\n\t\tvar coord = e.target.getCoordinates();\n\t\tvar s = 2;\n\t\tswitch (e.target.getType()) {\n\t\t\tcase 'Polygon':\n\t\t\t\tcoord = coord[0].slice(0, -1);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t\tvar l = coord.length;\n\t\tif (l === s && self.enableInitialGuides_) {\n\t\t\tvar x = coord[0][0];\n\t\t\tvar y = coord[0][1];\n\t\t\tcoord = [[x, y], [x, y - 1]];\n\t\t}\n\t\tif (l != nb && (self.enableInitialGuides_ ? l >= s : l > s)) {\n\t\t\tself.clearGuides(features);\n\t\t\tvar p1 = coord[l - s], p2 = coord[l - s - 1];\n\t\t\tif (l > s && !(p1[0] === p2[0] && p1[1] === p2[1])) {\n\t\t\t\tfeatures = self.addOrthoGuide([coord[l - s], coord[l - s - 1]]);\n\t\t\t}\n\t\t\tfeatures = features.concat(self.addGuide([coord[0], coord[1]]));\n\t\t\tfeatures = features.concat(self.addOrthoGuide([coord[0], coord[1]]));\n\t\t\tnb = l;\n\t\t}\n\t}\n\t// New drawing\n\tdrawi.on (\"drawstart\", function(e) {\n\t\t// When geom is changing add a new orthogonal direction \n\t\te.feature.getGeometry().on(\"change\", setGuides);\n\t});\n\t// end drawing / deactivate => clear directions\n\tdrawi.on ([\"drawend\", \"change:active\"], function(e) {\n\t\tself.clearGuides(features);\n\t\tif (e.feature) e.feature.getGeometry().un(\"change\", setGuides);\n\t\tnb = 0;\n\t\tfeatures = [];\n\t});\n};\n/** Listen to modify event to add orthogonal guidelines relative to the currently dragged point\n* @param {_ol_interaction_Modify_} modifyi a modify interaction to listen to\n* @api\n*/\nol.interaction.SnapGuides.prototype.setModifyInteraction = function (modifyi) {\n\tfunction mod(d, n) {\n\t\treturn ((d % n) + n) % n;\n\t}\n\tvar self = this;\n\t// Current guidelines\n\tvar features = [];\n\tfunction computeGuides(e) {\n\t\tvar selectedVertex = e.target.vertexFeature_\n\t\tif (!selectedVertex) return;\n\t\tvar f = e.target.getModifiedFeatures()[0];\n\t\tvar geom = f.getGeometry();\n\t\tvar coord = geom.getCoordinates();\n\t\tswitch (geom.getType()) {\n\t\t\tcase 'Polygon':\n\t\t\t\tcoord = coord[0].slice(0, -1);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t\tvar modifyVertex = selectedVertex.getGeometry().getCoordinates();\n\t\tvar idx = coord.findIndex(function(c) {\n\t\t\treturn c[0] === modifyVertex[0] && c[1] === modifyVertex[1]\n\t\t});\n\t\tvar l = coord.length;\n\t\tself.clearGuides(features);\n\t\tfeatures = self.addOrthoGuide([coord[mod(idx - 1, l)], coord[mod(idx - 2, l)]]);\n\t\tfeatures = features.concat(self.addGuide([coord[mod(idx - 1, l)], coord[mod(idx - 2, l)]]));\n\t\tfeatures = features.concat(self.addGuide([coord[mod(idx + 1, l)], coord[mod(idx + 2, l)]]));\n\t\tfeatures = features.concat(self.addOrthoGuide([coord[mod(idx + 1, l)], coord[mod(idx + 2, l)]]));\n\t}\n\tfunction setGuides(e) {\n\t\t// This callback is called before ol adds the vertex to the feature, so\n\t\t// defer a moment for openlayers to add the new vertex\n\t\tsetTimeout(computeGuides, 0, e);\n\t}\n\tfunction drawEnd() {\n\t\tself.clearGuides(features);\n\t\tfeatures = [];\n\t}\n\t// New drawing\n\tmodifyi.on(\"modifystart\", setGuides);\n\t// end drawing, clear directions\n\tmodifyi.on(\"modifyend\", drawEnd);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction split interaction for splitting feature geometry\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires  beforesplit, aftersplit, pointermove\n * @param {*} \n *  @param {ol.source.Vector|Array<ol.source.Vector>} options.source a list of source to split (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to split\n *  @param {integer} options.snapDistance distance (in px) to snap to an object, default 25px\n *\t@param {string|undefined} options.cursor cursor name to display when hovering an objet\n *  @param {function|undefined} opttion.filter a filter that takes a feature and return true if it can be clipped, default always split.\n *  @param ol.style.Style | Array<ol.style.Style> | false | undefined} options.featureStyle Style for the selected features, choose false if you don't want feature selection. By default the default edit style is used.\n *  @param {ol.style.Style | Array<ol.style.Style> | undefined} options.sketchStyle Style for the sektch features. \n *  @param {function|undefined} options.tolerance Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split.  Default is 1e-10.\n */\nol.interaction.Split = function(options) {\n  if (!options) options = {};\n  ol.interaction.Interaction.call(this, {\n    handleEvent: function(e) {\n      switch (e.type) {\n        case \"singleclick\":\n          return this.handleDownEvent(e);\n        case \"pointermove\":\n          return this.handleMoveEvent(e);\n        default: \n          return true;\n      }\n      //return true;\n    }\n  });\n  // Snap distance (in px)\n  this.snapDistance_ = options.snapDistance || 25;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = options.tolerance || 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n  if (options.features) {\n    this.sources_.push (new ol.source.Vector({ features: options.features }));\n  }\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n  // Default style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var fill = new ol.style.Fill({ color: 'rgba(255,255,255,0.4)' });\n  var stroke = new ol.style.Stroke({\n    color: '#3399CC',\n    width: 1.25\n  });\n  var sketchStyle = [\n    new ol.style.Style({\n      image: new ol.style.Circle({\n        fill: fill,\n        stroke: stroke,\n        radius: 5\n      }),\n      fill: fill,\n      stroke: stroke\n    })\n  ];\n  var featureStyle = [\n    new ol.style.Style({\n      stroke: new ol.style.Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new ol.style.Style({\n      image: new ol.style.Circle({\n        radius: 2*width,\n        fill: new ol.style.Fill({\n          color: blue\n        }),\n        stroke: new ol.style.Stroke({\n          color: white,\n          width: width/2\n        })\n      }),\n      stroke: new ol.style.Stroke({\n          color: blue,\n          width: width\n        })\n    }),\n  ];\n  // Custom style\n  if (options.sketchStyle) sketchStyle = options.sketchStyle instanceof Array ? options.sketchStyle : [options.sketchStyle];\n  if (options.featureStyle) featureStyle = options.featureStyle instanceof Array ? options.featureStyle : [options.featureStyle];\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      useSpatialIndex: false\n    }),\n    name:'Split overlay',\n    displayInLayerSwitcher: false,\n    style: function(f) {\n      if (f._sketch_) return sketchStyle;\n      else return featureStyle;\n    }\n  });\n};\nol.ext.inherits(ol.interaction.Split, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Split.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {ol.feature} \n * @private\n */\nol.interaction.Split.prototype.getClosestFeature = function(e) {\n  var f, c, g, d = this.snapDistance_+1;\n  for (var i=0; i<this.sources_.length; i++) {\n    var source = this.sources_[i];\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\n    if (f && f.getGeometry().splitAt) {\n      c = f.getGeometry().getClosestPoint(e.coordinate);\n      g = new ol.geom.LineString([e.coordinate,c]);\n      d = g.getLength() / e.frameState.viewState.resolution;\n      break;\n    }\n  }\n  if (d > this.snapDistance_) {\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry().getCoordinates());\n    var p = this.getMap().getPixelFromCoordinate(coord);\n    if (ol.coordinate.dist2d(e.pixel, p) < this.snapDistance_) {\n      c = coord;\n    }\n    //\n    return { source:source, feature:f, coord: c, link: g };\n  }\n}\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {Array<ol.coordinate>} coords list of coordinates\n* @return {ol.coordinate} the nearest coordinate in the list\n*/\nol.interaction.Split.prototype.getNearestCoord = function(pt, coords) {\n  var d, dm=Number.MAX_VALUE, p0;\n  for (var i=0; i < coords.length; i++) {\n    d = ol.coordinate.dist2d (pt, coords[i]);\n    if (d < dm) {\n      dm = d;\n      p0 = coords[i];\n    }\n  }\n  return p0;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol.interaction.Split.prototype.handleDownEvent = function(evt) {\n  // Something to split ?\n  var current = this.getClosestFeature(evt);\n  if (current) {\n    var self = this;\n    self.overlayLayer_.getSource().clear();\n    var split = current.feature.getGeometry().splitAt(current.coord, this.tolerance_);\n    var i;\n    if (split.length > 1) {\n      var tosplit = [];\n      for (i=0; i<split.length; i++) {\n        var f = current.feature.clone();\n        f.setGeometry(split[i]);\n        tosplit.push(f);\n      }\n      self.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n      current.source.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n      current.source.removeFeature(current.feature);\n      for (i=0; i<tosplit.length; i++) {\n        current.source.addFeature(tosplit[i]);\n      }\n      self.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n      current.source.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n    }\n  }\n  return false;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol.interaction.Split.prototype.handleMoveEvent = function(e) {\n  var map = e.map;\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n  if (current && this.filterSplit_(current.feature)) {\n    var p, l;\n    // Draw sketch\n    this.overlayLayer_.getSource().addFeature(current.feature);\n    p = new ol.Feature(new ol.geom.Point(current.coord));\n    p._sketch_ = true;\n    this.overlayLayer_.getSource().addFeature(p);\n    //\n    l = new ol.Feature(current.link);\n    l._sketch_ = true;\n    this.overlayLayer_.getSource().addFeature(l);\n    // move event\n    this.dispatchEvent({\n      type: 'pointermove',\n      coordinate: e.coordinate,\n      frameState: e.frameState,\n      originalEvent: e.originalEvent,\n      map: e.map,\n      pixel: e.pixel,\n      feature: current.feature,\n      linkGeometry: current.link\n    });\n  } else {\n    this.dispatchEvent(e);\n  }\n  var element = map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/** Interaction splitter: acts as a split feature agent while editing vector features (LineString).\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires  beforesplit, aftersplit\n * @param {olx.interaction.SplitOptions} \n *\t- source {ol.source.Vector|Array{ol.source.Vector}} The target source (or array of source) with features to be split (configured with useSpatialIndex set to true)\n *\t- triggerSource {ol.source.Vector} Any newly created or modified features from this source will be used to split features on the target source. If none is provided the target source is used instead.\n *\t- features {ol.Collection.<ol.Feature>} A collection of feature to be split (replace source target).\n *\t- triggerFeatures {ol.Collection.<ol.Feature>} Any newly created or modified features from this collection will be used to split features on the target source (replace triggerSource).\n *\t- filter {function|undefined} a filter that takes a feature and return true if the feature is eligible for splitting, default always split.\n *\t- tolerance {function|undefined} Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split. Default is 1e-10.\n * @todo verify auto intersection on features that split.\n */\nol.interaction.Splitter = function(options)\n{\tif (!options) options = {};\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t\t{\t// Hack to get only one changeFeature when draging with ol.interaction.Modify on.\n\t\t\t\tif (e.type != \"pointermove\" && e.type != \"pointerdrag\")\n\t\t\t\t{\tif (this.lastEvent_)\n\t\t\t\t\t{\tthis.splitSource(this.lastEvent_.feature);\n\t\t\t\t\t\tthis.lastEvent_ = null;\n\t\t\t\t\t}\n\t\t\t\t\tthis.moving_ = false;\n\t\t\t\t}\n\t\t\t\telse this.moving_ = true;\n\t\t\t\treturn true; \n\t\t\t},\n\t});\n\t// Features added / remove\n\tthis.added_ = [];\n\tthis.removed_ = [];\n\t// Source to split\n\tif (options.features)\n\t{\tthis.source_ = new ol.source.Vector({ features: options.features });\n\t}\n\telse \n\t{\tthis.source_ = options.source ? options.source : new ol.source.Vector({ features: new ol.Collection() });\n\t}\n\tvar trigger = this.triggerSource;\n\tif (options.triggerFeatures)\n\t{\ttrigger = new ol.source.Vector({ features: options.triggerFeatures });\n\t}\n\tif (trigger)\n\t{\ttrigger.on(\"addfeature\", this.onAddFeature.bind(this));\n\t\ttrigger.on(\"changefeature\", this.onChangeFeature.bind(this));\n\t\ttrigger.on(\"removefeature\", this.onRemoveFeature.bind(this));\n\t}\n\telse\n\t{\tthis.source_.on(\"addfeature\", this.onAddFeature.bind(this));\n\t\tthis.source_.on(\"changefeature\", this.onChangeFeature.bind(this));\n\t\tthis.source_.on(\"removefeature\", this.onRemoveFeature.bind(this));\n\t}\n\t// Split tolerance between the calculated intersection and the geometry\n\tthis.tolerance_ = options.tolerance || 1e-10;\n\t// Get all features candidate\n\tthis.filterSplit_ = options.filter || function(){ return true; };\n};\nol.ext.inherits(ol.interaction.Splitter, ol.interaction.Interaction);\n/** Calculate intersection on 2 segs\n* @param {Array<_ol_coordinate_>} s1 first seg to intersect (2 points)\n* @param {Array<_ol_coordinate_>} s2 second seg to intersect (2 points)\n* @return { boolean | _ol_coordinate_ } intersection point or false no intersection\n*/\nol.interaction.Splitter.prototype.intersectSegs = function(s1,s2)\n{\tvar tol = this.tolerance_;\n\t// Solve\n\tvar x12 = s1[0][0] - s1[1][0];\n\tvar x34 = s2[0][0] - s2[1][0];\n\tvar y12 = s1[0][1] - s1[1][1];\n\tvar y34 = s2[0][1] - s2[1][1];\n\tvar det = x12 * y34 - y12 * x34;\n\t// No intersection\n\tif (Math.abs(det) < tol)\n\t{\treturn false;\n\t}\n\telse\n\t{\t// Outside segement\n\t\tvar r1 = ((s1[0][0] - s2[1][0])*y34 - (s1[0][1] - s2[1][1])*x34) / det;\n\t\tif (Math.abs(r1)<tol) return s1[0];\n\t\tif (Math.abs(1-r1)<tol) return s1[1];\n\t\tif (r1<0 || r1>1) return false;\n\t\tvar r2 = ((s1[0][1] - s2[1][1])*x12 - (s1[0][0] - s2[1][0])*y12) / det;\n\t\tif (Math.abs(r2)<tol) return s2[1];\n\t\tif (Math.abs(1-r2)<tol) return s2[0];\n\t\tif (r2<0 || r2>1) return false;\n\t\t// Intersection\n\t\tvar a = s1[0][0] * s1[1][1] - s1[0][1] * s1[1][0];\n\t\tvar b = s2[0][0] * s2[1][1] - s2[0][1] * s2[1][0];\n\t\tvar p = [(a * x34 - b * x12) / det, (a * y34 - b * y12) / det];\n\t\t// Test start / end\n/*\nconsole.log(\"r1: \"+r1)\nconsole.log(\"r2: \"+r2)\nconsole.log (\"s10: \"+(_ol_coordinate_.dist2d(p,s1[0])<tol)) ;\nconsole.log (\"s11: \"+(_ol_coordinate_.dist2d(p,s1[1])<tol)) ;\nconsole.log (\"s20: \"+(_ol_coordinate_.dist2d(p,s2[0])<tol)) ;\nconsole.log (\"s21: \"+(_ol_coordinate_.dist2d(p,s2[1])<tol)) ;\n*/\n\t\treturn p;\n\t}\n};\n/** Split the source using a feature\n* @param {ol.Feature} feature The feature to use to split.\n*/\nol.interaction.Splitter.prototype.splitSource = function(feature)\n{\t// Allready perform a split\n\tif (this.splitting) return;\n\tvar self = this;\n\tvar i, k, f2;\n\t// Start splitting\n\tthis.source_.dispatchEvent({ type:'beforesplit', feaure: feature, source: this.source_ });\n\tthis.splitting = true;\n\tthis.added_ = [];\n\tthis.removed_ = [];\n\tvar c = feature.getGeometry().getCoordinates();\n\tvar seg, split = [];\n\tfunction intersect (f)\n\t{\tif (f !== feature)\n\t\t{\tvar c2 = f.getGeometry().getCoordinates();\n\t\t\tfor (var j=0; j<c2.length-1; j++)\n\t\t\t{\tvar p = this.intersectSegs (seg, [c2[j],c2[j+1]]);\n\t\t\t\tif (p)\n\t\t\t\t{\tsplit.push(p);\n\t\t\t\t\tg = f.getGeometry().splitAt(p, this.tolerance_);\n\t\t\t\t\tif (g && g.length>1)\n\t\t\t\t\t{\tfound = f;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t// Split existing features\n\tfor (i=0; i<c.length-1; i++)\n\t{\tseg = [c[i],c[i+1]];\n\t\tvar extent = ol.extent.buffer(ol.extent.boundingExtent(seg), this.tolerance_ /*0.01*/ );\n\t\tvar g;\n\t\twhile (true)\n\t\t{\tvar found = false;\n\t\t\tthis.source_.forEachFeatureIntersectingExtent(extent, intersect.bind(this));\n\t\t\t// Split feature\n\t\t\tif (found)\n\t\t\t{\tvar f = found;\n\t\t\t\tthis.source_.removeFeature(f);\n\t\t\t\tfor (k=0; k<g.length; k++)\n\t\t\t\t{\tf2 = f.clone();\n\t\t\t\t\tf2.setGeometry(g[k]);\n\t\t\t\t\tthis.source_.addFeature(f2);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t}\n\t// Auto intersect\n\tfor (i=0; i<c.length-2; i++)\n\t{\tfor (var j=i+1; j<c.length-1; j++)\n\t\t{\tvar p = this.intersectSegs ([c[i],c[i+1]], [c[j],c[j+1]]);\n\t\t\tif (p && p!=c[i+1])\n\t\t\t{\tsplit.push(p);\n\t\t\t}\n\t\t}\n\t}\n\t// Split original\n\tvar splitOriginal = false;\n\tif (split.length)\n\t{\tvar result = feature.getGeometry().splitAt(split, this.tolerance_);\n\t\tif (result.length>1)\n\t\t{\tfor (k=0; k<result.length; k++)\n\t\t\t{\tf2 = feature.clone();\n\t\t\t\tf2.setGeometry(result[k]);\n\t\t\t\tthis.source_.addFeature(f2);\n\t\t\t}\n\t\t\tsplitOriginal = true;\n\t\t}\n\t}\n\t// If the interaction is inserted after modify interaction, the objet is not consistant \n\t// > wait end of other interactions\n\tsetTimeout (function()\n\t{\tif (splitOriginal) self.source_.removeFeature(feature);\n\t\tself.source_.dispatchEvent({ type:'aftersplit', featureAdded: self.added_, featureRemoved: self.removed_, source: this.source_ });\n\t\t// Finish\n\t\tself.splitting = false;\n\t},0);\n};\n/** New feature source is added \n*/\nol.interaction.Splitter.prototype.onAddFeature = function(e)\n{\tthis.splitSource(e.feature);\n\tif (this.splitting) \n\t{\tthis.added_.push(e.feature);\n\t}\n\t/*\n\tif (this.splitting) return;\n\tvar self = this;\n\tsetTimeout (function() { self.splitSource(e.feature); }, 0);\n\t*/\n};\n/** Feature source is removed > count features added/removed\n*/\nol.interaction.Splitter.prototype.onRemoveFeature = function(e)\n{\tif (this.splitting) \n\t{\tvar n = this.added_.indexOf(e.feature);\n\t\tif (n==-1)\n\t\t{\tthis.removed_.push(e.feature);\n\t\t}\n\t\telse\n\t\t{\tthis.added_.splice(n,1);\n\t\t}\n\t}\n};\n/** Feature source is changing \n*/\nol.interaction.Splitter.prototype.onChangeFeature = function(e)\n{\tif (this.moving_) \n\t{\tthis.lastEvent_ = e;\n\t}\n\telse this.splitSource(e.feature);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction synchronize\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.SynchronizeOptions} \n *  - maps {Array<ol.Map>} An array of maps to synchronize with the map of the interaction\n */\nol.interaction.Synchronize = function(options)\n{\tif (!options) options={};\n\tvar self = this;\n\tol.interaction.Interaction.call(this,\n\t\t{\thandleEvent: function(e)\n\t\t\t\t{\tif (e.type==\"pointermove\") { self.handleMove_(e); }\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t});\n\tthis.maps = options.maps;\n};\nol.ext.inherits(ol.interaction.Synchronize, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Synchronize.prototype.setMap = function(map)\n{\n\tif (this._listener) {\n\t\tol.Observable.unByKey(this._listener.center);\n\t\tol.Observable.unByKey(this._listener.rotation);\n\t\tol.Observable.unByKey(this._listener.resolution);\n\t\tthis.getMap().getTargetElement().removeEventListener('mouseout', this._listener.mouseout);\n\t}\n\tthis._listener = null;\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tif (map) {\n\t\tthis._listener = {};\n\t\tthis._listener.center = this.getMap().getView().on('change:center', this.syncMaps.bind(this));\n\t\tthis._listener.rotation = this.getMap().getView().on('change:rotation', this.syncMaps.bind(this));\n\t\tthis._listener.resolution = this.getMap().getView().on('change:resolution', this.syncMaps.bind(this));\n\t\tthis._listener.mouseout = this.handleMouseOut_.bind(this);\n\t\tthis.getMap().getTargetElement().addEventListener('mouseout', this._listener.mouseout);\n\t\tthis.syncMaps();\n\t}\n};\n/** Synchronize the maps\n*/\nol.interaction.Synchronize.prototype.syncMaps = function(e)\n{\tvar map = this.getMap();\n\tif (!e) e = { type:'all' };\n\tif (map)\n\t{\tfor (var i=0; i<this.maps.length; i++)\n\t\t{\tswitch (e.type)\n\t\t\t{\tcase 'change:rotation':\n\t\t\t\t\tif (this.maps[i].getView().getRotation() != map.getView().getRotation())\n\t\t\t\t\t\tthis.maps[i].getView().setRotation(map.getView().getRotation()); \n\t\t\t\t\tbreak;\n\t\t\t\tcase 'change:center':\n\t\t\t\t\tif (this.maps[i].getView().getCenter() != map.getView().getCenter())\n\t\t\t\t\t\tthis.maps[i].getView().setCenter(map.getView().getCenter()); \n\t\t\t\t\tbreak;\n\t\t\t\tcase 'change:resolution':\n\t\t\t\t\tif (this.maps[i].getView().getResolution() != map.getView().getResolution())\n\t\t\t\t\t{\t/* old version prior to 1.19.1\n\t\t\t\t\t\tthis.maps[i].beforeRender ( ol.animation.zoom(\n\t\t\t\t\t\t\t{\tduration: 250,\n\t\t\t\t\t\t\t\tresolution: this.maps[i].getView().getResolution()\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tthis.maps[i].getView().setResolution(map.getView().getResolution());\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.maps[i].getView().setRotation(map.getView().getRotation());\n\t\t\t\t\tthis.maps[i].getView().setCenter(map.getView().getCenter());\n\t\t\t\t\tthis.maps[i].getView().setResolution(map.getView().getResolution());\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n};\n/** Cursor move > tells other maps to show the cursor\n* @param {ol.event} e \"move\" event\n*/\nol.interaction.Synchronize.prototype.handleMove_ = function(e)\n{\tfor (var i=0; i<this.maps.length; i++)\n\t{\tthis.maps[i].showTarget(e.coordinate);\n\t}\n\tthis.getMap().showTarget();\n};\n/** Cursor out of map > tells other maps to hide the cursor\n* @param {event} e \"mouseOut\" event\n*/\nol.interaction.Synchronize.prototype.handleMouseOut_ = function(/*e*/) {\n\tfor (var i=0; i<this.maps.length; i++) {\n\t\tthis.maps[i].targetOverlay_.setPosition(undefined);\n\t}\n};\n/** Show a target overlay at coord\n* @param {ol.coordinate} coord\n*/\nol.Map.prototype.showTarget = function(coord)\n{\tif (!this.targetOverlay_)\n\t{\tvar elt = document.createElement(\"div\");\n\t\t\t\telt.classList.add(\"ol-target\");\n\t\tthis.targetOverlay_ = new ol.Overlay({ element: elt });\n\t\tthis.targetOverlay_.setPositioning('center-center');\n\t\tthis.addOverlay(this.targetOverlay_);\n\t\telt.parentElement.classList.add(\"ol-target-overlay\");\n\t\t// hack to render targetOverlay before positioning it\n\t\tthis.targetOverlay_.setPosition([0,0]);\n\t}\n\tthis.targetOverlay_.setPosition(coord);\n};\n/** Hide the target overlay\n*/\nol.Map.prototype.hideTarget = function()\n{\n\tthis.removeOverlay(this.targetOverlay_);\n\tthis.targetOverlay_ = undefined;\n};\n\n/*\t\n\tTinker Bell effect on maps.\n\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\t@link https://github.com/Viglino\n */\n/**\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.interaction.TinkerBell.options}  options flashlight param\n *\t\t- color {ol.color} color of the sparkles\n */\nol.interaction.TinkerBell = function(options)\n{\toptions = options || {};\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.onMove,\n\t\thandleMoveEvent: this.onMove\n\t});\n\tthis.set('color', options.color ? ol.color.asString(options.color) : \"#fff\");\n\tthis.sparkle = [0,0];\n\tthis.sparkles = [];\n\tthis.lastSparkle = this.time = new Date();\n\tvar self = this;\n\tthis.out_ = function() { self.isout_=true; };\n\tthis.isout_ = true;\n};\nol.ext.inherits(ol.interaction.TinkerBell, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.TinkerBell.prototype.setMap = function(map) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tif (this.getMap()) {\n\t\tmap.getViewport().removeEventListener('mouseout', this.out_, false);\n\t\tthis.getMap().render();\n\t}\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.postcompose_.bind(this));\n\t\tmap.getViewport().addEventListener('mouseout', this.out_, false);\n\t}\n};\nol.interaction.TinkerBell.prototype.onMove = function(e)\n{\tthis.sparkle = e.pixel;\n\tthis.isout_ = false;\n\tthis.getMap().render();\n};\n/** Postcompose function\n*/\nol.interaction.TinkerBell.prototype.postcompose_ = function(e)\n{\tvar delta = 15;\n\tvar ctx = e.context;\n\tvar dt = e.frameState.time - this.time;\n\tthis.time = e.frameState.time;\n\tif (e.frameState.time-this.lastSparkle > 30 && !this.isout_)\n\t{\tthis.lastSparkle = e.frameState.time;\n\t\tthis.sparkles.push({ p:[this.sparkle[0]+Math.random()*delta-delta/2, this.sparkle[1]+Math.random()*delta], o:1 });\n\t}\n\tctx.save();\n\t\tctx.scale(e.frameState.pixelRatio,e.frameState.pixelRatio);\n\t\tctx.fillStyle = this.get(\"color\");\n\t\tfor (var i=this.sparkles.length-1, p; p=this.sparkles[i]; i--)\n\t\t{\tif (p.o < 0.2) \n\t\t\t{\tthis.sparkles.splice(0,i+1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tctx.globalAlpha = p.o;\n\t\t\tctx.beginPath();\n\t\t\tctx.arc (p.p[0], p.p[1], 2.2, 0, 2 * Math.PI, false);\n\t\t\tctx.fill();\n\t\t\tp.o *= 0.98;\n\t\t\tp.p[0] += (Math.random()-0.5);\n\t\t\tp.p[1] += dt*(1+Math.random())/30;\n\t\t}\n\tctx.restore();\n\t// tell OL3 to continue postcompose animation\n\tif (this.sparkles.length) this.getMap().render(); \n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction splitter: acts as a split feature agent while editing vector features (LineString).\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @param {olx.interaction.TouchCompass} \n *\t- onDrag {function|undefined} Function handling \"drag\" events. It provides a dpixel and a traction (in projection) vector form the center of the compas\n *\t- size {Number} size of the compass in px, default 80\n *\t- alpha {Number} opacity of the compass, default 0.5\n */\nol.interaction.TouchCompass = function(options) {\n\toptions = options||{};\n\tvar opt = {};\n\t// Click on the compass\n\topt.handleDownEvent = function(e)\n\t{\tvar s = this.getCenter_();\n\t\tvar dx = e.pixel[0]-s[0];\n\t\tvar dy = e.pixel[1]-s[1];\n\t\tthis.start = e;\n\t\treturn (Math.sqrt(dx*dx+dy*dy) < this.size/2);\n\t};\n\t// Pn drag\n\topt.handleDragEvent = function(e)\n\t{\tif (!this.pos) \n\t\t{\tthis.pos = this.start;\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t\tthis.pos = e;\n\t};\n\t// Stop drag\n\topt.handleUpEvent = function()\n\t{\tthis.pos = false;\n\t\treturn true;\n\t};\n\tol.interaction.Pointer.call(this, opt);\n\tthis.ondrag_ = options.onDrag;\n\tthis.size = options.size || 80;\n\tthis.alpha = options.alpha || 0.5;\n\tif (!ol.interaction.TouchCompass.prototype.compass)\n\t{\tvar canvas = ol.interaction.TouchCompass.prototype.compass = document.createElement('canvas');\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tvar s = canvas.width = canvas.height = this.size;\n\t\tvar w = s/10;\n\t\tvar r = s/2;\n\t\tvar r2 = 0.22*r;\n\t\tctx.translate(r,r);\n\t\tctx.fillStyle = \"#999\";\n\t\tctx.strokeStyle = \"#ccc\";\n\t\tctx.lineWidth = w;\n\t\tctx.beginPath();\n\t\tctx.arc (0,0, s*0.42, 0, 2*Math.PI);\n\t\tctx.fill();\n\t\tctx.stroke();\n\t\tctx.fillStyle = \"#99f\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.fill();\n\t\tctx.fillStyle = \"#eee\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.fill();\n\t}\n};\nol.ext.inherits(ol.interaction.TouchCompass, ol.interaction.Pointer);\n/** Compass Image as a JS Image object\n* @api\n*/\nol.interaction.TouchCompass.prototype.compass = null;\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.interaction.TouchCompass.prototype.setMap = function(map) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.interaction.Pointer.prototype.setMap.call (this, map);\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawCompass_.bind(this));\n\t\tol.ext.getMapCanvas(map);\n\t}\n};\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.TouchCompass.prototype.setActive = function(b)\n{\tol.interaction.Pointer.prototype.setActive.call (this, b);\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/**\n * Get the center of the compass\n * @param {_ol_coordinate_}\n * @private\n */\nol.interaction.TouchCompass.prototype.getCenter_ = function()\n{\tvar margin = 10;\n\tvar s = this.size;\n\tvar c = this.getMap().getSize(); \n\treturn [c[0]/2, c[1]-margin-s/2];\n}\n/**\n * Draw the compass on post compose\n * @private\n */\nol.interaction.TouchCompass.prototype.drawCompass_ = function(e)\n{\tif (!this.getActive()) return;\n\tvar canvas = ol.ext.getMapCanvas(this.getMap());\n\tvar ctx = canvas.getContext('2d');\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tctx.globalAlpha = this.alpha;\n\tctx.strokeStyle = \"#fff\";\n\tctx.lineWidth = 5;\n\tvar s = this.size;\n\tvar c = this.getCenter_();\n\tctx.drawImage(this.compass, 0,0,this.compass.width,this.compass.height, c[0]-s/2, c[1]-s/2, s,s);\n\tif (this.pos)\n\t{\tvar dx = this.pos.pixel[0]-this.start.pixel[0];\n\t\tvar dy = this.pos.pixel[1]-this.start.pixel[1];\n\t\tfor (var i=1; i<=4; i++)\n\t\t{\tctx.beginPath();\n\t\t\tctx.arc (c[0] +dx/4*i, c[1] +dy/4*i, s/2*(0.6+0.4*i/4), 0, 2*Math.PI);\n\t\t\tctx.stroke();\n\t\t}\n\t}\n\tctx.restore();\n\tif (this.pos)\n\t{\t// Get delta\n\t\tif (this.ondrag_) \n\t\t{\tvar r = this.getMap().getView().getResolution();\n\t\t\tvar delta = \n\t\t\t\t{\tdpixel: [ this.pos.pixel[0] - this.start.pixel[0], this.pos.pixel[1] - this.start.pixel[1] ]\n\t\t\t\t}\n\t\t\tdelta.traction = [ delta.dpixel[0]*r, -delta.dpixel[1]*r];\n\t\t\tthis.ondrag_(delta, this.pos);\n\t\t}\n\t\t// Continue animation\n\t\te.frameState.animate = true;\n\t}\n};\n\n/** Interaction rotate\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires select | rotatestart | rotating | rotateend | translatestart | translating | translateend | scalestart | scaling | scaleend\n * @param {any} options\n *  @param {function} options.filter A function that takes a Feature and a Layer and returns true if the feature may be transformed or false otherwise.\n *  @param {Array<ol.Layer>} options.layers array of layers to transform,\n *  @param {ol.Collection<ol.Feature>} options.features collection of feature to transform,\n *\t@param {ol.EventsConditionType|undefined} options.condition A function that takes an ol.MapBrowserEvent and a feature collection and returns a boolean to indicate whether that event should be handled. default: ol.events.condition.always.\n *\t@param {ol.EventsConditionType|undefined} options.addCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled ie. the feature will be added to the transforms features. default: ol.events.condition.never.\n *\t@param {number | undefined} options.hitTolerance Tolerance to select feature in pixel, default 0\n *\t@param {bool} options.translateFeature Translate when click on feature\n *\t@param {bool} options.translate Can translate the feature\n *\t@param {bool} options.stretch can stretch the feature\n *\t@param {bool} options.scale can scale the feature\n *\t@param {bool} options.rotate can rotate the feature\n *\t@param {bool} options.noFlip prevent the feature geometry to flip, default false\n *\t@param {bool} options.selection the intraction handle selection/deselection, if not use the select prototype to add features to transform, default true\n *\t@param {ol.events.ConditionType | undefined} options.keepAspectRatio A function that takes an ol.MapBrowserEvent and returns a boolean to keep aspect ratio, default ol.events.condition.shiftKeyOnly.\n *\t@param {ol.events.ConditionType | undefined} options.modifyCenter A function that takes an ol.MapBrowserEvent and returns a boolean to apply scale & strech from the center, default ol.events.condition.metaKey or ol.events.condition.ctrlKey.\n *\t@param {} options.style list of ol.style for handles\n *\n */\nol.interaction.Transform = function(options) {\n  if (!options) options = {};\n\tvar self = this;\n  this.selection_ = new ol.Collection();\n\t// Create a new overlay layer for the sketch\n\tthis.handles_ = new ol.Collection();\n\tthis.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      features: this.handles_,\n      useSpatialIndex: false,\n      wrapX: false // For vector editing across the -180 and 180 meridians to work properly, this should be set to false\n    }),\n    name:'Transform overlay',\n    displayInLayerSwitcher: false,\n    // Return the style according to the handle type\n    style: function (feature) {\n      return (self.style[(feature.get('handle')||'default')+(feature.get('constraint')||'')+(feature.get('option')||'')]);\n    },\n  });\n  // Extend pointer\n  ol.interaction.Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n  // Collection of feature to transform\n  this.features_ = options.features;\n  // Filter or list of layers to transform\n  if (typeof(options.filter)==='function') this._filter = options.filter;\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n  this._handleEvent = options.condition || function() { return true; };\n  this.addFn_ = options.addCondition || function() { return false; };\n  /* Translate when click on feature */\n  this.set('translateFeature', (options.translateFeature!==false));\n  /* Can translate the feature */\n  this.set('translate', (options.translate!==false));\n  /* Can stretch the feature */\n  this.set('stretch', (options.stretch!==false));\n  /* Can scale the feature */\n  this.set('scale', (options.scale!==false));\n  /* Can rotate the feature */\n  this.set('rotate', (options.rotate!==false));\n  /* Keep aspect ratio */\n  this.set('keepAspectRatio', (options.keepAspectRatio || function(e){ return e.originalEvent.shiftKey }));\n  /* Modify center */\n  this.set('modifyCenter', (options.modifyCenter || function(e){ return e.originalEvent.metaKey || e.originalEvent.ctrlKey }));\n  /* Prevent flip */\n  this.set('noFlip', (options.noFlip || false));\n  /* Handle selection */\n  this.set('selection', (options.selection !== false));\n  /*  */\n  this.set('hitTolerance', (options.hitTolerance || 0));\n  // Force redraw when changed\n  this.on ('propertychange', function() {\n    this.drawSketch_();\n  });\n  // setstyle\n  this.setDefaultStyle();\n};\nol.ext.inherits(ol.interaction.Transform, ol.interaction.Pointer);\n/** Cursors for transform\n*/\nol.interaction.Transform.prototype.Cursors = {\n  'default': 'auto',\n  'select': 'pointer',\n  'translate': 'move',\n  'rotate': 'move',\n  'rotate0': 'move',\n  'scale': 'nesw-resize',\n  'scale1': 'nwse-resize',\n  'scale2': 'nesw-resize',\n  'scale3': 'nwse-resize',\n  'scalev': 'ew-resize',\n  'scaleh1': 'ns-resize',\n  'scalev2': 'ew-resize',\n  'scaleh3': 'ns-resize'\n};\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Transform.prototype.setMap = function(map) {\n  if (this.getMap()) {\n    this.getMap().removeLayer(this.overlayLayer_);\n    if (this.previousCursor_) {\n      this.getMap().getTargetElement().style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n  ol.interaction.Pointer.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n  if (map !== null) {\n    this.isTouch = /touch/.test(map.getViewport().className);\n    this.setDefaultStyle();\n  }\n};\n/**\n * Activate/deactivate interaction\n * @param {bool}\n * @api stable\n */\nol.interaction.Transform.prototype.setActive = function(b) {\n  this.select(null);\n  this.overlayLayer_.setVisible(b);\n  ol.interaction.Pointer.prototype.setActive.call (this, b);\n};\n/** Set efault sketch style\n*/\nol.interaction.Transform.prototype.setDefaultStyle = function() {\n  // Style\n  var stroke = new ol.style.Stroke({ color: [255,0,0,1], width: 1 });\n  var strokedash = new ol.style.Stroke({ color: [255,0,0,1], width: 1, lineDash:[4,4] });\n  var fill0 = new ol.style.Fill({ color:[255,0,0,0.01] });\n  var fill = new ol.style.Fill({ color:[255,255,255,0.8] });\n  var circle = new ol.style.RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 15\n    });\n  circle.getAnchor()[0] = this.isTouch ? -10 : -5;\n  var bigpt = new ol.style.RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 16 : 8,\n      points: 4,\n      angle: Math.PI/4\n    });\n  var smallpt = new ol.style.RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 4,\n      angle: Math.PI/4\n    });\n  function createStyle (img, stroke, fill) {\n    return [ new ol.style.Style({image:img, stroke:stroke, fill:fill}) ];\n  }\n  /** Style for handles */\n  this.style = {\n    'default': createStyle (bigpt, strokedash, fill0),\n    'translate': createStyle (bigpt, stroke, fill),\n    'rotate': createStyle (circle, stroke, fill),\n    'rotate0': createStyle (bigpt, stroke, fill),\n    'scale': createStyle (bigpt, stroke, fill),\n    'scale1': createStyle (bigpt, stroke, fill),\n    'scale2': createStyle (bigpt, stroke, fill),\n    'scale3': createStyle (bigpt, stroke, fill),\n    'scalev': createStyle (smallpt, stroke, fill),\n    'scaleh1': createStyle (smallpt, stroke, fill),\n    'scalev2': createStyle (smallpt, stroke, fill),\n    'scaleh3': createStyle (smallpt, stroke, fill),\n  };\n  this.drawSketch_();\n}\n/**\n * Set sketch style.\n * @param {style} style Style name: 'default','translate','rotate','rotate0','scale','scale1','scale2','scale3','scalev','scaleh1','scalev2','scaleh3'\n * @param {ol.style.Style|Array<ol.style.Style>} olstyle\n * @api stable\n */\nol.interaction.Transform.prototype.setStyle = function(style, olstyle) {\n  if (!olstyle) return;\n  if (olstyle instanceof Array) this.style[style] = olstyle;\n  else this.style[style] = [ olstyle ];\n  for (var i=0; i<this.style[style].length; i++) {\n    var im = this.style[style][i].getImage();\n    if (im) {\n      if (style == 'rotate') im.getAnchor()[0] = -5;\n      if (this.isTouch) im.setScale(1.8);\n    }\n    var tx = this.style[style][i].getText();\n    if (tx) {\n      if (style == 'rotate') tx.setOffsetX(this.isTouch ? 14 : 7);\n      if (this.isTouch) tx.setScale(1.8);\n    }\n  }\n  this.drawSketch_();\n};\n/** Get Feature at pixel\n * @param {ol.Pixel}\n * @return {ol.feature}\n * @private\n */\nol.interaction.Transform.prototype.getFeatureAtPixel_ = function(pixel) {\n  var self = this;\n  return this.getMap().forEachFeatureAtPixel(pixel,\n    function(feature, layer) {\n      var found = false;\n      // Overlay ?\n      if (!layer) {\n        if (feature===self.bbox_) return false;\n        self.handles_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature, handle:feature.get('handle'), constraint:feature.get('constraint'), option:feature.get('option') };\n      }\n      // No seletion\n      if (!self.get('selection')) {\n        // Return the currently selected feature the user is interacting with.\n        if (self.selection_.getArray().some(function(f) { return feature === f; })) {\n          return { feature: feature };\n        }\n        return null;\n      }\n      // filter condition\n      if (self._filter) {\n        if (self._filter(feature,layer)) return { feature: feature };\n        else return null;\n      }\n      // feature belong to a layer\n      else if (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) return { feature: feature };\n        }\n        return null;\n      }\n      // feature in the collection\n      else if (self.features_) {\n        self.features_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature };\n        else return null;\n      }\n      // Others\n      else return { feature: feature };\n    },\n    { hitTolerance: this.get('hitTolerance') }\n  ) || {};\n}\n/** Draw transform sketch\n* @param {boolean} draw only the center\n*/\nol.interaction.Transform.prototype.drawSketch_ = function(center) {\n  var i, f, geom;\n  this.overlayLayer_.getSource().clear();\n  if (!this.selection_.getLength()) return;\n  var ext = this.selection_.item(0).getGeometry().getExtent();\n  // Clone and extend\n  ext = ol.extent.buffer(ext, 0);\n  this.selection_.forEach(function (f) {\n    ol.extent.extend(ext, f.getGeometry().getExtent());\n  });\n  if (center===true) {\n    if (!this.ispt_) {\n      this.overlayLayer_.getSource().addFeature(new ol.Feature( { geometry: new ol.geom.Point(this.center_), handle:'rotate0' }) );\n      geom = ol.geom.Polygon.fromExtent(ext);\n      f = this.bbox_ = new ol.Feature(geom);\n      this.overlayLayer_.getSource().addFeature (f);\n    }\n  }\n  else {\n    if (this.ispt_) {\n      var p = this.getMap().getPixelFromCoordinate([ext[0], ext[1]]);\n      ext = ol.extent.boundingExtent([\n        this.getMap().getCoordinateFromPixel([p[0]-10, p[1]-10]),\n        this.getMap().getCoordinateFromPixel([p[0]+10, p[1]+10])\n      ]);\n    }\n    geom = ol.geom.Polygon.fromExtent(ext);\n    f = this.bbox_ = new ol.Feature(geom);\n    var features = [];\n    var g = geom.getCoordinates()[0];\n    if (!this.ispt_) {\n      features.push(f);\n      // Middle\n      if (!this.iscircle_ && this.get('stretch') && this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol.Feature( { geometry: new ol.geom.Point([(g[i][0]+g[i+1][0])/2,(g[i][1]+g[i+1][1])/2]), handle:'scale', constraint:i%2?\"h\":\"v\", option:i });\n        features.push(f);\n      }\n      // Handles\n      if (this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol.Feature( { geometry: new ol.geom.Point(g[i]), handle:'scale', option:i });\n        features.push(f);\n      }\n      // Center\n      if (this.get('translate') && !this.get('translateFeature')) {\n        f = new ol.Feature( { geometry: new ol.geom.Point([(g[0][0]+g[2][0])/2, (g[0][1]+g[2][1])/2]), handle:'translate' });\n        features.push(f);\n      }\n    }\n    // Rotate\n    if (!this.iscircle_ && this.get('rotate')) {\n      f = new ol.Feature( { geometry: new ol.geom.Point(g[3]), handle:'rotate' });\n      features.push(f);\n    }\n    // Add sketch\n    this.overlayLayer_.getSource().addFeatures(features);\n  }\n};\n/** Select a feature to transform\n* @param {ol.Feature} feature the feature to transform\n* @param {boolean} add true to add the feature to the selection, default false\n*/\nol.interaction.Transform.prototype.select = function(feature, add) {\n  if (!feature) {\n    this.selection_.clear();\n    this.drawSketch_();\n    return;\n  }\n  if (!feature.getGeometry || !feature.getGeometry()) return;\n  // Add to selection\n  if (add) {\n    this.selection_.push(feature);\n  } else {\n    this.selection_.clear()\n    this.selection_.push(feature);\n  }\n  this.ispt_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false);\n  this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n  this.drawSketch_();\n  this.watchFeatures_();\n  // select event\n  this.dispatchEvent({ type:'select', feature: feature, features: this.selection_ });\n};\n/** Watch selected features\n * @private\n */\nol.interaction.Transform.prototype.watchFeatures_ = function() {\n  // Listen to feature modification\n  if (this._featureListeners) {\n    this._featureListeners.forEach(function (l) {\n      ol.Observable.unByKey(l)\n    });\n  }\n  this._featureListeners = [];\n  this.selection_.forEach(function(f) {\n    this._featureListeners.push(\n      f.on('change', function() {\n        this.drawSketch_();\n      }.bind(this))\n    );\n  }.bind(this));\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n * @private\n */\nol.interaction.Transform.prototype.handleDownEvent_ = function(evt) {\n  if (!this._handleEvent(evt, this.selection_)) return;\n  var sel = this.getFeatureAtPixel_(evt.pixel);\n  var feature = sel.feature;\n  if (this.selection_.getLength()\n    && this.selection_.getArray().indexOf(feature) >= 0\n    && ((this.ispt_ && this.get('translate')) || this.get('translateFeature'))\n  ){\n    sel.handle = 'translate';\n  }\n  if (sel.handle) {\n    this.mode_ = sel.handle;\n    this.opt_ = sel.option;\n    this.constraint_ = sel.constraint;\n    // Save info\n    this.coordinate_ = evt.coordinate;\n    this.pixel_ = evt.pixel;\n    this.geoms_ = [];\n    var extent = ol.extent.createEmpty();\n    for (var i=0, f; f=this.selection_.item(i); i++) {\n      this.geoms_.push(f.getGeometry().clone());\n      extent = ol.extent.extend(extent, f.getGeometry().getExtent());\n    }\n    this.extent_ = (ol.geom.Polygon.fromExtent(extent)).getCoordinates()[0];\n    if (this.mode_==='rotate') {\n      this.center_ = this.getCenter() || ol.extent.getCenter(extent);\n      // we are now rotating (cursor down on rotate mode), so apply the grabbing cursor\n      var element = evt.map.getTargetElement();\n      element.style.cursor = this.Cursors.rotate0;\n      this.previousCursor_ = element.style.cursor;\n    } else {\n      this.center_ = ol.extent.getCenter(extent);\n    }\n    this.angle_ = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n    this.dispatchEvent({\n      type: this.mode_+'start',\n      feature: this.selection_.item(0), // backward compatibility\n      features: this.selection_,\n      pixel: evt.pixel,\n      coordinate: evt.coordinate\n    });\n    return true;\n  }\n  else if (this.get('selection')) {\n    if (feature){\n      if (!this.addFn_(evt)) this.selection_.clear();\n      var index = this.selection_.getArray().indexOf(feature);\n      if (index < 0) this.selection_.push(feature);\n      else this.selection_.removeAt(index);\n    } else {\n      this.selection_.clear();\n    }\n    this.ispt_ = this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false;\n    this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n    this.drawSketch_();\n    this.watchFeatures_();\n    this.dispatchEvent({ type:'select', feature: feature, features: this.selection_, pixel: evt.pixel, coordinate: evt.coordinate });\n    return false;\n  }\n};\n/**\n * Get features to transform\n * @return {ol.Collection<ol.Feature>}\n */\nol.interaction.Transform.prototype.getFeatures = function() {\n  return this.selection_;\n};\n/**\n * Get the rotation center\n * @return {ol.coordinates|undefined}\n */\nol.interaction.Transform.prototype.getCenter = function() {\n  return this.get('center');\n};\n/**\n * Set the rotation center\n * @param {ol.coordinates|undefined} c the center point, default center on the objet\n */\nol.interaction.Transform.prototype.setCenter = function(c) {\n  return this.set('center', c);\n}\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @private\n */\nol.interaction.Transform.prototype.handleDragEvent_ = function(evt) {\n  if (!this._handleEvent(evt, this.features_)) return;\n  var i, f, geometry;\n  switch (this.mode_) {\n    case 'rotate': {\n      var a = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n      if (!this.ispt) {\n        // var geometry = this.geom_.clone();\n        // geometry.rotate(a-this.angle_, this.center_);\n        // this.feature_.setGeometry(geometry);\n        for (i=0, f; f=this.selection_.item(i); i++) {\n          geometry = this.geoms_[i].clone();\n          geometry.rotate(a - this.angle_, this.center_);\n          // bug: ol, bad calculation circle geom extent\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\n          f.setGeometry(geometry);\n        }\n      }\n      this.drawSketch_(true);\n      this.dispatchEvent({\n        type:'rotating',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        angle: a-this.angle_,\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'translate': {\n      var deltaX = evt.coordinate[0] - this.coordinate_[0];\n      var deltaY = evt.coordinate[1] - this.coordinate_[1];\n      //this.feature_.getGeometry().translate(deltaX, deltaY);\n      for (i=0, f; f=this.selection_.item(i); i++) {\n        f.getGeometry().translate(deltaX, deltaY);\n      }\n      this.handles_.forEach(function(f) {\n        f.getGeometry().translate(deltaX, deltaY);\n      });\n      this.coordinate_ = evt.coordinate;\n      this.dispatchEvent({\n        type:'translating',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        delta:[deltaX,deltaY],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'scale': {\n      var center = this.center_;\n      if (this.get('modifyCenter')(evt)) {\n        center = this.extent_[(Number(this.opt_)+2)%4];\n      }\n      var scx = (evt.coordinate[0] - center[0]) / (this.coordinate_[0] - center[0]);\n      var scy = (evt.coordinate[1] - center[1]) / (this.coordinate_[1] - center[1]);\n      if (this.get('noFlip')) {\n        if (scx<0) scx=-scx;\n        if (scy<0) scy=-scy;\n      }\n      if (this.constraint_) {\n        if (this.constraint_==\"h\") scx=1;\n        else scy=1;\n      } else {\n        if (this.get('keepAspectRatio')(evt)) {\n          scx = scy = Math.min(scx,scy);\n        }\n      }\n      for (i=0, f; f=this.selection_.item(i); i++) {\n        geometry = this.geoms_[i].clone();\n        geometry.applyTransform(function(g1, g2, dim) {\n          if (dim<2) return g2;\n          for (var j=0; j<g1.length; j+=dim) {\n            if (scx!=1) g2[j] = center[0] + (g1[j]-center[0])*scx;\n            if (scy!=1) g2[j+1] = center[1] + (g1[j+1]-center[1])*scy;\n          }\n          // bug: ol, bad calculation circle geom extent\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\n          return g2;\n        });\n        f.setGeometry(geometry);\n      }\n      this.drawSketch_();\n      this.dispatchEvent({\n        type:'scaling',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        scale:[scx,scy],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    default: break;\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nol.interaction.Transform.prototype.handleMoveEvent_ = function(evt) {\n  if (!this._handleEvent(evt, this.features_)) return;\n  // console.log(\"handleMoveEvent\");\n  if (!this.mode_) {\n    var sel = this.getFeatureAtPixel_(evt.pixel);\n    var element = evt.map.getTargetElement();\n    if (sel.feature) {\n      var c = sel.handle ? this.Cursors[(sel.handle||'default')+(sel.constraint||'')+(sel.option||'')] : this.Cursors.select;\n      if (this.previousCursor_===undefined) {\n        this.previousCursor_ = element.style.cursor;\n      }\n      element.style.cursor = c;\n    } else {\n      if (this.previousCursor_!==undefined) element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol.interaction.Transform.prototype.handleUpEvent_ = function(evt) {\n  // remove rotate0 cursor on Up event, otherwise it's stuck on grab/grabbing\n  if (this.mode_ === 'rotate') {\n    var element = evt.map.getTargetElement();\n    element.style.cursor = this.Cursors.default;\n    this.previousCursor_ = undefined;\n  }\n  //dispatchEvent\n  this.dispatchEvent({\n    type:this.mode_+'end',\n    feature: this.selection_.item(0),\n    features: this.selection_,\n    oldgeom: this.geoms_[0],\n    oldgeoms: this.geoms_\n  });\n  this.drawSketch_();\n  this.mode_ = null;\n  return false;\n};\n/** Get the features that are selected for transform\n * @return ol.Collection\n */\nol.interaction.Transform.prototype.getFeatures = function() {\n  return this.selection_;\n};\n\n/** Undo/redo interaction\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires undo\n * @fires redo\n * @param {*} options\n */\nol.interaction.UndoRedo = function(options) {\n  if (!options) options = {};\n\tol.interaction.Interaction.call(this, {\t\n    handleEvent: function() { \n      return true; \n    }\n  });\n  this._undoStack = [];\n  this._redoStack = [];\n  // Block counter\n  this._block = 0;\n  // Start recording\n  this._record = true;\n  // Custom definitions\n  this._defs = {};\n};\nol.ext.inherits(ol.interaction.UndoRedo, ol.interaction.Interaction);\n/** Add a custom undo/redo\n * @param {string} action the action key name\n * @param {function} undoFn function called when undoing\n * @param {function} redoFn function called when redoing\n * @api\n */\nol.interaction.UndoRedo.prototype.define = function(action, undoFn, redoFn) {\n  this._defs['_'+action] = { undo: undoFn, redo: redoFn };\n};\n/** Set a custom undo/redo\n * @param {string} action the action key name\n * @param {any} prop an object that will be passed in the undo/redo fucntions of the action\n * @return {boolean} true if the action is defined\n */\nol.interaction.UndoRedo.prototype.push = function(action, prop) {\n  if (this._defs['_'+action]) {\n    this._undoStack.push({type: '_'+action, prop: prop });\n    return true;\n  } else {\n    return false;\n  }\n};\n/** Activate or deactivate the interaction, ie. records or not events on the map.\n * @param {boolean} active\n * @api stable\n */\nol.interaction.UndoRedo.prototype.setActive = function(active) {\n  ol.interaction.Interaction.prototype.setActive.call (this, active);\n  this._record = active;\n};\n/**\n * Remove the interaction from its current map, if any, and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.UndoRedo.prototype.setMap = function(map) {\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  // Watch sources\n  this._watchSources();\n  this._watchInteractions();\n};\n/** Watch for changes in the map sources\n * @private\n */\nol.interaction.UndoRedo.prototype._watchSources = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._sourceListener) {\n    this._sourceListener.forEach(function(l) { ol.Observable.unByKey(l); })\n  }\n  this._sourceListener = [];\n  // Ges vector layers \n  function getVectorLayers(layers, init) {\n    if (!init) init = [];\n    layers.forEach(function(l) {\n      if (l instanceof ol.layer.Vector) {\n        init.push(l);\n      } else if (l.getLayers) {\n        getVectorLayers(l.getLayers(), init);\n      }\n    });\n    return init;\n  }\n  if (map) {\n    // Watch the vector sources in the map \n    var vectors = getVectorLayers(map.getLayers());\n    vectors.forEach((function(l) {\n      var s = l.getSource();\n      this._sourceListener.push( s.on(['addfeature', 'removefeature'], this._onAddRemove.bind(this)) );\n      this._sourceListener.push( s.on('clearstart', this.blockStart.bind(this)) );\n      this._sourceListener.push( s.on('clearend', this.blockEnd.bind(this)) );\n    }).bind(this));\n    // Watch new inserted/removed\n    this._sourceListener.push( map.getLayers().on(['add', 'remove'], this._watchSources.bind(this) ) );\n  }\n};\n/** Watch for interactions\n * @private\n */\nol.interaction.UndoRedo.prototype._watchInteractions = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._interactionListener) {\n    this._interactionListener.forEach(function(l) { ol.Observable.unByKey(l); })\n  }\n  this._interactionListener = [];\n  if (map) {\n    // Watch the interactions in the map \n    map.getInteractions().forEach((function(i) {\n      this._interactionListener.push(i.on(\n        ['setattributestart', 'modifystart', 'rotatestart', 'translatestart', 'scalestart', 'deletestart', 'deleteend', 'beforesplit', 'aftersplit'], \n        this._onInteraction.bind(this)\n      ));\n    }).bind(this));\n    // Watch new inserted / unwatch removed\n    this._interactionListener.push( map.getInteractions().on(\n      ['add', 'remove'], \n      this._watchInteractions.bind(this)\n    ));\n  }\n};\n/** A feature is added / removed\n */\nol.interaction.UndoRedo.prototype._onAddRemove = function(e) {\n  if (this._record) {\n    this._undoStack.push({type: e.type, source: e.target, feature: e.feature });\n    this._redoStack = [];\n  }\n};\nol.interaction.UndoRedo.prototype._onInteraction = function(e) {\n  var fn = this._onInteraction[e.type];\n  if (fn) fn.call(this,e);\n};\n/** Set attribute\n * @private\n */\nol.interaction.UndoRedo.prototype._onInteraction.setattributestart = function(e) {\n  this.blockStart();\n  var newp = Object.assign({}, e.properties);\n  e.features.forEach(function(f) {\n    var oldp = {};\n    for (var p in newp) {\n      oldp[p] = f.get(p);\n    }\n    this._undoStack.push({\n      type: 'changeattribute', \n      feature: f, \n      newProperties: newp,\n      oldProperties: oldp\n    });\n  }.bind(this));\n  this.blockEnd();\n};\nol.interaction.UndoRedo.prototype._onInteraction.rotatestart = \nol.interaction.UndoRedo.prototype._onInteraction.translatestart = \nol.interaction.UndoRedo.prototype._onInteraction.scalestart = \nol.interaction.UndoRedo.prototype._onInteraction.modifystart = function (e) {\n  this.blockStart();\n  e.features.forEach(function(m) {\n    this._undoStack.push({type: 'changefeature', feature: m, oldFeature: m.clone()  });\n  }.bind(this));\n  this.blockEnd();\n};\n/** Start an undo block\n * @api\n */\nol.interaction.UndoRedo.prototype.blockStart = function () {\n  this._undoStack.push({ type: 'blockstart' });\n  this._redoStack = [];\n};\n/** @private\n */\nol.interaction.UndoRedo.prototype._onInteraction.beforesplit =\nol.interaction.UndoRedo.prototype._onInteraction.deletestart =\nol.interaction.UndoRedo.prototype.blockStart;\n/** End an undo block\n * @api\n */\nol.interaction.UndoRedo.prototype.blockEnd = function () {\n  this._undoStack.push({ type: 'blockend' });\n};\n/** @private\n */\nol.interaction.UndoRedo.prototype._onInteraction.aftersplit =\nol.interaction.UndoRedo.prototype._onInteraction.deleteend =\nol.interaction.UndoRedo.prototype.blockEnd;\n/** handle undo/redo\n * @private\n */\nol.interaction.UndoRedo.prototype._handleDo = function(e, undo) {\n  // Not active\n  if (!this.getActive()) return;\n  // Stop recording while undoing\n  this._record = false;\n  switch (e.type) {\n    case 'addfeature': {\n      if (undo) e.source.removeFeature(e.feature);\n      else e.source.addFeature(e.feature);\n      break;\n    }\n    case 'removefeature': {\n      if (undo) e.source.addFeature(e.feature);\n      else e.source.removeFeature(e.feature);\n      break;\n    }\n    case 'changefeature': {\n      var geom = e.feature.getGeometry();\n      e.feature.setGeometry(e.oldFeature.getGeometry());\n      e.oldFeature.setGeometry(geom);\n      break;\n    }\n    case 'changeattribute': {\n      var newp = e.newProperties;\n      var oldp = e.oldProperties;\n      for (var p in oldp) {\n        if (oldp === undefined) e.feature.unset(p);\n        else e.feature.set(p, oldp[p]);\n      }\n      e.oldProperties = newp;\n      e.newProperties = oldp;\n      break;\n    }\n    case 'blockstart': {\n      this._block += undo ? -1 : 1;\n      break;\n    }\n    case 'blockend': {\n      this._block += undo ? 1 : -1;\n      break;\n    }\n    default: {\n      if (this._defs[e.type]) {\n        if (undo) this._defs[e.type].undo(e.prop);\n        else this._defs[e.type].redo(e.prop);\n      } else {\n        console.warn('[UndoRedoInteraction]: \"'+e.type.substr(1)+'\" is not defined.');\n      }\n    }\n  }\n  // Handle block\n  if (this._block<0) this._block = 0;\n  if (this._block) {\n    if (undo) this.undo();\n    else this.redo();\n  }\n  this._record = true;\n  // Dispatch event\n  this.dispatchEvent( { \n    type: undo ? 'undo' : 'redo',\n    action: e\n  });\n};\n/** Undo last operation\n * @api\n */\nol.interaction.UndoRedo.prototype.undo = function() {\n  var e = this._undoStack.pop();\n  if (!e) return;\n  this._redoStack.push(e);\n  this._handleDo(e, true);\n};\n/** Redo last operation\n * @api\n */\nol.interaction.UndoRedo.prototype.redo = function() {\n  var e = this._redoStack.pop();\n  if (!e) return;\n  this._undoStack.push(e);\n  this._handleDo(e, false);\n};\n/** Clear undo stack\n * @api\n */\nol.interaction.UndoRedo.prototype.clear = function() {\n  this._undoStack = [];\n  this._redoStack = [];\n};\n/** Check if undo is avaliable\n * @return {number} the number of undo \n * @api\n */\nol.interaction.UndoRedo.prototype.hasUndo = function() {\n  return this._undoStack.length;\n};\n/** Check if redo is avaliable\n * @return {number} the number of redo\n * @api\n */\nol.interaction.UndoRedo.prototype.hasRedo = function() {\n  return this._redoStack.length;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Abstract base class; normally only used for creating subclasses. Bin collector for data\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {boolean} options.listenChange listen changes (move) on source features to recalculate the bin, default true\n *  @param {fucntion} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {function} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.BinBase = function (options) {\n  options = options || {};\n  this._bindModify = this._onModifyFeature.bind(this);\n  this._watch === true;\n  ol.source.Vector.call(this, options);\n  this._origin = options.source;\n  this._listen = (options.listenChange !== false);\n  // Geometry function\n  this._geomFn = options.geometryFunction || ol.coordinate.getFeatureCenter || function (f) { return f.getGeometry().getFirstCoordinate(); };\n  // Existing features\n  this.reset();\n  // Future features\n  this._origin.on('addfeature', this._onAddFeature.bind(this));\n  this._origin.on('removefeature', this._onRemoveFeature.bind(this));\n  this._origin.on('clearstart', this._onClearFeature.bind(this));\n  this._origin.on('clearend', this._onClearFeature.bind(this));\n  if (typeof (options.flatAttributes) === 'function') this._flatAttributes = options.flatAttributes;\n};\nol.ext.inherits(ol.source.BinBase, ol.source.Vector);\n/**\n * On add feature\n * @param {ol.events.Event} e\n * @param {ol.Feature} bin\n * @private\n */\nol.source.BinBase.prototype._onAddFeature = function (e, bin, listen) {\n  var f = e.feature || e.target;\n  bin = bin || this.getBinAt(this._geomFn(f), true);\n  if (bin) bin.get('features').push(f);\n  if (this._listen && listen!==false) f.on('change', this._bindModify);\n};\n/**\n *  On remove feature\n *  @param {ol.events.Event} e\n *  @param {ol.Feature} bin\n *  @private\n */\nol.source.BinBase.prototype._onRemoveFeature = function (e, bin, listen) {\n  if (!this._watch) return;\n  var f = e.feature || e.target;\n  bin = bin || this.getBinAt(this._geomFn(f));\n  if (bin) {\n    // Remove feature from bin\n    var features = bin.get('features');\n    for (var i=0, fi; fi=features[i]; i++) {\n      if (fi===f) {\n        features.splice(i, 1);\n        break;\n      }\n    }\n    // Remove bin if no features\n    if (!features.length) {\n      this.removeFeature(bin);\n    }\n  } else {\n    // console.log(\"[ERROR:Bin] remove feature: feature doesn't exists anymore.\");\n  }\n  if (this._listen && listen!==false) f.un('change', this._bindModify);\n};\n/** When clearing features remove the listener\n * @private\n */\nol.source.BinBase.prototype._onClearFeature = function (e) {\n  if (e.type==='clearstart') {\n    if (this._listen) {\n      this._origin.getFeatures().forEach(function (f) {\n        f.un('change', this._bindModify);\n      }.bind(this));\n    }\n    this.clear();\n    this._watch = false;\n  } else {\n    this._watch = true;\n  }\n};\n/**\n * Get the bin that contains a feature\n * @param {ol.Feature} f the feature\n * @return {ol.Feature} the bin or null it doesn't exit\n */\nol.source.BinBase.prototype.getBin = function (feature) {\n  var bins = this.getFeatures();\n  for (var i=0, b; b = bins[i]; i++) {\n    var features = b.get('features');\n    for (var j=0, f; f=features[j]; j++) {\n      if (f===feature) return b;\n    }\n  }\n  return null;\n}\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @param {Object} attributes add key/value to this object to add properties to the grid feature\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.BinBase.prototype.getGridGeomAt = function (coord /*, attributes */) {\n  return new ol.geom.Polygon([coord]);\n};\n/** Get the bean at a coord\n * @param {ol.Coordinate} coord\n * @param {boolean} create true to create if doesn't exit\n * @return {ol.Feature} the bin or null it doesn't exit\n */\nol.source.BinBase.prototype.getBinAt = function (coord, create) {\n  var attributes = {};\n  var g = this.getGridGeomAt(coord, attributes);\n  if (!g) return null;\n  var center = g.getInteriorPoint ? g.getInteriorPoint().getCoordinates() : g.getInteriorPoints().getCoordinates()[0];// ol.extent.getCenter(g.getExtent());\n  var features = this.getFeaturesAtCoordinate( center );\n  var bin = features[0];\n  if (!bin && create) {\n    attributes.geometry = g;\n    attributes.features = [];\n    attributes.center = center;\n    bin = new ol.Feature(attributes);\n    this.addFeature(bin);\n  }\n  return bin || null;\n};\n/**\n *  A feature has been modified\n *  @param {ol.events.Event} e\n *  @private\n */\nol.source.BinBase.prototype._onModifyFeature = function (e) {\n  var bin = this.getBin(e.target);\n  var bin2 = this.getBinAt(this._geomFn(e.target), 'create');\n  if (bin !== bin2) {\n    // remove from the bin\n    if (bin) {\n      this._onRemoveFeature(e, bin, false);\n    }\n    // insert in the new bin\n    if (bin2) {\n      this._onAddFeature(e, bin2, false);\n    }\n  }\n  this.changed();\n};\n/** Clear all bins and generate a new one. \n */\nol.source.BinBase.prototype.reset = function () {\n  this.clear();\n  var features = this._origin.getFeatures();\n  for (var i = 0, f; f = features[i]; i++) {\n    this._onAddFeature({ feature: f });\n  }\n};\n/**\n * Get features without circular dependencies (vs. getFeatures)\n * @return {Array<ol.Feature>}\n */\nol.source.BinBase.prototype.getGridFeatures = function () {\n  var features = [];\n  this.getFeatures().forEach(function (f) {\n    var bin = new ol.Feature(f.getGeometry().clone());\n    for (var i in f.getProperties()) {\n      if (i!=='features' && i!=='geometry') {\n        bin.set(i, f.get(i));\n      }\n    }\n    bin.set('nb', f.get('features').length);\n    this._flatAttributes(bin, f.get('features'));\n    features.push(bin);\n  }.bind(this));\n  return features;\n};\n/** Create bin attributes using the features it contains when exporting \n * @param {ol.Feature} bin the bin to export\n * @param {Array<ol.Features>} features the features it contains\n */\nol.source.BinBase.prototype._flatAttributes = function(/*bin, features*/) {\n};\n/**\n * Get the orginal source\n * @return {ol.source.Vector}\n */\nol.source.BinBase.prototype.getSource = function () {\n  return this._origin;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n  @classdesc\n  ol.source.DBPedia is a DBPedia layer source that load DBPedia located content in a vector layer.\n  olx.source.DBPedia: olx.source.Vector\n  {\turl: {string} Url for DBPedia SPARQL \n  }\n  Inherits from:\n  <ol.source.Vector>\n*/\n/**\n* @constructor ol.source.DBPedia\n* @extends {ol.source.Vector}\n* @param {olx.source.DBPedia=} opt_options\n*/\nol.source.DBPedia = function(opt_options) {\n  var options = opt_options || {};\n  options.loader = this._loaderFn;\n  /** Url for DBPedia SPARQL */\n  this._url = options.url || \"http://fr.dbpedia.org/sparql\";\n  /** Max resolution to load features  */\n  this._maxResolution = options.maxResolution || 100;\n  /** Result language */\n  this._lang = options.lang || \"fr\";\n  /** Query limit */\n  this._limit = options.limit || 1000;\n  /** Default attribution */\n  if (!options.attributions) options.attributions = [ \"&copy; <a href='http://dbpedia.org/'>DBpedia</a> CC-by-SA\" ];\n  // Bbox strategy : reload at each move\n    if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n  ol.source.Vector.call (this, options);\n};\nol.ext.inherits(ol.source.DBPedia, ol.source.Vector);\n/** Decode RDF attributes and choose to add feature to the layer\n* @param {feature} the feature\n* @param {attributes} RDF attributes\n* @param {lastfeature} last feature added (null if none)\n* @return {boolean} true: add the feature to the layer\n* @API stable\n*/\nol.source.DBPedia.prototype.readFeature = function (feature, attributes, lastfeature) {\n  // Copy RDF attributes values\n  for (var i in attributes) {\n    if (attributes[i].type==='uri') attributes[i].value = encodeURI(attributes[i].value);\n    feature.set (i, attributes[i].value);\n  }\n  // Prevent same feature with different type duplication\n  if (lastfeature && lastfeature.get(\"subject\") == attributes.subject.value) {\n    // Kepp dbpedia.org type ?\n    // if (bindings[i].type.match (\"dbpedia.org\") lastfeature.get(\"type\") = bindings[i].type.value;\n    // Concat types\n    lastfeature.set(\"type\", lastfeature.get(\"type\") +\"\\n\"+ attributes.type.value);\n    return false;\n  } else {\n    return true;\n  }\n};\n/** Set RDF query subject, default: select label, thumbnail, abstract and type\n* @API stable\n*/\nol.source.DBPedia.prototype.querySubject = function () {\n  return \"?subject rdfs:label ?label. \"\n    + \"OPTIONAL {?subject dbpedia-owl:thumbnail ?thumbnail}.\"\n    + \"OPTIONAL {?subject dbpedia-owl:abstract ?abstract} . \"\n    + \"OPTIONAL {?subject rdf:type ?type}\";\n}\n/** Set RDF query filter, default: select language\n* @API stable\n*/\nol.source.DBPedia.prototype.queryFilter = function () {\n  return\t \"lang(?label) = '\"+this._lang+\"' \"\n    + \"&& lang(?abstract) = '\"+this._lang+\"'\"\n  // Filter on type \n  //+ \"&& regex (?type, 'Monument|Sculpture|Museum', 'i')\"\n}\n/** Loader function used to load features.\n* @private\n*/\nol.source.DBPedia.prototype._loaderFn = function(extent, resolution, projection) {\n  if (resolution > this._maxResolution) return;\n  var self = this;\n  var bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n  // SPARQL request: for more info @see http://fr.dbpedia.org/\n  var query =\t\"PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> \"\n        + \"SELECT DISTINCT * WHERE { \"\n        + \"?subject geo:lat ?lat . \"\n        + \"?subject geo:long ?long . \"\n        + this.querySubject()+\" . \"\n        + \"FILTER(\"+this.queryFilter()+\") . \"\n        // Filter bbox\n        + \"FILTER(xsd:float(?lat) <= \" + bbox[3] + \" && \" + bbox[1] + \" <= xsd:float(?lat) \"\n        + \"&& xsd:float(?long) <= \" + bbox[2] + \" && \" + bbox[0] + \" <= xsd:float(?long) \"\n        + \") . \"\n        + \"} LIMIT \"+this._limit;\n  // Ajax request to get the tile\n  ol.ext.Ajax.get({\n    url: this._url,\n    data: { query: query, format:\"json\" },\n    success: function(data) {\n      var bindings = data.results.bindings;\n      var features = [];\n      var att, pt, feature, lastfeature = null;\n      for ( var i in bindings ) {\n        att = bindings[i];\n        pt = [Number(bindings[i].long.value), Number(bindings[i].lat.value)];\n        feature = new ol.Feature(new ol.geom.Point(ol.proj.transform (pt,\"EPSG:4326\",projection)));\n        if (self.readFeature(feature, att, lastfeature)) {\n          features.push(feature);\n          lastfeature = feature;\n        }\n      }\n      self.addFeatures(features);\n    }});\n};\nol.style.clearDBPediaStyleCache;\nol.style.dbPediaStyleFunction; \n(function(){\n// Style cache\nvar styleCache = {};\n/** Reset the cache (when fonts are loaded)\n*/\nol.style.clearDBPediaStyleCache = function() {\n  styleCache = {};\n}\n/** Get a default style function for dbpedia\n* @param {} options\n* @param {string|function|undefined} options.glyph a glyph name or a function that takes a feature and return a glyph\n* @param {number} options.radius radius of the symbol, default 8\n* @param {ol.style.Fill} options.fill style for fill, default navy\n* @param {ol.style.stroke} options.stroke style for stroke, default 2px white\n* @param {string} options.prefix a prefix if many style used for the same type\n*\n* @require ol.style.FontSymbol and FontAwesome defs are required for dbPediaStyleFunction()\n*/\nol.style.dbPediaStyleFunction = function(options) {\n  if (!options) options={};\n  // Get font function using dbPedia type\n  var getFont;\n  switch (typeof(options.glyph)) {\n    case \"function\": getFont = options.glyph; break;\n    case \"string\": getFont = function(){ return options.glyph; }; break;\n    default: {\n      getFont = function (f) {\n        var type = f.get(\"type\");\n        if (type) {\n          if (type.match(\"/Museum\")) return \"fa-camera\";\n          else if (type.match(\"/Monument\")) return \"fa-building\";\n          else if (type.match(\"/Sculpture\")) return \"fa-android\";\n          else if (type.match(\"/Religious\")) return \"fa-institution\";\n          else if (type.match(\"/Castle\")) return \"fa-key\";\n          else if (type.match(\"Water\")) return \"fa-tint\";\n          else if (type.match(\"Island\")) return \"fa-leaf\";\n          else if (type.match(\"/Event\")) return \"fa-heart\";\n          else if (type.match(\"/Artwork\")) return \"fa-asterisk\";\n          else if (type.match(\"/Stadium\")) return \"fa-futbol-o\";\n          else if (type.match(\"/Place\")) return \"fa-street-view\";\n        }\n        return \"fa-star\";\n      }\n      break;\n    }\n  }\n  // Default values\n  var radius = options.radius || 8;\n  var fill = options.fill || new ol.style.Fill({ color:\"navy\"});\n  var stroke = options.stroke || new ol.style.Stroke({ color: \"#fff\", width: 2 });\n  var prefix = options.prefix ? options.prefix+\"_\" : \"\";\n  // Vector style function\n  return function (feature) {\n    var glyph = getFont(feature);\n    var k = prefix + glyph;\n    var style = styleCache[k];\n    if (!style) {\n      styleCache[k] = style = new ol.style.Style ({\n        image: new ol.style.FontSymbol({\n          glyph: glyph, \n          radius: radius, \n          fill: fill,\n          stroke: stroke\n        })\n      });\n    }\n    return [style];\n  }\n};\n})();\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** DFCI source: a source to display the French DFCI grid on a map\n * @see http://ccffpeynier.free.fr/Files/dfci.pdf\n * @constructor ol.source.DFCI\n * @extends {ol/source/Vector}\n * @param {any} options Vector source options\n *  @param {Array<Number>} resolutions a list of resolution to change the drawing level, default [1000,100,20]\n */\nol.source.DFCI = function(options) {\n\toptions = options || {};\n\toptions.loader = this._calcGrid;\n  options.strategy =  function(extent, resolution) {\n    if (this.resolution && this.resolution != resolution){\n      this.clear();\n      this.refresh();\n    }\n    return [extent];\n  }\n  this._bbox = [[0,1600000],[11*100000, 1600000+10*100000]];\n  ol.source.Vector.call (this, options);\n  this.set('resolutions', options.resolutions || [1000,100,20]);\n  // Add Lambert IIe proj \n  if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n  ol.proj.proj4.register(proj4);\n};\nol.ext.inherits(ol.source.DFCI, ol.source.Vector);\n/** Cacluate grid according extent/resolution\n */\nol.source.DFCI.prototype._calcGrid = function (extent, resolution, projection) {\n  // Show step 0\n  var f, ext, res = this.get('resolutions');\n  if (resolution > (res[0] || 1000)) {\n    if (this.resolution != resolution) {\n      if (!this._features0) {\n        ext = [this._bbox[0][0], this._bbox[0][1],this._bbox[1][0], this._bbox[1][1]];\n        this._features0 = this._getFeatures(0, ext, projection);\n      }\n      this.addFeatures(this._features0);\n    }\n  }\n  else if (resolution > (res[1] || 100)) {\n    this.clear();\n    ext = ol.proj.transformExtent(extent, projection, 'EPSG:27572');\n    f = this._getFeatures(1, ext, projection)\n    this.addFeatures(f);\n  }\n  else if (resolution > (res[2] || 0)) {\n    this.clear();\n    ext = ol.proj.transformExtent(extent, projection, 'EPSG:27572');\n    f = this._getFeatures(2, ext, projection)\n    this.addFeatures(f);\n  }\n  else {\n    this.clear();\n    ext = ol.proj.transformExtent(extent, projection, 'EPSG:27572');\n    f = this._getFeatures(3, ext, projection)\n    this.addFeatures(f);\n  }\n  // reset load\n  this.resolution = resolution;\n};\n/**\n * Get middle point\n * @private\n */\nol.source.DFCI.prototype._midPt = function(p1,p2) {\n  return [(p1[0]+p2[0])/2, (p1[1]+p2[1])/2];\n};\n/**\n * Get feature with geom\n * @private\n */\nol.source.DFCI.prototype._trFeature = function(geom, id, level, projection) {\n  var g  = new ol.geom.Polygon([geom]);\n  var f = new ol.Feature(g.transform('EPSG:27572', projection));\n  f.set('id', id);\n  f.set('level', level);\n  return f;\n};\n/** Get features\n * \n */\nol.source.DFCI.prototype._getFeatures = function (level, extent, projection) {\n  var features = [];\n  var i;\n  var step = 100000;\n  if (level>0) step /= 5;\n  if (level>1) step /= 10;\n  var p0 = [\n    Math.max(this._bbox[0][0], Math.floor(extent[0]/step)*step), \n    Math.max(this._bbox[0][1], Math.floor(extent[1]/step)*step)\n  ];\n  var p1 = [\n    Math.min(this._bbox[1][0]+99999, Math.floor(extent[2]/step)*step), \n    Math.min(this._bbox[1][1]+99999, Math.floor(extent[3]/step)*step)\n  ];\n  for (var x=p0[0]; x<=p1[0]; x += step) {\n    for (var y=p0[1]; y<=p1[1]; y += step) {\n      var p, geom = [ [x,y], [x+step, y], [x+step, y+step], [x , y+step], [x,y]];\n      if (level>2) {\n        var m = this._midPt(geom[0],geom[2]);\n        // .5\n        var g = [];\n        for (i=0; i<geom.length; i++) {\n          g.push(this._midPt(geom[i],m))\n        }\n        features.push(this._trFeature(g, ol.coordinate.toDFCI([x,y], 2)+'.5', level, projection));\n        // .1 > .4\n        for (i=0; i<4; i++) {\n          g = [];\n          g.push(geom[i]);\n          g.push(this._midPt(geom[i],geom[(i+1)%4]));\n          g.push(this._midPt(m,g[1]));\n          g.push(this._midPt(m,geom[i]));\n          p = this._midPt(geom[i],geom[(i+3)%4]);\n          g.push(this._midPt(m,p));\n          g.push(p);\n          g.push(geom[i]);\n          features.push(this._trFeature(g, ol.coordinate.toDFCI([x,y], 2)+'.'+(4-i), level, projection));\n        }\n      } else {\n        features.push(this._trFeature(geom, ol.coordinate.toDFCI([x,y], level), level, projection));\n      }\n    }\n  }\n  return features\n};\n\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/** Delaunay source\n * Calculate a delaunay triangulation from points in a source\n * @param {*} options extend ol/source/Vector options\n *  @param {ol/source/Vector} options.source the source that contains the points\n */\nol.source.Delaunay = function(options) {\n  options = options || {};\n  this._nodes = options.source;\n  delete options.source;\n  ol.source.Vector.call (this, options);\n  // Convex hull\n  this.hull = [];\n  // A new node is added to the source node: calculate the new triangulation\n  this._nodes.on('addfeature', this._onAddNode.bind(this));\n  // A new node is removed from the source node: calculate the new triangulation\n  this._nodes.on('removefeature', this._onRemoveNode.bind(this));\n  this.set ('epsilon', options.epsilon || .0001)\n};\nol.ext.inherits(ol.source.Delaunay, ol.source.Vector);\n/** Add a new triangle in the source\n * @param {Array<ol/coordinates>} pts\n */\nol.source.Delaunay.prototype._addTriangle = function(pts) {\n  var triangle = new ol.Feature(new ol.geom.Polygon([pts]));\n  this.addFeature(triangle);\n  this.flip.push(triangle);\n  return triangle;\n};\n/** Get nodes \n */\nol.source.Delaunay.prototype.getNodes = function () {\n  return this._nodes.getFeatures();\n};\n/** Get nodes source\n */\nol.source.Delaunay.prototype.getNodeSource = function () {\n  return this._nodes;\n};\n/**\n * A point has been removed\n * @param {ol/source/Vector.Event} evt \n */\nol.source.Delaunay.prototype._onRemoveNode = function(evt) {\n  // console.log(evt)\n  var pt = evt.feature.getGeometry().getCoordinates();\n  if (!pt) return;\n  // Still there (when removing duplicated points)\n  if (this.getNodesAt(pt).length) return;\n  // Get associated triangles\n  var triangles = this.getTrianglesAt(pt);\n  this.flip=[];\n  // Get hole\n  var i;\n  var edges = [];\n  while (triangles.length) {\n    var tr = triangles.pop()\n    this.removeFeature(tr);\n    tr = tr.getGeometry().getCoordinates()[0];\n    var pts = [];\n    for (i=0, p; p = tr[i]; i++) {\n      if (!ol.coordinate.equal(p,pt)) {\n        pts.push(p);\n      }\n    }\n    edges.push(pts);\n  }\n  pts = edges.pop();\nvar se = '';\nedges.forEach(function(e){\n  se += ' - '+this.listpt(e);\n}.bind(this));\nconsole.log('EDGES', se);\n  i = 0;\n  function testEdge(p0, p1, index) {\n    if (ol.coordinate.equal(p0, pts[index])) {\n      if (index) pts.push(p1);\n      else pts.unshift(p1);\n      return true\n    }\n    return false;\n  }\n  while (true) {\n    var e = edges[i];\n    if ( testEdge(e[0], e[1], 0) \n      || testEdge(e[1], e[0], 0)\n      || testEdge(e[0], e[1], pts.length-1)\n      || testEdge(e[1], e[0], pts.length-1)\n    ) {\n      edges.splice(i,1);\n      i = 0;\n    } else {\n      i++\n    }\n    if (!edges.length) break;\n    if (i>=edges.length) {\n      console.log(this.listpt(pts), this.listpt(edges));\n      throw '[DELAUNAY:removePoint] No edge found';\n    }\n  }\n  // Closed = interior\nconsole.log('PTS', this.listpt(pts))\n  var closed = ol.coordinate.equal(pts[0], pts[pts.length-1]);\n  if (closed) pts.pop();\n  // Update convex hull: remove pt + add new ones\n  var p;\n  for (i; p=this.hull[i]; i++) {\n    if (ol.coordinate.equal(pt,p)) {\n      this.hull.splice(i,1);\n      break;\n    }\n  }\n  this.hull = ol.coordinate.convexHull(this.hull.concat(pts));\n// select.getFeatures().clear();\n  // \n  var clockwise = function (t) {\n    var i1, s = 0;\n    for (var i=0; i<t.length; i++) {\n      i1 = (i+1) % t.length;\n      s += (t[i1][0] - t[i][0]) * (t[i1][1] + t[i][1]);\n    }\n    console.log(s)\n    return (s>=0 ? 1:-1)\n  };\n  // Add ears\n  // a l'interieur : Si surface ear et surface de l'objet ont meme signe\n  // extrieur ? ajoute le point et idem ? + ferme la \n  var clock;\nvar enveloppe = pts.slice();\n  if (closed) {\n    clock = clockwise(pts);\n  } else {\n    console.log('ouvert', pts, pts.slice().push(pt))\nenveloppe.push(pt);\n    clock = clockwise(enveloppe);\n  }\nconsole.log('S=',clock,'CLOSED',closed)\nconsole.log('E=',this.listpt(enveloppe))\n  for (i=0; i<=pts.length+1; i++) {\n    if (pts.length<3) break;\n    var t = [\n      pts[i % pts.length],\n      pts[(i+1) % pts.length],\n      pts[(i+2) % pts.length] \n    ];\n    if (clockwise(t)===clock) {\n      var ok = true;\n      for (var k=i+3; k<i+pts.length; k++) {\n        console.log('test '+k, this.listpt([pts[k % pts.length]]))\n        if (this.inCircle(pts[k % pts.length], t)) {\n          ok = false;\n          break;\n        }\n      }\n      if (ok) {\nconsole.log(this.listpt(t),'ok');\n        this._addTriangle(t);\n        // remove\n        pts.splice((i+1) % pts.length, 1);\n        // and restart\n        i = -1;\n      }\n    }\nelse console.log(this.listpt(t),'nok');\n  }\n/* DEBUG * /\nif (pts.length>3) console.log('oops');\nconsole.log('LEAV',this.listpt(pts));\nvar ul = $('ul.triangles').html('');\n$('<li>')\n.text('E:'+this.listpt(enveloppe)+' - '+clock+' - '+closed)\n.data('triangle', new ol.Feature(new ol.geom.Polygon([enveloppe])))\n.click(function(){\n  var t = $(this).data('triangle');\n  select.getFeatures().clear();\n  select.getFeatures().push(t);\n})\n.appendTo(ul);\nfor (var i=0; i<this.flip.length; i++) {\n  $('<li>')\n    .text(this.listpt(this.flip[i].getGeometry().getCoordinates()[0])\n        +' - ' + clockwise(this.flip[i].getGeometry().getCoordinates()[0]))\n    .data('triangle', this.flip[i])\n    .click(function(){\n      var t = $(this).data('triangle');\n      select.getFeatures().clear();\n      select.getFeatures().push(t);\n    })\n    .appendTo(ul);\n}\n/**/\n  // Flip?\n  this.flipTriangles();\n};\n/**\n * A new point has been added\n * @param {ol/source/VectorEvent} e \n */\nol.source.Delaunay.prototype._onAddNode = function(e) {\n  var finserted = e.feature;\n  var i, p;\n  // Not a point!\n  if (finserted.getGeometry().getType() !== 'Point') {\n    this._nodes.removeFeature(finserted);\n    return;\n  }\n  // Reset flip table\n  this.flip = [];\n  var nodes = this.getNodes();\n  // The point\n  var pt = finserted.getGeometry().getCoordinates();\n  // Test existing point\n  if (this.getNodesAt(pt).length > 1) {\n    console.log('remove duplicated points')\n    this._nodes.removeFeature(finserted);\n    return;\n  }\n  // Triangle needs at least 3 points\n  if (nodes.length <= 3) {\n    if (nodes.length===3) {\n      var pts = [];\n      for (i=0; i<3; i++) pts.push(nodes[i].getGeometry().getCoordinates());\n      this._addTriangle(pts);\n      this.hull = ol.coordinate.convexHull(pts);\n    }\n    return;\n  }\n  // Get the triangle\n  var t = this.getFeaturesAtCoordinate(pt)[0];\n  if (t) {\n    this.removeFeature(t);\n    t.set('del', true);\n    var c = t.getGeometry().getCoordinates()[0];\n    for (i=0; i<3; i++) {\n      this._addTriangle([ pt, c[i], c[(i+1)%3]]);\n    }\n  } else {\n    // Calculate new convex hull\n    var hull2 = this.hull.slice();\n    hull2.push(pt);\n    hull2 = ol.coordinate.convexHull(hull2);\n    // Search for points\n    for (i=0; p=hull2[i]; i++) {\n      if (ol.coordinate.equal(p,pt)) break;\n    }\n    i = (i!==0 ? i-1 : hull2.length-1);\n    var p0 = hull2[i];\n    var stop = hull2[(i+2) % hull2.length];\n    for (i=0; p=this.hull[i]; i++) {\n      if (ol.coordinate.equal(p,p0)) break;\n    }\n    // Connect to the hull\n    while (true) {\n      // DEBUG: prevent infinit loop\n      if (i>1000) {\n        console.error('[DELAUNAY:addPoint] Too many iterations')\n        break;\n      }\n      i++;\n      p = this.hull[i % this.hull.length];\n      this._addTriangle([pt, p, p0]);\n      p0 = p;\n      if (p[0] === stop[0] && p[1] === stop[1]) break;\n    }\n    this.hull = hull2;\n  }\n  this.flipTriangles();\n};\n/** Flipping algorithme: test new inserted triangle and flip\n */\nol.source.Delaunay.prototype.flipTriangles = function ()\t{\n  var count = 1000; // Count to prevent too many iterations\n  var pi;\n  while (this.flip.length) {\n    // DEBUG: prevent infinite loop\n    if (count--<0) {\n      console.error('[DELAUNAY:flipTriangles] Too many iterations')\n      break;\n    }\n    var tri = this.flip.pop();\n    if (tri.get('del')) continue;\n    var ti = tri.getGeometry().getCoordinates()[0];\n    for (var k=0; k<3; k++) {\n      // Get facing triangles\n      var mid = [(ti[(k+1)%3][0]+ti[k][0])/2, (ti[(k+1)%3][1]+ti[k][1])/2];\n      var triangles = this.getTrianglesAt(mid);\n      var pt1 = null;\n      // Get opposite point\n      if (triangles.length>1) {\n        var t0 = triangles[0].getGeometry().getCoordinates()[0];\n        var t1 = triangles[1].getGeometry().getCoordinates()[0];\n        for (pi=0; pi<t1.length; pi++) {\n          if (!this._ptInTriangle(t1[pi], t0)) {\n            pt1 = t1[pi];\n            break;\n          }\n        }\n      }\n      if (pt1) {\n        // Is in circle ?\n        if (this.inCircle(pt1, t0)) {\n          var pt2;\n          // Get opposite point\n          for (pi=0; pi<t0.length; pi++) {\n            if (!this._ptInTriangle(t0[pi], t1)) {\n              pt2 = t0.splice(pi,1)[0];\n              break;\n            }\n          }\n          // Flip triangles\n          if (this.intersectSegs([pt1, pt2], t0)) {\n            while (triangles.length) {\n              var tmp = triangles.pop();\n              tmp.set('del', true);\n              this.removeFeature(tmp);\n            }\n            this._addTriangle([pt1, pt2, t0[0]]);\n            this._addTriangle([pt1, pt2, t0[1]]);\n          }\n        }\n      }\n    }\n  }\n};\n/** Test intersection beetween 2 segs\n * @param {Array<ol.coordinates>} d1\n * @param {Array<ol.coordinates>} d2\n * @return {bbolean}\n */\nol.source.Delaunay.prototype.intersectSegs = function (d1, d2)\t{\n  var d1x = d1[1][0] - d1[0][0];\n  var d1y = d1[1][1] - d1[0][1];\n  var d2x = d2[1][0] - d2[0][0];\n  var d2y = d2[1][1] - d2[0][1];\n  var det = d1x * d2y - d1y * d2x;\n  if (det != 0) {\n    var k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\n    // Intersection: return [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\n    return (0<k && k<1);\n  }\n  else return false;\n};\n/** Test pt is a triangle's node\n * @param {ol.coordinate} pt\n * @param {Array<ol.coordinate>} triangle\n * @return {boolean}\n */\nol.source.Delaunay.prototype._ptInTriangle = function(pt, triangle) {\n  for (var i=0, p; p=triangle[i]; i++) {\n    if (ol.coordinate.equal(pt,p)) return true;\n  }\n  return false;\n};\n/** List points in a triangle (assume points get an id) for debug purposes\n * @param {Array<ol.coordinate>} pts\n * @return {String} ids list\n */\nol.source.Delaunay.prototype.listpt = function (pts) {\n  var s = '';\n  for (var i=0, p; p = pts[i]; i++) {\n    var c = this._nodes.getClosestFeatureToCoordinate(p);\n    if (!ol.coordinate.equal(c.getGeometry().getCoordinates(), p)) c=null;\n    s += (s?', ':'') + (c ? c.get('id') : '?');\n  }\n  return s;\n};\n/** Test if coord is within triangle's circumcircle \n * @param {ol.coordinate} coord\n * @param {Array<ol.coordinate>} triangle\n * @return {boolean}\n */\nol.source.Delaunay.prototype.inCircle = function (coord, triangle) {\n  var c = this.getCircumCircle(triangle);\n  return ol.coordinate.dist2d(coord, c.center) < c.radius;\n}\n/** Calculate the circumcircle of a triangle\n * @param {Array<ol.coordinate>} triangle\n * @return {*}\n */\nol.source.Delaunay.prototype.getCircumCircle = function (triangle) {\n  var x1 = triangle[0][0];\n  var y1 = triangle[0][1];\n  var x2 = triangle[1][0];\n  var y2 = triangle[1][1];\n  var x3 = triangle[2][0];\n  var y3 = triangle[2][1];\n  var m1 = (x1-x2)/(y2-y1);\n  var m2 = (x1-x3)/(y3-y1);\n  var b1 = ((y1+y2)/2) - m1*(x1+x2)/2;\n  var b2 = ((y1+y3)/2) - m2*(x1+x3)/2;\n  var cx = (b2-b1)/(m1-m2);\n  var cy = m1*cx + b1;\n  var center = [cx, cy];\n  return  { \n    center: center, \n    radius: ol.coordinate.dist2d(center,triangle[0])\n  };\n};\n/** Get triangles at a point\n */\nol.source.Delaunay.prototype.getTrianglesAt = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  var result = [];\n  this.forEachFeatureIntersectingExtent(extent, function(f){\n    result.push(f);\n  });\n  return result;\n};\n/** Get nodes at a point\n */\nol.source.Delaunay.prototype.getNodesAt = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  return this._nodes.getFeaturesInExtent(extent);\n};\n\n  /*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for INSEE grid\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the grid in meter, default 200m\n *  @param {function} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {function} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.FeatureBin = function (options) {\n  options = options || {};\n  this._sourceFeature = new ol.source.Vector ({ features: options.features || [] });\n  ol.source.BinBase.call(this, options);\n};\nol.ext.inherits(ol.source.FeatureBin, ol.source.BinBase);\n/** Set grid size\n * @param {ol.Feature} features\n */\nol.source.FeatureBin.prototype.setFeatures = function (features) {\n  this._sourceFeature.clear();\n  this._sourceFeature.addFeatures(features || []);\n  this.reset();\n};\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.FeatureBin.prototype.getGridGeomAt = function (coord, attributes) {\n  var f = this._sourceFeature.getFeaturesAtCoordinate(coord)[0];\n  if (!f) return null;\n  var a = f.getProperties();\n  for (var i in a) {\n    if (i!=='geometry') attributes[i] = a[i];\n  }\n  return f.getGeometry();\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n  ol.source.GeoImage is a layer source with georeferencement to place it on a map.\n  olx.source.GeoImageOptions:\n  {\turl: {string} url of the static image\n    image: {image} the static image, if not provided, use url to load an image\n    imageCenter: {ol.Coordinate} of the center of the image\n    imageScale: {ol.Size|Number} [scalex, scaley] of the image\n    imageRotate: {number} angle of the image in radian, default 0\n    imageCrop: {ol.Extent} of the image to be show (in the image) default: [0,0,imageWidth,imageHeight]\n    imageMask: {Array.<ol.Coordinate>} - linestring to mask the image on the map\n  }\n*/\n/** Layer source with georeferencement to place it on a map\n* @constructor \n* @extends {ol.source.ImageCanvas}\n* @param {olx.source.GeoImageOptions=} options\n*/\nol.source.GeoImage = function(opt_options) {\n  var options = { \n    attributions: opt_options.attributions,\n    logo: opt_options.logo,\n    projection: opt_options.projection\n  };\n  // options.projection = opt_options.projection;\n  // Coordinate of the image center \n  this.center = opt_options.imageCenter;\n  // Scale of the image \n  this.scale = opt_options.imageScale;\n  // Rotation of the image\n  this.rotate = opt_options.imageRotate ? opt_options.imageRotate : 0;\n  // Crop of the image\n  this.crop = opt_options.imageCrop;\n  // Mask of the image\n  this.mask = opt_options.imageMask;\n  // Load Image\n  this._image = (opt_options.image ? opt_options.image : new Image );\n  this._image.crossOrigin = opt_options.crossOrigin; // 'anonymous';\n  // Show image on load\n  var self = this;\n  this._image.onload = function() {\n    self.setCrop (self.crop);\n    self.changed();\n  }\n  if (!opt_options.image) this._image.src = opt_options.url;\n  // Draw image on canvas\n  options.canvasFunction = function(extent, resolution, pixelRatio, size /*, projection*/ ) {\n    var canvas = document.createElement('canvas');\n    canvas.width = size[0];\n    canvas.height = size[1];\n    var ctx = canvas.getContext('2d');\n    if (!this._imageSize) return canvas;\n    // transform coords to pixel\n    function tr(xy) {\n      return [\n        (xy[0]-extent[0])/(extent[2]-extent[0]) * size[0],\n        (xy[1]-extent[3])/(extent[1]-extent[3]) * size[1]\n      ];\n    }\n    // Clipping mask\n    if (this.mask) {\n      ctx.beginPath();\n      var p = tr(this.mask[0]);\n      ctx.moveTo(p[0],p[1]);\n      for (var i=1; i<this.mask.length; i++) {\n        p = tr(this.mask[i]);\n        ctx.lineTo(p[0],p[1]);\n      }\n      ctx.clip();\n    }\n    // Draw\n    var pixel = tr(this.center);\n    var dx = (this._image.naturalWidth/2 - this.crop[0]) *this.scale[0] /resolution *pixelRatio;\n    var dy = (this._image.naturalHeight/2 - this.crop[1]) *this.scale[1] /resolution *pixelRatio;\n    var sx = this._imageSize[0]*this.scale[0]/resolution *pixelRatio;\n    var sy = this._imageSize[1]*this.scale[1]/resolution *pixelRatio;\n    ctx.translate(pixel[0],pixel[1]);\n    if (this.rotate) ctx.rotate(this.rotate);\n    ctx.drawImage(this._image, this.crop[0], this.crop[1], this._imageSize[0], this._imageSize[1], -dx, -dy, sx,sy);\n    return canvas;\n  }\n  ol.source.ImageCanvas.call (this, options);\t\n  this.setCrop (this.crop);\n  // Calculate extent on change\n  this.on('change', function() {\n    this.set('extent', this.calculateExtent());\n  }.bind(this));\n};\nol.ext.inherits(ol.source.GeoImage, ol.source.ImageCanvas);\n/**\n * Get coordinate of the image center.\n * @return {ol.Coordinate} coordinate of the image center.\n * @api stable\n */\nol.source.GeoImage.prototype.getCenter = function() {\n  return this.center;\n}\n/**\n * Set coordinate of the image center.\n * @param {ol.Coordinate} coordinate of the image center.\n * @api stable\n */\nol.source.GeoImage.prototype.setCenter = function(center) {\n  this.center = center;\n  this.changed();\n}\n/**\n * Get image scale.\n * @return {ol.size} image scale (along x and y axis).\n * @api stable\n */\nol.source.GeoImage.prototype.getScale = function() {\n  return this.scale;\n}\n/**\n * Set image scale.\n * @param {ol.size|Number} image scale (along x and y axis or both).\n * @api stable\n */\nol.source.GeoImage.prototype.setScale = function(scale) {\n  switch (typeof(scale)) {\n    case 'number':\n      scale = [scale,scale];\n      break;\n    case 'object': \n      if (scale.length != 2) return;\n      break;\n    default: return;\n  }\n  this.scale = scale;\n  this.changed();\n};\n/**\n * Get image rotation.\n * @return {Number} rotation in degre.\n * @api stable\n */\nol.source.GeoImage.prototype.getRotation = function() {\n  return this.rotate;\n};\n/**\n * Set image rotation.\n * @param {Number} rotation in radian.\n * @api stable\n */\nol.source.GeoImage.prototype.setRotation = function(angle) {\n  this.rotate = angle;\n  this.changed();\n};\n/**\n * Get the image.\n * @api stable\n */\nol.source.GeoImage.prototype.getGeoImage = function() {\n  return this._image;\n};\n/**\n * Get image crop extent.\n * @return {ol.extent} image crop extent.\n * @api stable\n */\nol.source.GeoImage.prototype.getCrop = function() {\n  return this.crop;\n};\n/**\n * Set image mask.\n * @param {ol.geom.LineString} coords of the mask\n * @api stable\n */\nol.source.GeoImage.prototype.setMask = function(mask) {\n  this.mask = mask;\n  this.changed();\n};\n/**\n * Get image mask.\n * @return {ol.geom.LineString} coords of the mask\n * @api stable\n */\nol.source.GeoImage.prototype.getMask = function() {\n  return this.mask;\n};\n/**\n * Set image crop extent.\n * @param {ol.extent|Number} image crop extent or a number to crop from original size.\n * @api stable\n */\nol.source.GeoImage.prototype.setCrop = function(crop) {\n  // Image not loaded => get it latter\n  if (!this._image.naturalWidth) {\n    this.crop = crop;\n    return;\n  }\n  if (crop) {\n    switch (typeof(crop)) {\n      case 'number':\n        crop = [crop,crop,this._image.naturalWidth-crop,this._image.naturalHeight-crop];\n        break;\n      case 'object': \n        if (crop.length != 4) return;\n        break;\n      default: return;\n    }\n    crop = ol.extent.boundingExtent([ [crop[0],crop[1]], [crop[2],crop[3]] ]);\n    this.crop = [ Math.max(0,crop[0]), Math.max(0,crop[1]), Math.min(this._image.naturalWidth,crop[2]), Math.min(this._image.naturalHeight,crop[3]) ];\n  }\n  else this.crop = [0,0, this._image.naturalWidth,this._image.naturalHeight];\n  if (this.crop[2]<=this.crop[0]) this.crop[2] = this.crop[0]+1;\n  if (this.crop[3]<=this.crop[1]) this.crop[3] = this.crop[1]+1;\n  this._imageSize = [ this.crop[2]-this.crop[0], this.crop[3]-this.crop[1] ];\n  this.changed();\n};\n/** Get the extent of the source.\n * @param {module:ol/extent~Extent} extent If provided, no new extent will be created. Instead, that extent's coordinates will be overwritten.\n * @return {ol.extent}\n */\nol.source.GeoImage.prototype.getExtent = function(opt_extent) {\n  if (opt_extent) {\n    var ext = this.get('extent');\n    for (var i=0; i<opt_extent.length; i++) {\n      opt_extent[i] = ext[i];\n    }\n    return ext;\n  } else {\n    return this.get('extent');\n  }\n};\n/** Calculate the extent of the source image.\n * @param {boolean} usemask return the mask extent, default return the image extent\n * @return {ol.extent}\n */\nol.source.GeoImage.prototype.calculateExtent = function(usemask) {\n  var polygon;\n  if (usemask!==false && this.getMask()) {\n    polygon = new ol.geom.Polygon([this.getMask()])\n  } else {\n    var center = this.getCenter();\n    var scale = this.getScale();\n    var width = this.getGeoImage().width * scale[0];\n    var height = this.getGeoImage().height * scale[1];\n    var extent = ol.extent.boundingExtent([\n      [ center[0]-width/2, center[1]-height/2 ],\n      [ center[0]+width/2, center[1]+height/2 ]\n    ]);\n    polygon = ol.geom.Polygon.fromExtent(extent);\n    polygon.rotate(-this.getRotation(), center);\n  }\n  var ext = polygon.getExtent();\n  return ext;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** IGN's Geoportail WMTS source\n * @constructor\n * @extends {ol.source.WMTS}\n * @param {String=} layer Layer name.\n * @param {olx.source.OSMOptions=} options WMTS options \n *  @param {number} options.minZoom\n *  @param {number} options.maxZoom\n *  @param {string} options.server\n *  @param {string} options.gppKey api key, default 'choisirgeoportail'\n *  @param {string} options.authentication basic authentication associated with the gppKey as btoa(\"login:pwd\")\n *  @param {string} options.format image format, default 'image/jpeg'\n *  @param {string} options.style layer style, default 'normal'\n *  @param {string} options.crossOrigin default 'anonymous'\n *  @param {string} options.wrapX default true\n */\nol.source.Geoportail = function (layer, options) {\n  options = options || {};\n  var matrixIds = new Array();\n  var resolutions = new Array();//[156543.03392804103,78271.5169640205,39135.75848201024,19567.879241005125,9783.939620502562,4891.969810251281,2445.9849051256406,1222.9924525628203,611.4962262814101,305.74811314070485,152.87405657035254,76.43702828517625,38.218514142588134,19.109257071294063,9.554628535647034,4.777314267823517,2.3886571339117584,1.1943285669558792,0.5971642834779396,0.29858214173896974,0.14929107086948493,0.07464553543474241];\n  var size = ol.extent.getWidth(ol.proj.get('EPSG:3857').getExtent()) / 256;\n  for (var z=0; z <= (options.maxZoom ? options.maxZoom : 20) ; z++) {\n    matrixIds[z] = z ; \n    resolutions[z] = size / Math.pow(2, z);\n  }\n  var tg = new ol.tilegrid.WMTS ({\n    origin: [-20037508, 20037508],\n    resolutions: resolutions,\n    matrixIds: matrixIds\n  });\n  tg.minZoom = (options.minZoom ? options.minZoom : 0);\n  var attr = [ ol.source.Geoportail.prototype.attribution ];\n  if (options.attributions) attr = options.attributions;\n  this._server = options.server || 'https://wxs.ign.fr/geoportail/wmts';\n  this._gppKey = options.gppKey || 'choisirgeoportail';\n  var wmts_options = {\n    url: this.serviceURL(),\n    layer: layer,\n    matrixSet: 'PM',\n    format: options.format ? options.format : 'image/jpeg',\n    projection: 'EPSG:3857',\n    tileGrid: tg,\n    style: options.style ? options.style : 'normal',\n    attributions: attr,\n    crossOrigin: (typeof options.crossOrigin == 'undefined') ? 'anonymous' : options.crossOrigin,\n    wrapX: !(options.wrapX===false)\n  };\n  ol.source.WMTS.call(this, wmts_options);\n  // Load url using basic authentification\n  if (options.authentication) {\n    this.setTileLoadFunction(ol.source.Geoportail.tileLoadFunctionWithAuthentication(options.authentication, this.getFormat()));\n  }\n};\nol.ext.inherits(ol.source.Geoportail, ol.source.WMTS);\n/** Standard IGN-GEOPORTAIL attribution \n*/\nol.source.Geoportail.prototype.attribution = '<a href=\"http://www.geoportail.gouv.fr/\">Goportail</a> &copy; <a href=\"http://www.ign.fr/\">IGN-France</a>';\n/** Get service URL according to server url or standard url\n*/\nol.source.Geoportail.prototype.serviceURL = function() {\n  if (this._server) {\n    return this._server.replace (/^(https?:\\/\\/[^/]*)(.*)$/, \"$1/\"+this._gppKey+\"$2\") ;\n  } else {\n    return (window.geoportailConfig ? window.geoportailConfig.url : \"https://wxs.ign.fr/\") +this._gppKey+ \"/geoportail/wmts\" ;\n  }\n};\n/**\n * Return the associated API key of the Map.\n * @function\n * @return the API key.\n * @api stable\n */\nol.source.Geoportail.prototype.getGPPKey = function() {\n  return this._gppKey;\n};\n/**\n * Set the associated API key to the Map.\n * @param {String} key the API key.\n * @param {String} authentication as btoa(\"login:pwd\")\n * @api stable\n */\nol.source.Geoportail.prototype.setGPPKey = function(key, authentication) {\n  this._gppKey = key;\n  var serviceURL = this.serviceURL();\n  this.setTileUrlFunction (function() {\n    var url = ol.source.Geoportail.prototype.getTileUrlFunction().apply(this, arguments);\n    if (url) {\n      var args = url.split(\"?\");\n      return serviceURL+\"?\"+args[1];\n    }\n    else return url;\n  });\n  // Load url using basic authentification\n  if (authentication) {\n    this.setTileLoadFunction(ol.source.Geoportail.tileLoadFunctionWithAuthentication(authentication, this.getFormat()));\n  }\n};\n/** Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n * constructed.\n * @param {ol.Coordinate} coord \n * @param {Number} resolution \n * @param {ol.proj.Projection} projection default the source projection\n * @param {Object} options \n *  @param {string} options.INFO_FORMAT response format text/plain, text/html, application/json, default text/plain\n * @return {String|undefined} GetFeatureInfo URL.\n */\nol.source.Geoportail.prototype.getFeatureInfoUrl  = function(coord, resolution, projection, options) {\n  options = options || {};\n  if (!projection) projection = this.getProjection();\n  var tileCoord = this.tileGrid.getTileCoordForCoordAndResolution(coord, resolution);\n  var ratio = 1;\n  var url = this.getTileUrlFunction()(tileCoord, ratio, projection);\n  if (!url) return url;\n  var tileResolution = this.tileGrid.getResolution(tileCoord[0]);\n  var tileExtent = this.tileGrid.getTileCoordExtent(tileCoord);\n  var i = Math.floor((coord[0] - tileExtent[0]) / (tileResolution / ratio));\n  var j = Math.floor((tileExtent[3] - coord[1]) / (tileResolution / ratio));\n  return url.replace(/Request=GetTile/i, 'Request=getFeatureInfo')\n    +'&INFOFORMAT='+(options.INFO_FORMAT||'text/plain')\n    +'&I='+i\n    +'&J='+j;\n};\n/** Get feature info\n * @param {ol.Coordinate} coord \n * @param {Number} resolution \n * @param {ol.proj.Projection} projection default the source projection\n * @param {Object} options \n *  @param {string} options.INFO_FORMAT response format text/plain, text/html, application/json, default text/plain\n *  @param {function} options.callback a function that take the response as parameter\n *  @param {function} options.error function called when an error occurred\n */\nol.source.Geoportail.prototype.getFeatureInfo = function(coord, resolution, options) {\n  var url = this.getFeatureInfoUrl(coord, resolution, null, options);\n  ol.ext.Ajax.get({\n    url: url,\n    dataType: options.format || 'text/plain',\n    options: { \n      encode: false \n    },\n    success: function(resp) {\n      if (options.callback) options.callback(resp);\n    },\n    error: options.error || function(){}\n  })\n};\n/** Get a tile load function to load tiles with basic authentication\n * @param {string} authentication as btoa(\"login:pwd\")\n * @param {string} format mime type\n * @return {function} tile load function to load tiles with basic authentication\n */\nol.source.Geoportail.tileLoadFunctionWithAuthentication = function(authentication, format) {\n  if (!authentication) return undefined;\n  return function(tile, src) {\n    var xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", src);\n    xhr.setRequestHeader(\"Authorization\", \"Basic \" + authentication);\n    xhr.responseType = \"arraybuffer\";\n    xhr.onload = function () {\n      var arrayBufferView = new Uint8Array(this.response);\n      var blob = new Blob([arrayBufferView], { type: format });\n      var urlCreator = window.URL || window.webkitURL;\n      var imageUrl = urlCreator.createObjectURL(blob);\n      tile.getImage().src = imageUrl;\n    };\n    xhr.onerror = function () {\n      tile.getImage().src = \"\";\n    };\n    xhr.send();\n  };\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for grid binning\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the grid in meter, default 200m\n *  @param {function} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {function} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.GridBin = function (options) {\n  options = options || {};\n  ol.source.BinBase.call(this, options);\n  this.set('gridProjection', options.gridProjection || 'EPSG:4326');\n  this.set('size', options.size || 1);\n};\nol.ext.inherits(ol.source.GridBin, ol.source.BinBase);\n/** Set grid projection\n * @param {ol.ProjectionLike} proj\n */\nol.source.GridBin.prototype.setGridProjection = function (proj) {\n  this.set('gridProjection', proj);\n  this.reset();\n};\n/** Set grid size\n * @param {number} size\n */\nol.source.GridBin.prototype.setSize = function (size) {\n  this.set('size', size);\n  this.reset();\n};\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.GridBin.prototype.getGridGeomAt = function (coord) {\n  coord = ol.proj.transform (coord, this.getProjection() || 'EPSG:3857', this.get('gridProjection'));\n  var size = this.get('size');\n  var x = size * Math.floor(coord[0] / size);\n  var y = size * Math.floor(coord[1] / size);\n  var geom = new ol.geom.Polygon([[[x,y], [x+size,y], [x+size,y+size], [x,y+size], [x,y]]]);\n  return geom.transform(this.get('gridProjection'), this.getProjection() || 'EPSG:3857');\n};\n\n/*\tCopyright (c) 2017-2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for hexagonal binning\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + ol.HexGridOptions\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the hexagon in map units, default 80000\n *  @param {ol.coordinate} [options.origin] origin of the grid, default [0,0]\n *  @param {HexagonLayout} [options.layout] grid layout, default pointy\n *  @param {function} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {function} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.HexBin = function (options) {\n  options = options || {};\n  /** The HexGrid\n   * \t@type {ol.HexGrid}\n   */\n  this._hexgrid = new ol.HexGrid(options);\n  ol.source.BinBase.call(this, options);\n};\nol.ext.inherits(ol.source.HexBin, ol.source.BinBase);\n/** Get the hexagon geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.HexBin.prototype.getGridGeomAt = function (coord) {\n  var h = this._hexgrid.coord2hex(coord);\n  return new ol.geom.Polygon([this._hexgrid.getHexagon(h)])\n};\n/**\tSet the inner HexGrid size.\n * \t@param {number} newSize\n * \t@param {boolean} noreset If true, reset will not be called (It need to be called through)\n */\nol.source.HexBin.prototype.setSize = function (newSize, noreset) {\n  this._hexgrid.setSize(newSize);\n  if (!noreset) {\n    this.reset();\n  }\n}\n/**\tGet the inner HexGrid size.\n * \t@return {number}\n */\nol.source.HexBin.prototype.getSize = function () {\n  return this._hexgrid.getSize();\n}\n/**\tSet the inner HexGrid layout.\n * \t@param {HexagonLayout} newLayout\n * \t@param {boolean} noreset If true, reset will not be called (It need to be called through)\n */\nol.source.HexBin.prototype.setLayout = function (newLayout, noreset) {\n  this._hexgrid.setLayout(newLayout);\n  if (!noreset) {\n    this.reset();\n  }\n}\n/**\tGet the inner HexGrid layout.\n * \t@return {HexagonLayout}\n */\nol.source.HexBin.prototype.getLayout = function () {\n  return this._hexgrid.getLayout();\n};\n/**\tSet the inner HexGrid origin.\n * \t@param {ol.Coordinate} newLayout\n * \t@param {boolean} noreset If true, reset will not be called (It need to be called through)\n */\nol.source.HexBin.prototype.setOrigin = function (newLayout, noreset) {\n  this._hexgrid.setOrigin(newLayout);\n  if (!noreset) {\n    this.reset();\n  }\n};\n/**\tGet the inner HexGrid origin.\n * \t@return {ol.Coordinate}\n */\nol.source.HexBin.prototype.getOrigin = function () {\n  return this._hexgrid.getOrigin();\n};\n/**\n * Get hexagons without circular dependencies (vs. getFeatures)\n * @return {Array<ol.Feature>}\n */\nol.source.HexBin.prototype.getHexFeatures = function () {\n  return ol.source.BinBase.prototype.getGridFeatures.call(this);\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for INSEE grid\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the grid in meter, default 200m\n *  @param {function} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {function} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.InseeBin = function (options) {\n  options = options || {};\n  this._grid = new ol.InseeGrid({ size: options.size });\n  ol.source.BinBase.call(this, options);\n};\nol.ext.inherits(ol.source.InseeBin, ol.source.BinBase);\n/** Set grid size\n * @param {number} size\n */\nol.source.InseeBin.prototype.setSize = function (size) {\n  if (this.getSize() !== size) {\n    this._grid.set('size', size);\n    this.reset();\n  }\n};\n/** Get grid size\n * @return {number} size\n */\nol.source.InseeBin.prototype.getSize = function () {\n  return this._grid.get('size');\n};\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.InseeBin.prototype.getGridGeomAt = function (coord) {\n  return this._grid.getGridAtCoordinate(coord, this.getProjection());\n};\n/** Get grid extent \n * @param {ol.ProjectionLike} proj\n * @return {ol.Extent}\n */\nol.source.InseeBin.prototype.getGridExtent = function (proj) {\n  return this._grid.getExtent(proj);\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\t@classdesc\n\tol.source.Mapillary is a source that load Mapillary's geotagged photos in a vector layer.\n\tInherits from:\n\t<ol.source.Vector>\n*/\n/**\n* @constructor ol.source.Mapillary\n* @extends {ol.source.Vector}\n* @param {olx.source.Mapillary=} options\n*/\nol.source.Mapillary = function(opt_options)\n{\tvar options = opt_options || {};\n\toptions.loader = this._loaderFn;\n\t/** Max resolution to load features  */\n\tthis._maxResolution = options.maxResolution || 100;\n\t/** Query limit */\n\tthis._limit = options.limit || 100;\n\t/** Default attribution */\n\tif (!options.attributions) options.attributions = [ \"&copy; <a href='https://www.mapillary.com/'>Mapillary</a>\" ];\n\t// Bbox strategy : reload at each move\n    if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n\t// Init parent\n\tol.source.Vector.call (this, options);\n\t// Client ID\n\t// this.set(\"clientId\", options.clientId);\n};\nol.ext.inherits(ol.source.Mapillary, ol.source.Vector);\n/** Decode wiki attributes and choose to add feature to the layer\n* @param {feature} the feature\n* @param {attributes} wiki attributes\n* @return {boolean} true: add the feature to the layer\n* @API stable\n*/\nol.source.Mapillary.prototype.readFeature = function (/*feature, attributes*/)\n{\t// Allways read feature (no filter)\n\treturn true;\n};\n/** Loader function used to load features.\n* @private\n*/\nol.source.Mapillary.prototype._loaderFn = function(extent, resolution, projection)\n{\tif (resolution > this._maxResolution) return;\n\tvar bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n\t// Commons API: for more info @see https://www.mapillary.com/developer\n\tvar date = Date.now() - 6 * 30 * 24 * 60 * 60 * 1000;\n\tvar url = \"https://a.mapillary.com/v2/search/im?client_id=\"\n\t\t+ this.get('clientId')\n\t\t+ \"&max_lat=\" + bbox[3]\n\t\t+ \"&max_lon=\" + bbox[2]\n\t\t+ \"&min_lat=\" + bbox[1]\n\t\t+ \"&min_lon=\" + bbox[0]\n\t\t+ \"&limit=\"+(this._limit-1)\n\t\t+ \"&start_time=\" + date;\n\t// Ajax request to get the tile\n\tol.ext.Ajax.get(\n\t{\turl: url,\n\t\tdataType: 'jsonp', \n\t\tsuccess: function(data) \n\t\t{\tconsole.log(data);\n\t\t\t/*\n\t\t\tvar features = [];\n\t\t\tvar att, pt, feature, lastfeature = null;\n\t\t\tif (data.query && data.query.pages) return;\n\t\t\tfor ( var i in data.query.pages)\n\t\t\t{\tatt = data.query.pages[i];\n\t\t\t\tif (att.coordinates && att.coordinates.length ) \n\t\t\t\t{\tpt = [att.coordinates[0].lon, att.coordinates[0].lat];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\tvar meta = att.imageinfo[0].metadata;\n\t\t\t\t\tif (!meta)\n\t\t\t\t\t{\t//console.log(att);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tpt = [];\n\t\t\t\t\tfor (var k=0; k<meta.length; k++)\n\t\t\t\t\t{\tif (meta[k].name==\"GPSLongitude\") pt[0] = meta[k].value;\n\t\t\t\t\t\tif (meta[k].name==\"GPSLatitude\") pt[1] = meta[k].value;\n\t\t\t\t\t}\n\t\t\t\t\tif (!pt.length) \n\t\t\t\t\t{\t//console.log(att);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfeature = new ol.Feature(new ol.geom.Point(ol.proj.transform (pt,\"EPSG:4326\",projection)));\n\t\t\t\tatt.imageinfo[0].title = att.title;\n\t\t\t\tif (self.readFeature(feature, att.imageinfo[0]))\n\t\t\t\t{\tfeatures.push(feature);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.addFeatures(features);\n\t\t\t*/\n    }});\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OSM layer using the Ovepass API\n * @constructor ol.source.Overpass\n * @extends {ol.source.Vector}\n * @param {any} options\n *  @param {string} options.url service url, default: https://overpass-api.de/api/interpreter\n *  @param {Array<string>} options.filter an array of tag filters, ie. [\"key\", \"key=value\", \"key~value\", ...]\n *  @param {boolean} options.node get nodes, default: true\n *  @param {boolean} options.way get ways, default: true\n *  @param {boolean} options.rel get relations, default: false\n *  @param {number} options.maxResolution maximum resolution to load features\n *  @param {string|ol.Attribution|Array<string>} options.attributions source attribution, default OSM attribution\n *  @param {ol.loadingstrategy} options.strategy loading strategy, default ol.loadingstrategy.bbox\n */\nol.source.Overpass = function(options) {\n\toptions = options || {};\n\toptions.loader = this._loaderFn;\n\t/** Ovepass API Url */\n\tthis._url = options.url || 'https://overpass-api.de/api/interpreter';\n\t/** Max resolution to load features  */\n\tthis._maxResolution = options.maxResolution || 100;\n\t/** Default attribution */\n\tif (!options.attributions) {\n    options.attributions = ol.source.OSM.ATTRIBUTION;\n  }\n\t// Bbox strategy : reload at each move\n  if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n  ol.source.Vector.call (this, options);\n  this._types = {\n    node: options.node!==false,\n    way: options.way!==false,\n    rel: options.rel===true\n  };\n  this._filter = options.filter;\n};\nol.ext.inherits(ol.source.Overpass, ol.source.Vector);\n/** Loader function used to load features.\n* @private\n*/\nol.source.Overpass.prototype._loaderFn = function(extent, resolution, projection) {\n  if (resolution > this._maxResolution) return;\n\tvar self = this;\n  var bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n  bbox = bbox[1] + ',' + bbox[0] + ',' + bbox[3] + ',' + bbox[2];\n  // Overpass QL\n  var query = '[bbox:'+bbox+'][out:xml][timeout:25];';\n  query += '(';\n  // Search attributes\n  for (var t in this._types) {\n    if (this._types[t]) {\n      query += t;\n      for (var n=0, filter; filter = this._filter[n]; n++) {\n        query += '['+filter+']';\n      }\n      query += ';'\n    }\n  }\n  query +=');out;>;out skel qt;'\n  var ajax = new XMLHttpRequest();\n\tajax.open('POST', this._url, true);\n\tajax.onload = function () {\n    var features = new ol.format.OSMXML().readFeatures(this.responseText,{featureProjection: projection});\n    var result = [];\n    // Remove duplicated features\n    for (var i=0, f; f=features[i]; i++) {\n      if (!self.hasFeature(f)) result.push(f);\n    }\n    self.addFeatures(result);\n\t};\n\tajax.onerror = function () {\n\t\tconsole.log(arguments);\n\t};\n  ajax.send('data='+query);\n};\n/**\n * Search if feature is allready loaded\n * @param {ol.Feature} feature\n * @return {boolean} \n * @private\n */\nol.source.Overpass.prototype.hasFeature = function(feature) {\n\tvar p = feature.getGeometry().getFirstCoordinate();\n\tvar id = feature.getId();\n\tvar existing = this.getFeaturesInExtent([p[0]-0.1, p[1]-0.1, p[0]+0.1, p[1]+0.1]);\n\tfor (var i=0, f; f=existing[i]; i++) {\n\t\tif (id===f.getId()) {\n      return true;\n    }\n\t}\n\treturn false;\n};\n\n(function () {\n  var clear = ol.source.Vector.prototype.clear;\n  /** Overwrite ol/source/Vector clear to fire clearstart / clearend event\n   */\n  ol.source.Vector.prototype.clear = function(opt_fast) {\n    this.dispatchEvent({ type: 'clearstart' });\n    clear.call(this, opt_fast)\n    this.dispatchEvent({ type: 'clearend' });\n  };\n})();\n\n/** \n * @classdesc 3D vector layer rendering\n * @constructor\n * @extends {pl.layer.Image}\n * @param {Object} options\n *  @param {ol.layer.Vector} options.source the source to display in 3D\n *  @param {ol.style.Style} options.styler drawing style\n *  @param {number} options.maxResolution  max resolution to render 3D\n *  @param {number} options.defaultHeight default height if none is return by a propertie\n *  @param {function|string|Number} options.height a height function (returns height giving a feature) or a popertie name for the height or a fixed value\n *  @param {Array<number>} options.center center of the view, default [.5,1]\n */\nol.layer.Vector3D = function (options) {\n  options = options || {};\n  this._source = options.source;\n  this.height_ = options.height = this.getHfn (options.height);\n  var canvas = document.createElement('canvas');\n  ol.layer.Image.call (this, { \n    source: new ol.source.ImageCanvas({\n      canvasFunction: function(extent, resolution, pixelRatio, size /*, projection*/ ) {\n        canvas.width = size[0];\n        canvas.height = size[1];\n        return canvas;\n      }\n    }), \n    height: options.height,\n    center: options.center || [.5,1],\n    defaultHeight: options.defaultHeight || 0,\n    maxResolution: options.maxResolution || Infinity \n  });\n  this.setStyle(options.style);\n  this.on (['postcompose', 'postrender'], this.onPostcompose_.bind(this));\n}\nol.ext.inherits(ol.layer.Vector3D, ol.layer.Image);\n/**\n * Set style associated with the renderer\n * @param {ol.style.Style} s\n */\nol.layer.Vector3D.prototype.setStyle = function(s) {\n  if (s instanceof ol.style.Style) this._style = s;\n  else this._style = new ol.style.Style();\n  if (!this._style.getStroke()) {\n    this._style.setStroke(new ol.style.Stroke({\n      width: 1,\n      color: 'red'\n    }));\n  }\n  if (!this._style.getFill()) {\n    this._style.setFill( new ol.style.Fill({ color: 'rgba(0,0,255,0.5)'}) );\n  }\n  if (!this._style.getText()) {\n    this._style.setText( new ol.style.Fill({ \n      color: 'red'}) \n    );\n  }\n  // Get the geometry\n  if (s && s.getGeometry()) {\n    var geom = s.getGeometry();\n    if (typeof(geom)==='function') {\n      this.set('geometry', geom);\n    } else {\n      this.set('geometry', function() { return geom; });\n    }\n  } else {\n    this.set('geometry', function(f) { return f.getGeometry(); });\n  }\n};\n/**\n * Get style associated with the renderer\n * @return {ol.style.Style}\n */\nol.layer.Vector3D.prototype.getStyle = function() {\n  return this._style;\n};\n/** Calculate 3D at potcompose\n*/\nol.layer.Vector3D.prototype.onPostcompose_ = function(e) {\n  var res = e.frameState.viewState.resolution;\n  if (res > this.get('maxResolution')) return;\n  this.res_ = res*400;\n  if (this.animate_) {\n    var elapsed = e.frameState.time - this.animate_;\n    if (elapsed < this.animateDuration_) {\n      this.elapsedRatio_ = this.easing_(elapsed / this.animateDuration_);\n      // tell OL3 to continue postcompose animation\n      e.frameState.animate = true;\n    } else {\n      this.animate_ = false;\n      this.height_ = this.toHeight_\n    }\n  }\n  var ratio = e.frameState.pixelRatio;\n  var ctx = e.context;\n  var m = this.matrix_ = e.frameState.coordinateToPixelTransform;\n  // Old version (matrix)\n  if (!m) {\n    m = e.frameState.coordinateToPixelMatrix,\n    m[2] = m[4];\n    m[3] = m[5];\n    m[4] = m[12];\n    m[5] = m[13];\n  }\n  this.center_ = [ \n    ctx.canvas.width*this.get('center')[0]/ratio, \n    ctx.canvas.height*this.get('center')[1]/ratio \n  ];\n  var f = this._source.getFeaturesInExtent(e.frameState.extent);\n  ctx.save();\n    ctx.scale(ratio,ratio);\n    var s = this.getStyle();\n    ctx.lineWidth = s.getStroke().getWidth();\n    ctx.lineCap = s.getStroke().getLineCap();\n    ctx.strokeStyle = ol.color.asString(s.getStroke().getColor());\n    ctx.fillStyle = ol.color.asString(s.getFill().getColor());\n    var builds = [];\n    for (var i=0; i<f.length; i++) {\n      builds.push (this.getFeature3D_ (f[i], this.getFeatureHeight(f[i])));\n    }\n    this.drawFeature3D_ (ctx, builds);\n  ctx.restore();\n};\n/** Create a function that return height of a feature\n*\t@param {function|string|number} h a height function or a popertie name or a fixed value\n*\t@return {function} function(f) return height of the feature f\n*/\nol.layer.Vector3D.prototype.getHfn= function(h) {\n  switch (typeof(h)) {\n    case 'function': return h;\n    case 'string': {\n      var dh = this.get('defaultHeight');\n        return (function(f) {\n          return (Number(f.get(h)) || dh); \n        });\n      }\n    case 'number': return (function(/*f*/) { return h; });\n    default: return (function(/*f*/) { return 10; });\n  }\n}\n/** Animate rendering\n * @param {olx.render3D.animateOptions}\n *  @param {string|function|number} param.height an attribute name or a function returning height of a feature or a fixed value\n *  @param {number} param.duration the duration of the animatioin ms, default 1000\n *  @param {ol.easing} param.easing an ol easing function\n *\t@api\n */\nol.layer.Vector3D.prototype.animate = function(options) {\n  options = options || {};\n  this.toHeight_ = this.getHfn(options.height);\n  this.animate_ = new Date().getTime();\n  this.animateDuration_ = options.duration ||1000;\n  this.easing_ = options.easing || ol.easing.easeOut;\n  // Force redraw\n  this.changed();\n}\n/** Check if animation is on\n*\t@return {bool}\n*/\nol.layer.Vector3D.prototype.animating = function() {\n  if (this.animate_ && new Date().getTime() - this.animate_ > this.animateDuration_) {\n    this.animate_ = false;\n  }\n  return !!this.animate_;\n}\n/** \n*/\nol.layer.Vector3D.prototype.getFeatureHeight = function (f) {\n  if (this.animate_) {\n    var h1 = this.height_(f);\n    var h2 = this.toHeight_(f);\n    return (h1*(1-this.elapsedRatio_)+this.elapsedRatio_*h2);\n  }\n  else return this.height_(f);\n};\n/**\n*/\nol.layer.Vector3D.prototype.hvector_ = function (pt, h) {\n  var p0 = [\n    pt[0]*this.matrix_[0] + pt[1]*this.matrix_[1] + this.matrix_[4],\n    pt[0]*this.matrix_[2] + pt[1]*this.matrix_[3] + this.matrix_[5]\n  ];\n  return {\n    p0: p0, \n    p1: [\n      p0[0] + h/this.res_ * (p0[0]-this.center_[0]),\n      p0[1] + h/this.res_ * (p0[1]-this.center_[1])\n    ]\n  };\n};\n/**\n*/\nol.layer.Vector3D.prototype.getFeature3D_ = function (f, h) {\n  var geom = this.get('geometry')(f);\n  var c = geom.getCoordinates();\n  switch (geom.getType()) {\n    case \"Polygon\":\n      c = [c];\n    // fallthrough\n    case \"MultiPolygon\":\n      var build = [];\n      for (var i=0; i<c.length; i++) {\n        for (var j=0; j<c[i].length; j++) {\n          var b = [];\n          for (var k=0; k<c[i][j].length; k++) {\n            b.push( this.hvector_(c[i][j][k], h) );\n          }\n          build.push(b);\n        }\n      }\n      return { type:\"MultiPolygon\", feature: f, geom: build };\n    case \"Point\":\n      return { type:\"Point\", feature: f, geom: this.hvector_(c,h) };\n    default: return {};\n  }\n}\n/**\n*/\nol.layer.Vector3D.prototype.drawFeature3D_ = function(ctx, build) {\n  var i,j, b, k;\n  // Construct\n  for (i=0; i<build.length; i++) {\t\n    switch (build[i].type) {\n      case \"MultiPolygon\": {\n        for (j=0; j<build[i].geom.length; j++) {\n          b = build[i].geom[j];\n          for (k=0; k < b.length; k++) {\n            ctx.beginPath();\n            ctx.moveTo(b[k].p0[0], b[k].p0[1]);\n            ctx.lineTo(b[k].p1[0], b[k].p1[1]);\n            ctx.stroke();\n          }\n        }\n        break;\n      }\n      case \"Point\": {\n        var g = build[i].geom;\n          ctx.beginPath();\n          ctx.moveTo(g.p0[0], g.p0[1]);\n          ctx.lineTo(g.p1[0], g.p1[1]);\n          ctx.stroke();\n          break;\n        }\n      default: break;\n    }\n  }\n  // Roof\n  for (i=0; i<build.length; i++) {\n    switch (build[i].type) {\n      case \"MultiPolygon\": {\n        ctx.beginPath();\n        for (j=0; j<build[i].geom.length; j++) {\n          b = build[i].geom[j];\n          if (j==0) {\n            ctx.moveTo(b[0].p1[0], b[0].p1[1]);\n            for (k=1; k < b.length; k++) {\n              ctx.lineTo(b[k].p1[0], b[k].p1[1]);\n            }\n          } else {\n            ctx.moveTo(b[0].p1[0], b[0].p1[1]);\n            for (k=b.length-2; k>=0; k--) {\n              ctx.lineTo(b[k].p1[0], b[k].p1[1]);\n            }\n          }\n          ctx.closePath();\n        }\n        ctx.fill(\"evenodd\");\n        ctx.stroke();\n        break;\n      }\n      case \"Point\": {\n        b = build[i];\n        var t = b.feature.get('label');\n        if (t) {\n          var p = b.geom.p1;\n          var m = ctx.measureText(t);\n          var h = Number (ctx.font.match(/\\d+(\\.\\d+)?/g).join([]));\n          ctx.fillRect (p[0]-m.width/2 -5, p[1]-h -5, m.width +10, h +10)\n          ctx.strokeRect (p[0]-m.width/2 -5, p[1]-h -5, m.width +10, h +10)\n          ctx.save()\n            ctx.fillStyle = ol.color.asString(this._style.getText().getFill().getColor());\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'bottom';\n            ctx.fillText ( t, p[0], p[1] );\n          ctx.restore();\n        }\n        break;\n      }\n      default: break;\n    }\n  }\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n  @classdesc\n  ol.source.WikiCommons is a source that load Wikimedia Commons content in a vector layer.\n  Inherits from:\n  <ol.source.Vector>\n*/\n/**\n* @constructor ol.source.WikiCommons\n* @extends {ol.source.Vector}\n* @param {olx.source.WikiCommons=} options\n*/\nol.source.WikiCommons = function(opt_options) {\n  var options = opt_options || {};\n  options.loader = this._loaderFn;\n  /** Max resolution to load features  */\n  this._maxResolution = options.maxResolution || 100;\n  /** Result language */\n  this._lang = options.lang || \"fr\";\n  /** Query limit */\n  this._limit = options.limit || 100;\n  /** Default attribution */\n  if (!options.attributions) options.attributions = [ \"&copy; <a href='https://commons.wikimedia.org/'>Wikimedia Commons</a>\" ];\n  // Bbox strategy : reload at each move\n    if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n  ol.source.Vector.call (this, options);\n};\nol.ext.inherits(ol.source.WikiCommons, ol.source.Vector);\n/** Decode wiki attributes and choose to add feature to the layer\n* @param {feature} the feature\n* @param {attributes} wiki attributes\n* @return {boolean} true: add the feature to the layer\n* @API stable\n*/\nol.source.WikiCommons.prototype.readFeature = function (feature, attributes){\n  feature.set(\"descriptionurl\", attributes.descriptionurl);\n  feature.set(\"url\", attributes.url);\n  feature.set(\"title\", attributes.title.replace(/^file:|.jpg$/ig,\"\"));\n  feature.set(\"thumbnail\", attributes.url.replace(/^(.+wikipedia\\/commons)\\/([a-zA-Z0-9]\\/[a-zA-Z0-9]{2})\\/(.+)$/,\"$1/thumb/$2/$3/200px-$3\"));\n  feature.set(\"user\", attributes.user);\n  if (attributes.extmetadata && attributes.extmetadata.LicenseShortName) feature.set(\"copy\", attributes.extmetadata.LicenseShortName.value);\n  return true;\n};\n/** Loader function used to load features.\n* @private\n*/\nol.source.WikiCommons.prototype._loaderFn = function(extent, resolution, projection){\n  if (resolution > this._maxResolution) return;\n  var self = this;\n  var bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n  // Commons API: for more info @see https://commons.wikimedia.org/wiki/Commons:API/MediaWiki\n  var url = \"https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=coordinates|imageinfo\"\n    + \"&generator=geosearch&iiprop=timestamp|user|url|extmetadata|metadata|size&iiextmetadatafilter=LicenseShortName\"\n    + \"&ggsbbox=\" + bbox[3] + \"|\" + bbox[0] + \"|\" + bbox[1] + \"|\" + bbox[2]\n    + \"&ggslimit=\"+this._limit\n    + \"&iilimit=\"+(this._limit-1)\n    + \"&ggsnamespace=6\";\n  // Ajax request to get the tile\n  ol.ext.Ajax.get({\n    url: url,\n    success: function(data) {\n      //console.log(data);\n      var features = [];\n      var att, pt, feature;\n      if (!data.query || !data.query.pages) return;\n      for ( var i in data.query.pages){\n        att = data.query.pages[i];\n        if (att.coordinates && att.coordinates.length ) {\n          pt = [att.coordinates[0].lon, att.coordinates[0].lat];\n        } else {\n          var meta = att.imageinfo[0].metadata;\n          if (!meta) {\n            //console.log(att);\n            continue;\n          }\n          pt = [];\n          var found=0;\n          for (var k=0; k<meta.length; k++) {\n            if (meta[k].name==\"GPSLongitude\") {\n              pt[0] = meta[k].value;\n              found++;\n            }\n            if (meta[k].name==\"GPSLatitude\") {\n              pt[1] = meta[k].value;\n              found++;\n            }\n          }\n          if (found!=2) {\n            //console.log(att);\n            continue;\n          }\n        }\n        feature = new ol.Feature(new ol.geom.Point(ol.proj.transform (pt,\"EPSG:4326\",projection)));\n        att.imageinfo[0].title = att.title;\n        if (self.readFeature(feature, att.imageinfo[0])) {\n          features.push(feature);\n        }\n      }\n      self.addFeatures(features);\n  }});\n};\n\n/*\n\tCopyright (c) 2015 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n\tol.layer.AnimatedCluster is a vector layer that animate cluster\n*/\n/**\n *  A vector layer for animated cluster\n * @constructor \n * @extends {ol.layer.Vector}\n * @param {olx.layer.AnimatedClusterOptions=} options extend olx.layer.Options\n * \t@param {Number} options.animationDuration animation duration in ms, default is 700ms \n * \t@param {ol.easingFunction} animationMethod easing method to use, default ol.easing.easeOut\n */\nol.layer.AnimatedCluster = function(opt_options)\n{\tvar options = opt_options || {};\n\tol.layer.Vector.call (this, options);\n\tthis.oldcluster = new ol.source.Vector();\n\tthis.clusters = [];\n\tthis.animation={start:false};\n\tthis.set('animationDuration', typeof(options.animationDuration)=='number' ? options.animationDuration : 700);\n\tthis.set('animationMethod', options.animationMethod || ol.easing.easeOut);\n\t// Save cluster before change\n\tthis.getSource().on('change', this.saveCluster.bind(this));\n\t// Animate the cluster\n\tthis.on(['precompose','prerender'], this.animate.bind(this));\n\tthis.on(['postcompose','postrender'], this.postanimate.bind(this));\n};\nol.ext.inherits(ol.layer.AnimatedCluster, ol.layer.Vector);\n/** save cluster features before change\n * @private\n */\nol.layer.AnimatedCluster.prototype.saveCluster = function() {\n\tif (this.oldcluster) {\n\t\tthis.oldcluster.clear();\n\t\tif (!this.get('animationDuration')) return;\n\t\tvar features = this.getSource().getFeatures();\n\t\tif (features.length && features[0].get('features'))\n\t\t{\tthis.oldcluster.addFeatures (this.clusters);\n\t\t\tthis.clusters = features.slice(0);\n\t\t\tthis.sourceChanged = true;\n\t\t}\n\t}\n};\n/** \n * Get the cluster that contains a feature\n * @private\n*/\nol.layer.AnimatedCluster.prototype.getClusterForFeature = function(f, cluster)\n{\tfor (var j=0, c; c=cluster[j]; j++)\n\t{\tvar features = c.get('features');\n\t\tif (features && features.length) \n\t\t{\tfor (var k=0, f2; f2=features[k]; k++)\n\t\t\t{\tif (f===f2) \n\t\t\t\t{\treturn c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n/** \n * Stop animation \n * @private \n */\nol.layer.AnimatedCluster.prototype.stopAnimation = function()\n{\tthis.animation.start = false;\n\tthis.animation.cA = [];\n\tthis.animation.cB = [];\n};\n/** \n * animate the cluster\n * @private\n */\nol.layer.AnimatedCluster.prototype.animate = function(e)\n{\tvar duration = this.get('animationDuration');\n\tif (!duration) return;\n\tvar resolution = e.frameState.viewState.resolution;\n\tvar i, c0, a = this.animation;\n\tvar time = e.frameState.time;\n\t// Start a new animation, if change resolution and source has changed\n\tif (a.resolution != resolution && this.sourceChanged)\n\t{\tvar extent = e.frameState.extent;\n\t\tif (a.resolution < resolution)\n\t\t{\textent = ol.extent.buffer(extent, 100*resolution);\n\t\t\ta.cA = this.oldcluster.getFeaturesInExtent(extent);\n\t\t\ta.cB = this.getSource().getFeaturesInExtent(extent);\n\t\t\ta.revers = false;\n\t\t}\n\t\telse\n\t\t{\textent = ol.extent.buffer(extent, 100*resolution);\n\t\t\ta.cA = this.getSource().getFeaturesInExtent(extent);\n\t\t\ta.cB = this.oldcluster.getFeaturesInExtent(extent);\n\t\t\ta.revers = true;\n\t\t}\n\t\ta.clusters = [];\n\t\tfor (i=0, c0; c0=a.cA[i]; i++)\n\t\t{\tvar f = c0.get('features');\n\t\t\tif (f && f.length) \n\t\t\t{\tvar c = this.getClusterForFeature (f[0], a.cB);\n\t\t\t\tif (c) a.clusters.push({ f:c0, pt:c.getGeometry().getCoordinates() });\n\t\t\t}\n\t\t}\n\t\t// Save state\n\t\ta.resolution = resolution;\n\t\tthis.sourceChanged = false;\n\t\t// No cluster or too much to animate\n\t\tif (!a.clusters.length || a.clusters.length>1000) \n\t\t{\tthis.stopAnimation();\n\t\t\treturn;\n\t\t}\n\t\t// Start animation from now\n\t\ttime = a.start = (new Date()).getTime();\n\t}\n\t// Run animation\n\tif (a.start) {\n\t\tvar vectorContext = e.vectorContext || ol.render.getVectorContext(e);\n\t\tvar d = (time - a.start) / duration;\n\t\t// Animation ends\n\t\tif (d > 1.0) \n\t\t{\tthis.stopAnimation();\n\t\t\td = 1;\n\t\t}\n\t\td = this.get('animationMethod')(d);\n\t\t// Animate\n\t\tvar style = this.getStyle();\n\t\tvar stylefn = (typeof(style) == 'function') ? style : style.length ? function(){ return style; } : function(){ return [style]; } ;\n\t\t// Layer opacity\n\t\te.context.save();\n\t\te.context.globalAlpha = this.getOpacity();\n\t\tfor (i=0, c; c=a.clusters[i]; i++)\n\t\t{\tvar pt = c.f.getGeometry().getCoordinates();\n\t\t\tvar dx = pt[0]-c.pt[0];\n\t\t\tvar dy = pt[1]-c.pt[1];\n\t\t\tif (a.revers)\n\t\t\t{\tpt[0] = c.pt[0] + d * dx;\n\t\t\t\tpt[1] = c.pt[1] + d * dy;\n\t\t\t}\n\t\t\telse\n\t\t\t{\tpt[0] = pt[0] - d * dx;\n\t\t\t\tpt[1] = pt[1] - d * dy;\n\t\t\t}\n\t\t\t// Draw feature\n\t\t\tvar st = stylefn(c.f, resolution, true);\n\t\t\tif (!st.length) st = [st];\n\t\t\t// If one feature: draw the feature\n\t\t\tif (c.f.get(\"features\").length===1 && !dx && !dy) {\n\t\t\t\tf = c.f.get(\"features\")[0];\n\t\t\t}\n\t\t\t// else draw a point\n\t\t\telse {\n\t\t\t\tvar geo = new ol.geom.Point(pt);\n\t\t\t\tf = new ol.Feature(geo);\n\t\t\t}\n\t\t\tfor (var k=0, s; s=st[k]; k++) {\n\t\t\t\t// Multi-line text\n\t\t\t\tif (s.getText() && /\\n/.test(s.getText().getText())) {\n\t\t\t\t\tvar offsetX = s.getText().getOffsetX();\n\t\t\t\t\tvar offsetY = s.getText().getOffsetY();\n\t\t\t\t\tvar rot = s.getText().getRotation() || 0;\n\t\t\t\t\tvar fontSize = Number((s.getText().getFont() || '10px').match(/\\d+/)) * 1.2;\n\t\t\t\t\tvar str = s.getText().getText().split('\\n')\n\t\t\t\t\tvar dl, nb = str.length-1;\n\t\t\t\t\tvar s2 = s.clone();\n\t\t\t\t\t// Draw each lines\n\t\t\t\t\tstr.forEach(function(t, i) {\n\t\t\t\t\t\tif (i==1) {\n\t\t\t\t\t\t\t// Allready drawn\n\t\t\t\t\t\t\ts2.setImage();\n\t\t\t\t\t\t\ts2.setFill();\n\t\t\t\t\t\t\ts2.setStroke();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch (s.getText().getTextBaseline()) {\n\t\t\t\t\t\t\tcase 'alphabetic':\n\t\t\t\t\t\t\tcase 'ideographic':\n\t\t\t\t\t\t\tcase 'bottom': {\n\t\t\t\t\t\t\t\tdl = nb;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase 'hanging':\n\t\t\t\t\t\t\tcase 'top': {\n\t\t\t\t\t\t\t\tdl = 0;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdefault : {\n\t\t\t\t\t\t\t\tdl = nb/2;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\ts2.getText().setOffsetX(offsetX - Math.sin(rot)*fontSize*(i - dl));\n\t\t\t\t\t\ts2.getText().setOffsetY(offsetY + Math.cos(rot)*fontSize*(i - dl));\n\t\t\t\t\t\ts2.getText().setText(t);\n\t\t\t\t\t\tvectorContext.drawFeature(f, s2);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvectorContext.drawFeature(f, s);\n\t\t\t\t}\n\t\t\t\t/* OLD VERSION OL < 4.3\n\t\t\t\t// Retina device\n\t\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\t\tvar sc;\n\t\t\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : s.getImage();\n\t\t\t\tif (imgs)\n\t\t\t\t{\tsc = imgs.getScale(); \n\t\t\t\t\timgs.setScale(sc*ratio); \n\t\t\t\t}\n\t\t\t\t// OL3 > v3.14\n\t\t\t\tif (vectorContext.setStyle)\n\t\t\t\t{\t// If one feature: draw the feature\n\t\t\t\t\tif (c.f.get(\"features\").length===1 && !dx && !dy) {\n\t\t\t\t\t\tvectorContext.drawFeature(c.f.get(\"features\")[0], s);\n\t\t\t\t\t}\n\t\t\t\t\t// else draw a point\n\t\t\t\t\telse {\n\t\t\t\t\t\tvectorContext.setStyle(s);\n\t\t\t\t\t\tvectorContext.drawGeometry(geo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// older version\n\t\t\t\telse\n\t\t\t\t{\tvectorContext.setImageStyle(imgs);\n\t\t\t\t\tvectorContext.setTextStyle(s.getText());\n\t\t\t\t\tvectorContext.drawPointGeometry(geo);\n\t\t\t\t}\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t\te.context.restore();\n\t\t// tell ol to continue postcompose animation\n\t\te.frameState.animate = true;\n\t\t// Prevent layer drawing (clip with null rect)\n\t\te.context.save();\n\t\te.context.beginPath();\n\t\te.context.rect(0,0,0,0);\n\t\te.context.clip();\n\t\tthis.clip_ = true;\n\t}\n\treturn;\n};\n/**  \n * remove clipping after the layer is drawn\n * @private\n */\nol.layer.AnimatedCluster.prototype.postanimate = function(e)\n{\tif (this.clip_)\n\t{\te.context.restore();\n\t\tthis.clip_ = false;\n\t}\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * Image layer to use with a GeoImage source and return the extent calcaulted with this source.\n * @extends {ol.layer.Image}\n * @param {Object=} options Layer Image options.\n * @api\n */\nol.layer.GeoImage = function(options) {\n  ol.layer.Image.call(this, options);\n}\nol.ext.inherits (ol.layer.GeoImage, ol.layer.Image);\n/**\n * Return the {@link module:ol/extent~Extent extent} of the source associated with the layer.\n * @return {ol.Extent} The layer extent.\n * @observable\n * @api\n */\nol.layer.GeoImage.prototype.getExtent = function() {\n  return this.getSource().getExtent();\n}\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n// \n/** IGN's Geoportail WMTS layer definition\n * @constructor \n * @extends {ol.layer.Tile}\n * @param {string} layer Layer name\n * @param {olx.layer.WMTSOptions=} options WMTS options if not defined default are used\n *  @param {string} options.gppKey Geoportail API key\n * @param {olx.source.WMTSOptions=} tileoptions WMTS options if not defined default are used\n */\nol.layer.Geoportail = function(layer, options, tileoptions) {\n  options = options || {};\n\ttileoptions = tileoptions || {};\n\tvar capabilities = window.geoportailConfig ? window.geoportailConfig.capabilities[options.gppKey || options.key] || window.geoportailConfig.capabilities[\"default\"] || ol.layer.Geoportail.capabilities : ol.layer.Geoportail.capabilities;\n  capabilities = capabilities[layer];\n\tif (!capabilities) {\n    capabilities = { title: layer, originators: [] };\n    console.error(\"ol.layer.Geoportail: no layer definition for \\\"\"+layer+\"\\\"\\nTry to use ol/layer/Geoportail~loadCapabilities() to get it.\");\n    // throw new Error(\"ol.layer.Geoportail: no layer definition for \\\"\"+layer+\"\\\"\");\n  }\n\t// tile options & default params\n\tfor (var i in capabilities) if (typeof\ttileoptions[i]== \"undefined\") tileoptions[i] = capabilities[i];\n\tthis._originators = capabilities.originators;\n\tif (!tileoptions.gppKey) tileoptions.gppKey = options.gppKey || options.key;\n\toptions.source = new ol.source.Geoportail(layer, tileoptions);\n\tif (!options.name) options.name = capabilities.title;\n\tif (!options.desc) options.desc = capabilities.desc;\n\tif (!options.extent && capabilities.bbox) {\n    if (capabilities.bbox[0]>-170 && capabilities.bbox[2]<170)\n    options.extent = ol.proj.transformExtent(capabilities.bbox, 'EPSG:4326', 'EPSG:3857');\n\t}\n\t// calculate layer max resolution\n\tif (!options.maxResolution && tileoptions.minZoom) {\n    options.source.getTileGrid().minZoom -= (tileoptions.minZoom>1 ? 2 : 1);\n\t\toptions.maxResolution = options.source.getTileGrid().getResolution(options.source.getTileGrid().minZoom)\n\t\toptions.source.getTileGrid().minZoom = tileoptions.minZoom;\n  }\n  ol.layer.Tile.call (this, options);\n  this.set('layer', layer);\n  this.set('queryable', capabilities.queryable);\n  // BUG GPP: Attributions constraints are not set properly :(\n/** /\n  // Set attribution according to the originators\n  var counter = 0;\n  // Get default attribution\n  var getAttrib = function(title, o) {\n    if (this.get('attributionMode')==='logo') {\n      if (!title) return ol.source.Geoportail.prototype.attribution;\n      else return '<a href=\"'+o.href+'\"><img src=\"'+o.logo+'\" title=\"&copy; '+o.attribution+'\" /></a>';\n    } else {\n      if (!title) return ol.source.Geoportail.prototype.attribution;\n      else return '&copy; <a href=\"'+o.href+'\" title=\"&copy; '+(o.attribution||title)+'\" >'+title+'</a>'\n    }\n  }.bind(this);\n  var currentZ, currentCenter = [];\n  var setAttribution = function(e) {\n    var a, o, i;\n    counter--;\n    if (!counter) {\n      var z = e.frameState.viewState.zoom;\n      console.log(e)\n      if (z===currentZ \n        && e.frameState.viewState.center[0]===currentCenter[0]\n        && e.frameState.viewState.center[1]===currentCenter[1]){\n          return;\n      }\n      currentZ = z;\n      currentCenter = e.frameState.viewState.center;\n      var ex = e.frameState.extent;\n      ex = ol.proj.transformExtent (ex, e.frameState.viewState.projection, 'EPSG:4326');\n      if (this._originators) {\n        var attrib = this.getSource().getAttributions();\n        // ol v5\n        if (typeof(attrib)==='function') attrib = attrib();\n        attrib.splice(0, attrib.length);\n        var maxZoom = 0;\n        for (a in this._originators) {\n          o = this._originators[a];\n          for (i=0; i<o.constraint.length; i++) {\n            if (o.constraint[i].maxZoom > maxZoom\n              && ol.extent.intersects(ex, o.constraint[i].bbox)) {\n                maxZoom = o.constraint[i].maxZoom;\n            }\n          }\t\n        }\n        if (maxZoom < z) z = maxZoom;\n        if (this.getSource().getTileGrid() && z < this.getSource().getTileGrid().getMinZoom()) {\n          z = this.getSource().getTileGrid().getMinZoom();\n        }\n        for (a in this._originators) {\n          o = this._originators[a];\n          if (!o.constraint.length) {\n            attrib.push (getAttrib(a, o));\n          } else {\n            for (i=0; i<o.constraint.length; i++) {\n              if ( z <= o.constraint[i].maxZoom \n                && z >= o.constraint[i].minZoom \n                && ol.extent.intersects(ex, o.constraint[i].bbox)) {\n                  attrib.push (getAttrib(a, o));\n                  break;\n              }\n            }\n          }\n        }\n        if (!attrib.length) attrib.push ( getAttrib() );\n        this.getSource().setAttributions(attrib);\n      }\n    }\n  }.bind(this);\n  this.on('precompose', function(e) {\n    counter++;\n    setTimeout(function () { setAttribution(e) }, 500);\n  });\n/**/\n};\nol.ext.inherits (ol.layer.Geoportail, ol.layer.Tile);\n/** Default capabilities for main layers\n */\nol.layer.Geoportail.capabilities = {\n  \"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD\",\"title\":\"Carte IGN\",\"format\":\"image/jpeg\",\"style\":\"normal\",\"queryable\":false,\"tilematrix\":\"PM\",\"minZoom\":0,\"maxZoom\":18,\"bbox\":[-179.62723,-84.5047,179.74588,85.47958],\"desc\":\"Cartographie topographique multi-chelles du territoire franais issue des bases de donnes vecteur de lIGN - emprise nationale, visible du 1/200 au 1/130000000\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":0,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":13,\"bbox\":[-63.37252,13.428586,11.429714,51.44377]},{\"minZoom\":11,\"maxZoom\":12,\"bbox\":[-63.37252,13.428586,11.496459,51.444122]},{\"minZoom\":9,\"maxZoom\":9,\"bbox\":[-64.81273,13.428586,11.496459,51.444016]},{\"minZoom\":10,\"maxZoom\":10,\"bbox\":[-63.37252,13.428586,11.496459,51.444016]},{\"minZoom\":0,\"maxZoom\":2,\"bbox\":[-175.99709,-84.42859,175.99709,84.2865]},{\"minZoom\":4,\"maxZoom\":4,\"bbox\":[-179.62723,-84.0159,-179.21112,85.47958]},{\"minZoom\":18,\"maxZoom\":18,\"bbox\":[-63.189068,-21.428364,55.846638,51.175068]},{\"minZoom\":15,\"maxZoom\":17,\"bbox\":[-63.189117,-21.428364,55.84698,51.175068]},{\"minZoom\":14,\"maxZoom\":14,\"bbox\":[-63.283817,-21.7006,56.039127,51.44377]},{\"minZoom\":6,\"maxZoom\":8,\"bbox\":[-179.49689,-84.02368,179.74588,85.30035]},{\"minZoom\":3,\"maxZoom\":3,\"bbox\":[-176.23093,-84.5047,179.08267,84.89126]},{\"minZoom\":5,\"maxZoom\":5,\"bbox\":[-179.57285,-83.84196,178.4975,85.36646]}]}}},\n  \"ELEVATION.SLOPES\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"ELEVATION.SLOPES\",\"title\":\"Altitude\",\"format\":\"image/jpeg\",\"style\":\"normal\",\"queryable\":true,\"tilematrix\":\"PM\",\"minZoom\":6,\"maxZoom\":14,\"bbox\":[-178.20589,-22.595179,167.43176,50.93085],\"desc\":\"La couche altitude se compose d'un MNT (Modle Numrique de Terrain) affich en teintes hypsomtriques et issu de la BD ALTI.\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":6,\"maxZoom\":14,\"constraint\":[{\"minZoom\":6,\"maxZoom\":14,\"bbox\":[55.205746,-21.392344,55.846554,-20.86271]}]}}},\n  \"GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1\",\"title\":\"Plan IGN j+1\",\"format\":\"image/png\",\"style\":\"normal\",\"queryable\":false,\"tilematrix\":\"PM\",\"minZoom\":0,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75],\"desc\":\"Plan IGN j+1\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":0,\"maxZoom\":18,\"constraint\":[{\"minZoom\":0,\"maxZoom\":18,\"bbox\":[-179,-80,179,80]}]}}},\n  \"CADASTRALPARCELS.PARCELS\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"CADASTRALPARCELS.PARCELS\",\"title\":\"Parcelles cadastrales\",\"format\":\"image/png\",\"style\":\"bdparcellaire\",\"queryable\":false,\"tilematrix\":\"PM\",\"minZoom\":0,\"maxZoom\":20,\"bbox\":[-63.160706,-21.39223,55.84643,51.090965],\"desc\":\"Limites des parcelles cadastrales issues de plans scanns et de plans numriques.\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":0,\"maxZoom\":20,\"constraint\":[{\"minZoom\":0,\"maxZoom\":20,\"bbox\":[-63.160706,-21.39223,55.84643,51.090965]}]}}},\n  \"ORTHOIMAGERY.ORTHOPHOTOS\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"ORTHOIMAGERY.ORTHOPHOTOS\",\"title\":\"Photographies ariennes\",\"format\":\"image/jpeg\",\"style\":\"normal\",\"queryable\":true,\"tilematrix\":\"PM\",\"minZoom\":0,\"bbox\":[-180,-86,180,84],\"desc\":\"Photographies ariennes\",\"originators\":{\"PLANETOBSERVER\":{\"href\":\"http://www.planetobserver.com/\",\"attribution\":\"PlanetObserver (images satellites)\",\"logo\":\"https://wxs.ign.fr/static/logos/PLANETOBSERVER/PLANETOBSERVER.gif\",\"minZoom\":0,\"maxZoom\":12,\"constraint\":[{\"minZoom\":0,\"maxZoom\":12,\"bbox\":[-180,-86,180,84]}]},\"MPM\":{\"href\":\"http://www.marseille-provence.com/\",\"attribution\":\"Marseille Provence Mtropole\",\"logo\":\"https://wxs.ign.fr/static/logos/MPM/MPM.gif\",\"minZoom\":20,\"maxZoom\":20,\"constraint\":[{\"minZoom\":20,\"maxZoom\":20,\"bbox\":[5.076959,43.153347,5.7168245,43.454994]}]},\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":13,\"maxZoom\":20,\"constraint\":[{\"bbox\":[0.035491213,43.221077,6.0235267,49.696926]},{\"minZoom\":20,\"maxZoom\":20,\"bbox\":[0.035491213,43.221077,6.0235267,49.696926]},{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"CRAIG\":{\"href\":\"http://www.craig.fr\",\"attribution\":\"Centre Rgional Auvergnat de l'Information Gographique (CRAIG)\",\"logo\":\"https://wxs.ign.fr/static/logos/CRAIG/CRAIG.gif\",\"minZoom\":13,\"maxZoom\":20,\"constraint\":[{\"minZoom\":20,\"maxZoom\":20,\"bbox\":[2.2243388,44.76621,2.7314367,45.11295]},{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES/CNES.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"CG06\":{\"href\":\"http://www.cg06.fr\",\"attribution\":\"Dpartement Alpes Maritimes (06) en partenariat avec: Groupement Orthophoto 06 (NCA, Ville de Cannes, CARF, CASA,CG06, CA de Grasse)\",\"logo\":\"https://wxs.ign.fr/static/logos/CG06/CG06.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"CG45\":{\"href\":\"http://www.loiret.com\",\"attribution\":\"Le conseil gnral du Loiret\",\"logo\":\"https://wxs.ign.fr/static/logos/CG45/CG45.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"RGD_SAVOIE\":{\"href\":\"http://www.rgd.fr\",\"attribution\":\"Rgie de Gestion de Donnes des Pays de Savoie (RGD 73-74)\",\"logo\":\"https://wxs.ign.fr/static/logos/RGD_SAVOIE/RGD_SAVOIE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"e-Megalis\":{\"href\":\"http://www.e-megalisbretagne.org//\",\"attribution\":\"Syndicat mixte de coopration territoriale (e-Megalis)\",\"logo\":\"https://wxs.ign.fr/static/logos/e-Megalis/e-Megalis.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"SIGLR\":{\"href\":\"http://www.siglr.org//\",\"attribution\":\"SIGLR\",\"logo\":\"https://wxs.ign.fr/static/logos/SIGLR/SIGLR.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"PPIGE\":{\"href\":\"http://www.ppige-npdc.fr/\",\"attribution\":\"PPIGE\",\"logo\":\"https://wxs.ign.fr/static/logos/PPIGE/PPIGE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"FEDER2\":{\"href\":\"http://www.europe-en-france.gouv.fr/\",\"attribution\":\"Fonds europen de dveloppement conomique et rgional\",\"logo\":\"https://wxs.ign.fr/static/logos/FEDER2/FEDER2.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"FEDER\":{\"href\":\"http://www.europe-en-france.gouv.fr/\",\"attribution\":\"Fonds europen de dveloppement conomique et rgional\",\"logo\":\"https://wxs.ign.fr/static/logos/FEDER/FEDER.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"CRCORSE\":{\"href\":\"http://www.corse.fr//\",\"attribution\":\"CRCORSE\",\"logo\":\"https://wxs.ign.fr/static/logos/CRCORSE/CRCORSE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_AUVERGNE\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_AUVERGNE/CNES_AUVERGNE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"FEDER_PAYSDELALOIRE\":{\"href\":\"http://www.europe-en-paysdelaloire.eu/\",\"attribution\":\"Pays-de-la-Loire\",\"logo\":\"https://wxs.ign.fr/static/logos/FEDER_PAYSDELALOIRE/FEDER_PAYSDELALOIRE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"FEDER_AUVERGNE\":{\"href\":\"http://www.europe-en-auvergne.eu/\",\"attribution\":\"Auvergne\",\"logo\":\"https://wxs.ign.fr/static/logos/FEDER_AUVERGNE/FEDER_AUVERGNE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"PREFECTURE_GUADELOUPE\":{\"href\":\"www.guadeloupe.pref.gouv.fr/\",\"attribution\":\"guadeloupe\",\"logo\":\"https://wxs.ign.fr/static/logos/PREFECTURE_GUADELOUPE/PREFECTURE_GUADELOUPE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"BOURGOGNE-FRANCHE-COMTE\":{\"href\":\"https://www.bourgognefranchecomte.fr/\",\"attribution\":\"Auvergne\",\"logo\":\"https://wxs.ign.fr/static/logos/BOURGOGNE-FRANCHE-COMTE/BOURGOGNE-FRANCHE-COMTE.gif\",\"minZoom\":13,\"maxZoom\":19,\"constraint\":[{\"minZoom\":13,\"maxZoom\":19,\"bbox\":[-179.5,-75,179.5,75]}]},\"ASTRIUM\":{\"href\":\"http://www.geo-airbusds.com/\",\"attribution\":\"Airbus Defence and Space\",\"logo\":\"https://wxs.ign.fr/static/logos/ASTRIUM/ASTRIUM.gif\",\"minZoom\":13,\"maxZoom\":16,\"constraint\":[{\"minZoom\":13,\"maxZoom\":16,\"bbox\":[-55.01953,1.845384,-50.88867,6.053161]}]},\"DITTT\":{\"href\":\"http://www.dittt.gouv.nc/portal/page/portal/dittt/\",\"attribution\":\"Direction des Infrastructures, de la Topographie et des Transports Terrestres\",\"logo\":\"https://wxs.ign.fr/static/logos/DITTT/DITTT.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[163.47784,-22.767689,167.94624,-19.434975]}]},\"CNES_ALSACE\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_ALSACE/CNES_ALSACE.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_971\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_971/CNES_971.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_972\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_972/CNES_972.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_974\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_974/CNES_974.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_975\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_975/CNES_975.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_976\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_976/CNES_976.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_977\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_977/CNES_977.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]},\"CNES_978\":{\"href\":\"http://www.cnes.fr/\",\"attribution\":\"Centre national d'tudes spatiales (CNES)\",\"logo\":\"https://wxs.ign.fr/static/logos/CNES_978/CNES_978.gif\",\"minZoom\":13,\"maxZoom\":18,\"constraint\":[{\"minZoom\":13,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75]}]}}},\n  \"GEOGRAPHICALGRIDSYSTEMS.PLANIGN\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"GEOGRAPHICALGRIDSYSTEMS.PLANIGN\",\"title\":\"Plan IGN\",\"format\":\"image/jpeg\",\"style\":\"normal\",\"queryable\":false,\"tilematrix\":\"PM\",\"minZoom\":0,\"maxZoom\":18,\"bbox\":[-179.5,-75,179.5,75],\"desc\":\"Reprsentation graphique des bases de donnes IGN.\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":0,\"maxZoom\":18,\"constraint\":[{\"minZoom\":10,\"maxZoom\":18,\"bbox\":[-63.37252,-21.475586,55.925865,51.31212]},{\"minZoom\":0,\"maxZoom\":9,\"bbox\":[-179.5,-75,179.5,75]}]}}},\n  \"GEOGRAPHICALGRIDSYSTEMS.MAPS\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"GEOGRAPHICALGRIDSYSTEMS.MAPS\",\"title\":\"Cartes IGN\",\"format\":\"image/jpeg\",\"style\":\"normal\",\"queryable\":true,\"tilematrix\":\"PM\",\"minZoom\":0,\"maxZoom\":18,\"bbox\":[-180,-68.138855,180,80],\"desc\":\"Cartes IGN\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":0,\"maxZoom\":18,\"constraint\":[{\"minZoom\":17,\"maxZoom\":17,\"bbox\":[-63.189117,-21.428364,55.84698,51.175068]},{\"minZoom\":18,\"maxZoom\":18,\"bbox\":[-63.189068,-21.428364,55.846638,51.175068]},{\"minZoom\":7,\"maxZoom\":8,\"bbox\":[-178.20573,-68.138855,144.84375,51.909786]},{\"minZoom\":13,\"maxZoom\":14,\"bbox\":[-178.20573,-67.101425,142.03836,51.44377]},{\"minZoom\":11,\"maxZoom\":12,\"bbox\":[-178.20573,-67.101425,142.03836,51.444122]},{\"minZoom\":9,\"maxZoom\":10,\"bbox\":[-178.20573,-68.138855,144.84375,51.444016]},{\"minZoom\":15,\"maxZoom\":16,\"bbox\":[-178.20573,-46.502903,77.60037,51.175068]},{\"minZoom\":0,\"maxZoom\":6,\"bbox\":[-180,-60,180,80]}]},\"NCL-DITTT\":{\"href\":\"http://www.dittt.gouv.nc/portal/page/portal/dittt\",\"attribution\":\"Direction des Infrastructures, de la Topographie et des Transports Terrestres du gouvernement de la Nouvelle-Caldonie\",\"logo\":\"https://wxs.ign.fr/static/logos/NCL-DITTT/NCL-DITTT.gif\",\"minZoom\":8,\"maxZoom\":16,\"constraint\":[{\"minZoom\":8,\"maxZoom\":10,\"bbox\":[163.47784,-22.854631,168.24048,-19.402704]},{\"minZoom\":11,\"maxZoom\":13,\"bbox\":[163.47784,-22.972307,168.24327,-19.494438]},{\"minZoom\":14,\"maxZoom\":15,\"bbox\":[164.53125,-22.75592,168.22266,-20.303417]},{\"minZoom\":16,\"maxZoom\":16,\"bbox\":[163.47784,-22.79525,168.19109,-19.494438]}]}}},\n  \"TRANSPORTNETWORKS.ROADS\": {\"server\":\"https://wxs.ign.fr/geoportail/wmts\",\"layer\":\"TRANSPORTNETWORKS.ROADS\",\"title\":\"Routes\",\"format\":\"image/png\",\"style\":\"normal\",\"queryable\":false,\"tilematrix\":\"PM\",\"minZoom\":6,\"maxZoom\":18,\"bbox\":[-63.969162,-21.49687,55.964417,71.584076],\"desc\":\"Affichage du rseau routier franais et europen.\",\"originators\":{\"IGN\":{\"href\":\"http://www.ign.fr\",\"attribution\":\"Institut national de l'information gographique et forestire\",\"logo\":\"https://wxs.ign.fr/static/logos/IGN/IGN.gif\",\"minZoom\":6,\"maxZoom\":18,\"constraint\":[{\"minZoom\":15,\"maxZoom\":18,\"bbox\":[-63.37252,-21.475586,55.925865,51.31212]},{\"minZoom\":6,\"maxZoom\":14,\"bbox\":[-63.969162,-21.49687,55.964417,71.584076]}]}}},\n};\n/** Load capabilities from the service\n * @param {string} gppKey the API key to get capabilities for\n * @return {*} Promise-like response\n */\nol.layer.Geoportail.loadCapabilities = function(gppKey, all) {\n  var onSuccess = function() {}\n  var onError = function() {}\n  var onFinally = function() {};\n  this.getCapabilities(gppKey,all).then(function(c) {\n    ol.layer.Geoportail.capabilities = c;\n    onSuccess(c);\n  }).catch(function(e) { \n    onError(e);\n  }).finally(function(c) {\n    onFinally(c);\n  });\n  var response = {\n    then: function (callback) {\n      if (typeof(callback)==='function') onSuccess = callback;\n      return response;\n    },\n    catch: function (callback) {\n      if (typeof(callback)==='function') onError = callback;\n      return response;\n    },\n    finally: function (callback) {\n      if (typeof(callback)==='function') onFinally = callback;\n      return response;\n    }\n  }\n  return response;\n};\n/** Get Key capabilities\n * @param {string} gppKey the API key to get capabilities for\n * @return {*} Promise-like response\n */\nol.layer.Geoportail.getCapabilities = function(gppKey) {\n  var capabilities = {};\n  var onSuccess = function() {}\n  var onError = function() {}\n  var onFinally = function() {}\n  var geopresolutions = [156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338];\n  // Transform resolution to zoom\n\tfunction getZoom(res) {\n    res = Number(res) * 0.000281;\n\t\tfor (var r=0; r<geopresolutions.length; r++) \n\t\t\tif (res>geopresolutions[r]) return r;\n  }\n  // Merge constraints \n  function mergeConstraints(ori) {\n    for (var i=ori.constraint.length-1; i>0; i--) {\n      for (var j=0; j<i; j++) {\n        var bok = true;\n        for (var k=0; k<4; k++) {\n          if (ori.constraint[i].bbox[k] != ori.constraint[j].bbox[k]) {\n            bok = false;\n            break;\n          }\n        }\n        if (!bok) continue;\n        if (ori.constraint[i].maxZoom == ori.constraint[j].minZoom \n         || ori.constraint[j].maxZoom == ori.constraint[i].minZoom \n         || ori.constraint[i].maxZoom+1 == ori.constraint[j].minZoom \n         || ori.constraint[j].maxZoom+1 == ori.constraint[i].minZoom\n         || ori.constraint[i].minZoom-1 == ori.constraint[j].maxZoom\n         || ori.constraint[j].minZoom-1 == ori.constraint[i].maxZoom) {\n          ori.constraint[j].maxZoom = Math.max(ori.constraint[i].maxZoom, ori.constraint[j].maxZoom);\n          ori.constraint[j].minZoom = Math.min(ori.constraint[i].minZoom, ori.constraint[j].minZoom);\n          ori.constraint.splice(i,1);\n          break;\n        }\n      }\n    }\n  }\n  // Get capabilities\n  ol.ext.Ajax.get({\n    url: 'https://wxs.ign.fr/'+gppKey+'/autoconf/',\n    dataType: 'TEXT',\n    error: function (e) {\n      onError(e);\n      onFinally({});\n    },\n    success: function(resp) {\n      var parser = new DOMParser();\n      var config = parser.parseFromString(resp,\"text/xml\");\n      var layers = config.getElementsByTagName('Layer');\n      for (var i=0, l; l=layers[i]; i++) {\n        // WMTS ?\n        if (!/WMTS/.test(l.getElementsByTagName('Server')[0].attributes['service'].value)) continue;\n//        if (!all && !/geoportail\\/wmts/.test(l.find(\"OnlineResource\").attr(\"href\"))) continue;\n        var service = {\n          server: l.getElementsByTagName('gpp:Key')[0].innerHTML.replace(gppKey+\"/\",\"\"), \n          layer: l.getElementsByTagName('Name')[0].innerHTML,\n          title: l.getElementsByTagName('Title')[0].innerHTML,\n          format: l.getElementsByTagName('Format')[0].innerHTML,\n          style: l.getElementsByTagName('Style')[0].getElementsByTagName('Name')[0].innerHTML,\n          queryable: (l.attributes.queryable.value==='1'),\n          tilematrix: 'PM',\n          minZoom: getZoom(l.getElementsByTagName('sld:MaxScaleDenominator')[0].innerHTML),\n          maxZoom: getZoom(l.getElementsByTagName('sld:MinScaleDenominator')[0].innerHTML),\n          bbox: JSON.parse('['+l.getElementsByTagName('gpp:BoundingBox')[0].innerHTML+']'),\n          desc: l.getElementsByTagName('Abstract')[0].innerHTML.replace(/^<!\\[CDATA\\[(.*)\\]\\]>$/, '$1')\n        };\n        service.originators = {};\n        var origin = l.getElementsByTagName('gpp:Originator');\n        for (var k=0, o; o=origin[k]; k++) {\n          var ori = service.originators[o.attributes['name'].value] = {\n            href: o.getElementsByTagName('gpp:URL')[0].innerHTML,\n\t\t\t\t\t\tattribution: o.getElementsByTagName('gpp:Attribution')[0].innerHTML,\n\t\t\t\t\t\tlogo: o.getElementsByTagName('gpp:Logo')[0].innerHTML,\n\t\t\t\t\t\tminZoom: 20,\n\t\t\t\t\t\tmaxZoom: 0,\n\t\t\t\t\t\tconstraint: []\n          };\n          // Scale contraints\n          var constraint = o.getElementsByTagName('gpp:Constraint');\n\t\t\t\t\tfor (var j=0, c; c=constraint[j]; j++) {\n            var zmax = getZoom(c.getElementsByTagName('sld:MinScaleDenominator')[0].innerHTML);\n\t\t\t\t\t\tvar zmin = getZoom(c.getElementsByTagName('sld:MaxScaleDenominator')[0].innerHTML);\n\t\t\t\t\t\tif (zmin > ori.maxZoom) ori.maxZoom = zmin;\n\t\t\t\t\t\tif (zmin < ori.minZoom) ori.minZoom = zmin;\n\t\t\t\t\t\tif (zmax>ori.maxZoom) ori.maxZoom = zmax;\n\t\t\t\t\t\tif (zmax<ori.minZoom) ori.minZoom = zmax;\n\t\t\t\t\t\tori.constraint.push({\n              minZoom: zmin,\n\t\t\t\t\t\t\tmaxZoom: zmax,\n\t\t\t\t\t\t\tbbox: JSON.parse('['+c.getElementsByTagName('gpp:BoundingBox')[0].innerHTML+']')\n\t\t\t\t\t\t});\n          }\n          // Merge constraints\n          mergeConstraints(ori)\n        }\n        capabilities[service.layer] = service;\n      }\n      onSuccess(capabilities);\n      onFinally(capabilities);\n    }\n  });\n  // Promise like response\n  var response = {\n    then: function (callback) {\n      if (typeof(callback)==='function') onSuccess = callback;\n      return response;\n    },\n    catch: function (callback) {\n      if (typeof(callback)==='function') onError = callback;\n      return response;\n    },\n    finally: function (callback) {\n      if (typeof(callback)==='function') onFinally = callback;\n      return response;\n    },\n  }\n  return response;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Return a preview image of the source.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {String} the preview url\n * @api\n */\nol.source.Source.prototype.getPreview = function(/*lonlat, resolution*/) {\n\treturn \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAk6QAAJOkBUCTn+AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANeSURBVHic7ZpPiE1RHMc/780MBhkik79JSUlIUbOxI+wkI2yRhYSUlJLNpJF/xcpiJBmZGBZsNM1CkmhKITGkGbH0/BuPmXnP4rxbb/TOn3fvOffeec6nfqvb/b7f93fveeec37ng8Xg8Ho/nf6Uu4d+fDswFssCvhHOJhaXAMeApMAQUyyIPPAdOAiuTStAVy4EHjDWsix5gdRLJ2mY34ulWYz6IEeA4kIk9awtkgTOEM/5vdAKT4k0/Ou3YMR/ELcbRm9AKFLBbgCJwNE4TYZkJfMG++SIwDCyLz0o4bI17WdyJz0r1TAZ+oDcxCBwAFgIzEIuhvcBbg3sLwOK4DFXLFvQGniCGSSUagS4DjUPOHESkA3XiOWCORqMR6Nfo9DjI3QqPUSd+ylBnv0Zn0GrWFvmIOvGNhjqrNDp/EAutyFgRKUM2tgO+Gur81FxvAKYZaimxXYBvmuuLDHWWaK4X0RfJCNsF6NdcbzXU2a65PohYFKWOc+jn8PUajbWIXaBKp9NB7lZYh34OzwFbFfd/NtDYYSth27urLGIm0M31AL3APWAAmIooymaDnPIl/Vz4NN1yHrd7gcvxWQnHAuA3bsyPop8hUsE13BSgK04TUViBeFo2zedJ8S6wElexW4D2eNOPTjNi6WvD/DtEr8E6tk6GGoAmxFY2iFHE9NZiQf8gogiB9gTEH23izAZuE77vHyU+ANucO1QwD3hD/MbLowAcdm20EmkwXx4n3NodS9rMB2HabYpEWs0HcRqHp0fNwAvJD+eBTZr7p6BvmQVxUaEzEbiruNfJekH15L8jtrEm7JJolEcOmKXRqQOuKDQuY7HZY8s8iNfzkSLxIuI43FTrkkLnOlBfRW4VsWk+oAX5weknxFAxJQNckGgVgZuIRVoomoGXEmGTMa+iQ6K7M4SW7k24QYgiuDQPYinbhugiF4H3RGtzZYCzyIvQXfpNI1ybLyeLpf5+iTbkRbiP2EcocTHm4+YI8iI8RFHwWjAfsA95Q+YZFU6wasl8wB7kReijtNbIILa0vcg/PRlGfPQwHmlCviDqAzaA+OREtzqr1ejOIDorxlNEjTGUBV4nnUWCvAJxGDlA8q9j3DEArAn2zvXAfOwfl6eVAmJrPpJ0Ih6Px+PxeJLjLwPul3vj5d0eAAAAAElFTkSuQmCC\";\n};\n/**\n * Return the tile image of the source.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {String} the preview url\n * @api\n */\nol.source.Tile.prototype.getPreview = function(lonlat, resolution)\n{\tif (!lonlat) lonlat = [21020, 6355964];\n\tif (!resolution) resolution = 150;\n\tvar coord = this.getTileGrid().getTileCoordForCoordAndResolution(lonlat, resolution);\n\tvar fn = this.getTileUrlFunction();\n\treturn fn.call(this, coord, this.getProjection());\n};\n/**\n * Return the tile image of the source.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {String} the preview url\n * @api\n */\nol.source.TileWMS.prototype.getPreview = function(lonlat, resolution)\n{\tif (!lonlat) lonlat = [21020, 6355964];\n\tif (!resolution) resolution = 150;\n/*\tNo way to acces tileUrlFunction...\n\tvar fn = this.getTileUrlFunction();\n\treturn fn.call(this, lonlat, this.getProjection());\n*/\n\t// Use getfeature info instead\n\tvar url = this.getGetFeatureInfoUrl ? \n\t\tthis.getGetFeatureInfoUrl(lonlat, resolution, this.getProjection() || 'EPSG:3857', {})\n\t\t: this.getFeatureInfoUrl(lonlat, resolution, this.getProjection() || 'EPSG:3857', {});\n\turl = url.replace(/getfeatureinfo/i,\"GetMap\");\n\treturn url;\n};\n/**\n * Return a preview for the layer.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {Array<String>} list of preview url\n * @api\n */\nol.layer.Base.prototype.getPreview = function(lonlat, resolution)\n{\tif (this.get(\"preview\")) return [ this.get(\"preview\") ];\n\tif (!resolution) resolution = 150;\n\t// Get middle resolution\n\tif (resolution < this.getMinResolution() || resolution > this.getMaxResolution()) \n\t{\tvar rmin = this.getMinResolution(),\n\t\t\trmax = this.getMaxResolution();\n\t\tif (rmax>100000) rmax = 156543;\t// min zoom : world\n\t\tif (rmin<0.15) rmin = 0.15;\t// max zoom \n\t\tresolution = rmax;\n\t\twhile (rmax>rmin) \n\t\t{\trmin *= 2;\n\t\t\trmax /= 2;\n\t\t\tresolution = rmin;\n\t\t}\n\t}\n\tvar e = this.getExtent();\n\tif (!lonlat) lonlat = [21020, 6355964];\t// Default lonlat\n\tif (e && !ol.extent.containsCoordinate(e,lonlat)) lonlat = [ (e[0]+e[2])/2, (e[1]+e[3])/2 ];\n\tif (this.getSource) return [ this.getSource().getPreview(lonlat, resolution) ];\n\treturn [];\n};\n/**\n * Return a preview for the layer.\n * @param {_ol_coordinate_|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {Array<String>} list of preview url\n * @api\n */\nol.layer.Group.prototype.getPreview = function(lonlat, resolution)\n{\tif (this.get(\"preview\")) return [ this.get(\"preview\") ];\n\tvar t = [];\n\tif (this.getLayers) \n\t{\tvar l = this.getLayers().getArray();\n\t\tfor (var i=0; i<l.length; i++) \n\t\t{\tt = t.concat(l[i].getPreview(lonlat, resolution));\n\t\t}\n\t}\n\treturn t;\n};\n//NB: (Not confirmed)To use this module, you just have to :\n\t\t\t\t//   import('ol-ext/layer/getpreview')\n\n/** ol.layer.Vector.prototype.setRender3D\n * @extends {ol.layer.Vector}\n * @param {ol.render3D}\n */\nol.layer.Vector.prototype.setRender3D = function (r) {\n  r.setLayer(this);\n}\n/** \n * @classdesc\n *ol.render3D 3D vector layer rendering\n * @constructor\n * @param {Object} param\n *  @param {ol.layer.Vector} param.layer the layer to display in 3D\n *  @param {ol.style.Style} options.styler drawing style\n *  @param {number} param.maxResolution  max resolution to render 3D\n *  @param {number} param.defaultHeight default height if none is return by a propertie\n *  @param {function|string|Number} param.height a height function (returns height giving a feature) or a popertie name for the height or a fixed value\n */\nol.render3D = function (options) {\n  options = options || {};\n  options.maxResolution = options.maxResolution || 100\n  options.defaultHeight = options.defaultHeight || 0;\n  ol.Object.call (this, options);\n  this.setStyle(options.style);\n  this.height_ = options.height = this.getHfn (options.height);\n  if (options.layer) this.setLayer(options.layer);\n}\nol.ext.inherits(ol.render3D, ol.Object);\n/**\n * Set style associated with the renderer\n * @param {ol.style.Style} s\n */\nol.render3D.prototype.setStyle = function(s) {\n  if (s instanceof ol.style.Style) this._style = s;\n  else this._style = new ol.style.Style ();\n  if (!this._style.getStroke()) {\n    this._style.setStroke(new ol.style.Stroke({\n      width: 1,\n      color: 'red'\n    }));\n  }\n  if (!this._style.getFill()) {\n    this._style.setFill( new ol.style.Fill({ color: 'rgba(0,0,255,0.5)'}) );\n  }\n  // Get the geometry\n  if (s && s.getGeometry()) {\n    var geom = s.getGeometry();\n    if (typeof(geom)==='function') {\n      this.set('geometry', geom);\n    } else {\n      this.set('geometry', function() { return geom; });\n    }\n  } else {\n    this.set('geometry', function(f) { return f.getGeometry(); });\n  }\n};\n/**\n * Get style associated with the renderer\n * @return {ol.style.Style}\n */\nol.render3D.prototype.getStyle = function() {\n  return this._style;\n};\n/** Calculate 3D at potcompose\n*/\nol.render3D.prototype.onPostcompose_ = function(e) {\n  var res = e.frameState.viewState.resolution;\n  if (res > this.get('maxResolution')) return;\n  this.res_ = res*400;\n  if (this.animate_) {\n    var elapsed = e.frameState.time - this.animate_;\n    if (elapsed < this.animateDuration_) {\n      this.elapsedRatio_ = this.easing_(elapsed / this.animateDuration_);\n      // tell OL3 to continue postcompose animation\n      e.frameState.animate = true;\n    } else {\n      this.animate_ = false;\n      this.height_ = this.toHeight_\n    }\n  }\n  var ratio = e.frameState.pixelRatio;\n  var ctx = e.context;\n  var m = this.matrix_ = e.frameState.coordinateToPixelTransform;\n  // Old version (matrix)\n  if (!m) {\n    m = e.frameState.coordinateToPixelMatrix,\n    m[2] = m[4];\n    m[3] = m[5];\n    m[4] = m[12];\n    m[5] = m[13];\n  }\n  this.center_ = [ ctx.canvas.width/2/ratio, ctx.canvas.height/ratio ];\n  var f = this.layer_.getSource().getFeaturesInExtent(e.frameState.extent);\n  ctx.save();\n    ctx.scale(ratio,ratio);\n    var s = this.getStyle();\n    ctx.lineWidth = s.getStroke().getWidth();\n    ctx.strokeStyle = ol.color.asString(s.getStroke().getColor());\n    ctx.fillStyle = ol.color.asString(s.getFill().getColor());\n    var builds = [];\n    for (var i=0; i<f.length; i++) {\n      builds.push (this.getFeature3D_ (f[i], this.getFeatureHeight(f[i])));\n    }\n    this.drawFeature3D_ (ctx, builds);\n  ctx.restore();\n};\n/** Set layer to render 3D\n*/\nol.render3D.prototype.setLayer = function(l) {\n  if (this._listener) {\n    this._listener.forEach( function(l) { \n      ol.Observable.unByKey(l); \n    });\n  }\n  this.layer_ = l;\n  this._listener = l.on (['postcompose', 'postrender'], this.onPostcompose_.bind(this));\n}\n/** Create a function that return height of a feature\n*\t@param {function|string|number} h a height function or a popertie name or a fixed value\n*\t@return {function} function(f) return height of the feature f\n*/\nol.render3D.prototype.getHfn= function(h) {\n  switch (typeof(h)) {\n    case 'function': return h;\n    case 'string': {\n      var dh = this.get('defaultHeight');\n        return (function(f) {\n          return (Number(f.get(h)) || dh); \n        });\n      }\n    case 'number': return (function(/*f*/) { return h; });\n    default: return (function(/*f*/) { return 10; });\n  }\n}\n/** Animate rendering\n * @param {olx.render3D.animateOptions}\n *  @param {string|function|number} param.height an attribute name or a function returning height of a feature or a fixed value\n *  @param {number} param.duration the duration of the animatioin ms, default 1000\n *  @param {ol.easing} param.easing an ol easing function\n *\t@api\n */\nol.render3D.prototype.animate = function(options) {\n  options = options || {};\n  this.toHeight_ = this.getHfn(options.height);\n  this.animate_ = new Date().getTime();\n  this.animateDuration_ = options.duration ||1000;\n  this.easing_ = options.easing || ol.easing.easeOut;\n  // Force redraw\n  this.layer_.changed();\n}\n/** Check if animation is on\n*\t@return {bool}\n*/\nol.render3D.prototype.animating = function() {\n  if (this.animate_ && new Date().getTime() - this.animate_ > this.animateDuration_) {\n    this.animate_ = false;\n  }\n  return !!this.animate_;\n}\n/** \n*/\nol.render3D.prototype.getFeatureHeight = function (f) {\n  if (this.animate_) {\n    var h1 = this.height_(f);\n    var h2 = this.toHeight_(f);\n    return (h1*(1-this.elapsedRatio_)+this.elapsedRatio_*h2);\n  }\n  else return this.height_(f);\n};\n/**\n*/\nol.render3D.prototype.hvector_ = function (pt, h) {\n  var p0 = [\n    pt[0]*this.matrix_[0] + pt[1]*this.matrix_[1] + this.matrix_[4],\n    pt[0]*this.matrix_[2] + pt[1]*this.matrix_[3] + this.matrix_[5]\n  ];\n  return {\n    p0: p0, \n    p1: [\n      p0[0] + h/this.res_ * (p0[0]-this.center_[0]),\n      p0[1] + h/this.res_ * (p0[1]-this.center_[1])\n    ]\n  };\n};\n/**\n*/\nol.render3D.prototype.getFeature3D_ = function (f, h) {\n  var geom = this.get('geometry')(f);\n  var c = geom.getCoordinates();\n  switch (geom.getType()) {\n    case \"Polygon\":\n      c = [c];\n    // fallthrough\n    case \"MultiPolygon\":\n      var build = [];\n      for (var i=0; i<c.length; i++) {\n        for (var j=0; j<c[i].length; j++) {\n          var b = [];\n          for (var k=0; k<c[i][j].length; k++) {\n            b.push( this.hvector_(c[i][j][k], h) );\n          }\n          build.push(b);\n        }\n      }\n      return { type:\"MultiPolygon\", feature: f, geom: build };\n    case \"Point\":\n      return { type:\"Point\", feature: f, geom: this.hvector_(c,h) };\n    default: return {};\n  }\n}\n/**\n*/\nol.render3D.prototype.drawFeature3D_ = function(ctx, build) {\n  var i,j, b, k;\n  // Construct\n  for (i=0; i<build.length; i++) {\t\n    switch (build[i].type) {\n      case \"MultiPolygon\": {\n        for (j=0; j<build[i].geom.length; j++) {\n          b = build[i].geom[j];\n          for (k=0; k < b.length; k++) {\n            ctx.beginPath();\n            ctx.moveTo(b[k].p0[0], b[k].p0[1]);\n            ctx.lineTo(b[k].p1[0], b[k].p1[1]);\n            ctx.stroke();\n          }\n        }\n        break;\n      }\n      case \"Point\": {\n        var g = build[i].geom;\n          ctx.beginPath();\n          ctx.moveTo(g.p0[0], g.p0[1]);\n          ctx.lineTo(g.p1[0], g.p1[1]);\n          ctx.stroke();\n          break;\n        }\n      default: break;\n    }\n  }\n  // Roof\n  for (i=0; i<build.length; i++) {\n    switch (build[i].type) {\n      case \"MultiPolygon\": {\n        ctx.beginPath();\n        for (j=0; j<build[i].geom.length; j++) {\n          b = build[i].geom[j];\n          if (j==0) {\n            ctx.moveTo(b[0].p1[0], b[0].p1[1]);\n            for (k=1; k < b.length; k++) {\n              ctx.lineTo(b[k].p1[0], b[k].p1[1]);\n            }\n          } else {\n            ctx.moveTo(b[0].p1[0], b[0].p1[1]);\n            for (k=b.length-2; k>=0; k--) {\n              ctx.lineTo(b[k].p1[0], b[k].p1[1]);\n            }\n          }\n          ctx.closePath();\n        }\n        ctx.fill(\"evenodd\");\n        ctx.stroke();\n        break;\n      }\n      case \"Point\": {\n        b = build[i];\n        var t = b.feature.get('label');\n        if (t) {\n          var p = b.geom.p1;\n          var f = ctx.fillStyle;\n          ctx.fillStyle = ctx.strokeStyle;\n          ctx.textAlign = 'center';\n          ctx.textBaseline = 'bottom';\n          ctx.fillText ( t, p[0], p[1] );\n          var m = ctx.measureText(t);\n          var h = Number (ctx.font.match(/\\d+(\\.\\d+)?/g).join([]));\n          ctx.fillStyle = \"rgba(255,255,255,0.5)\";\n          ctx.fillRect (p[0]-m.width/2 -5, p[1]-h -5, m.width +10, h +10)\n          ctx.strokeRect (p[0]-m.width/2 -5, p[1]-h -5, m.width +10, h +10)\n          ctx.fillStyle = f;\n          //console.log(build[i].feature.getProperties())\n        }\n        break;\n      }\n      default: break;\n    }\n  }\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * A popup element to be displayed over the map and attached to a single map\n * location. The popup are customized using CSS.\n *\n * @example\nvar popup = new ol.Overlay.Popup();\nmap.addOverlay(popup);\npopup.show(coordinate, \"Hello!\");\npopup.hide();\n*\n* @constructor\n* @extends {ol.Overlay}\n* @param {} options Extend Overlay options \n*\t@param {String} options.popupClass the a class of the overlay to style the popup.\n*\t@param {bool} options.closeBox popup has a close box, default false.\n*\t@param {function|undefined} options.onclose: callback function when popup is closed\n*\t@param {function|undefined} options.onshow callback function when popup is shown\n*\t@param {Number|Array<number>} options.offsetBox an offset box\n*\t@param {ol.OverlayPositioning | string | undefined} options.positioning \n*\t\tthe 'auto' positioning var the popup choose its positioning to stay on the map.\n* @api stable\n*/\nol.Overlay.Popup = function (options) {\n  var self = this;\n  options = options || {};\n  if (typeof(options.offsetBox)==='number') this.offsetBox = [options.offsetBox,options.offsetBox,options.offsetBox,options.offsetBox];\n  else this.offsetBox = options.offsetBox;\n  // Popup div\n  var element = document.createElement(\"div\");\n  //element.classList.add('ol-overlaycontainer-stopevent');\n  options.element = element;\n  // Anchor div\n  var anchorElement = document.createElement(\"div\");\n  anchorElement.classList.add(\"anchor\");\n  element.appendChild(anchorElement);\n  // Content\n  this.content = ol.ext.element.create(\"div\", { \n    html: options.html || '',\n    className: \"ol-popup-content\",\n    parent: element\n  });\n  // Closebox\n  this.closeBox = options.closeBox;\n  this.onclose = options.onclose;\n  this.onshow = options.onshow;\n  var button = document.createElement(\"button\");\n  button.classList.add(\"closeBox\");\n  if (options.closeBox) button.classList.add('hasclosebox');\n  button.setAttribute('type', 'button');\n  element.insertBefore(button, anchorElement);\n  button.addEventListener(\"click\", function() {\n    self.hide();\n  });\n  // Stop event\n  if (options.stopEvent) {\n    element.addEventListener(\"mousedown\", function(e){ e.stopPropagation(); });\n    element.addEventListener(\"touchstart\", function(e){ e.stopPropagation(); });\n  }\n  ol.Overlay.call(this, options);\n  this._elt = this.element;\n  // call setPositioning first in constructor so getClassPositioning is called only once\n  this.setPositioning(options.positioning || 'auto');\n  this.setPopupClass(options.popupClass || options.className || 'default');\n  // Show popup on timeout (for animation purposes)\n  if (options.position) {\n    setTimeout(function(){ this.show(options.position); }.bind(this));\n  }\n};\nol.ext.inherits(ol.Overlay.Popup, ol.Overlay);\n/**\n * Get CSS class of the popup according to its positioning.\n * @private\n */\nol.Overlay.Popup.prototype.getClassPositioning = function () {\n  var c = \"\";\n  var pos = this.getPositioning();\n  if (/bottom/.test(pos)) c += \"ol-popup-bottom \";\n  if (/top/.test(pos)) c += \"ol-popup-top \";\n  if (/left/.test(pos)) c += \"ol-popup-left \";\n  if (/right/.test(pos)) c += \"ol-popup-right \";\n  if (/^center/.test(pos)) c += \"ol-popup-middle \";\n  if (/center$/.test(pos)) c += \"ol-popup-center \";\n  return c;\n};\n/**\n * Set a close box to the popup.\n * @param {bool} b\n * @api stable\n */\nol.Overlay.Popup.prototype.setClosebox = function (b) {\n  this.closeBox = b;\n  if (b) this._elt.classList.add(\"hasclosebox\");\n  else this._elt.classList.remove(\"hasclosebox\");\n};\n/**\n * Set the CSS class of the popup.\n * @param {string} c class name.\n * @api stable\n */\nol.Overlay.Popup.prototype.setPopupClass = function (c) {\n  this._elt.className = \"\";\n    var classesPositioning = this.getClassPositioning().split(' ')\n      .filter(function(className) {\n        return className.length > 0;\n      });\n    var classes = [\"ol-popup\"];\n    if (c) {\n      c.split(' ').filter(function(className) {\n        return className.length > 0;\n      })\n      .forEach(function(className) {\n        classes.push(className);\n      });\n    } else {\n      classes.push(\"default\");\n    }\n      classesPositioning.forEach(function(className) {\n        classes.push(className);\n      });\n    if (this.closeBox) {\n      classes.push(\"hasclosebox\");\n    }\n    this._elt.classList.add.apply(this._elt.classList, classes);\n};\n/**\n * Add a CSS class to the popup.\n * @param {string} c class name.\n * @api stable\n */\nol.Overlay.Popup.prototype.addPopupClass = function (c) {\n  this._elt.classList.add(c);\n};\n/**\n * Remove a CSS class to the popup.\n * @param {string} c class name.\n * @api stable\n */\nol.Overlay.Popup.prototype.removePopupClass = function (c) {\n  this._elt.classList.remove(c);\n};\n/**\n * Set positionning of the popup\n * @param {ol.OverlayPositioning | string | undefined} pos an ol.OverlayPositioning \n * \t\tor 'auto' to var the popup choose the best position\n * @api stable\n */\nol.Overlay.Popup.prototype.setPositioning = function (pos) {\n  if (pos === undefined)\n    return;\n  if (/auto/.test(pos)) {\n    this.autoPositioning = pos.split('-');\n    if (this.autoPositioning.length==1) this.autoPositioning[1]=\"auto\";\n  }\n  else this.autoPositioning = false;\n  pos = pos.replace(/auto/g,\"center\");\n  if (pos==\"center\") pos = \"bottom-center\";\n  this.setPositioning_(pos);\n};\n/** @private\n * @param {ol.OverlayPositioning | string | undefined} pos\n */\nol.Overlay.Popup.prototype.setPositioning_ = function (pos) {\n  if (this._elt) {\n    ol.Overlay.prototype.setPositioning.call(this, pos);\n    this._elt.classList.remove(\"ol-popup-top\", \"ol-popup-bottom\", \"ol-popup-left\", \"ol-popup-right\", \"ol-popup-center\", \"ol-popup-middle\");\n    var classes = this.getClassPositioning().split(' ')\n      .filter(function(className) {\n        return className.length > 0;\n      });\n    this._elt.classList.add.apply(this._elt.classList, classes);\n  }\n};\n/** Check if popup is visible\n* @return {boolean}\n*/\nol.Overlay.Popup.prototype.getVisible = function () {\n  return this._elt.classList.contains(\"visible\");\n};\n/**\n * Set the position and the content of the popup.\n * @param {ol.Coordinate|string} coordinate the coordinate of the popup or the HTML content.\n * @param {string|undefined} html the HTML content (undefined = previous content).\n * @example\nvar popup = new ol.Overlay.Popup();\n// Show popup\npopup.show([166000, 5992000], \"Hello world!\");\n// Move popup at coord with the same info\npopup.show([167000, 5990000]);\n// set new info\npopup.show(\"New informations\");\n* @api stable\n*/\nol.Overlay.Popup.prototype.show = function (coordinate, html) {\n  if (!html && typeof(coordinate)=='string') {\n    html = coordinate; \n    coordinate = null;\n  }\n  if (coordinate===true) {\n    coordinate = this.getPosition();\n  }\n  var self = this;\n  var map = this.getMap();\n  if (!map) return;\n  if (html && html !== this.prevHTML) {\n    // Prevent flickering effect\n    this.prevHTML = html;\n    this.content.innerHTML = \"\";\n    if (html instanceof Element) {\n      this.content.appendChild(html);\n    } else {\n      this.content.insertAdjacentHTML('beforeend', html);\n    }\n    // Refresh when loaded (img)\n    Array.prototype.slice.call(this.content.querySelectorAll('img'))\n      .forEach(function(image) {\n        image.addEventListener(\"load\", function() {\n          map.renderSync();\n        });\n      });\n  }\n  if (coordinate) {\n    // Auto positionning\n    if (this.autoPositioning) {\n      var p = map.getPixelFromCoordinate(coordinate);\n      var s = map.getSize();\n      var pos=[];\n      if (this.autoPositioning[0]=='auto') {\n        pos[0] = (p[1]<s[1]/3) ? \"top\" : \"bottom\";\n      }\n      else pos[0] = this.autoPositioning[0];\n      pos[1] = (p[0]<2*s[0]/3) ? \"left\" : \"right\";\n      this.setPositioning_(pos[0]+\"-\"+pos[1]);\n      if (this.offsetBox) {\n        this.setOffset([this.offsetBox[pos[1]==\"left\"?2:0], this.offsetBox[pos[0]==\"top\"?3:1] ]);\n      }\n    } else {\n      if (this.offsetBox){\n        this.setOffset(this.offsetBox);\n      }\n    }\n    // Show\n    this.setPosition(coordinate);\n    // Set visible class (wait to compute the size/position first)\n    this._elt.parentElement.style.display = '';\n    if (typeof (this.onshow) == 'function') this.onshow();\n    this._tout = setTimeout (function() {\n      self._elt.classList.add(\"visible\"); \n    }, 0);\n  }\n};\n/**\n * Hide the popup\n * @api stable\n */\nol.Overlay.Popup.prototype.hide = function () {\n  if (this.getPosition() == undefined) return;\n  if (typeof (this.onclose) == 'function') this.onclose();\n  this.setPosition(undefined);\n  if (this._tout) clearTimeout(this._tout);\n  this._elt.classList.remove(\"visible\");\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n *\tThe Magnify overlay add a \"magnifying glass\" effect to an OL3 map that displays \n *\ta portion of the map in a different zoom (and actually display different content).\n *\n * @constructor\n * @extends {ol.Overlay}\n * @param {olx.OverlayOptions} options Overlay options \n * @api stable\n */\nol.Overlay.Magnify = function (options) {\n\tvar elt = document.createElement(\"div\");\n\t\t\telt.className = \"ol-magnify\";\n\tthis._elt = elt;\n\tol.Overlay.call(this,\n\t\t{\tpositioning: options.positioning || \"center-center\",\n\t\t\telement: this._elt,\n\t\t\tstopEvent: false\n\t\t});\n\t// Create magnify map\n\tthis.mgmap_ = new ol.Map(\n\t{\tcontrols: new ol.Collection(),\n\t\tinteractions: new ol.Collection(),\n\t\ttarget: options.target || this._elt,\n\t\tview: new ol.View({ projection: options.projection }),\n\t\tlayers: options.layers\n\t});\n\tthis.mgview_ = this.mgmap_.getView();\n\tthis.external_ = options.target?true:false;\n\tthis.set(\"zoomOffset\", options.zoomOffset||1);\n\tthis.set(\"active\", true);\n\tthis.on(\"propertychange\", this.setView_.bind(this));\n};\nol.ext.inherits(ol.Overlay.Magnify, ol.Overlay);\n/**\n * Set the map instance the overlay is associated with.\n * @param {ol.Map} map The map instance.\n */\nol.Overlay.Magnify.prototype.setMap = function(map) {\n\tif (this.getMap()) {\n\t\tthis.getMap().getViewport().removeEventListener(\"mousemove\", this.onMouseMove_);\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.Overlay.prototype.setMap.call(this, map);\n\tmap.getViewport().addEventListener(\"mousemove\", this.onMouseMove_.bind(this));\n\tthis._listener = map.getView().on('propertychange', this.setView_.bind(this));\n\tthis.setView_();\n};\n/** Get the magnifier map\n*\t@return {_ol_Map_}\n*/\nol.Overlay.Magnify.prototype.getMagMap = function()\n{\treturn this.mgmap_;\n};\n/** Magnify is active\n*\t@return {boolean}\n*/\nol.Overlay.Magnify.prototype.getActive = function()\n{\treturn this.get(\"active\");\n};\n/** Activate or deactivate\n*\t@param {boolean} active\n*/\nol.Overlay.Magnify.prototype.setActive = function(active)\n{\treturn this.set(\"active\", active);\n};\n/** Mouse move\n * @private\n */\nol.Overlay.Magnify.prototype.onMouseMove_ = function(e)\n{\tvar self = this;\n\tif (!self.get(\"active\"))\n\t{\tself.setPosition();\n\t}\n\telse\n\t{\tvar px = self.getMap().getEventCoordinate(e);\n\t\tif (!self.external_) self.setPosition(px);\n\t\tself.mgview_.setCenter(px);\n\t\tif (self._elt.querySelector('canvas').style.display ==\"none\") self.mgmap_.updateSize();\n\t}\n};\n/** View has changed\n * @private\n */\nol.Overlay.Magnify.prototype.setView_ = function(e)\n{\tif (!this.get(\"active\"))\n\t{\tthis.setPosition();\n\t\treturn;\n\t}\n\tif (!e)\n\t{\t// refresh all\n\t\tthis.setView_({key:'rotation'});\n\t\tthis.setView_({key:'resolution'});\n\t\treturn;\n\t}\n\t// Set the view params\n\tswitch (e.key)\n\t{\tcase 'rotation':\n\t\t\tthis.mgview_.setRotation(this.getMap().getView().getRotation());\n\t\t\tbreak;\n\t\tcase 'zoomOffset':\n\t\tcase 'resolution':\n\t\t{\tvar z = Math.max(0,this.getMap().getView().getZoom()+Number(this.get(\"zoomOffset\")));\n\t\t\tthis.mgview_.setZoom(z);\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * A placemark element to be displayed over the map and attached to a single map\n * location. The placemarks are customized using CSS.\n *\n * @example\nvar popup = new ol.Overlay.Placemark();\nmap.addOverlay(popup);\npopup.show(coordinate);\npopup.hide();\n*\n* @constructor\n* @extends {ol.Overlay}\n* @param {} options Extend ol/Overlay/Popup options \n*\t@param {String} options.color placemark color\n*\t@param {String} options.backgroundColor placemark color\n*\t@param {String} options.contentColor placemark color\n*\t@param {Number} options.radius placemark radius in pixel\n*\t@param {String} options.popupClass the a class of the overlay to style the popup.\n*\t@param {function|undefined} options.onclose: callback function when popup is closed\n*\t@param {function|undefined} options.onshow callback function when popup is shown\n* @api stable\n*/\nol.Overlay.Placemark = function (options) {\n  options = options || {};\n  options.popupClass = (options.popupClass || '') + ' placemark anim'\n  options.positioning = 'bottom-center',\n  ol.Overlay.Popup.call(this, options);\n  this.setPositioning = function(){};\n  if (options.color) this.element.style.color = options.color;\n  if (options.backgroundColor ) this.element.style.backgroundColor  = options.backgroundColor ;\n  if (options.contentColor ) this.setContentColor(options.contentColor);\n  if (options.size) this.setRadius(options.size);\n};\nol.ext.inherits(ol.Overlay.Placemark, ol.Overlay.Popup);\n/**\n * Set the position and the content of the placemark (hide it before to enable animation).\n * @param {ol.Coordinate|string} coordinate the coordinate of the popup or the HTML content.\n * @param {string|undefined} html the HTML content (undefined = previous content).\n */\nol.Overlay.Placemark.prototype.show = function(coordinate, html) {\n  if (coordinate===true) {\n    coordinate = this.getPosition();\n  }\n  this.hide();\n  ol.Overlay.Popup.prototype.show.apply(this, [coordinate, html]);\n};\n/**\n * Set the placemark color.\n * @param {string} color\n */\nol.Overlay.Placemark.prototype.setColor = function(color) {\n  this.element.style.color = color;\n};\n/**\n * Set the placemark background color.\n * @param {string} color\n */\nol.Overlay.Placemark.prototype.setBackgroundColor = function(color) {\n  this.element.style.backgroundColor = color;\n};\n/**\n * Set the placemark content color.\n * @param {string} color\n */\nol.Overlay.Placemark.prototype.setContentColor = function(color) {\n  var c = this.element.getElementsByClassName('ol-popup-content')[0];\n  if (c) c.style.color = color;\n};\n/**\n * Set the placemark class.\n * @param {string} name\n */\nol.Overlay.Placemark.prototype.setClassName = function(name) {\n  var oldclass = this.element.className;\n  this.element.className = 'ol-popup placemark ol-popup-bottom ol-popup-center ' \n    + (/visible/.test(oldclass) ? 'visible ' : '')\n    + (/anim/.test(oldclass) ? 'anim ' : '')\n    + name;\n};\n/**\n * Set the placemark radius.\n * @param {number} size size in pixel\n */\nol.Overlay.Placemark.prototype.setRadius = function(size) {\n  this.element.style.fontSize = size + 'px';\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Template attributes for popup\n * @typedef {Object} TemplateAttributes\n * @property {string} title\n * @property {function} format a function that takes an attribute and a feature and returns the formated attribute\n * @property {string} before string to instert before the attribute (prefix)\n * @property {string} after string to instert after the attribute (sudfix)\n * @property {boolean|function} visible boolean or a function (feature, value) that decides the visibility of a attribute entry\n */\n/** Template \n * @typedef {Object} Template\n * @property {string|function} title title of the popup, attribute name or a function that takes a feature and returns the title\n * @property {Object.<TemplateAttributes>} attributes a list of template attributes \n */\n/**\n * A popup element to be displayed on a feature.\n *\n * @constructor\n * @extends {ol.Overlay.Popup}\n * @param {} options Extend Popup options \n *  @param {String} options.popupClass the a class of the overlay to style the popup.\n *  @param {bool} options.closeBox popup has a close box, default false.\n *  @param {function|undefined} options.onclose: callback function when popup is closed\n *  @param {function|undefined} options.onshow callback function when popup is shown\n *  @param {Number|Array<number>} options.offsetBox an offset box\n *  @param {ol.OverlayPositioning | string | undefined} options.positionning \n *    the 'auto' positioning var the popup choose its positioning to stay on the map.\n *  @param {Template} options.template A template with a list of properties to use in the popup\n *  @param {boolean} options.canFix Enable popup to be fixed, default false\n *  @param {boolean} options.showImage display image url as image, default false\n *  @param {boolean} options.maxChar max char to display in a cell, default 200\n *  @api stable\n */\nol.Overlay.PopupFeature = function (options) {\n  options = options || {};\n  ol.Overlay.Popup.call(this, options);\n  this.setTemplate(options.template);\n  this.set('canFix', options.canFix)\n  this.set('showImage', options.showImage)\n  this.set('maxChar', options.maxChar||200)\n  // Bind with a select interaction\n  if (options.select && (typeof options.select.on ==='function')) {\n    this._select = options.select;\n    options.select.on('select', function(e){\n      if (!this._noselect) this.show(e.mapBrowserEvent.coordinate, options.select.getFeatures().getArray());\n    }.bind(this));\n  }\n};\nol.ext.inherits(ol.Overlay.PopupFeature, ol.Overlay.Popup);\n/** Set the template\n * @param {Template} template A template with a list of properties to use in the popup\n */\nol.Overlay.PopupFeature.prototype.setTemplate = function(template) {\n  this._template = template;\n  if (this._template && this._template.attributes instanceof Array) {\n    var att = {};\n    this._template.attributes.forEach(function (a) {\n      att[a] = true;\n    });\n    this._template.attributes = att;\n  }\n};\n/** Show the popup on the map\n * @param {ol.coordinate|undefined} coordinate Position of the popup\n * @param {ol.Feature|Array<ol.Feature>} features The features on the popup\n */\nol.Overlay.PopupFeature.prototype.show = function(coordinate, features) {\n  if (coordinate instanceof ol.Feature \n    || (coordinate instanceof Array && coordinate[0] instanceof ol.Feature)) {\n    features = coordinate;\n    coordinate = null;\n  }\n  if (!(features instanceof Array)) features = [features];\n  this._features = features.slice();\n  if (!this._count) this._count = 1;\n  // Calculate html upon feaures attributes\n  this._count = 1;\n  var html = this._getHtml(features[0]);\n  this.hide();\n  if (html) {\n    if (!coordinate || features[0].getGeometry().getType()==='Point') {\n      coordinate = features[0].getGeometry().getFirstCoordinate();\n    }\n    ol.Overlay.Popup.prototype.show.call(this, coordinate, html);\n  }\n};\n/**\n * @private\n */\nol.Overlay.PopupFeature.prototype._getHtml = function(feature) {\n  if (!feature) return '';\n  var html = ol.ext.element.create('DIV', { className: 'ol-popupfeature' });\n  if (this.get('canFix')) {\n    ol.ext.element.create('I', { className:'ol-fix', parent: html })\n      .addEventListener('click', function(){\n        this.element.classList.toggle('ol-fixed');\n      }.bind(this));\n  }\n  var template = this._template;\n  // calculate template\n  if (!template || !template.attributes) {\n    template = template || {};\n    template. attributes = {};\n    for (var i in feature.getProperties()) if (i!='geometry') {\n      template.attributes[i] = i;\n    }\n  }\n  // Display title\n  if (template.title) {\n    var title;\n    if (typeof template.title === 'function') {\n      title = template.title(feature);\n    } else {\n      title = feature.get(template.title);\n    }\n    ol.ext.element.create('H1', { html:title, parent: html });\n  }\n  // Display properties in a table\n  if (template.attributes) {\n    var tr, table = ol.ext.element.create('TABLE', { parent: html });\n    var atts = template.attributes;\n    for (var att in atts) {\n      var a = atts[att];\n      var content, val = feature.get(att);\n      // Get calculated value\n      if (typeof(a.format)==='function') {\n        val = a.format(val, feature);\n      }\n      // Is entry visible?\n      var visible = true;\n      if (typeof(a.visible)==='boolean') {\n        visible = a.visible;\n      } else if (typeof(a.visible)==='function') {\n        visible = a.visible(feature, val);\n      }\n      if (visible) {\n        tr = ol.ext.element.create('TR', { parent: table });\n        ol.ext.element.create('TD', { html: a.title || att, parent: tr });\n        // Show image or content\n        if (this.get('showImage') && /(http(s?):)([/|.|\\w|\\s|-])*\\.(?:jpg|gif|png)/.test(val)) {\n          content = ol.ext.element.create('IMG',{\n            src: val\n          });\n        } else {\n          content = (a.before||'') + val + (a.after||'');\n          var maxc = this.get('maxChar') || 200;\n          if (typeof(content) === 'string' && content.length>maxc) content = content.substr(0,maxc)+'[...]';\n        }\n        // Add value\n        ol.ext.element.create('TD', {\n          html: content,\n          parent: tr\n        });\n      }\n    }\n  }\n  // Zoom button\n  ol.ext.element.create('BUTTON', { className: 'ol-zoombt', parent: html })\n    .addEventListener('click', function() {\n      if (feature.getGeometry().getType()==='Point') {\n        this.getMap().getView().animate({\n          center: feature.getGeometry().getFirstCoordinate(),\n          zoom:  Math.max(this.getMap().getView().getZoom(), 18)\n        });\n      } else  {\n        var ext = feature.getGeometry().getExtent();\n        this.getMap().getView().fit(ext, { duration:1000 });\n      }\n    }.bind(this));\n  // Counter\n  if (this._features.length > 1) {\n    var div = ol.ext.element.create('DIV', { className: 'ol-count', parent: html });\n    ol.ext.element.create('DIV', { \n      className: 'ol-prev', \n      parent: div,\n      click: function() {\n        this._count--;\n        if (this._count<1) this._count = this._features.length;\n        html = this._getHtml(this._features[this._count-1]);\n        setTimeout(function() { \n          ol.Overlay.Popup.prototype.show.call(this, this.getPosition(), html); \n        }.bind(this), 350 );\n      }.bind(this)\n    });\n    ol.ext.element.create('TEXT', { html:this._count+'/'+this._features.length, parent: div });\n    ol.ext.element.create('DIV', { \n      className: 'ol-next', \n      parent: div,\n      click: function() {\n        this._count++;\n        if (this._count>this._features.length) this._count = 1;\n        html = this._getHtml(this._features[this._count-1]);\n        setTimeout(function() { \n          ol.Overlay.Popup.prototype.show.call(this, this.getPosition(), html); \n        }.bind(this), 350 );\n      }.bind(this)\n    });\n  }\n  // Use select interaction\n  if (this._select) {\n    this._noselect = true;\n    this._select.getFeatures().clear();\n    this._select.getFeatures().push(feature);\n    this._noselect = false;\n  }\n  return html;\n};\n/** Fix the popup\n * @param {boolean} fix\n */\nol.Overlay.PopupFeature.prototype.setFix = function (fix) {\n  if (fix) this.element.classList.add('ol-fixed');\n  else this.element.classList.remove('ol-fixed');\n};\n/** Is a popup fixed\n * @return {boolean} \n */\nol.Overlay.PopupFeature.prototype.getFix = function () {\n  return this.element.classList.contains('ol-fixed');\n};\n/** Get a function to use as format to get local string for an attribute\n * if the attribute is a number: Number.toLocaleString()\n * if the attribute is a date: Date.toLocaleString()\n * otherwise the attibute itself\n * @param {string} locales string with a BCP 47 language tag, or an array of such strings\n * @param {*} options Number or Date toLocaleString options\n * @return {function} a function that takes an attribute and return the formated attribute\n */\nol.Overlay.PopupFeature.localString = function (locales , options) {\n  return function (a) {\n    if (a && a.toLocaleString) {\n      return a.toLocaleString(locales , options);\n    } else {\n      // Try to get a date from a string\n      var date = new Date(a);\n      if (isNaN(date)) return a;\n      else return date.toLocaleString(locales , options);\n    }\n  };\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A tooltip element to be displayed over the map and attached on the cursor position.\n * @constructor\n * @extends {ol.Overlay.Popup}\n * @param {} options Extend Popup options \n *\t@param {String} options.popupClass the a class of the overlay to style the popup.\n *  @param {number} options.maximumFractionDigits maximum digits to display on measure, default 2\n *  @param {function} options.formatLength a function that takes a number and returns the formated value, default length in meter\n *  @param {function} options.formatArea a function that takes a number and returns the formated value, default length in square-meter\n *  @param {function} options.getHTML a function that takes a feature and the info string and return a formated info to display in the tooltip, default display feature measure & info\n *\t@param {Number|Array<number>} options.offsetBox an offset box\n *\t@param {ol.OverlayPositioning | string | undefined} options.positionning \n *\t\tthe 'auto' positioning var the popup choose its positioning to stay on the map.\n * @api stable\n */\nol.Overlay.Tooltip = function (options) {\n  options = options || {};\n  options.popupClass = options.popupClass || options.className || 'tooltips black';\n  options.positioning = options.positioning || 'center-left';\n  options.stopEvent = !!(options.stopEvent);\n  ol.Overlay.Popup.call(this, options);\n  this.set('maximumFractionDigits', options.maximumFractionDigits||2);\n  if (typeof(options.formatLength)==='function') this.formatLength = options.formatLength;\n  if (typeof(options.formatArea)==='function') this.formatArea = options.formatArea;\n  if (typeof(options.getHTML)==='function') this.getHTML = options.getHTML;\n  this._interaction = new ol.interaction.Interaction({\n    handleEvent: function(e){\n      if (e.type==='pointermove' || e.type==='click') {\n        var info = this.getHTML(this._feature, this.get('info'));\n        if (info) {\n          this.show(e.coordinate, info);\n        }\n        else this.hide();\n        this._coord = e.coordinate;\n      }\n      return true;\n    }.bind(this)\n  });\n};\nol.ext.inherits(ol.Overlay.Tooltip, ol.Overlay.Popup);\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.Overlay.Tooltip.prototype.setMap = function (map) {\n  if (this.getMap()) this.getMap().removeInteraction(this._interaction);\n  ol.Overlay.Popup.prototype.setMap.call(this, map);\n  if (this.getMap()) this.getMap().addInteraction(this._interaction);\n};\n/** Get the information to show in the tooltip\n * The area/length will be added if a feature is attached.\n * @param {ol.Feature|undefined} feature the feature\n * @param {string} info the info string\n * @api\n */\nol.Overlay.Tooltip.prototype.getHTML = function(feature, info) {\n  if (this.get('measure')) return this.get('measure') + (info ? '<br/>'+ info : '');\n  else return info || '';\n};\n/** Set the Tooltip info\n * If information is not null it will be set with a delay,\n * thus watever the information is inserted, the significant information will be set.\n * ie. ttip.setInformation('ok'); ttip.setInformation(null); will set 'ok' \n * ttip.set('info','ok'); ttip.set('info', null); will set null\n * @param {string} what The information to display in the tooltip, default remove information\n */\nol.Overlay.Tooltip.prototype.setInfo = function(what) {\n  if (!what) {\n    this.set('info','');\n    this.hide();\n  }\n  else setTimeout(function() { \n    this.set('info', what); \n    this.show(this._coord, this.get('info'));\n  }.bind(this));\n};\n/** Remove the current featue attached to the tip \n * Similar to setFeature() with no argument\n */\nol.Overlay.Tooltip.prototype.removeFeature = function() {\n  this.setFeature();\n};\n/** Format area to display in the popup. \n * Can be overwritten to display measure in a different unit (default: square-metter).\n * @param {number} area area in m2\n * @return {string} the formated area\n * @api\n */\nol.Overlay.Tooltip.prototype.formatArea = function(area) {\n  if (area > Math.pow(10,-1*this.get('maximumFractionDigits'))) {\n    if (area>10000) {\n      return (area/1000000).toLocaleString(undefined, {maximumFractionDigits: this.get('maximumFractionDigits)')}) + ' km';\n    } else {\n      return area.toLocaleString(undefined, {maximumFractionDigits: this.get('maximumFractionDigits')}) + ' m';\n    }\n  } else {\n    return '';\n  }\n};\n/** Format area to display in the popup\n * Can be overwritten to display measure in different unit (default: meter).\n * @param {number} length length in m\n * @return {string} the formated length\n * @api\n */\nol.Overlay.Tooltip.prototype.formatLength = function(length) {\n  if (length > Math.pow(10,-1*this.get('maximumFractionDigits'))) {\n    if (length>100) {\n      return (length/1000).toLocaleString(undefined, {maximumFractionDigits: this.get('maximumFractionDigits')}) + ' km';\n    } else {\n      return length.toLocaleString(undefined, {maximumFractionDigits: this.get('maximumFractionDigits')}) + ' m';\n    }\n  } else {\n    return '';\n  }\n};\n/** Set a feature associated with the tooltips, measure info on the feature will be added in the tooltip\n * @param {ol.Feature|ol.Event} feature an ol.Feature or an event (object) with a feature property\n */\nol.Overlay.Tooltip.prototype.setFeature = function(feature) {\n  // Handle event with a feature as property.\n  if (feature && feature.feature) feature = feature.feature;\n  // The feature\n  this._feature = feature;\n  if (this._listener) {\n    this._listener.forEach(function(l) {\n      ol.Observable.unByKey(l);\n    });\n  }\n  this._listener = [];\n  this.set('measure', '');\n  if (feature) {\n    this._listener.push(feature.getGeometry().on('change', function(e){ \n      var geom = e.target;\n      var measure;\n      if (geom.getArea) {\n        measure = this.formatArea(ol.sphere.getArea(geom, { projection: this.getMap().getView().getProjection() }));\n      } else if (geom.getLength) {\n        measure = this.formatLength(ol.sphere.getLength(geom, { projection: this.getMap().getView().getProjection() }));\n      }\n      this.set('measure', measure);\n    }.bind(this)));\n  }\n};\n\n/*\n\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n\tol.coordinate.convexHull compute a convex hull using Andrew's Monotone Chain Algorithm.\n\t@see https://en.wikipedia.org/wiki/Convex_hull_algorithms\n*/\nol.coordinate.convexHull;\n(function(){\n/** Tests if a point is left or right of line (a,b).\n* @param {ol.coordinate} a point on the line\n* @param {ol.coordinate} b point on the line\n* @param {ol.coordinate} o\n* @return {bool} true if (a,b,o) turns clockwise\n*/\nvar clockwise = function (a, b, o) {\n  return ((a[0] - o[0]) * (b[1] - o[1]) - (a[1] - o[1]) * (b[0] - o[0]) <= 0);\n};\n/** Compute a convex hull using Andrew's Monotone Chain Algorithm\n * @param {Array<ol.geom.Point>} points an array of 2D points\n * @return {Array<ol.geom.Point>} the convex hull vertices\n */\nol.coordinate.convexHull = function (points) {\t// Sort by increasing x and then y coordinate\n  var i;\n  points.sort(function(a, b) {\n    return a[0] == b[0] ? a[1] - b[1] : a[0] - b[0];\n  });\n  // Compute the lower hull\n  var lower = [];\n  for (i = 0; i < points.length; i++) {\n    while (lower.length >= 2 && clockwise(lower[lower.length - 2], lower[lower.length - 1], points[i])) {\n      lower.pop();\n    }\n    lower.push(points[i]);\n  }\n  // Compute the upper hull\n  var upper = [];\n  for (i = points.length - 1; i >= 0; i--) {\n    while (upper.length >= 2 && clockwise(upper[upper.length - 2], upper[upper.length - 1], points[i])) {\n      upper.pop();\n    }\n    upper.push(points[i]);\n  }\n  upper.pop();\n  lower.pop();\n  return lower.concat(upper);\n};\n/* Get coordinates of a geometry */\nvar getCoordinates = function (geom) {\n  var i, p\n  var h = [];\n  switch (geom.getType()) {\n    case \"Point\":h.push(geom.getCoordinates());\n      break;\n    case \"LineString\":\n    case \"LinearRing\":\n    case \"MultiPoint\":h = geom.getCoordinates();\n      break;\n    case \"MultiLineString\":\n      p = geom.getLineStrings();\n      for (i = 0; i < p.length; i++) h.concat(getCoordinates(p[i]));\n      break;\n    case \"Polygon\":\n      h = getCoordinates(geom.getLinearRing(0));\n      break;\n    case \"MultiPolygon\":\n      p = geom.getPolygons();\n      for (i = 0; i < p.length; i++) h.concat(getCoordinates(p[i]));\n      break;\n    case \"GeometryCollection\":\n      p = geom.getGeometries();\n      for (i = 0; i < p.length; i++) h.concat(getCoordinates(p[i]));\n      break;\n    default:break;\n  }\n  return h;\n};\n/** Compute a convex hull on a geometry using Andrew's Monotone Chain Algorithm\n * @return {Array<ol.geom.Point>} the convex hull vertices\n */\nol.geom.Geometry.prototype.convexHull = function() {\n  return ol.coordinate.convexHull(getCoordinates(this));\n};\n})();\n\n/*\n\tCopyright (c) 2018 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n*/\n/** Convert coordinate to French DFCI grid\n * @param {ol/coordinate} coord\n * @param {number} level [0-3]\n * @param {ol/proj/Projection} projection of the coord, default EPSG:27572\n * @return {String} the DFCI index\n */\nol.coordinate.toDFCI = function (coord, level, projection) {\n  if (!level && level !==0) level = 3;\n  if (projection) {\n    if (!ol.proj.get('EPSG:27572')) {\n      // Add Lambert IIe proj \n      if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n      ol.proj.proj4.register(proj4);\n    }\n    coord = ol.proj.transform(coord, projection, 'EPSG:27572');\n  }\n  var x = coord[0];\n  var y = coord[1];\n  var s = '';\n  // Level 0\n  var step = 100000;\n  s += String.fromCharCode(65 + Math.floor((x<800000?x:x+200000)/step))\n    + String.fromCharCode(65 + Math.floor((y<2300000?y:y+200000)/step) - 1500000/step);\n  if (level === 0) return s;\n  // Level 1\n  var step1 = 100000/5;\n  s += 2*Math.floor((x%step)/step1);\n  s += 2*Math.floor((y%step)/step1);\n  if (level === 1) return s;\n  // Level 2\n  var step2 = step1 / 10;\n  var x0 = Math.floor((x%step1)/step2);\n  s += String.fromCharCode(65 + (x0<8 ? x0 : x0+2));\n  s += Math.floor((y%step1)/step2);\n  if (level === 2) return s;\n  // Level 3\n  var x3 = Math.floor((x%step2)/500);\n  var y3 = Math.floor((y%step2)/500);\n  if (x3<1) {\n    if (y3>1) s += '.1';\n    else s += '.4';\n  } else if (x3>2) {\n    if (y3>1) s += '.2';\n    else s += '.3';\n  } else if (y3>2) {\n    if (x3<2) s += '.1';\n    else s += '.2';\n  } else if (y3<1) {\n    if (x3<2) s += '.4';\n    else s += '.3';\n  } else {\n    s += '.5';\n  }\n  return s;\n};\n/** Get coordinate from French DFCI index\n * @param {String} index the DFCI index\n * @param {ol/proj/Projection} projection result projection, default EPSG:27572\n * @return {ol/coordinate} coord\n */\nol.coordinate.fromDFCI = function (index, projection) {\n  var coord;\n  // Level 0\n  var step = 100000;\n  var x = index.charCodeAt(0) - 65;\n  x = (x<8 ? x : x-2)*step;\n  var y = index.charCodeAt(1) - 65;\n  y = (y<8 ? y : y-2)*step + 1500000;\n  if (index.length===2) {\n    coord = [x+step/2, y+step/2];\n  } else {\n    // Level 1\n    step /= 5;\n    x += Number(index.charAt(2))/2*step;\n    y += Number(index.charAt(3))/2*step;\n    if (index.length===4) {\n      coord = [x+step/2, y+step/2];\n    } else {\n      // Level 2\n      step /= 10;\n      var x0 = index.charCodeAt(4) - 65;\n      x += (x0<8 ? x0 : x0-2)*step;\n      y += Number(index.charAt(5))*step;\n      if (index.length === 6) {\n        coord = [x+step/2, y+step/2];\n      } else {\n        // Level 3\n        switch (index.charAt(7)) {\n          case '1':\n            coord = [x+step/4, y+3*step/4];\n            break;\n          case '2':\n            coord = [x+3*step/4, y+3*step/4];\n            break;\n          case '3':\n            coord = [x+3*step/4, y+step/4];\n            break;\n          case '4':\n            coord = [x+step/4, y+step/4];\n            break;\n          default:\n            coord = [x+step/2, y+step/2];\n            break;\n        }\n      }\n    }\n  }\n  // Convert ?\n  if (projection) {\n    if (!ol.proj.get('EPSG:27572')) {\n      // Add Lambert IIe proj \n      if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n      ol.proj.proj4.register(proj4);\n    }\n    coord = ol.proj.transform(coord, 'EPSG:27572', projection);\n  }\n  return coord;\n};\n/** The string is a valid DFCI index\n * @param {string} index DFCI index\n * @return {boolean}\n */\nol.coordinate.validDFCI = function (index) {\n  if (index.length<2 || index.length>8) return false;\n  if (/[^A-H|^K-N]/.test(index.substr(0,1))) return false;\n  if (/[^B-H|^K-N]/.test(index.substr(1,1))) return false;\n  if (index.length>2) {\n    if (index.length<4) return false;\n    if (/[^0,^2,^4,^6,^8]/.test(index.substr(2,1))) return false;\n    if (/[^0,^2,^4,^6,^8]/.test(index.substr(3,1))) return false;\n  }\n  if (index.length>4) {\n    if (index.length<6) return false;\n    if (/[^A-H|^K-L]/.test(index.substr(4,1))) return false;\n    if (/[^0-9]/.test(index.substr(5,1))) return false;\n  }\n  if (index.length>6) {\n    if (index.length<8) return false;\n    if (index.substr(6,1)!=='.') return false;\n    if (/[^1-5]/.test(index.substr(7,1))) return false;\n  }\n  return true;\n}\n/** Coordinate is valid for DFCI \n * @param {ol/coordinate} coord\n * @param {ol/proj/Projection} projection result projection, default EPSG:27572\n * @return {boolean}\n */\nol.coordinate.validDFCICoord = function (coord, projection) {\n  if (projection) {\n    if (!ol.proj.get('EPSG:27572')) {\n      // Add Lambert IIe proj \n      if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n      ol.proj.proj4.register(proj4);\n    }\n    coord = ol.proj.transform(coord, projection, 'EPSG:27572');\n  }\n  // Test extent\n  if (0 > coord[0] || coord[0] > 1200000 ) return false;\n  if (1600000 > coord[1] || coord[1] > 2700000 ) return false;\n  return true;\n};\n\n/*\n\tCopyright (c) 2018 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n*/\n/* Define namespace\n */\nol.graph = {};\n/** \n * @classdesc \n * Compute the shortest paths between nodes in a graph source\n * The source must only contains LinesString.\n * \n * It uses a A* optimisation.\n * You can overwrite methods to customize the result.\n * @see https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm\n * @constructor\n * @fires calculating \n * @fires start\n * @fires finish\n * @fires pause\n * @param {any} options\n *  @param {ol/source/Vector} options.source the source for the edges \n *  @param {integer} [options.maxIteration=20000] maximum iterations before a pause event is fired, default 20000\n *  @param {integer} [options.stepIteration=2000] number of iterations before a calculating event is fired, default 2000\n *  @param {number} [options.epsilon=1E-6] geometric precision (min distance beetween 2 points), default 1E-6\n */\nol.graph.Dijskra = function (options) {\n  options = options || {};\n  this.source = options.source;\n  this.nodes = new ol.source.Vector();\n  // Maximum iterations\n  this.maxIteration = options.maxIteration || 20000;\n  this.stepIteration = options.stepIteration || 2000;\n  // A* optimisation\n  this.astar = true;\n  this.candidat = [];\n  ol.Object.call (this);\n  this.set ('epsilon', options.epsilon || 1E-6);\n};\nol.ext.inherits(ol.graph.Dijskra, ol.Object);\n/** Get the weighting of the edge, for example a speed factor\n * The function returns a value beetween ]0,1]\n * - 1   = no weighting\n * - 0.5 = goes twice more faster on this road\n * \n * If no feature is provided you must return the lower weighting you're using\n * @param {ol/Feature} feature\n * @return {number} a number beetween 0-1 \n * @api\n */\nol.graph.Dijskra.prototype.weight = function(/* feature */) {\n  return 1;\n};\n/** Get the edge direction\n * -  0 : the road is blocked\n * -  1 : direct way\n * - -1 : revers way\n * -  2 : both way\n * @param {ol/Feature} feature\n * @return {Number} 0: blocked, 1: direct way, -1: revers way, 2:both way \n * @api\n */\nol.graph.Dijskra.prototype.direction = function(/* feature */) {\n  return 2;\n};\n/** Calculate the length of an edge\n * @param {ol/Feature|ol/geom/LineString} geom\n * @return {number}\n * @api\n */\nol.graph.Dijskra.prototype.getLength = function(geom) {\n  if (geom.getGeometry) geom = geom.getGeometry();\n  return geom.getLength();\n};\n/** Get the nodes source concerned in the calculation\n * @return {ol/source/Vector}\n */\nol.graph.Dijskra.prototype.getNodeSource = function() {\n  return this.nodes;\n};\n/** Get all features at a coordinate\n * @param {ol/coordinate} coord\n * @return {Array<ol/Feature>}\n */\nol.graph.Dijskra.prototype.getEdges = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  var result = [];\n  this.source.forEachFeatureIntersectingExtent(extent, function(f){\n    result.push(f);\n  });\n  return result;\n};\n/** Get a node at a coordinate\n * @param {ol/coordinate} coord\n * @return {ol/Feature} the node\n */\nol.graph.Dijskra.prototype.getNode = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  var result = [];\n  this.nodes.forEachFeatureIntersectingExtent(extent, function(f){\n    result.push(f);\n  });\n  return result[0];\n};\n/** Add a node\n * @param {ol/coorindate} p\n * @param {number} wdist the distance to reach this node\n * @param {ol/Feature} from the feature used to come to this node\n * @param {ol/Feature} prev the previous node\n * @return {ol/Feature} the node\n * @private\n */\nol.graph.Dijskra.prototype.addNode = function(p, wdist, dist, from, prev) {\n  // Final condition\n  if (this.wdist && wdist > this.wdist) return false;\n  // Look for existing point\n  var node = this.getNode(p);\n  // Optimisation ?\n  var dtotal = wdist + this.getLength(new ol.geom.LineString([this.end, p])) * this.weight();\n  if (this.astar && this.wdist && dtotal > this.wdist) return false;\n  if (node) {\n    // Allready there\n    if (node!==this.arrival && node.get('wdist') <= wdist) return node;\n    // New candidat\n    node.set('dist', dist);\n    node.set('wdist', wdist);\n    node.set('dtotal', dtotal);\n    node.set('from', from);\n    node.set('prev', prev);\n    if (node===this.arrival) {\n      this.wdist = wdist;\n    }\n    this.candidat.push (node);\n  } else {\n    // New candidat\n    node =  new ol.Feature({\n      geometry: new ol.geom.Point(p),\n      from: from, \n      prev: prev, \n      dist: dist || 0, \n      wdist: wdist, \n      dtotal: dtotal, \n    });\n    if (wdist<0) {\n      node.set('wdist', false);\n    }\n    else this.candidat.push (node);\n    // Add it in the node source\n    this.nodes.addFeature(node);\n  }\n  return node;\n};\n/** Get the closest coordinate of a node in the graph source (an edge extremity)\n * @param {ol/coordinate} p\n * @return {ol/coordinate} \n * @private\n */\nol.graph.Dijskra.prototype.closestCoordinate = function(p) {\n  var e = this.source.getClosestFeatureToCoordinate(p);\n  var p0 = e.getGeometry().getFirstCoordinate();\n  var p1 = e.getGeometry().getLastCoordinate();\n  if (ol.coordinate.dist2d(p, p0) < ol.coordinate.dist2d(p, p1)) return p0;\n  else return p1;\n};\n/** Calculate a path beetween 2 points\n * @param {ol/coordinate} start\n * @param {ol/coordinate} end\n * @return {boolean|Array<ol/coordinate>} false if don't start (still running) or start and end nodes\n */\nol.graph.Dijskra.prototype.path = function(start, end) {\n  if (this.running) return false;\n  // Starting nodes\n  start = this.closestCoordinate(start);\n  this.end = this.closestCoordinate(end);\n  if (start[0]===this.end[0] \n    && start[1]===this.end[1]) {\n      this.dispatchEvent({\n        type: 'finish',\n        route: [],\n        wDistance: -1,\n        distance: this.wdist\n      });\n      return false;\n    }\n  // Initialize\n  var self = this;\n  this.nodes.clear();\n  this.candidat = [];\n  this.wdist = 0;\n  this.running = true;\n  // Starting point\n  this.addNode(start, 0);\n  // Arrival\n  this.arrival = this.addNode(this.end, -1);\n  // Start\n  this.nb = 0;\n  this.dispatchEvent({\n    type: 'start'\n  });\n  setTimeout(function() { self._resume(); });\n  return [start, this.end];\n};\n/** Restart after pause\n */\nol.graph.Dijskra.prototype.resume = function() {\n  if (this.running) return;\n  if (this.candidat.length) {\n    this.running = true;\n    this.nb = 0;\n    this._resume();\n  }\n};\n/** Pause \n */\nol.graph.Dijskra.prototype.pause = function() {\n  if (!this.running) return;\n  this.nb = -1;\n};\n/** Get the current 'best way'.\n * This may be used to animate while calculating.\n * @return {Array<ol/Feature>}\n */\nol.graph.Dijskra.prototype.getBestWay = function() {\n  var node, max = -1;\n  for (var i=0, n; n = this.candidat[i]; i++) {\n    if (n.get('wdist') > max) {\n      node = n;\n      max = n.get('wdist');\n    }\n  }\n  // Calculate route to this node\n  return this.getRoute(node);\n};\n/** Go on searching new candidats\n * @private\n */\nol.graph.Dijskra.prototype._resume = function() {\n  if (!this.running) return;\n  while (this.candidat.length) {\n    // Sort by wdist\n    this.candidat.sort (function(a,b) {\n      return (a.get('dtotal') < b.get('dtotal') ? 1 : a.get('dtotal')===b.get('dtotal') ? 0 : -1);\n    });\n    // First candidate\n    var node = this.candidat.pop();\n    var p = node.getGeometry().getCoordinates();\n    // Find connected edges\n    var edges = this.getEdges(p);\n    for (var i=0, e; e=edges[i]; i++) {\n      if (node.get('from')!==e) {\n        var dist = this.getLength (e);\n        if (dist < 0) {\n          console.log ('distance < 0!');\n          // continue;\n        }\n        var wdist = node.get('wdist') + dist * this.weight(e);\n        dist = node.get('dist') + dist;\n        var pt1 = e.getGeometry().getFirstCoordinate();\n        var pt2 = e.getGeometry().getLastCoordinate();\n        var sens = this.direction(e);\n        if (sens!==0) {\n          if (p[0]===pt1[0] && p[1]===pt1[1] && sens!==-1) {\n            this.addNode(pt2, wdist, dist, e, node);\n          }\n          if (p[0]===pt2[0] && p[0]===pt2[0] && sens!==1) {\n            this.addNode(pt1, wdist, dist, e, node);\n          }\n        }\n      }\n      // Test overflow or pause\n      if (this.nb === -1 || this.nb++ > this.maxIteration) {\n        this.running = false;\n        this.dispatchEvent({\n          type: 'pause',\n          overflow: (this.nb !== -1)\n        });\n        return;\n      }\n      // Take time to do something\n      if (!(this.nb % this.stepIteration)){\n        var self = this;\n        window.setTimeout(function() { self._resume() }, 5);\n        this.dispatchEvent({\n          type: 'calculating'\n        });\n        return;\n      }\n    }\n  }\n  // Finish!\n  this.nodes.clear();\n  this.running = false;\n  this.dispatchEvent({\n    type: 'finish',\n    route: this.getRoute(this.arrival),\n    wDistance: this.wdist,\n    distance: this.arrival.get('dist')\n  });\n};\n/** Get the route to a node\n * @param {ol/Feature} node\n * @return {Array<ol/Feature>}\n * @private\n */\nol.graph.Dijskra.prototype.getRoute = function(node) {\n  var route = [];\n  while (node) {\n    route.unshift(node.get('from'));\n    node = node.get('prev');\n  }\n  route.shift();\n  return route;\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n  Usefull function to handle geometric operations\n*/\n/** Distance beetween 2 points\n *\tUsefull geometric functions\n * @param {ol.Coordinate} p1 first point\n * @param {ol.Coordinate} p2 second point\n * @return {number} distance\n */\nol.coordinate.dist2d = function(p1, p2) {\n  var dx = p1[0]-p2[0];\n  var dy = p1[1]-p2[1];\n  return Math.sqrt(dx*dx+dy*dy);\n}\n/** 2 points are equal\n *\tUsefull geometric functions\n * @param {ol.Coordinate} p1 first point\n * @param {ol.Coordinate} p2 second point\n * @return {boolean}\n */\nol.coordinate.equal = function(p1, p2) {\n  return (p1[0]==p2[0] && p1[1]==p2[1]);\n}\n/** Get center coordinate of a feature\n * @param {ol.Feature} f\n * @return {ol.coordinate} the center\n */\nol.coordinate.getFeatureCenter = function(f) {\n  return ol.coordinate.getGeomCenter (f.getGeometry());\n};\n/** Get center coordinate of a geometry\n* @param {ol.Feature} geom\n* @return {ol.Coordinate} the center\n*/\nol.coordinate.getGeomCenter = function(geom) {\n  switch (geom.getType()) {\n    case 'Point': \n      return geom.getCoordinates();\n    case \"MultiPolygon\":\n            geom = geom.getPolygon(0);\n            // fallthrough\n    case \"Polygon\":\n      return geom.getInteriorPoint().getCoordinates();\n    default:\n      return geom.getClosestPoint(ol.extent.getCenter(geom.getExtent()));\n  }\n};\n/** Offset a polyline\n * @param {Array<ol.Coordinate>} coords\n * @param {number} offset\n * @return {Array<ol.Coordinate>} resulting coord\n * @see http://stackoverflow.com/a/11970006/796832\n * @see https://drive.google.com/viewerng/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxqa2dhZGdldHN0b3JlfGd4OjQ4MzI5M2Y0MjNmNzI2MjY\n */\nol.coordinate.offsetCoords = function (coords, offset) {\n  var path = [];\n  var N = coords.length-1;\n  var max = N;\n  var mi, mi1, li, li1, ri, ri1, si, si1, Xi1, Yi1;\n  var p0, p1, p2;\n  var isClosed = ol.coordinate.equal(coords[0],coords[N]);\n  if (!isClosed) {\n    p0 = coords[0];\n    p1 = coords[1];\n    p2 = [\n      p0[0] + (p1[1] - p0[1]) / ol.coordinate.dist2d(p0,p1) *offset,\n      p0[1] - (p1[0] - p0[0]) / ol.coordinate.dist2d(p0,p1) *offset\n    ];\n    path.push(p2);\n    coords.push(coords[N])\n    N++;\n    max--;\n  }\n  for (var i = 0; i < max; i++) {\n    p0 = coords[i];\n    p1 = coords[(i+1) % N];\n    p2 = coords[(i+2) % N];\n    mi = (p1[1] - p0[1])/(p1[0] - p0[0]);\n    mi1 = (p2[1] - p1[1])/(p2[0] - p1[0]);\n    // Prevent alignements\n    if (Math.abs(mi-mi1) > 1e-10) {\n      li = Math.sqrt((p1[0] - p0[0])*(p1[0] - p0[0])+(p1[1] - p0[1])*(p1[1] - p0[1]));\n      li1 = Math.sqrt((p2[0] - p1[0])*(p2[0] - p1[0])+(p2[1] - p1[1])*(p2[1] - p1[1]));\n      ri = p0[0] + offset*(p1[1] - p0[1])/li;\n      ri1 = p1[0] + offset*(p2[1] - p1[1])/li1;\n      si = p0[1] - offset*(p1[0] - p0[0])/li;\n      si1 = p1[1] - offset*(p2[0] - p1[0])/li1;\n      Xi1 = (mi1*ri1-mi*ri+si-si1) / (mi1-mi);\n      Yi1 = (mi*mi1*(ri1-ri)+mi1*si-mi*si1) / (mi1-mi);\n      // Correction for vertical lines\n      if(p1[0] - p0[0] == 0) {\n        Xi1 = p1[0] + offset*(p1[1] - p0[1])/Math.abs(p1[1] - p0[1]);\n        Yi1 = mi1*Xi1 - mi1*ri1 + si1;\n      }\n      if (p2[0] - p1[0] == 0 ) {\n        Xi1 = p2[0] + offset*(p2[1] - p1[1])/Math.abs(p2[1] - p1[1]);\n        Yi1 = mi*Xi1 - mi*ri + si;\n      }\n      path.push([Xi1, Yi1]);\n    }\n  }\n  if (isClosed) {\n    path.push(path[0]);\n  } else {\n    coords.pop();\n    p0 = coords[coords.length-1];\n    p1 = coords[coords.length-2];\n    p2 = [\n      p0[0] - (p1[1] - p0[1]) / ol.coordinate.dist2d(p0,p1) *offset,\n      p0[1] + (p1[0] - p0[0]) / ol.coordinate.dist2d(p0,p1) *offset\n    ];\n    path.push(p2);\n  }\n  return path;\n}\n/** Find the segment a point belongs to\n * @param {ol.Coordinate} pt\n * @param {Array<ol.Coordinate>} coords\n * @return {} the index (-1 if not found) and the segment\n */\nol.coordinate.findSegment = function (pt, coords) {\n  for (var i=0; i<coords.length-1; i++) {\n    var p0 = coords[i];\n    var p1 = coords[i+1];\n    if (ol.coordinate.equal(pt, p0) || ol.coordinate.equal(pt, p1)) {\n      return { index:1, segment: [p0,p1] };\n    } else {\n      var d0 = ol.coordinate.dist2d(p0,p1);\n      var v0 = [ (p1[0] - p0[0]) / d0, (p1[1] - p0[1]) / d0 ];\n      var d1 = ol.coordinate.dist2d(p0,pt);\n      var v1 = [ (pt[0] - p0[0]) / d1, (pt[1] - p0[1]) / d1 ];\n      if (Math.abs(v0[0]*v1[1] - v0[1]*v1[0]) < 1e-10) {\n        return { index:1, segment: [p0,p1] };\n      }\n    }\n  }\n  return { index: -1 };\n};\n/**\n * Split a Polygon geom with horizontal lines\n * @param {Array<ol.Coordinate>} geom\n * @param {number} y the y to split\n * @param {number} n contour index\n * @return {Array<Array<ol.Coordinate>>}\n */\nol.coordinate.splitH = function (geom, y, n) {\n  var x, abs;\n  var list = [];\n  for (var i=0; i<geom.length-1; i++) {\n    // Hole separator?\n    if (!geom[i].length || !geom[i+1].length) continue;\n    // Intersect\n    if (geom[i][1]<=y && geom[i+1][1]>y || geom[i][1]>=y && geom[i+1][1]<y) {\n      abs = (y-geom[i][1]) / (geom[i+1][1]-geom[i][1]);\n      x = abs * (geom[i+1][0]-geom[i][0]) + geom[i][0];\n      list.push ({ contour: n, index: i, pt: [x,y], abs: abs });\n    }\n  }\n  // Sort x\n  list.sort(function(a,b) { return a.pt[0] - b.pt[0] });\n  // Horizontal segement\n  var result = [];\n  for (var j=0; j<list.length-1; j += 2) {\n    result.push([list[j], list[j+1]])\n  }\n  return result;\n};\n/** Create a geometrie given a type and coordinates */\nol.geom.createFromType = function (type, coordinates) {\n  switch (type) {\n    case 'LineString': return new ol.geom.LineString(coordinates);\n    case 'LinearRing': return new ol.geom.LinearRing(coordinates);\n    case 'MultiLineString': return new ol.geom.MultiLineString(coordinates);\n    case 'MultiPoint': return new ol.geom.MultiPoint(coordinates);\n    case 'MultiPolygon': return new ol.geom.MultiPolygon(coordinates);\n    case 'Point': return new ol.geom.Point(coordinates);\n    case 'Polygon': return new ol.geom.Polygon(coordinates);\n    default:\n      console.error('[createFromType] Unsupported type: '+type);\n      return null;\n  }\n};\n\n/** Split a lineString by a point or a list of points\n *\tNB: points must be on the line, use getClosestPoint() to get one\n* @param {ol.Coordinate | Array<ol.Coordinate>} pt points to split the line\n* @param {Number} tol distance tolerance for 2 points to be equal\n*/\nol.geom.LineString.prototype.splitAt = function(pt, tol) {\n  var i;\n  if (!pt) return [this];\n    if (!tol) tol = 1e-10;\n    // Test if list of points\n    if (pt.length && pt[0].length) {\n      var result = [this];\n      for (i=0; i<pt.length; i++) {\n        var r = [];\n        for (var k=0; k<result.length; k++) {\n          var ri = result[k].splitAt(pt[i], tol);\n          r = r.concat(ri);\n        }\n        result = r;\n      }\n      return result;\n    }\n    // Nothing to do\n    if (ol.coordinate.equal(pt,this.getFirstCoordinate())\n    || ol.coordinate.equal(pt,this.getLastCoordinate())) {\n      return [this];\n    }\n    // Get\n    var c0 = this.getCoordinates();\n    var ci=[c0[0]];\n    var c = [];\n    for (i=0; i<c0.length-1; i++) {\n      // Filter equal points\n      if (ol.coordinate.equal(c0[i],c0[i+1])) continue;\n      // Extremity found\n      if (ol.coordinate.equal(pt,c0[i+1])) {\n        ci.push(c0[i+1]);\n        c.push(new ol.geom.LineString(ci));\n        ci = [];\n      }\n      // Test alignement\n      else if (!ol.coordinate.equal(pt,c0[i])) {\n        var d1, d2, split=false;\n        if (c0[i][0] == c0[i+1][0]) {\n          d1 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (c0[i][0] == pt[0]) && (0 < d1 && d1 <= 1)\n        } else if (c0[i][1] == c0[i+1][1]) {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          split = (c0[i][1] == pt[1]) && (0 < d1 && d1 <= 1)\n        } else {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          d2 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (Math.abs(d1-d2) <= tol && 0 < d1 && d1 <= 1)\n        }\n        // pt is inside the segment > split\n        if (split) {\n          ci.push(pt);\n          c.push (new ol.geom.LineString(ci));\n          ci = [pt];\n        }\n      }\n      ci.push(c0[i+1]);\n    }\n    if (ci.length>1) c.push (new ol.geom.LineString(ci));\n    if (c.length) return c;\n    else return [this];\n}\n// import('ol-ext/geom/LineStringSplitAt')\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\tUsefull function to handle geometric operations\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/**\n * Calculate a MultiPolyline to fill a Polygon with a scribble effect that appears hand-made\n * @param {} options\n *  @param {Number} options.interval interval beetween lines\n *  @param {Number} options.angle hatch angle in radian, default PI/2\n * @return {ol.geom.MultiLineString|null} the resulting MultiLineString geometry or null if none\n */\nol.geom.MultiPolygon.prototype.scribbleFill = function (options) {\n  var scribbles = [];\n  var poly = this.getPolygons();\n  var i, p, s;\n  for (i=0; p=poly[i]; i++) {\n    var mls = p.scribbleFill(options);\n    if (mls) scribbles.push(mls);\n  } \n  if (!scribbles.length) return null;\n  // Merge scribbles\n  var scribble = scribbles[0];\n    var ls;\n    for (i = 0; s = scribbles[i]; i++) {\n        ls = s.getLineStrings();\n        for (var k = 0; k < ls.length; k++) {\n            scribble.appendLineString(ls[k]);\n        }\n    }\n  return scribble;\n};\n/**\n * Calculate a MultiPolyline to fill a Polygon with a scribble effect that appears hand-made\n * @param {} options\n *  @param {Number} options.interval interval beetween lines\n *  @param {Number} options.angle hatch angle in radian, default PI/2\n * @return {ol.geom.MultiLineString|null} the resulting MultiLineString geometry or null if none\n */\nol.geom.Polygon.prototype.scribbleFill = function (options) {\n\tvar step = options.interval;\n  var angle = options.angle || Math.PI/2;\n  var i, k,l;\n  // Geometry + rotate\n\tvar geom = this.clone();\n\tgeom.rotate(angle, [0,0]);\n  var coords = geom.getCoordinates();\n  // Merge holes\n  var coord = coords[0];\n  for (i=1; i<coords.length; i++) {\n    // Add a separator\n    coord.push([]);\n    // Add the hole\n    coord = coord.concat(coords[i]);\n  }\n  // Extent \n\tvar ext = geom.getExtent();\n\t// Split polygon with horizontal lines\n  var lines = [];\n\tfor (var y = (Math.floor(ext[1]/step)+1)*step; y<ext[3]; y += step) {\n    l = ol.coordinate.splitH(coord, y, i);\n    lines = lines.concat(l);\n  }\n  if (!lines.length) return null;\n  // Order lines on segment index\n  var mod = coord.length-1;\n\tvar first = lines[0][0].index;\n\tfor (k=0; l=lines[k]; k++) {\n\t\tlines[k][0].index = (lines[k][0].index-first+mod) % mod;\n\t\tlines[k][1].index = (lines[k][1].index-first+mod) % mod;\n\t}\n  var scribble = [];\n  while (true) {\n    for (k=0; l=lines[k]; k++) {\n      if (!l[0].done) break;\n    }\n    if (!l) break;\n    var scrib = [];\n    while (l) {\n      l[0].done = true;\n      scrib.push(l[0].pt);\n      scrib.push(l[1].pt);\n      var nexty = l[0].pt[1] + step;\n      var d0 = Infinity;\n      var l2 = null;\n      while (lines[k]) {\n        if (lines[k][0].pt[1] > nexty) break;\n        if (lines[k][0].pt[1] === nexty) {\n          var d = Math.min(\n            (lines[k][0].index - l[0].index + mod) % mod,\n            (l[0].index - lines[k][0].index + mod) % mod\n          );\n          var d2 = Math.min(\n            (l[1].index - l[0].index + mod) % mod,\n            (l[0].index - l[1].index + mod) % mod\n          );\n          if (d<d0 && d<d2) {\n            d0 = d;\n            if (!lines[k][0].done) l2 = lines[k];\n            else l2 = null;\n          }\n        }\n        k++;\n      }\n      l = l2;\n    }\n    if (scrib.length) {\n      scribble.push(scrib);\n    }\n  }\n  // Return the scribble as MultiLineString\n  if (!scribble.length) return null;\n  var mline = new ol.geom.MultiLineString(scribble);\n  mline.rotate(-angle,[0,0]);\n\treturn mline.cspline({ pointsPerSeg:8, tension:.9 });\n};\n// import('ol-ext/geom/Scribble')\n/** Compute great circle bearing of two points.\n * @See http://www.movable-type.co.uk/scripts/latlong.html for the original code\n * @param {ol.coordinate} origin origin in lonlat\n * @param {ol.coordinate} destination destination in lonlat\n * @return {number} bearing angle in radian\n */\nol.sphere.greatCircleBearing = function(origin, destination) {\n  var toRad = Math.PI/180;\n  var ori = [ origin[0]*toRad, origin[1]*toRad ];\n  var dest = [ destination[0]*toRad, destination[1]*toRad ];\n  var bearing = Math.atan2(\n    Math.sin(dest[0] - ori[0]) * Math.cos(dest[1]),\n    Math.cos(ori[1]) * Math.sin(dest[1]) - Math.sin(ori[1]) * Math.cos(dest[1]) * Math.cos(dest[0] - ori[0])\n  );\n  return bearing;\n};\n/** \n * Computes the destination point given an initial point, a distance and a bearing\n * @See http://www.movable-type.co.uk/scripts/latlong.html for the original code\n * @param {ol.coordinate} origin stating point in lonlat coords\n * @param {number} distance\n * @param {number} bearing bearing angle in radian\n * @param {*} options\n *  @param {booelan} normalize normalize longitude beetween -180/180, deafulet true\n *  @param {number|undefined} options.radius sphere radius, default 6371008.8\n */\nol.sphere.computeDestinationPoint = function(origin, distance, bearing, options) {\n  options = options || {};\n  var toRad = Math.PI/180;\n  var radius = options.radius || 6371008.8;\n  var phi1 = origin[1] * toRad;\n  var lambda1 = origin[0] * toRad;\n  var delta = distance / radius;\n  var phi2 = Math.asin(\n    Math.sin(phi1) * Math.cos(delta) +\n    Math.cos(phi1) * Math.sin(delta) * Math.cos(bearing)\n  );\n  var lambda2 = lambda1 +\n    Math.atan2(\n      Math.sin(bearing) * Math.sin(delta) * Math.cos(phi1),\n      Math.cos(delta) - Math.sin(phi1) * Math.sin(phi2)\n    );\n  var lon = lambda2 / toRad;\n  // normalise to >=-180 and <=180 \n  if (options.normalize!==false && (lon < -180 || lon > 180)) {\n    lon = ((lon * 540) % 360) - 180;\n  }\n  return [ lon, phi2 / toRad ];\n};\n/** Calculate a track along the great circle given an origin and a destination\n * @param {ol.coordinate} origin origin in lonlat\n * @param {ol.coordinate} destination destination in lonlat\n * @param {number} distance distance between point along the track in meter, default 1km (1000)\n * @param {number|undefined} radius sphere radius, default 6371008.8\n * @return {Array<ol.coordinate>}\n */\nol.sphere.greatCircleTrack = function(origin, destination, options) {\n  options = options || {};\n  var bearing = ol.sphere.greatCircleBearing(origin, destination);\n  var dist = ol.sphere.getDistance(origin, destination, options.radius);\n  var distance = options.distance || 1000;\n  var d = distance;\n  var geom = [origin];\n  while (d < dist) {\n    geom.push(ol.sphere.computeDestinationPoint(origin, d, bearing, { radius: options.radius, normalize: false }));\n    d += distance;\n  }\n  var pt = ol.sphere.computeDestinationPoint(origin, dist, bearing, { radius: options.radius, normalize: false });\n  if (Math.abs(pt[0]-destination[0]) > 1) {\n    if (pt[0] > destination[0]) destination[0] += 360;\n    else destination[0] -= 360;\n  } \n  geom.push(destination);\n  return geom;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Pulse an extent on postcompose\n*\t@param {ol.coordinates} point to pulse\n*\t@param {ol.pulse.options} options pulse options param\n*\t  @param {ol.projectionLike|undefined} options.projection projection of coords, default no transform\n*\t  @param {Number} options.duration animation duration in ms, default 2000\n*\t  @param {ol.easing} options.easing easing function, default ol.easing.upAndDown\n*\t  @param {ol.style.Stroke} options.style stroke style, default 2px red\n*/\nol.Map.prototype.animExtent = function(extent, options)\n{\tvar listenerKey;\n\toptions = options || {};\n\t// Change to map's projection\n\tif (options.projection)\n\t{\textent = ol.proj.transformExtent (extent, options.projection, this.getView().getProjection());\n\t}\n\t// options\n\tvar start = new Date().getTime();\n\tvar duration = options.duration || 1000;\n\tvar easing = options.easing || ol.easing.upAndDown;\n\tvar width = options.style ? options.style.getWidth() || 2 : 2;\n\tvar color = options.style ? options.style.getColr() || 'red' : 'red';\n\t// Animate function\n\tfunction animate(event) \n\t{\tvar frameState = event.frameState;\n\t\tvar ratio = frameState.pixelRatio;\n\t\tvar elapsed = frameState.time - start;\n\t\tif (elapsed > duration) ol.Observable.unByKey(listenerKey);\n\t\telse\n\t\t{\tvar elapsedRatio = elapsed / duration;\n\t\t\tvar p0 = this.getPixelFromCoordinate([extent[0],extent[1]]);\n\t\t\tvar p1 = this.getPixelFromCoordinate([extent[2],extent[3]]);\n\t\t\tvar context = event.context;\n\t\t\tcontext.save();\n\t\t\tcontext.scale(ratio,ratio);\n\t\t\tcontext.beginPath();\n\t\t\t// var e = easing(elapsedRatio)\n\t\t\tcontext.globalAlpha = easing(1 - elapsedRatio);\n\t\t\tcontext.lineWidth = width;\n\t\t\tcontext.strokeStyle = color;\n\t\t\tcontext.rect(p0[0], p0[1], p1[0]-p0[0], p1[1]-p0[1]);\n\t\t\tcontext.stroke();\n\t\t\tcontext.restore();\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\tframeState.animate = true;\n\t\t}\n\t}\n\t// Launch animation\n\tlistenerKey = this.on('postcompose', animate.bind(this));\n\tthis.renderSync();\n}\n\n/** Create a cardinal spline version of this geometry.\n*\tOriginal https://github.com/epistemex/cardinal-spline-js\n*\t@see https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Cardinal_spline\n*\n* @param {} options\n*\t@param {Number} options.tension a [0,1] number / can be interpreted as the \"length\" of the tangent, default 0.5\n*\t@param {Number} options.resolution size of segment to split\n*\t@param {Interger} options.pointsPerSeg number of points per segment to add if no resolution is provided, default add 10 points per segment\n*/\n/** Cache cspline calculation\n*/\nol.geom.Geometry.prototype.cspline = function(options)\n{\t// Calculate cspline\n\tif (this.calcCSpline_)\n\t{\tif (this.csplineGeometryRevision != this.getRevision() \n\t\t\t|| this.csplineOption != JSON.stringify(options))\n\t\t{\tthis.csplineGeometry_ = this.calcCSpline_(options)\n\t\t\tthis.csplineGeometryRevision = this.getRevision();\n\t\t\tthis.csplineOption = JSON.stringify(options);\n\t\t}\n\t\treturn this.csplineGeometry_;\n\t}\n\t// Default do nothing\n\telse\n\t{\treturn this;\n\t}\n}\nol.geom.GeometryCollection.prototype.calcCSpline_ = function(options)\n{\tvar g=[], g0=this.getGeometries();\n\tfor (var i=0; i<g0.length; i++)\n\t{\tg.push(g0[i].cspline(options));\n\t}\n\treturn new ol.geom.GeometryCollection(g);\n}\nol.geom.MultiLineString.prototype.calcCSpline_ = function(options)\n{\tvar g=[], lines = this.getLineStrings();\n\tfor (var i=0; i<lines.length; i++)\n\t{\tg.push(lines[i].cspline(options).getCoordinates());\n\t}\n\treturn new ol.geom.MultiLineString(g);\n}\nol.geom.Polygon.prototype.calcCSpline_ = function(options)\n{\tvar g=[], g0=this.getCoordinates();\n\tfor (var i=0; i<g0.length; i++)\n\t{\tg.push((new ol.geom.LineString(g0[i])).cspline(options).getCoordinates());\n\t}\n\treturn new ol.geom.Polygon(g);\n}\nol.geom.MultiPolygon.prototype.calcCSpline_ = function(options)\n{\tvar g=[], g0=this.getPolygons();\n\tfor (var i=0; i<g0.length; i++)\n\t{\tg.push(g0[i].cspline(options).getCoordinates());\n\t}\n\treturn new ol.geom.MultiPolygon(g);\n}\n/**\n*/\nol.geom.LineString.prototype.calcCSpline_ = function(options)\n {\tif (!options) options={};\n\tvar line = this.getCoordinates();\n\tvar tension = typeof options.tension === \"number\" ? options.tension : 0.5;\n\tvar resolution = options.resolution || (this.getLength() / line.length / (options.pointsPerSeg || 10));\n\tvar pts, res = [],\t\t\t// clone array\n\t\tx, y,\t\t\t\t\t// our x,y coords\n\t\tt1x, t2x, t1y, t2y,\t\t// tension vectors\n\t\tc1, c2, c3, c4,\t\t\t// cardinal points\n\t\tst, t, i;\t\t\t\t// steps based on num. of segments\n\t// clone array so we don't change the original\n\t//\n\tpts = line.slice(0);\n\t// The algorithm require a previous and next point to the actual point array.\n\t// Check if we will draw closed or open curve.\n\t// If closed, copy end points to beginning and first points to end\n\t// If open, duplicate first points to befinning, end points to end\n\tif (line.length>2 && line[0][0]==line[line.length-1][0] && line[0][1]==line[line.length-1][1]) \n\t{\tpts.unshift(line[line.length-2]);\n\t\tpts.push(line[1]);\n\t}\n\telse \n\t{\tpts.unshift(line[0]);\n\t\tpts.push(line[line.length-1]);\n\t}\n\t// ok, lets start..\n\tfunction dist2d(x1, y1, x2, y2)\n\t{\tvar dx = x2-x1;\n\t\tvar dy = y2-y1;\n\t\treturn Math.sqrt(dx*dx+dy*dy);\n\t}\n\t// 1. loop goes through point array\n\t// 2. loop goes through each segment between the 2 pts + 1e point before and after\n\tfor (i=1; i < (pts.length - 2); i++) \n\t{\tvar d1 = dist2d (pts[i][0], pts[i][1], pts[i+1][0], pts[i+1][1]);\n\t\tvar numOfSegments = Math.round(d1/resolution);\n\t\tvar d=1;\n\t\tif (options.normalize)\n\t\t{\td1 = dist2d (pts[i+1][0], pts[i+1][1], pts[i-1][0], pts[i-1][1]);\n\t\t\tvar d2 = dist2d (pts[i+2][0], pts[i+2][1], pts[i][0], pts[i][1]);\n\t\t\tif (d1<d2) d = d1/d2;\n\t\t\telse d = d2/d1;\n\t\t}\n\t\t// calc tension vectors\n\t\tt1x = (pts[i+1][0] - pts[i-1][0]) * tension *d;\n\t\tt2x = (pts[i+2][0] - pts[i][0]) * tension *d;\n\t\tt1y = (pts[i+1][1] - pts[i-1][1]) * tension *d;\n\t\tt2y = (pts[i+2][1] - pts[i][1]) * tension *d;\n\t\tfor (t=0; t <= numOfSegments; t++) \n\t\t{\t// calc step\n\t\t\tst = t / numOfSegments;\n\t\t\t// calc cardinals\n\t\t\tc1 =   2 * Math.pow(st, 3) \t- 3 * Math.pow(st, 2) + 1; \n\t\t\tc2 = -(2 * Math.pow(st, 3)) + 3 * Math.pow(st, 2); \n\t\t\tc3 = \t   Math.pow(st, 3)\t- 2 * Math.pow(st, 2) + st; \n\t\t\tc4 = \t   Math.pow(st, 3)\t- \t  Math.pow(st, 2);\n\t\t\t// calc x and y cords with common control vectors\n\t\t\tx = c1 * pts[i][0]\t+ c2 * pts[i+1][0] + c3 * t1x + c4 * t2x;\n\t\t\ty = c1 * pts[i][1]\t+ c2 * pts[i+1][1] + c3 * t1y + c4 * t2y;\n\t\t\t//store points in array\n\t\t\tif (x && y) res.push([x,y]);\n\t\t}\n\t}\n\treturn new ol.geom.LineString(res);\n}\n//NB: (Not confirmed)To use this module, you just have to :\n//   import('ol-ext/utils/cspline')\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** @typedef {'pointy' | 'flat'} HexagonLayout\n *  Layout of a Hexagon. Flat means the bottom part of the hexagon is flat.\n */\n/**\n* Hexagonal grids\n* @classdesc ol.HexGrid is a class to compute hexagonal grids\n* @see http://www.redblobgames.com/grids/hexagons\n*\n* @constructor ol.HexGrid\n* @extends {ol.Object}\n* @param {Object} [options]\n*\t@param {number} [options.size] size of the exagon in map units, default 80000\n*\t@param {ol.Coordinate} [options.origin] orgin of the grid, default [0,0]\n*\t@param {HexagonLayout} [options.layout] grid layout, default pointy\n*/\nol.HexGrid = function (options)\n{\toptions = options || {};\n\tol.Object.call (this, options);\n\t// Options\n\tthis.size_ = options.size||80000;\n\tthis.origin_ = options.origin || [0,0];\n\tthis.layout_ = this.layout[options.layout] || this.layout.pointy;\n};\nol.ext.inherits(ol.HexGrid, ol.Object);\n/** Layout\n*/\nol.HexGrid.prototype.layout =\n{\tpointy: \n\t[\tMath.sqrt(3), Math.sqrt(3)/2, 0, 3/2, \n\t\tMath.sqrt(3)/3, -1/3, 0, 2/3, \n\t\t// corners\n\t\tMath.cos(Math.PI / 180 * (60 * 0 + 30)), Math.sin(Math.PI / 180 * (60 * 0 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 1 + 30)), Math.sin(Math.PI / 180 * (60 * 1 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 2 + 30)), Math.sin(Math.PI / 180 * (60 * 2 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 3 + 30)), Math.sin(Math.PI / 180 * (60 * 3 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 4 + 30)), Math.sin(Math.PI / 180 * (60 * 4 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 5 + 30)), Math.sin(Math.PI / 180 * (60 * 5 + 30))\n\t],\n\tflat: \n\t[\t3/2, 0, Math.sqrt(3)/2, Math.sqrt(3), 2/3, \n\t\t0, -1/3, Math.sqrt(3) / 3, \n\t\t// corners\n\t\tMath.cos(Math.PI / 180 * (60 * 0)), Math.sin(Math.PI / 180 * (60 * 0)), \n\t\tMath.cos(Math.PI / 180 * (60 * 1)), Math.sin(Math.PI / 180 * (60 * 1)), \n\t\tMath.cos(Math.PI / 180 * (60 * 2)), Math.sin(Math.PI / 180 * (60 * 2)), \n\t\tMath.cos(Math.PI / 180 * (60 * 3)), Math.sin(Math.PI / 180 * (60 * 3)), \n\t\tMath.cos(Math.PI / 180 * (60 * 4)), Math.sin(Math.PI / 180 * (60 * 4)), \n\t\tMath.cos(Math.PI / 180 * (60 * 5)), Math.sin(Math.PI / 180 * (60 * 5))\n\t]\n};\n/** Set layout\n* @param {HexagonLayout | undefined} layout name, default pointy\n*/\nol.HexGrid.prototype.setLayout = function (layout)\n{\tthis.layout_ = this.layout[layout] || this.layout.pointy;\n\tthis.changed();\n}\n/** Get layout\n* @return {HexagonLayout} layout name\n*/\nol.HexGrid.prototype.getLayout = function ()\n{\treturn (this.layout_[9]!=0 ? 'pointy' : 'flat');\n}\n/** Set hexagon origin\n* @param {ol.Coordinate} coord origin\n*/\nol.HexGrid.prototype.setOrigin = function (coord)\n{\tthis.origin_ = coord;\n\tthis.changed();\n}\n/** Get hexagon origin\n* @return {ol.Coordinate} coord origin\n*/\nol.HexGrid.prototype.getOrigin = function ()\n{\treturn this.origin_;\n}\n/** Set hexagon size\n* @param {number} hexagon size\n*/\nol.HexGrid.prototype.setSize = function (s) {\n\tthis.size_ = s || 80000;\n\tthis.changed();\n}\n/** Get hexagon size\n* @return {number} hexagon size\n*/\nol.HexGrid.prototype.getSize = function () {\n\treturn this.size_;\n}\n/** Convert cube to axial coords\n* @param {ol.Coordinate} c cube coordinate\n* @return {ol.Coordinate} axial coordinate\n*/\nol.HexGrid.prototype.cube2hex = function (c)\n{\treturn [c[0], c[2]];\n};\n/** Convert axial to cube coords\n* @param {ol.Coordinate} h axial coordinate\n* @return {ol.Coordinate} cube coordinate\n*/\nol.HexGrid.prototype.hex2cube = function(h)\n{\treturn [h[0], -h[0]-h[1], h[1]];\n};\n/** Convert offset to axial coords\n* @param {ol.Coordinate} h axial coordinate\n* @return {ol.Coordinate} offset coordinate\n*/\nol.HexGrid.prototype.hex2offset = function (h)\n{\tif (this.layout_[9]) return [ h[0] + (h[1] - (h[1]&1)) / 2, h[1] ];\n\telse return [ h[0], h[1] + (h[0] + (h[0]&1)) / 2 ];\n}\n/** Convert axial to offset coords\n* @param {ol.Coordinate} o offset coordinate\n* @return {ol.Coordinate} axial coordinate\n*/\nol.HexGrid.prototype.offset2hex = function(o)\n{\tif (this.layout_[9]) return [ o[0] - (o[1] - (o[1]&1)) / 2,  o[1] ];\n\telse return [ o[0], o[1] - (o[0] + (o[0]&1)) / 2 ];\n}\n/** Convert offset to cube coords\n* @param {ol.Coordinate} c cube coordinate\n* @return {ol.Coordinate} offset coordinate\n* /\nol.HexGrid.prototype.cube2offset = function(c)\n{\treturn hex2offset(cube2hex(c));\n};\n/** Convert cube to offset coords\n* @param {ol.Coordinate} o offset coordinate\n* @return {ol.Coordinate} cube coordinate\n* /\nol.HexGrid.prototype.offset2cube = function (o)\n{\treturn hex2cube(offset2Hex(o));\n};\n/** Round cube coords\n* @param {ol.Coordinate} h cube coordinate\n* @return {ol.Coordinate} rounded cube coordinate\n*/\nol.HexGrid.prototype.cube_round = function(h)\n{\tvar rx = Math.round(h[0])\n\tvar ry = Math.round(h[1])\n\tvar rz = Math.round(h[2])\n\tvar x_diff = Math.abs(rx - h[0])\n\tvar y_diff = Math.abs(ry - h[1])\n\tvar z_diff = Math.abs(rz - h[2])\n\tif (x_diff > y_diff && x_diff > z_diff) rx = -ry-rz\n\telse if (y_diff > z_diff) ry = -rx-rz\n\telse rz = -rx-ry\n\treturn [rx, ry, rz];\n};\n/** Round axial coords\n* @param {ol.Coordinate} h axial coordinate\n* @return {ol.Coordinate} rounded axial coordinate\n*/\nol.HexGrid.prototype.hex_round = function(h)\n{\treturn this.cube2hex( this.cube_round( this.hex2cube(h )) );\n};\n/** Get hexagon corners\n*/\nol.HexGrid.prototype.hex_corner = function(center, size, i)\n{\treturn [ center[0] + size * this.layout_[8+(2*(i%6))], center[1] + size * this.layout_[9+(2*(i%6))]];\n};\n/** Get hexagon coordinates at a coordinate\n* @param {ol.Coordinate} coord\n* @return {Arrary<ol.Coordinate>}\n*/\nol.HexGrid.prototype.getHexagonAtCoord = function (coord)\n{\treturn (this.getHexagon(this.coord2hex(coord)));\n};\n/** Get hexagon coordinates at hex\n* @param {ol.Coordinate} hex\n* @return {Arrary<ol.Coordinate>}\n*/\nol.HexGrid.prototype.getHexagon = function (hex)\n{\tvar p = [];\n\tvar c = this.hex2coord(hex);\n\tfor (var i=0; i<=7; i++)\n\t{\tp.push(this.hex_corner(c, this.size_, i, this.layout_[8]));\n\t}\n\treturn p;\n};\n/** Convert hex to coord\n* @param {ol.hex} hex\n* @return {ol.Coordinate}\n*/\nol.HexGrid.prototype.hex2coord = function (hex)\n{\treturn [\n\t\tthis.origin_[0] + this.size_ * (this.layout_[0] * hex[0] + this.layout_[1] * hex[1]), \n\t\tthis.origin_[1] + this.size_ * (this.layout_[2] * hex[0] + this.layout_[3] * hex[1])\n\t];\n};\n/** Convert coord to hex\n* @param {ol.Coordinate} coord\n* @return {ol.hex}\n*/\nol.HexGrid.prototype.coord2hex = function (coord)\n{\tvar c = [ (coord[0]-this.origin_[0]) / this.size_, (coord[1]-this.origin_[1]) / this.size_ ];\n\tvar q = this.layout_[4] * c[0] + this.layout_[5] * c[1];\n\tvar r = this.layout_[6] * c[0] + this.layout_[7] * c[1];\n\treturn this.hex_round([q, r]);\n};\n/** Calculate distance between to hexagon (number of cube)\n* @param {ol.Coordinate} a first cube coord\n* @param {ol.Coordinate} a second cube coord\n* @return {number} distance\n*/\nol.HexGrid.prototype.cube_distance = function (a, b)\n{\t//return ( (Math.abs(a[0] - b[0]) + Math.abs(a[1] - b[1]) + Math.abs(a[2] - b[2])) / 2 );\n\treturn ( Math.max (Math.abs(a[0] - b[0]), Math.abs(a[1] - b[1]), Math.abs(a[2] - b[2])) );\n};\n(function(){\n/** Line interpolation\n*/\nfunction lerp(a, b, t)\n{\t// for floats\n    return a + (b - a) * t;\n}\nfunction cube_lerp(a, b, t)\n{\t// for hexes\n    return [ \n\t\tlerp (a[0]+1e-6, b[0], t), \n\t\tlerp (a[1]+1e-6, b[1], t),\n\t\tlerp (a[2]+1e-6, b[2], t)\n\t];\n}\n/** Calculate line between to hexagon\n* @param {ol.Coordinate} a first cube coord\n* @param {ol.Coordinate} b second cube coord\n* @return {Array<ol.Coordinate>} array of cube coordinates\n*/\nol.HexGrid.prototype.cube_line = function (a, b)\n{\tvar d = this.cube_distance(a, b);\n\tif (!d) return [a];\n    var results = []\n    for (var i=0; i<=d; i++) \n\t{\tresults.push ( this.cube_round ( cube_lerp(a, b, i/d) ) );\n\t}\n    return results;\n};\n})();\nol.HexGrid.prototype.neighbors =\n{\t'cube':\t[ [+1, -1,  0], [+1,  0, -1], [0, +1, -1], [-1, +1,  0], [-1,  0, +1], [0, -1, +1] ],\n\t'hex':\t[ [+1, 0], [+1,  -1], [0, -1], [-1, 0], [-1, +1], [0, +1] ]\n};\n/** Get the neighbors for an hexagon\n* @param {ol.Coordinate} h axial coord\n* @param {number} direction\n* @return { ol.Coordinate | Array<ol.Coordinate> } neighbor || array of neighbors\n*/\nol.HexGrid.prototype.hex_neighbors = function (h, d)\n{\tif (d!==undefined)\n\t{\treturn [ h[0] + this.neighbors.hex[d%6][0], h[1]  + this.neighbors.hex[d%6][1] ];\n\t}\n\telse\n\t{\tvar n = [];\n\t\tfor (d=0; d<6; d++)\n\t\t{\tn.push ([ h[0] + this.neighbors.hex[d][0], h[1]  + this.neighbors.hex[d][1] ]);\n\t\t}\n\t\treturn n;\n\t}\n};\n/** Get the neighbors for an hexagon\n* @param {ol.Coordinate} c cube coord\n* @param {number} direction\n* @return { ol.Coordinate | Array<ol.Coordinate> } neighbor || array of neighbors\n*/\nol.HexGrid.prototype.cube_neighbors = function (c, d)\n{\tif (d!==undefined)\n\t{\treturn [ c[0] + this.neighbors.cube[d%6][0], c[1]  + this.neighbors.cube[d%6][1], c[2]  + this.neighbors.cube[d%6][2] ];\n\t}\n\telse\n\t{\tvar n = [];\n\t\tfor (d=0; d<6; d++)\n\t\t{\tn.push ([ c[0] + this.neighbors.cube[d][0], c[1]  + this.neighbors.cube[d][1], c[2]  + this.neighbors.cube[d][2] ]);\n\t\t}\n\t\tfor (d=0; d<6; d++) n[d] = this.cube2hex(n[d])\n\t\treturn n;\n\t}\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * French INSEE grids\n * @classdesc a class to compute French INSEE grids, ie. fix area (200x200m) square grid, \n * based appon EPSG:3035\n *\n * @requires proj4\n * @constructor \n * @extends {ol.Object}\n * @param {Object} [options]\n *  @param {number} [options.size] size grid size in meter, default 200 (200x200m)\n */\nol.InseeGrid = function (options) {\n  options = options || {};\n  // Define EPSG:3035 if none\n  if (!proj4.defs[\"EPSG:3035\"]) {\n    proj4.defs(\"EPSG:3035\",\"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs\");\n    ol.proj.proj4.register(proj4);\n  }\n  ol.Object.call (this, options);\n  // Options\n  var size = Math.max(200, Math.round((options.size||0)/200) * 200);\n  this.set('size', size);\n};\nol.ext.inherits (ol.InseeGrid, ol.Object);\n/** Grid extent (in EPSG:3035)\n */\nol.InseeGrid.extent = [3200000,2000000,4300000,3140000];\n/** Get the grid extent\n * @param {ol.proj.ProjLike} [proj='EPSG:3857']\n */\nol.InseeGrid.prototype.getExtent = function (proj) {\n  return ol.proj.transformExtent(ol.InseeGrid.extent, proj||'EPSG:3035', 'EPSG:3857')\n};\n/** Get grid geom at coord\n * @param {ol.Coordinate} coord\n * @param {ol.proj.ProjLike} [proj='EPSG:3857']\n */\nol.InseeGrid.prototype.getGridAtCoordinate = function (coord, proj) {\n  var c = ol.proj.transform(coord, proj||'EPSG:3857', 'EPSG:3035')\n  var s = this.get('size');\n  var x = Math.floor(c[0]/s) * s;\n  var y = Math.floor(c[1]/s) * s;\n  var geom = new ol.geom.Polygon([[[x,y],[x+s,y],[x+s,y+s],[x,y+s],[x,y]]]);\n  geom.transform('EPSG:3035', proj||'EPSG:3857');\n  return geom;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Show a markup a point on postcompose\n*\t@deprecated use map.animateFeature instead\n*\t@param {ol.coordinates} point to pulse\n*\t@param {ol.markup.options} pulse options param\n*\t\t- projection {ol.projection|String|undefined} projection of coords, default none\n*\t\t- delay {Number} delay before mark fadeout\n*\t\t- maxZoom {Number} zoom when mark fadeout\n*\t\t- style {ol.style.Image|ol.style.Style|Array<ol.style.Style>} Image to draw as markup, default red circle\n*\t@return Unique key for the listener with a stop function to stop animation\n*/\nol.Map.prototype.markup = function(coords, options)\n{\tvar listenerKey;\n\tvar self = this;\n\toptions = options || {};\n\t// Change to map's projection\n\tif (options.projection)\n\t{\tcoords = ol.proj.transform(coords, options.projection, this.getView().getProjection());\n\t}\n\t// options\n\tvar start = new Date().getTime();\n\tvar delay = options.delay || 3000;\n\tvar duration = 1000;\n\tvar maxZoom = options.maxZoom || 100;\n\tvar easing = ol.easing.easeOut;\n\tvar style = options.style;\n\tif (!style) style = new ol.style.Circle({ radius:10, stroke:new ol.style.Stroke({color:'red', width:2 }) });\n\tif (style instanceof ol.style.Image) style = new ol.style.Style({ image: style });\n\tif (!(style instanceof Array)) style = [style];\n\t// Animate function\n\tfunction animate(event) \n\t{\tvar frameState = event.frameState;\n\t\tvar elapsed = frameState.time - start;\n\t\tif (elapsed > delay+duration) \n\t\t{\tol.Observable.unByKey(listenerKey);\n\t\t\tlistenerKey = null;\n\t\t}\n\t\telse \n\t\t{\tif (delay>elapsed && this.getView().getZoom()>maxZoom) delay = elapsed;\n\t\t\tvar ratio = frameState.pixelRatio;\n\t\t\tvar elapsedRatio = 0;\n\t\t\tif (elapsed > delay) elapsedRatio = (elapsed-delay) / duration;\n\t\t\tvar context = event.context;\n\t\t\tcontext.save();\n\t\t\tcontext.beginPath();\n\t\t\tcontext.globalAlpha = easing(1 - elapsedRatio);\n\t\t\tfor (var i=0; i<style.length; i++)\n\t\t\t{\tvar imgs = style[i].getImage();\n\t\t\t\tvar sc = imgs.getScale(); \n\t\t\t\timgs.setScale(sc*ratio);\n\t\t\t\tevent.vectorContext.setStyle(style[i]);\n\t\t\t\tevent.vectorContext.drawGeometry(new ol.geom.Point(coords));\n\t\t\t\timgs.setScale(sc);\n\t\t\t}\n\t\t\tcontext.restore();\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\tif (elapsed >= delay) frameState.animate = true;\n\t\t}\n\t}\n\tsetTimeout (function()\n\t\t{\tif (listenerKey) self.renderSync(); \n\t\t}, delay);\n\t// Launch animation\n\tlistenerKey = this.on('postcompose', animate.bind(this));\n\tthis.renderSync();\n\tlistenerKey.stop = function()\n\t{\tdelay = duration = 0;\n\t\tthis.target.renderSync();\n\t};\n\treturn listenerKey;\n}\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Ordering function for ol.layer.Vector renderOrder parameter\n*\tol.ordering.fn (options)\n*\tIt will return an ordering function (f0,f1)\n*\t@namespace\n*/\nol.ordering = {};\n/** y-Ordering\n*\t@return ordering function (f0,f1)\n*/\nol.ordering.yOrdering = function()\n{\treturn function(f0,f1)\n\t{\treturn f1.getGeometry().getExtent()[1] - f0.getGeometry().getExtent()[1] ;\n\t};\n};\n/** Order with a feature attribute\n * @param options\n *  @param {string} options.attribute ordering attribute, default zIndex\n *  @param {function} options.equalFn ordering function for equal values\n * @return ordering function (f0,f1)\n */\nol.ordering.zIndex = function(options)\n{\tif (!options) options = {};\n\tvar attr = options.attribute || 'zIndex';\n\tif (options.equalFn)\n\t{\treturn function(f0,f1)\n\t\t{\tif (f0.get(attr) == f1.get(attr)) return options.equalFn(f0,f1);\n\t\t\telse return f0.get(attr) < f1.get(attr) ? 1:-1;\n\t\t};\n\t}\n\telse\n\t{\treturn function(f0,f1)\n\t\t{\tif (f0.get(attr) == f1.get(attr)) return 0;\n\t\t\telse return f0.get(attr) < f1.get(attr) ? 1:-1;\n\t\t};\n\t}\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Pulse a point on postcompose\n*\t@deprecated use map.animateFeature instead\n*\t@param {ol.coordinates} point to pulse\n*\t@param {ol.pulse.options} pulse options param\n*\t\t- projection {ol.projection||String} projection of coords\n*\t\t- duration {Number} animation duration in ms, default 3000\n*\t\t- amplitude {Number} movement amplitude 0: none - 0.5: start at 0.5*radius of the image - 1: max, default 1\n*\t\t- easing {ol.easing} easing function, default ol.easing.easeOut\n*\t\t- style {ol.style.Image|ol.style.Style|Array<ol.style.Style>} Image to draw as markup, default red circle\n*/\nol.Map.prototype.pulse = function(coords, options)\n{\tvar listenerKey;\n\toptions = options || {};\n\t// Change to map's projection\n\tif (options.projection)\n\t{\tcoords = ol.proj.transform(coords, options.projection, this.getView().getProjection());\n\t}\n\t// options\n\tvar start = new Date().getTime();\n\tvar duration = options.duration || 3000;\n\tvar easing = options.easing || ol.easing.easeOut;\n\tvar style = options.style;\n\tif (!style) style = new ol.style.Circle({ radius:30, stroke:new ol.style.Stroke({color:'red', width:2 }) });\n\tif (style instanceof ol.style.Image) style = new ol.style.Style({ image: style });\n\tif (!(style instanceof Array)) style = [style];\n\tvar amplitude = options.amplitude || 1;\n\tif (amplitude<0) amplitude=0;\n\tvar maxRadius = options.radius || 15;\n\tif (maxRadius<0) maxRadius = 5;\n\t/*\n\tvar minRadius = maxRadius - (options.amplitude || maxRadius); //options.minRadius || 0;\n\tvar width = options.lineWidth || 2;\n\tvar color = options.color || 'red';\n\tconsole.log(\"pulse\")\n\t*/\n\t// Animate function\n\tfunction animate(event) \n\t{\tvar frameState = event.frameState;\n\t\tvar ratio = frameState.pixelRatio;\n\t\tvar elapsed = frameState.time - start;\n\t\tif (elapsed > duration) ol.Observable.unByKey(listenerKey);\n\t\telse\n\t\t{\tvar elapsedRatio = elapsed / duration;\n\t\t\tvar context = event.context;\n\t\t\tcontext.save();\n\t\t\tcontext.beginPath();\n\t\t\tvar e = easing(elapsedRatio)\n\t\t\tcontext.globalAlpha = easing(1 - elapsedRatio);\n\t\t\tconsole.log(\"anim\")\n\t\t\tfor (var i=0; i<style.length; i++)\n\t\t\t{\tvar imgs = style[i].getImage();\n\t\t\t\tvar sc = imgs.getScale(); \n\t\t\t\timgs.setScale(ratio*sc*(1+amplitude*(e-1)));\n\t\t\t\tevent.vectorContext.setStyle(style[i]);\n\t\t\t\tevent.vectorContext.drawGeometry(new ol.geom.Point(coords));\n\t\t\t\timgs.setScale(sc);\n\t\t\t}\n\t\t\tcontext.restore();\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\tframeState.animate = true;\n\t\t}\n\t}\n\t// Launch animation\n\tlistenerKey = this.on('postcompose', animate.bind(this));\n\tthis.renderSync();\n}\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*\n*  Add a chart style to display charts (pies or bars) on a map \n*/\n/**\n * @requires ol.style.Circle\n * @requires ol.structs.IHasChecksum\n */\n/**\n * @classdesc\n * Set chart style for vector features.\n *\n * @constructor\n * @param {} options\n *\t@param {String} options.type Chart type: pie,pie3D, donut or bar\n *\t@param {number} options.radius Chart radius/size, default 20\n *\t@param {number} options.rotation Rotation in radians (positive rotation clockwise). Default is 0.\n *\t@param {bool} options.snapToPixel use integral numbers of pixels, default true\n *\t@param {_ol_style_Stroke_} options.stroke stroke style\n *\t@param {String|Array<ol.color>} options.colors predefined color set \"classic\",\"dark\",\"pale\",\"pastel\",\"neon\" / array of color string, default classic\n *\t@param {number} options.offsetX X offset in px\n *\t@param {number} options.offsetY Y offset in px\n *\t@param {number} options.animation step in an animation sequence [0,1]\n *\t@param {number} options.max maximum value for bar chart\n * @see [Statistic charts example](../../examples/map.style.chart.html)\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.Chart = function(opt_options) {\n  var options = opt_options || {};\n  var strokeWidth = 0;\n  if (opt_options.stroke) strokeWidth = opt_options.stroke.getWidth();\n  ol.style.RegularShape.call (this, {\n    radius: options.radius + strokeWidth, \n    fill: new ol.style.Fill({color: [0,0,0]}),\n    rotation: options.rotation,\n    snapToPixel: options.snapToPixel\n  });\n  if (options.scale) this.setScale(options.scale);\n  this.stroke_ = options.stroke;\n  this.radius_ = options.radius || 20;\n  this.donutratio_ = options.donutRatio || 0.5;\n  this.type_ = options.type;\n  this.offset_ = [options.offsetX ? options.offsetX : 0, options.offsetY ? options.offsetY : 0];\n  this.animation_ = (typeof(options.animation) == 'number') ? { animate:true, step:options.animation } : this.animation_ = { animate:false, step:1 };\n  this.max_ = options.max;\n  this.data_ = options.data;\n  if (options.colors instanceof Array) {\n    this.colors_ = options.colors;\n  } else {\n    this.colors_ = ol.style.Chart.colors[options.colors];\n    if(!this.colors_) this.colors_ = ol.style.Chart.colors.classic;\n  }\n  this.renderChart_();\n};\nol.ext.inherits(ol.style.Chart, ol.style.RegularShape);\n/** Default color set: classic, dark, pale, pastel, neon\n*/\nol.style.Chart.colors = {\n  \"classic\":\t[\"#ffa500\",\"blue\",\"red\",\"green\",\"cyan\",\"magenta\",\"yellow\",\"#0f0\"],\n  \"dark\":\t\t[\"#960\",\"#003\",\"#900\",\"#060\",\"#099\",\"#909\",\"#990\",\"#090\"],\n  \"pale\":\t\t[\"#fd0\",\"#369\",\"#f64\",\"#3b7\",\"#880\",\"#b5d\",\"#666\"],\n  \"pastel\":\t[\"#fb4\",\"#79c\",\"#f66\",\"#7d7\",\"#acc\",\"#fdd\",\"#ff9\",\"#b9b\"], \n  \"neon\":\t\t[\"#ff0\",\"#0ff\",\"#0f0\",\"#f0f\",\"#f00\",\"#00f\"]\n}\n/**\n * Clones the style. \n * @return {ol.style.Chart}\n */\nol.style.Chart.prototype.clone = function() {\n  var s = new ol.style.Chart({\n    type: this.type_,\n    radius: this.radius_,\n    rotation: this.getRotation(),\n    scale: this.getScale(),\n    data: this.getData(),\n    snapToPixel: this.getSnapToPixel ? this.getSnapToPixel() : false,\n    stroke: this.stroke_,\n    colors: this.colors_,\n    offsetX: this.offset_[0],\n    offsetY: this.offset_[1],\n    animation: this.animation_\n  });\n  s.setScale(this.getScale());\n  s.setOpacity(this.getOpacity());\n  return s;\n};\n/** Get data associatied with the chart\n*/\nol.style.Chart.prototype.getData = function() {\n  return this.data_;\n}\n/** Set data associatied with the chart\n*\t@param {Array<number>}\n*/\nol.style.Chart.prototype.setData = function(data) {\n  this.data_ = data;\n  this.renderChart_();\n}\n/** Get symbol radius\n*/\nol.style.Chart.prototype.getRadius = function() {\n  return this.radius_;\n}\n/** Set symbol radius\n*\t@param {number} symbol radius\n*\t@param {number} donut ratio\n*/\nol.style.Chart.prototype.setRadius = function(radius, ratio) {\n  this.radius_ = radius;\n  this.donuratio_ = ratio || this.donuratio_;\n  this.renderChart_();\n}\n/** Set animation step \n*\t@param {false|number} false to stop animation or the step of the animation [0,1]\n*/\nol.style.Chart.prototype.setAnimation = function(step) {\n  if (step===false) {\n    if (this.animation_.animate == false) return;\n    this.animation_.animate = false;\n  } else {\n    if (this.animation_.step == step) return;\n    this.animation_.animate = true;\n    this.animation_.step = step;\n  }\n  this.renderChart_();\n}\n/** @private\n*/\nol.style.Chart.prototype.renderChart_ = function() {\n  var strokeStyle;\n  var strokeWidth = 0;\n  if (this.stroke_)  {\n    strokeStyle = ol.color.asString(this.stroke_.getColor());\n    strokeWidth = this.stroke_.getWidth();\n  }\n  // no atlas manager is used, create a new canvas\n  var canvas = this.getImage();\n  // draw the circle on the canvas\n  var context = (canvas.getContext('2d'));\n  context.clearRect(0, 0, canvas.width, canvas.height);\n  context.lineJoin = 'round';\n  var sum=0;\n  var i, c;\n  for (i=0; i<this.data_.length; i++) {\n    sum += this.data_[i];\n  }\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n  // then move to (x, y)\n  context.translate(0,0);\n  var step = this.animation_.animate ? this.animation_.step : 1;\n  //console.log(this.animation_.step)\n  // Draw pie\n  switch (this.type_) {\n    case \"donut\":\n    case \"pie3D\":\n    case \"pie\": {\n      var a, a0 = Math.PI * (step-1.5);\n      c = canvas.width/2;\n      context.strokeStyle = strokeStyle;\n      context.lineWidth = strokeWidth;\n      context.save();\n      if (this.type_==\"pie3D\") {\n        context.translate(0, c*0.3);\n        context.scale(1, 0.7);\n        context.beginPath();\n        context.fillStyle = \"#369\";\n        context.arc ( c, c*1.4, this.radius_ *step, 0, 2*Math.PI);\n        context.fill();\n        context.stroke();\n      }\n      if (this.type_==\"donut\") {\n        context.save();\n        context.beginPath();\n        context.rect ( 0,0,2*c,2*c );\n        context.arc ( c, c, this.radius_ *step *this.donutratio_, 0, 2*Math.PI);\n        context.clip(\"evenodd\");\n      }\n      for (i=0; i<this.data_.length; i++) {\n        context.beginPath();\n        context.moveTo(c,c);\n        context.fillStyle = this.colors_[i%this.colors_.length];\n        a = a0 + 2*Math.PI*this.data_[i]/sum *step;\n        context.arc ( c, c, this.radius_ *step, a0, a);\n        context.closePath();\n        context.fill();\n        context.stroke();\n        a0 = a;\n      }\n      if (this.type_==\"donut\") {\n        context.restore();\n        context.beginPath();\n        context.strokeStyle = strokeStyle;\n        context.lineWidth = strokeWidth;\n        context.arc ( c, c, this.radius_ *step *this.donutratio_, Math.PI * (step-1.5), a0);\n        context.stroke();\n      }\n      context.restore();\n      break;\n    }\n    case \"bar\":\n    default: {\n      var max=0;\n      if (this.max_) {\n        max = this.max_;\n      } else {\n        for (i=0; i<this.data_.length; i++) {\n          if (max < this.data_[i]) max = this.data_[i];\n        }\n      }\n      var s = Math.min(5,2*this.radius_/this.data_.length);\n      c = canvas.width/2;\n      var b = canvas.width - strokeWidth;\n      var x, x0 = c - this.data_.length*s/2\n      context.strokeStyle = strokeStyle;\n      context.lineWidth = strokeWidth;\n      for (i=0; i<this.data_.length; i++) {\n        context.beginPath();\n        context.fillStyle = this.colors_[i%this.colors_.length];\n        x = x0 + s;\n        var h = this.data_[i]/max*2*this.radius_ *step;\n        context.rect ( x0, b-h, s, h);\n        //console.log ( x0+\", \"+(b-this.data_[i]/max*2*this.radius_)+\", \"+x+\", \"+b);\n        context.closePath();\n        context.fill();\n        context.stroke();\n        x0 = x;\n      }\n    }\n  }\n  // Set Anchor\n  var anchor = this.getAnchor();\n  anchor[0] = c - this.offset_[0];\n  anchor[1] = c - this.offset_[1];\n};\n/**\n * @inheritDoc\n */\nol.style.Chart.prototype.getChecksum = function() {\n  var strokeChecksum = (this.stroke_!==null) ?\n    this.stroke_.getChecksum() : '-';\n  var fillChecksum;\n  var recalculate = (this.checksums_===null) ||\n    (strokeChecksum != this.checksums_[1] ||\n    fillChecksum != this.checksums_[2] ||\n    this.radius_ != this.checksums_[3] ||\n    this.data_.join('|') != this.checksums_[4]);\n  if (recalculate) {\n    var checksum = 'c' + strokeChecksum + fillChecksum \n      + ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n      + this.data_.join('|');\n    this.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.data_.join('|')];\n  }\n  return this.checksums_[0];\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * Fill style with named pattern\n *\n * @constructor\n * @param {olx.style.FillPatternOption=}  options\n *\t@param {ol.style.Image|undefined} options.image an image pattern, image must be preloaded to draw on first call\n *\t@param {number|undefined} options.opacity opacity with image pattern, default:1\n *\t@param {olx.style.fillPattern} options.pattern pattern name (override by image option)\n *\t@param {ol.color} options.color pattern color\n *\t@param {ol.style.Fill} options.fill fill color (background)\n *\t@param {number} options.offset pattern offset for hash/dot/circle/cross pattern\n *\t@param {number} options.size line size for hash/dot/circle/cross pattern\n *\t@param {number} options.spacing spacing for hash/dot/circle/cross pattern\n *\t@param {number|bool} options.angle angle for hash pattern / true for 45deg dot/circle/cross\n *\t@param {number} options.scale pattern scale \n * @extends {ol.style.Fill}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.FillPattern = function(options)\n{\tif (!options) options = {};\n\tvar pattern;\n\tvar canvas = this.canvas_ = document.createElement('canvas');\n\tvar scale = Number(options.scale)>0 ? Number(options.scale) : 1;\n\tvar ratio = scale*ol.has.DEVICE_PIXEL_RATIO || ol.has.DEVICE_PIXEL_RATIO;\n\tvar ctx = canvas.getContext('2d');\n\tif (options.image)\n\t{\toptions.image.load();\n\t\tvar i;\n\t\tvar img = options.image.getImage();\n\t\tif (img.width)\n\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t}\n\t\telse \n\t\t{\tvar self = this;\n\t\t\tpattern = [0,0,0,0];\n\t\t\timg.onload = function ()\n\t\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t\tself.setColor(pattern);\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\tvar pat = this.getPattern_(options);\n\t\tcanvas.width = Math.round(pat.width *ratio);\n\t\tcanvas.height = Math.round(pat.height *ratio);\n\t\tctx.beginPath();\n\t\tif (options.fill) \n\t\t{\tctx.fillStyle = ol.color.asString(options.fill.getColor());\n\t\t\tctx.fillRect(0,0, canvas.width, canvas.height);\n\t\t}\n\t\tctx.scale(ratio,ratio);\n\t\tctx.lineCap = \"round\";\n\t\tctx.lineWidth = pat.stroke || 1;\n\t\tctx.fillStyle = ol.color.asString(options.color||\"#000\");\n\t\tctx.strokeStyle = ol.color.asString(options.color||\"#000\");\n\t\tif (pat.circles) for (i=0; i<pat.circles.length; i++)\n\t\t{\tvar ci = pat.circles[i]; \n\t\t\tctx.beginPath();\n\t\t\tctx.arc(ci[0], ci[1], ci[2], 0,2*Math.PI);\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t}\n\t\tif (!pat.repeat) pat.repeat=[[0,0]];\n\t\tif (pat.char)\n\t\t{\tctx.font = pat.font || (pat.width)+\"px Arial\";\n\t\t\tctx.textAlign = 'center';\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tif (pat.angle) \n\t\t\t{\tctx.fillText(pat.char, pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, 3*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, 3*pat.height/4);\n\t\t\t}\n\t\t\telse ctx.fillText(pat.char, pat.width/2, pat.height/2);\n\t\t}\n\t\tif (pat.lines) for (i=0; i<pat.lines.length; i++) for (var r=0; r<pat.repeat.length; r++)\n\t\t{\tvar li = pat.lines[i];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(li[0]+pat.repeat[r][0],li[1]+pat.repeat[r][1]);\n\t\t\tfor (var k=2; k<li.length; k+=2)\n\t\t\t{\tctx.lineTo(li[k]+pat.repeat[r][0],li[k+1]+pat.repeat[r][1]);\n\t\t\t}\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t\tctx.save()\n\t\t\tctx.strokeStyle = 'red';\n\t\t\tctx.strokeWidth = 0.1;\n\t\t\t//ctx.strokeRect(0,0,canvas.width,canvas.height);\n\t\t\tctx.restore()\n\t\t}\n\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\tif (options.offset)\n\t\t{\tvar offset = options.offset;\n\t\t\tif (typeof(offset) == \"number\") offset = [offset,offset];\n\t\t\tif (offset instanceof Array) \n\t\t\t{\tvar dx = Math.round((offset[0]*ratio));\n\t\t\t\tvar dy = Math.round((offset[1]*ratio));\n\t\t\t\t// New pattern\n\t\t\t\tctx.scale(1/ratio,1/ratio)\n\t\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\t\t\t\tctx.translate(dx,dy);\n\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\tctx.fillRect(-dx, -dy, canvas.width,canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t}\n\t\t}\n\t}\n\tol.style.Fill.call (this, { color: pattern });\n};\nol.ext.inherits(ol.style.FillPattern, ol.style.Fill);\n/**\n * Clones the style. \n * @return {ol.style.FillPattern}\n */\nol.style.FillPattern.prototype.clone = function()\n{\tvar s = ol.style.Fill.prototype.clone.call(this);\n\ts.canvas_ = this.canvas_;\n\treturn s;\n};\n/** Get canvas used as pattern\n*\t@return {canvas}\n*/\nol.style.FillPattern.prototype.getImage = function()\n{\treturn this.canvas_;\n}\n/** Get pattern\n*\t@param {olx.style.FillPatternOption}\n*/\nol.style.FillPattern.prototype.getPattern_ = function(options)\n{\tvar pat = ol.style.FillPattern.prototype.patterns[options.pattern]\n\t\t|| ol.style.FillPattern.prototype.patterns.dot;\n\tvar d = Math.round(options.spacing)||10;\n\tvar size;\n\tswitch (options.pattern)\n\t{\tcase 'dot':\n\t\tcase 'circle':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.circles = [[ d/2, d/2, size ]]\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/2+d, d/2, size ],\n\t\t\t\t\t\t[ d/2-d, d/2, size ],\n\t\t\t\t\t\t[ d/2, d/2+d, size ],\n\t\t\t\t\t\t[ d/2, d/2-d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2-d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2-d, size ] ])\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\td = pat.width = pat.height = Math.round(d*1.4);\n\t\t\t\tpat.circles = [[ d/4, d/4, size ], [ 3*d/4, 3*d/4, size ]];\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/4+d, d/4, size ],\n\t\t\t\t\t\t[ d/4, d/4+d, size ],\n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4, size ],\n\t\t\t\t\t\t[ 3*d/4, 3*d/4-d, size ],\n\t\t\t\t\t\t[ d/4+d, d/4+d, size ], \n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4-d, size ] ]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'tile':\n\t\tcase 'square':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.lines = [[ d/2-size, d/2-size, d/2+size, d/2-size, d/2+size, d/2+size, d/2-size,d/2+size, d/2-size, d/2-size ]]\n\t\t\t}\n\t\t\telse\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\t//size *= Math.sqrt(2);\n\t\t\t\tpat.lines = [[ d/2-size,d/2, d/2,d/2-size, d/2+size,d/2, d/2,d/2+size, d/2-size,d/2 ]]\n\t\t\t}\n\t\t\tif (options.pattern=='square') pat.repeat = [[0,0], [0,d], [d,0], [0,-d], [-d,0], [-d,-d], [d,d], [-d,d], [d,-d] ]\n\t\t\tbreak;\n\t\t}\n\t\tcase 'cross':\n\t\t{\t// Limit angle to 0 | 45\n\t\t\tif (options.angle) options.angle = 45;\n\t\t}\n\t\t// fallsthrough\n\t\tcase 'hatch':\n\t\t{\tvar a = Math.round(((options.angle||0)-90)%360);\n\t\t\tif (a>180) a -= 360;\n\t\t\ta *= Math.PI/180;\n\t\t\tvar cos = Math.cos(a);\n\t\t\tvar sin = Math.sin(a);\n\t\t\tif (Math.abs(sin)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0,0.5, d, 0.5 ] ];\n\t\t\t\tpat.repeat = [ [0,0], [0,d] ];\n\t\t\t}\n\t\t\telse  if (Math.abs(cos)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0.5,0, 0.5, d] ];\n\t\t\t\tpat.repeat = [ [0,0], [d,0] ];\n\t\t\t\tif (options.pattern=='cross') \n\t\t\t\t{\tpat.lines.push ([ 0,0.5, d, 0.5 ]);\n\t\t\t\t\tpat.repeat.push([0,d]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\tvar w = pat.width = Math.round(Math.abs(d/sin)) || 1;\n\t\t\t\tvar h = pat.height = Math.round(Math.abs(d/cos)) || 1;\n\t\t\t\tif (options.pattern=='cross')\n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h], [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0] ];\n\t\t\t\t}\n\t\t\t\telse if (cos*sin>0) \n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\tpat.lines = [ [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [-w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tpat.stroke = options.size===0 ? 0 : options.size||4;\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n\treturn pat\n}\n/** Static fuction to add char patterns\n*\t@param {title} \n*\t@param {olx.fillpattern.Option}\n*\t\t- size {integer} default 10\n*\t\t- width {integer} default 10\n*\t\t- height {integer} default 10\n*\t\t- circles {Array<circles>}\n*\t\t- lines: {Array<pointlist>}\n*\t\t- stroke {integer}\n*\t\t- fill {bool}\n*\t\t- char {char}\n*\t\t- font {string} default \"10px Arial\"\n*/\nol.style.FillPattern.addPattern = function (title, options)\n{\tif (!options) options={};\n\tol.style.FillPattern.prototype.patterns[title || options.char] =\n\t{\twidth: options.width || options.size || 10,\n\t\theight: options.height || options.size || 10,\n\t\tfont: options.font,\n\t\tchar: options.char,\n\t\tcircles: options.circles,\n\t\tlines: options.lines,\n\t\trepeat: options.repeat,\n\t\tstroke: options.stroke,\n\t\tangle: options.angle,\n\t\tfill: options.fill\n\t}\n}\n/** Patterns definitions\n\tExamples : http://seig.ensg.ign.fr/fichchap.php?NOFICHE=FP31&NOCHEM=CHEMS009&NOLISTE=1&N=8\n*/\nol.style.FillPattern.prototype.patterns =\n{\n\t\"hatch\":\n\t{\twidth:5,\n\t\theight:5,\n\t\tlines:[[0,2.5,5,2.5]],\n\t\tstroke:1\n\t},\n\t\"cross\":\n\t{\twidth:7,\n\t\theight:7,\n\t\tlines:[[0,3,10,3],[3,0,3,10]],\n\t\tstroke:1\n\t},\n\t\"dot\":\n\t{\twidth:8,\n\t\theight:8,\n\t\tcircles:[[5,5,2]],\n\t\tstroke:false,\n\t\tfill:true,\n\t},\n\t\"circle\":\n\t{\twidth:10,\n\t\theight:10,\n\t\tcircles:[[5,5,2]],\n\t\tstroke:1,\n\t\tfill:false,\n\t},\n\t\"square\":\n\t{\twidth:10,\n\t\theight:10,\n\t\tlines:[[3,3, 3,8, 8,8, 8,3, 3,3]],\n\t\tstroke:1,\n\t\tfill:false,\n\t},\n\t\"tile\":\n\t{\twidth:10,\n\t\theight:10,\n\t\tlines:[[3,3, 3,8, 8,8, 8,3, 3,3]],\n\t\tfill:true,\n\t},\n\t\"woven\":\n\t{\twidth: 12,\n\t\theight: 12,\n\t\tlines: [[ 3,3, 9,9 ],[0,12, 3,9], [9,3, 12,0], [-1,1,1,-1], [13,11,11,13]],\n\t\tstroke: 1\n\t},\n\t\"crosses\":\n\t{\twidth: 8,\n\t\theight: 8,\n\t\tlines: [[ 2,2, 6,6 ],[2,6,6,2]],\n\t\tstroke: 1\n\t},\n\t\"caps\":\n\t{\twidth: 8,\n\t\theight: 8,\n\t\tlines: [[ 2,6, 4,2, 6,6 ]],\n\t\tstroke: 1\n\t},\n\t\"nylon\":\n\t{\twidth: 20,\n\t\theight: 20,\n//\t\tlines: [[ 0,5, 0,0, 5,0 ],[ 5,10, 10,10, 10,5 ], [ 10,15, 10,20, 15,20 ],[ 15,10, 20,10, 20,15 ]],\n//\t\trepeat: [[0,0], [20,0], [0,20], [-20,0], [0,-20], [-20,-20]],\n\t\tlines: [[ 1,6, 1,1, 6,1 ],[ 6,11, 11,11, 11,6 ], [ 11,16, 11,21, 16,21 ],[ 16,11, 21,11, 21,16 ]],\n\t\trepeat: [[0,0], [-20,0], [0,-20] ],\n\t\tstroke: 1\n\t},\n\t\"hexagon\":\n\t{\twidth: 20,\n\t\theight: 12,\n\t\tlines: [[ 0,10, 4,4, 10,4, 14,10, 10,16, 4,16, 0,10 ]],\n\t\tstroke:1,\n\t\trepeat:[[0,0],[10,6],[10,-6],[-10,-6]]\n\t},\n\t\"cemetry\":\n\t{\twidth:15,\n\t\theight:19,\n\t\tlines:[[0,3.5,7,3.5],[3.5,0,3.5,10],\n\t\t\t//[7,12.5,14,12.5],[10.5,9,10.5,19]\n\t\t\t],\n\t\tstroke:1,\n\t\trepeat:[[0,0],[7,9]]\n\t},\n\t\"sand\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tcircles:[[1,2,1],[9,3,1],[2,16,1],\n\t\t\t\t[7,8,1],[6,14,1],[4,19,1],\n\t\t\t\t[14,2,1],[12,10,1],[14,18,1],\n\t\t\t\t[18,8,1],[18,14,1]],\n\t\tfill:1\n\t},\n\t\"conglomerate\":\n\t{\twidth:30,\n\t\theight:20,\n\t\tcircles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],\n\t\tlines:[[7,5, 6,7, 9,9, 11,8, 11,6, 9,5, 7,5], \n\t\t\t[16,10, 15,13, 16,14, 19,15, 21,13, 22,9, 20,8, 19,8, 16,10], \n\t\t\t[24,6, 26,7, 27,5, 26,4, 24,4, 24,6]],\n\t\tstroke:1\n\t},\n\t\"gravel\":\n\t{\twidth:15,\n\t\theight:10,\n\t\tcircles:[[4,2,1],[5,9,1],[1,7,1]],//[9,9,1],,[15,2,1]],\n\t\tlines:[[7,5, 6,6, 7,7, 8,7, 9,7, 10,5, 9,4, 7,5], [11,2, 14,4, 14,1, 12,1, 11,2]],\n\t\tstroke:1\n\t},\n\t\"brick\":\n\t{\twidth:18,\n\t\theight:16,\n\t\tlines:[\t[0,1,18,1],[0,10,18,10], [6,1,6,10],[12,10,12,18],[12,0,12,1]],\n\t\tstroke:1\n\t},\n\t\"dolomite\":\n\t{\twidth:20,\n\t\theight:16,\n\t\tlines:[[0,1,20,1],[0,9,20,9],[1,9,6,1],[11,9,14,16],[14,0,14.4,1]],\n\t\tstroke:1\n\t},\n\t\"coal\":\n\t{\twidth:20,\n\t\theight:16,\n\t\tlines:[[1,5, 7,1, 7,7], [11,10, 12,5, 18,9], [5,10, 2,15, 9,15,], [15,16, 15,13, 20,16], [15,0, 15,2, 20,0]],\n\t\tfill:1\n\t},\n\t\"breccia\":\n\t{\twidth:20,\n\t\theight:16,\n\t\tlines:[[1,5, 7,1, 7,7, 1,5], [11,10, 12,5, 18,9, 11,10], [5,10, 2,15, 9,15, 5,10], [15,16, 15,13, 22,18], [15,0, 15,2, 20,0] ],\n\t\tstroke:1,\n\t},\n\t\"clay\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tlines:[[0,0, 3,11, 0,20], [11,0, 10,3, 13,13, 11,20], [0,0, 10,3, 20,0], [0,12, 3,11, 13,13, 20,12]],\n\t\tstroke:1\n\t},\n\t\"flooded\":\n\t{\twidth:15,\n\t\theight:10,\n\t\tlines:[\t[0,1,10,1],[0,6,5,6], [10,6,15,6]],\n\t\tstroke:1\n\t},\n\t\"chaos\":\n\t{\twidth:40,\n\t\theight:40,\n\t\tlines:[[40,2, 40,0, 38,0, 40,2], \n\t\t\t[4,0, 3,2, 2,5, 0,0, 0,3, 2,7, 5,6, 7,7, 8,10, 9,12, 9,13, 9,14, 8,14, 6,15, 2,15, 0,20, 0,22, 2,20, 5,19, \n\t\t\t\t8,15, 10,14, 11,12.25, 10,12, 10,10, 12,9, 13,7, 12,6, 13,4, 16,7, 17,4, 20,0, 18,0, 15,3, 14,2, 14,0,\n\t\t\t\t12,1, 11,0, 10,1, 11,4, 10,7, 9,8, 8,5, 6,4, 5,3, 5,1, 5,0, 4,0],\n\t\t\t[7,1, 7,3, 8,3, 8,2, 7,1], [4,3, 5,5, 4,5, 4,3], [34,5, 33,7, 38,10, 38,8, 36,5, 34,5], \n\t\t\t[ 27,0, 23,2, 21,8, 30,0, 27,0], \n\t\t\t[25,8, 26,12, 26,16, 22.71875,15.375, 20,13, 18,15, 17,18, 13,22, 17,21, 19,22, 21,20, 19,18, 22,17, 30,25, \n\t\t\t26,26, 24,28, 21.75,33.34375, 20,36, 18,40, 20,40, 24,37, 25,32, 27,31, 26,38, 27,37, 30,32, 32,35, 36,37, \n\t\t\t38,40, 38,39, 40,40, 37,36, 34,32, 37,31, 36,29, 33,27, 34,24, 39,21, 40,21, 40,16, 37,20, 31,22, 32,25, \n\t\t\t27,20, 29,15, 30,20, 32,20, 34,18, 33,12, 31,11, 29,14, 26,9, 25,8], [39,24, 37,26, 40,28, 39,24], \n\t\t\t[13,15, 9,19, 14,18, 13,15], [18,23, 14,27, 16,27, 17,25, 20,26, 18,23], \n\t\t\t[6,24, 2,26, 1,28, 2,30, 5,28, 12,30, 16,32, 18,30, 15,30, 12,28, 9,25, 7,27, 6,24], \n\t\t\t[29,27, 32,28, 33,31, 30,29, 27,28, 29,27], \n\t\t\t[5,35, 1,33, 3,36, 13,38, 15,35, 10,36, 5,35]],\n\t\tfill:1,\n\t},\n\t\"grass\":\n\t{\twidth:27,\n\t\theight:22,\n\t\tlines: [[0,10.5,13,10.5], [2.5,10,1.5,7], [4.5,10, 4.5,5, 3.5,4 ], [7,10, 7.5,6, 8.5,3], [10,10,11,6]],\n\t\trepeat: [[0,0],[14,10]],\n\t\tstroke:1\n\t},\n\t\"swamp\":\n\t{\twidth:24,\n\t\theight:23,\n\t\tlines:[ [0,10.5,9.5,10.5], [2.5,10,2.5,7], [4.5,10,4.5,4], [6.5,10,6.5,6], [3,12.5,7,12.5] ],\n\t\trepeat: [[0,0],[14,10]],\n\t\tstroke:1\n\t},\n\t\"wave\":\n\t{\twidth:10,\n\t\theight:8,\n\t\tlines:[ [0,0, 5,4, 10,0] ],\n\t\tstroke:1\n\t},\n\t\"vine\":\n\t{\twidth:13,\n\t\theight:13,\n\t\tlines:[[3,0,3,6],[9,7,9,13]],\n\t\tstroke:1.0\n\t},\n\t\"forest\":\n\t{\twidth:55,\n\t\theight:30,\n\t\tcircles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],\n\t\tstroke:1\n\t},\n\t\"scrub\":\n\t{\twidth:26,\n\t\theight:20,\n\t\tlines:[ [1,4, 4,8, 6,4] ],\n\t\tcircles:[[20,13,1.5]],\n\t\tstroke:1,\n\t},\n\t\"tree\":\n\t{\twidth:30,\n\t\theight:30,\n\t\tlines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,0.71,6.36,0,4.24,0.71,2.12,4.24,0,7.78,0.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78]],\n\t\trepeat: [[3,1],[18,16]],\n\t\tstroke:1\n\t},\n\t\"pine\":\n\t{\twidth:30,\n\t\theight:30,\n\t\tlines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49]],\n\t\trepeat:[[3,1],[18,16]],\n\t\tstroke:1\n\t},\n\t\"pines\":\n\t{\twidth:22,\n\t\theight:20,\n\t\tlines:[[1,4,3.5,1,6,4],[1,8,3.5,5,6,8],[3.5,1,3.5,11],[12,14.5,14.5,14,17,14.5],[12,18,17,18],[14.5,12,14.5,18]],\n\t\trepeat: [[2,1]],\n\t\tstroke:1\n\t},\n\t\"rock\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tlines:[\t[1,0,1,9],[4,0,4,9],[7,0,7,9], \n\t\t\t\t[10,1,19,1],[10,4,19,4],[10,7,19,7],\n\t\t\t\t[0,11,9,11],[0,14,9,14],[0,17,9,17], \n\t\t\t\t[12,10,12,19],[15,10,15,19],[18,10,18,19] ],\n\t\trepeat:[[0.5,0.5]],\n\t\tstroke:1\n\t},\n\t\"rocks\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tlines:[\t[5,0, 3,0, 5,4, 4,6, 0,3, 0,5, 3,6, 5,9, 3.75,10, 2.5,10, 0,9, 0,10, 4,11, 5,14, 4,15, 0,13,\n\t\t\t0,13, 0,13, 0,14, 0,14, 5,16, 5,18, 3,19, 0,19, -0.25,19.9375, 5,20, 10,19, 10,20, 11,20, 12,19,\n\t\t\t14,20, 15,20, 17,19, 20,20, 20,19, 19,16, 20,15, 20,11, 20,10, 19,8, 20,5, 20,0, 19,0, 20,2, 19,4,\n\t\t\t17,4, 16,3, 15,0, 14,0, 15,4, 11,5, 10,4, 11,0, 10,0, 9,4, 6,5, 5,0,],\n\t\t\t[18,5, 19,6, 18,10, 16,10, 14,9, 16,5, 18,5], \n\t\t\t[5,6, 9,5, 10,6, 10,9, 6,10, 5,6], \n\t\t\t[14,5, 14,8, 13,9, 12,9, 11,7, 12,5, 14,5], \n\t\t\t[ 5,11, 8,10, 9,11, 10,14, 6,15, 6,15, 5,11], \n\t\t\t[13,10, 14,11, 15,14, 15,14, 15,14, 11,15, 10,11, 11,10, 13,10], \n\t\t\t[15,12, 16,11, 19,11, 19,15, 16,14, 16,14, 15,12], \n\t\t\t[6,16, 9,15, 10,18, 5,19, 6,16], \n\t\t\t[10,16, 14,16, 14,18, 13,19, 11,18, 10,16], \n\t\t\t[15,15, 18,16, 18,18, 16,19, 15,18, 15,15]],\n\t\tstroke:1\n\t}\n}\n/**\n * /\nol.style.FillPattern.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.form_+\"-\"+this.glyphs_ != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.form_+\"-\"+this.glyphs_;\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.form_+\"-\"+this.glyphs_];\n\t}\n\treturn this.checksums_[0];\n};\n/**/\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Flow line style\n * Draw LineString with a variable color / width\n *\n * @extends {ol.style.Style}\n * @constructor\n * @param {Object} options\n *  @param {boolean} options.visible draw only the visible part of the line, default true\n *  @param {number|function} options.width Stroke width or a function that gets a feature and the position (beetween [0,1]) and returns current width\n *  @param {number} options.width2 Final stroke width\n *  @param {ol.colorLike|function} options.color Stroke color or a function that gets a feature and the position (beetween [0,1]) and returns current color\n *  @param {ol.colorLike} options.color2 Final sroke color\n */\nol.style.FlowLine = function(options) {\n  if (!options) options = {};\n  ol.style.Style.call (this, { \n    renderer: this._render.bind(this),\n    geometry: options.geometry\n  });\n  // Draw only visible\n  this._visible = (options.visible !== false);\n  // Width\n  if (typeof options.width === 'function') {\n    this._widthFn = options.width;\n  } else {\n    this.setWidth(options.width);\n  }\n  this.setWidth2(options.width2);\n  // Color\n  if (typeof options.color === 'function') {\n    this._colorFn = options.color;\n  } else {\n    this.setColor(options.color);\n  }\n  this.setColor2(options.color2);\n  // LineCap\n  this.setLineCap(options.lineCap);\n};\nol.ext.inherits(ol.style.FlowLine, ol.style.Style);\n/** Set the initial width\n * @param {number} width width, default 0\n */\nol.style.FlowLine.prototype.setWidth = function(width) {\n  this._width = width || 0;\n};\n/** Set the final width\n * @param {number} width width, default 0\n */\nol.style.FlowLine.prototype.setWidth2 = function(width) {\n  this._width2 = width;\n};\n/** Set the LineCap\n * @param {steing} cap LineCap (round or mitter), default mitter\n */\nol.style.FlowLine.prototype.setLineCap = function(cap) {\n  this._lineCap = (cap==='round' ? 'round' : 'mitter');\n};\n/** Get the current width at step\n * @param {ol.feature} feature\n * @param {number} step current drawing step beetween [0,1] \n * @return {number} \n */\nol.style.FlowLine.prototype.getWidth = function(feature, step) {\n  if (this._widthFn) return this._widthFn(feature, step);\n  var w2 = (typeof(this._width2) === 'number') ? this._width2 : this._width;\n  return this._width + (w2-this._width) * step;\n};\n/** Set the initial color\n * @param {ol.colorLike} color\n */\nol.style.FlowLine.prototype.setColor = function(color) {\n  try{\n    this._color = ol.color.asArray(color);\n  } catch(e) {\n    this._color = [0,0,0,1];\n  }\n};\n/** Set the final color\n * @param {ol.colorLike} color\n */\nol.style.FlowLine.prototype.setColor2 = function(color) {\n  try {\n    this._color2 = ol.color.asArray(color);\n  } catch(e) {\n    this._color2 = null;    \n  }\n};\n/** Get the current color at step\n * @param {ol.feature} feature\n * @param {number} step current drawing step beetween [0,1] \n * @return {string} \n */\nol.style.FlowLine.prototype.getColor = function(feature, step) {\n  if (this._colorFn) return ol.color.asString(this._colorFn(feature, step));\n  var color = this._color;\n  var color2 = this._color2 || this._color\n  return 'rgba('+\n          + Math.round(color[0] + (color2[0]-color[0]) * step) +','\n          + Math.round(color[1] + (color2[1]-color[1]) * step) +','\n          + Math.round(color[2] + (color2[2]-color[2]) * step) +','\n          + (color[3] + (color2[3]-color[3]) * step)\n          +')';\n};\n/** Renderer function\n * @param {Array<ol.coordinate>} geom The pixel coordinates of the geometry in GeoJSON notation\n * @param {ol.render.State} e The olx.render.State of the layer renderer\n */\nol.style.FlowLine.prototype._render = function(geom, e) {\n  if (e.geometry.getType()==='LineString') {\n    var i, p, ctx = e.context;\n    // Get geometry used at drawing\n    if (!this._visible) {\n      var a = e.pixelRatio / e.resolution;\n      var g = e.geometry.getCoordinates();\n      var dx = geom[0][0] - g[0][0] * a;\n      var dy = geom[0][1] + g[0][1] * a;\n      geom = [];\n      for (i=0; p=g[i]; i++) {\n        geom[i] = [ dx + p[0] * a, dy - p[1] * a];\n      }\n    }\n    // Split into\n    var geoms = this._splitInto(geom, 255, 2);\n    var k = 0;\n    var nb = geoms.length;\n    // Draw\n    ctx.save();\n      ctx.lineJoin = 'round';\n      ctx.lineCap = this._lineCap || 'mitter';\n      geoms.forEach(function(g) {\n        var step = k++/nb;\n        ctx.lineWidth = this.getWidth(e.feature, step) * e.pixelRatio;\n        ctx.strokeStyle = this.getColor(e.feature, step);\n        ctx.beginPath();\n        ctx.moveTo(g[0][0],g[0][1]);\n        for (i=1; p=g[i]; i++) {\n          ctx.lineTo(p[0],p[1]);\n          ctx.stroke();\n        }\n      }.bind(this));\n    ctx.restore();\n  }\n};\n/** Split line geometry into equal length geometries\n * @param {Array<ol.coordinate>} geom\n * @param {number} nb number of resulting geometries, default 255\n * @param {number} nim minimum length of the resulting geometries, default 1\n */\nol.style.FlowLine.prototype._splitInto = function(geom, nb, min) {\n  var i, p;\n  // Split geom into equal length geoms\n  var geoms = [];\n  var dl, l = 0;\n  for (i=1; p=geom[i]; i++) {\n    l += ol.coordinate.dist2d(geom[i-1], p);\n  }\n  var length = Math.max (min||2, l/(nb||255));\n  var p0 = geom[0];\n  l = 0;\n  var g = [p0];\n  i = 1;\n  p = geom[1];\n  while (i < geom.length) {\n    var dx = p[0]-p0[0];\n    var dy = p[1]-p0[1];\n    dl = Math.sqrt(dx*dx + dy*dy);\n    if (l+dl > length) {\n      var d = (length-l) / dl;\n      g.push([ \n        p0[0] + dx * d,  \n        p0[1] + dy * d \n      ]);\n      geoms.push(g);\n      p0 =[ \n        p0[0] + dx * d*.9,  \n        p0[1] + dy * d*.9\n      ];\n      g = [p0];\n      l = 0;\n    } else {\n      l += dl;\n      p0 = p;\n      g.push(p0);\n      i++;\n      p = geom[i];\n    }\n  }\n  geoms.push(g);\n  return geoms;\n}\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * A marker style to use with font symbols.\n *\n * @constructor\n * @param {} options Options.\n *  @param {number} options.glyph the glyph name or a char to display as symbol. \n * \t\tThe name must be added using the {@link ol.style.FontSymbol.addDefs} function.\n *  @param {string} options.form \n * \t\tnone|circle|poi|bubble|marker|coma|shield|blazon|bookmark|hexagon|diamond|triangle|sign|ban|lozenge|square\n * \t\ta form that will enclose the glyph, default none\n *  @param {number} options.radius\n *  @param {number} options.rotation\n *  @param {number} options.rotateWithView\n *  @param {number} options.opacity\n *  @param {number} options.fontSize, default 1\n *  @param {string} options.fontStyle the font style (bold, italic, bold italic, etc), default none\n *  @param {boolean} options.gradient true to display a gradient on the symbol\n *  @param {_ol_style_Fill_} options.fill\n *  @param {_ol_style_Stroke_} options.stroke\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.FontSymbol = function(options)\n{\toptions = options || {};\n\tvar strokeWidth = 0;\n\tif (options.stroke) strokeWidth = options.stroke.getWidth();\n\tol.style.RegularShape.call (this,{ radius: options.radius, fill:options.fill,\n\t\t\t\t\t\t\t\t\trotation:options.rotation, rotateWithView: options.rotateWithView });\n\tif (typeof(options.opacity)==\"number\") this.setOpacity(options.opacity);\n\tthis.color_ = options.color;\n\tthis.fontSize_ = options.fontSize || 1;\n\tthis.fontStyle_ = options.fontStyle || '';\n\tthis.stroke_ = options.stroke;\n\tthis.fill_ = options.fill;\n\tthis.radius_ = options.radius -strokeWidth;\n\tthis.form_ = options.form || \"none\";\n\tthis.gradient_ = options.gradient;\n\tthis.offset_ = [options.offsetX ? options.offsetX :0, options.offsetY ? options.offsetY :0];\n\tthis.glyph_ = this.getGlyph(options.glyph) || \"\";\n\tthis.renderMarker_();\n};\nol.ext.inherits(ol.style.FontSymbol, ol.style.RegularShape);\n/** Cool stuff to get the image symbol for a style\n*/\nol.style.Image.prototype.getImagePNG = function()\n{\tvar canvas = this.getImage();\n\tif (canvas) \n\t{\ttry { return canvas.toDataURL(\"image/png\"); }\n\t\tcatch(e) { return false; }\n\t}\n\telse return false;\n}\n/** \n *\tFont defs\n */\nol.style.FontSymbol.prototype.defs = { 'fonts':{}, 'glyphs':{} };\n/** Static function : add new font defs \n * @param {String|Object} font the font desciption\n * @param {} glyphs a key / value list of glyph definitions. \n * \t\tEach key is the name of the glyph, \n * \t\tthe value is an object that code the font, the caracter code, \n * \t\tthe name and a search string for the glyph.\n */\n ol.style.FontSymbol.addDefs = function(font, glyphs)\n {\tvar thefont = font;\n\tif (typeof(font) == \"string\") thefont = {\"font\":font, \"name\":font, \"copyright\":\"\" };\n\tif (!thefont.font || typeof(thefont.font) != \"string\") \n\t{\tconsole.log(\"bad font def\");\n\t\treturn;\n\t}\n\tvar fontname = thefont.font;\n\tol.style.FontSymbol.prototype.defs.fonts[fontname] = thefont;\n\tfor (var i in glyphs)\n\t{\tvar g = glyphs[i];\n\t\tif (typeof(g) == \"string\" && g.length==1) g = { char: g };\n\t\tol.style.FontSymbol.prototype.defs.glyphs[i] =\n\t\t\t{\tfont: thefont.font,\n\t\t\t\tchar: g.char || \"\"+String.fromCharCode(g.code) || \"\",\n\t\t\t\ttheme: g.theme || thefont.name,\n\t\t\t\tname: g.name || i,\n\t\t\t\tsearch: g.search || \"\"\n\t\t\t};\n\t}\n };\n/**\n * Clones the style. \n * @return {ol.style.FontSymbol}\n */\nol.style.FontSymbol.prototype.clone = function()\n{\tvar g = new ol.style.FontSymbol(\n\t{\tglyph: \"\",\n\t\tcolor: this.color_,\n\t\tfontSize: this.fontSize_,\n\t\tfontStyle: this.fontStyle_,\n\t\tstroke: this.stroke_,\n\t\tfill: this.fill_,\n\t\tradius: this.radius_ + (this.stroke_ ? this.stroke_.getWidth():0),\n\t\tform: this.form_,\n\t\tgradient: this.gradient_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1],\n\t\topacity: this.getOpacity(),\n\t\trotation: this.getRotation(),\n\t\trotateWithView: this.getRotateWithView()\n\t});\n\tg.setScale(this.getScale());\n\tg.glyph_ = this.glyph_;\n\tg.renderMarker_();\n\treturn g;\n};\n/**\n * Get the fill style for the symbol.\n * @return {ol.style.Fill} Fill style.\n * @api\n */\nol.style.FontSymbol.prototype.getFill = function() {\n  return this.fill_;\n};\n/**\n * Get the stroke style for the symbol.\n * @return {_ol_style_Stroke_} Stroke style.\n * @api\n */\nol.style.FontSymbol.prototype.getStroke = function() {\n  return this.stroke_;\n};\n/**\n * Get the glyph definition for the symbol.\n * @param {string|undefined} name a glyph name to get the definition, default return the glyph definition for the style.\n * @return {_ol_style_Stroke_} Stroke style.\n * @api\n */\nol.style.FontSymbol.prototype.getGlyph = function(name)\n{\tif (name) return ol.style.FontSymbol.prototype.defs.glyphs[name] || { \"font\":\"none\",\"char\":name.charAt(0),\"theme\":\"none\",\"name\":\"none\", \"search\":\"\"};\n\telse return this.glyph_;\n};\n/**\n * Get the glyph name.\n * @return {string} the name\n * @api\n */\nol.style.FontSymbol.prototype.getGlyphName = function()\n{\tfor (var i in ol.style.FontSymbol.prototype.defs.glyphs)\n\t{\tif (ol.style.FontSymbol.prototype.defs.glyphs[i] === this.glyph_) return i;\n\t}\n\treturn \"\";\n};\n/**\n * Get the stroke style for the symbol.\n * @return {_ol_style_Stroke_} Stroke style.\n * @api\n */\nol.style.FontSymbol.prototype.getFontInfo = function(glyph)\n{\treturn ol.style.FontSymbol.prototype.defs.fonts[glyph.font];\n}\n/** @private\n */\nol.style.FontSymbol.prototype.renderMarker_ = function()\n{\n\tvar strokeStyle;\n\tvar strokeWidth = 0;\n\tif (this.stroke_) \n\t{\tstrokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tstrokeWidth = this.stroke_.getWidth();\n\t}\n\t// no atlas manager is used, create a new canvas\n\tvar canvas = this.getImage();\n\t//console.log(this.getImage().width+\" / \"+(2 * (this.radius_ + strokeWidth) + 1));\n\t/** @type {ol.style.FontSymbol.RenderOptions} */\n\tvar renderOptions = {\n\t\tstrokeStyle: strokeStyle,\n\t\tstrokeWidth: strokeWidth,\n\t\tsize: canvas.width,\n\t};\n\t// draw the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tthis.drawMarker_(renderOptions, context, 0, 0);\n\t// Set Anchor\n\tvar a = this.getAnchor();\n\ta[0] = canvas.width / 2 - this.offset_[0];\n\ta[1] = canvas.width / 2 - this.offset_[1];\n\t//this.createMarkerHitDetectionCanvas_(renderOptions);\n};\n/**\n * @private\n * @param {ol.style.FontSymbol.RenderOptions} renderOptions\n * @param {CanvasRenderingContext2D} context\n */\nol.style.FontSymbol.prototype.drawPath_ = function(renderOptions, context)\n{\n\tvar s = 2*this.radius_+renderOptions.strokeWidth+1;\n\tvar w = renderOptions.strokeWidth/2;\n\tvar c = renderOptions.size / 2;\n\t// Transfo to place the glyph at the right place\n\tvar transfo = { fac:1, posX:renderOptions.size / 2, posY:renderOptions.size / 2 };\n\tcontext.lineJoin = 'round';\n\tcontext.beginPath();\n\t// Draw the path with the form\n\tswitch (this.form_)\n\t{\tcase \"none\": transfo.fac=1;  break;\n\t\tcase \"circle\":\n\t\tcase \"ban\":\n\t\t\tcontext.arc ( c, c, s/2, 0, 2 * Math.PI, true);\n\t\t\tbreak;\n\t\tcase \"poi\":\n\t\t\tcontext.arc ( c, c -0.4*this.radius_, 0.6*this.radius_, 0.15*Math.PI, 0.85*Math.PI, true);\n\t\t\tcontext.lineTo ( c-0.89*0.05*s, (0.95+0.45*0.05)*s+w);\n\t\t\tcontext.arc ( c, 0.95*s+w, 0.05*s, 0.85*Math.PI, 0.15*Math.PI, true);\n\t\t\ttransfo = { fac:0.45, posX:c, posY:c -0.35*this.radius_ };\n\t\t\tbreak;\n\t\tcase \"bubble\":\n\t\t\tcontext.arc ( c, c -0.2*this.radius_, 0.8*this.radius_, 0.4*Math.PI, 0.6*Math.PI, true);\n\t\t\tcontext.lineTo ( 0.5*s+w, s+w);\n\t\t\ttransfo = { fac:0.7, posX:c, posY:c -0.2*this.radius_ };\n\t\t\tbreak;\n\t\tcase \"marker\":\n\t\t\tcontext.arc ( c, c -0.2*this.radius_, 0.8*this.radius_, 0.25*Math.PI, 0.75*Math.PI, true);\n\t\t\tcontext.lineTo ( 0.5*s+w, s+w);\n\t\t\ttransfo = { fac:0.7, posX: c, posY: c -0.2*this.radius_ };\n\t\t\tbreak;\n\t\tcase \"coma\":\n\t\t/*\n\t\t\tcontext.arc( renderOptions.size / 2, renderOptions.size / 2 +0.2*this.radius_, 0.8*this.radius_, 0.5*Math.PI, 0, true);\n\t\t\tcontext.arc( renderOptions.size / 2, renderOptions.size / 2 -0.2*this.radius_, 0.8*this.radius_, 0, 0.5*Math.PI, true);\n\t\t*/\n\t\t\tcontext.moveTo ( c + 0.8*this.radius_, c -0.2*this.radius_);\n\t\t\tcontext.quadraticCurveTo ( 0.95*s+w, 0.75*s+w, 0.5*s+w, s+w);\n\t\t\tcontext.arc ( c, c -0.2*this.radius_, 0.8*this.radius_, 0.45*Math.PI, 0, false);\n\t\t\ttransfo = { fac:0.7, posX: c, posY: c -0.2*this.radius_ };\n\t\t\tbreak;\n\t\tdefault:\n\t\t{\tvar pts;\n\t\t\tswitch (this.form_)\n\t\t\t{\tcase \"shield\": \n\t\t\t\t\tpts = [ 0.05,0, 0.95,0, 0.95,0.8, 0.5,1, 0.05,0.8, 0.05,0 ]; \n\t\t\t\t\ttransfo.posY = 0.45*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"blazon\": \n\t\t\t\t\tpts = [ 0.1,0, 0.9,0, 0.9,0.8, 0.6,0.8, 0.5,1, 0.4,0.8, 0.1,0.8, 0.1,0 ]; \n\t\t\t\t\ttransfo.fac = 0.8;\n\t\t\t\t\ttransfo.posY = 0.4*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"bookmark\": \n\t\t\t\t\tpts = [ 0.05,0, 0.95,0, 0.95,1, 0.5,0.8, 0.05,1, 0.05,0 ]; \n\t\t\t\t\ttransfo.fac = 0.9;\n\t\t\t\t\ttransfo.posY = 0.4*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hexagon\": \n\t\t\t\t\tpts = [ 0.05,0.2, 0.5,0, 0.95,0.2, 0.95,0.8, 0.5,1, 0.05,0.8, 0.05,0.2 ]; \n\t\t\t\t\ttransfo.fac = 0.9;\n\t\t\t\t\ttransfo.posY = 0.5*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"diamond\": \n\t\t\t\t\tpts = [ 0.25,0, 0.75,0, 1,0.2, 1,0.4, 0.5,1, 0,0.4, 0,0.2, 0.25,0 ]; \n\t\t\t\t\ttransfo.fac = 0.75 ;\n\t\t\t\t\ttransfo.posY = 0.35*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"triangle\": \n\t\t\t\t\tpts = [ 0,0, 1,0, 0.5,1, 0,0 ]; \n\t\t\t\t\ttransfo.fac = 0.6 ;\n\t\t\t\t\ttransfo.posY = 0.3*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sign\": \n\t\t\t\t\tpts = [ 0.5,0.05, 1,0.95, 0,0.95, 0.5,0.05 ]; \n\t\t\t\t\ttransfo.fac = 0.7 ;\n\t\t\t\t\ttransfo.posY = 0.65*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"lozenge\": \n\t\t\t\t\tpts = [ 0.5,0, 1,0.5, 0.5,1, 0,0.5, 0.5,0 ]; \n\t\t\t\t\ttransfo.fac = 0.7;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"square\": \n\t\t\t\tdefault: \n\t\t\t\t\tpts = [ 0,0, 1,0, 1,1, 0,1, 0,0 ]; break;\n\t\t\t}\n\t\t\tfor (var i=0; i<pts.length; i+=2) context.lineTo ( pts[i]*s+w, pts[i+1]*s+w);\n\t\t}\n\t}\n\tcontext.closePath();\n\treturn transfo;\n}\n/**\n * @private\n * @param {ol.style.FontSymbol.RenderOptions} renderOptions\n * @param {CanvasRenderingContext2D} context\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nol.style.FontSymbol.prototype.drawMarker_ = function(renderOptions, context, x, y)\n{\tvar fcolor = this.fill_ ? this.fill_.getColor() : \"#000\";\n\tvar scolor = this.stroke_ ? this.stroke_.getColor() : \"#000\";\n\tif (this.form_ == \"none\" && this.stroke_ && this.fill_)\n\t{\tscolor = this.fill_.getColor();\n\t\tfcolor = this.stroke_.getColor();\n\t}\n\t// reset transform\n\tcontext.setTransform(1, 0, 0, 1, 0, 0);\n\t// then move to (x, y)\n\tcontext.translate(x, y);\n\tvar tr = this.drawPath_(renderOptions, context);\n\tif (this.fill_) \n\t{\tif (this.gradient_ && this.form_!=\"none\")\n\t\t{\tvar grd = context.createLinearGradient(0,0,renderOptions.size/2,renderOptions.size);\n\t\t\tgrd.addColorStop (1, ol.color.asString(fcolor));\n\t\t\tgrd.addColorStop (0, ol.color.asString(scolor));\n\t\t\tcontext.fillStyle = grd;\n\t\t}\n\t\telse context.fillStyle = ol.color.asString(fcolor);\n\t\tcontext.fill();\n\t}\n\tif (this.stroke_ && renderOptions.strokeWidth) {\n\t\tcontext.strokeStyle = renderOptions.strokeStyle;\n\t\tcontext.lineWidth = renderOptions.strokeWidth;\n\t\tcontext.stroke();\n\t}\n\t// Draw the symbol\n\tif (this.glyph_.char)\n\t{\tcontext.font = this.fontStyle_ +' '\n\t\t\t\t+ (2*tr.fac*(this.radius_)*this.fontSize_)+\"px \"\n\t\t\t\t+ this.glyph_.font;\n\t\tcontext.strokeStyle = context.fillStyle;\n\t\tcontext.lineWidth = renderOptions.strokeWidth * (this.form_ == \"none\" ? 2:1);\n\t\tcontext.fillStyle = ol.color.asString(this.color_ || scolor);\n\t\tcontext.textAlign = \"center\";\n\t\tcontext.textBaseline = \"middle\";\n\t\tvar t = this.glyph_.char;\n\t\tif (renderOptions.strokeWidth && scolor!=\"transparent\") context.strokeText(t, tr.posX, tr.posY);\n\t\tcontext.fillText(t, tr.posX, tr.posY);\n\t}\n\tif (this.form_==\"ban\" && this.stroke_ && renderOptions.strokeWidth) \n\t{\tcontext.strokeStyle = renderOptions.strokeStyle;\n\t\tcontext.lineWidth = renderOptions.strokeWidth;\n\t\tvar r = this.radius_ + renderOptions.strokeWidth;\n\t\tvar d = this.radius_ * Math.cos(Math.PI/4);\n\t\tcontext.moveTo(r + d, r - d);\n\t\tcontext.lineTo(r - d, r + d);\n\t\tcontext.stroke();\n\t}\n};\n/**\n * @inheritDoc\n */\nol.style.FontSymbol.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.form_+\"-\"+this.glyphs_ != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.form_+\"-\"+this.glyphs_;\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.form_+\"-\"+this.glyphs_];\n\t}\n\treturn this.checksums_[0];\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*\n*  Photo style for vector features\n*/\n/**\n * @requires ol.style.RegularShape\n * @requires ol.structs.IHasChecksum\n */\n/**\n * @classdesc\n * Set Photo style for vector features.\n *\n * @constructor\n * @param {} options\n *  @param { default | square | round | anchored | folio } options.kind\n *  @param {boolean} options.crop crop within square, default is false\n *  @param {Number} options.radius symbol size\n *  @param {boolean} options.shadow drop a shadow\n *  @param {ol.style.Stroke} options.stroke\n *  @param {String} options.src image src\n *  @param {String} options.crossOrigin The crossOrigin attribute for loaded images. Note that you must provide a crossOrigin value if you want to access pixel data with the Canvas renderer.\n *  @param {Number} options.offsetX Horizontal offset in pixels. Default is 0.\n *  @param {Number} options.offsetY Vertical offset in pixels. Default is 0.\n *  @param {function} options.onload callback when image is loaded (to redraw the layer)\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.Photo = function(options)\n{\toptions = options || {};\n\tthis.sanchor_ = options.kind==\"anchored\" ? 8:0;\n\tthis.shadow_ = Number(options.shadow) || 0;\n\tif (!options.stroke) \n\t{\toptions.stroke = new ol.style.Stroke({ width: 0, color: \"#000\"})\n\t}\n\tvar strokeWidth = options.stroke.getWidth();\n\tif (strokeWidth<0) strokeWidth = 0;\n\tif (options.kind=='folio') strokeWidth += 6;\n\toptions.stroke.setWidth(strokeWidth);\n\tol.style.RegularShape.call (this,\n\t{\tradius: options.radius + strokeWidth + this.sanchor_/2 + this.shadow_/2, \n\t\tpoints:0\n\t//\tfill:new ol.style.Fill({color:\"red\"}) // No fill to create a hit detection Image\n\t});\n\t// Hack to get the hit detection Image (no API exported)\n\tif (!this.hitDetectionCanvas_)\n\t{\tvar img = this.getImage();\n\t\tfor (var i in this)\n\t\t{\tif (this[i] && this[i].getContext && this[i]!==img)\n\t\t\t{\tthis.hitDetectionCanvas_ = this[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tthis.stroke_ = options.stroke;\n\tthis.fill_ = options.fill;\n\tthis.crop_ = options.crop;\n\tthis.crossOrigin_ = options.crossOrigin;\n\tthis.kind_ = options.kind || \"default\";\n\tthis.radius_ = options.radius;\n\tthis.src_ = options.src;\n\tthis.offset_ = [options.offsetX ? options.offsetX :0, options.offsetY ? options.offsetY :0];\n\tthis.onload_ = options.onload;\n\tif (typeof(options.opacity)=='number') this.setOpacity(options.opacity);\n\tif (typeof(options.rotation)=='number') this.setRotation(options.rotation);\n\tthis.renderPhoto_();\n};\nol.ext.inherits(ol.style.Photo, ol.style.RegularShape);\n/**\n * Clones the style. \n * @return {ol.style.Photo}\n */\nol.style.Photo.prototype.clone = function()\n{\treturn new ol.style.Photo(\n\t{\tstroke: this.stroke_,\n\t\tfill: this.fill_,\n\t\tshadow: this.shadow_,\n\t\tcrop: this.crop_,\n\t\tcrossOrigin: this.crossOrigin_,\n\t\tkind: this.kind_,\n\t\tradius: this.radius_,\n\t\tsrc: this.src_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1],\n\t\topacity: this.getOpacity(),\n\t\trotation: this.getRotation()\n\t});\n};\n/**\n * Draws a rounded rectangle using the current state of the canvas. \n * Draw a rectangle if the radius is null.\n * @param {Number} x The top left x coordinate\n * @param {Number} y The top left y coordinate \n * @param {Number} width The width of the rectangle \n * @param {Number} height The height of the rectangle\n * @param {Number} radius The corner radius.\n */\nCanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) \n{\tif (!r) this.rect(x,y,w,h);\n\telse\n\t{\tif (w < 2 * r) r = w / 2;\n\t\tif (h < 2 * r) r = h / 2;\n\t\tthis.beginPath();\n\t\tthis.moveTo(x+r, y);\n\t\tthis.arcTo(x+w, y, x+w, y+h, r);\n\t\tthis.arcTo(x+w, y+h, x, y+h, r);\n\t\tthis.arcTo(x, y+h, x, y, r);\n\t\tthis.arcTo(x, y, x+w, y, r);\n\t\tthis.closePath();\n\t}\n\treturn this;\n}\n/**\n * Draw the form without the image\n * @private\n */\nol.style.Photo.prototype.drawBack_ = function(context, color, strokeWidth)\n{\tvar canvas = context.canvas;\n\tcontext.beginPath();\n    context.fillStyle = color;\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tswitch (this.kind_)\n\t{\tcase 'square':\n\t\t\tcontext.rect(0,0,canvas.width-this.shadow_, canvas.height-this.shadow_);\n\t\t\tbreak;\n\t\tcase 'circle':\n\t\t\tcontext.arc(this.radius_+strokeWidth, this.radius_+strokeWidth, this.radius_+strokeWidth, 0, 2 * Math.PI, false);\n\t\t\tbreak;\n\t\tcase 'folio':\n\t\t\tvar offset = 6;\n\t\t\tstrokeWidth -= offset;\n\t\t\tcontext.strokeStyle = 'rgba(0,0,0,0.5)';\n\t\t\tvar w = canvas.width-this.shadow_-2*offset;\n\t\t\tvar a = Math.atan(6/w);\n\t\t\tcontext.save();\n\t\t\tcontext.rotate(-a);\n\t\t\tcontext.translate(-6,2);\n\t\t\tcontext.beginPath();\n\t\t\tcontext.rect(offset,offset,w,w);\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t\tcontext.restore();\n\t\t\tcontext.save();\n\t\t\tcontext.translate(6,-1);\n\t\t\tcontext.rotate(a);\n\t\t\tcontext.beginPath();\n\t\t\tcontext.rect(offset,offset,w,w);\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t\tcontext.restore();\n\t\t\tcontext.beginPath();\n\t\t\tcontext.rect(offset,offset,w,w);\n\t\t\tcontext.stroke();\n\t\t\tbreak;\n\t\tcase 'anchored':\n\t\t\tcontext.roundRect(this.sanchor_/2,0,canvas.width-this.sanchor_-this.shadow_, canvas.height-this.sanchor_-this.shadow_, strokeWidth);\n\t\t\tcontext.moveTo(canvas.width/2-this.sanchor_-this.shadow_/2,canvas.height-this.sanchor_-this.shadow_);\n\t\t\tcontext.lineTo(canvas.width/2+this.sanchor_-this.shadow_/2,canvas.height-this.sanchor_-this.shadow_);\n\t\t\tcontext.lineTo(canvas.width/2-this.shadow_/2,canvas.height-this.shadow_);break;\n\t\tdefault: /* roundrect */\n\t\t\tcontext.roundRect(0,0,canvas.width-this.shadow_, canvas.height-this.shadow_, strokeWidth);\n\t\t\tbreak;\n\t}\n\tcontext.closePath();\n}\n/**\n * @private\n */\nol.style.Photo.prototype.renderPhoto_ = function()\n{\n\tvar strokeStyle;\n\tvar strokeWidth = 0;\n\tif (this.stroke_) \n\t{\tstrokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tstrokeWidth = this.stroke_.getWidth();\n\t}\n\tvar canvas = this.getImage();\n\t// Draw hitdetection image\n\tvar context = this.hitDetectionCanvas_.getContext('2d');\n\tthis.drawBack_(context,\"#000\",strokeWidth);\n    context.fill();\n\t// Draw the image\n\tcontext = canvas.getContext('2d');\n\tthis.drawBack_(context,strokeStyle,strokeWidth);\n\t// Draw a shadow\n\tif (this.shadow_)\n\t{\tcontext.shadowColor = 'rgba(0,0,0,0.5)';\n\t\tcontext.shadowBlur = this.shadow_/2;\n\t\tcontext.shadowOffsetX = this.shadow_/2;\n\t\tcontext.shadowOffsetY = this.shadow_/2;\n\t}\n    context.fill();\n\tcontext.shadowColor = 'transparent';\n\tvar self = this;\n\tvar img = this.img_ = new Image();\n\tif (this.crossOrigin_) img.crossOrigin = this.crossOrigin_;\n\timg.src = this.src_;\n\t// Draw image\n\tif (img.width) self.drawImage_(img);\n\telse img.onload = function()\n\t{\tself.drawImage_(img);\n\t\t// Force change (?!)\n\t\t// self.setScale(1);\n\t\tif (self.onload_) self.onload_();\n\t};\n\t// Set anchor\n\tvar a = this.getAnchor();\n\ta[0] = (canvas.width - this.shadow_)/2;\n\ta[1] = (canvas.height - this.shadow_)/2;\n\tif (this.sanchor_)\n\t{\ta[1] = canvas.height - this.shadow_;\n\t}\n}\n/**\n * Draw an timage when loaded\n * @private\n */\nol.style.Photo.prototype.drawImage_ = function(img)\n{\tvar canvas = this.getImage();\n\t// Remove the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tvar strokeWidth = 0;\n\tif (this.stroke_) strokeWidth = this.stroke_.getWidth();\n\tvar size = 2*this.radius_;\n\tcontext.save();\n\tif (this.kind_=='circle')\n\t{\tcontext.beginPath();\n\t\tcontext.arc(this.radius_+strokeWidth, this.radius_+strokeWidth, this.radius_, 0, 2 * Math.PI, false);\n\t\tcontext.clip();\n\t}\n\tvar s, x, y, w, h, sx, sy, sw, sh;\n\t// Crop the image to a square vignette\n\tif (this.crop_) \n\t{\ts = Math.min (img.width/size, img.height/size);\n\t\tsw = sh = s*size;\n\t\tsx = (img.width-sw)/2;\n\t\tsy = (img.height-sh)/2;\n\t\tx = y = 0;\n\t\tw = h = size+1;\n\t}\n\t// Fit the image to the size\n\telse \n\t{\ts = Math.min (size/img.width, size/img.height);\n\t\tsx = sy = 0;\n\t\tsw = img.width;\n\t\tsh = img.height;\n\t\tw = s*sw;\n\t\th = s*sh;\n\t\tx = (size-w)/2;\n\t\ty = (size-h)/2;\n\t}\n\tx += strokeWidth + this.sanchor_/2;\n\ty += strokeWidth;\n\tcontext.drawImage(img, sx, sy, sw, sh, x, y, w, h);\n\tcontext.restore();\n\t// Draw a circle to avoid aliasing on clip\n\tif (this.kind_=='circle' && strokeWidth)\n\t{\tcontext.beginPath();\n\t\tcontext.strokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tcontext.lineWidth = strokeWidth/4;\n\t\tcontext.arc(this.radius_+strokeWidth, this.radius_+strokeWidth, this.radius_, 0, 2 * Math.PI, false);\n\t\tcontext.stroke();\n\t}\n}\n/**\n * @inheritDoc\n */\nol.style.Photo.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-');\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_];\n\t}\n\treturn this.checksums_[0];\n};\n\n/** Add a setTextPath style to draw text along linestrings\n@toto letterpadding/spacing, wordpadding/spacing\n*/\n(function()\n{\n/** Internal drawing function called on postcompose\n* @param {ol.eventPoscompose} e postcompose event\n*/\nfunction drawTextPath (e)\n{\t// Prent drawing at large resolution\n\tif (e.frameState.viewState.resolution > this.textPathMaxResolution_) return;\n\tvar extent = e.frameState.extent;\n\tvar c2p = e.frameState.coordinateToPixelTransform;\n\t// Get pixel path with coordinates\n\tvar k;\n\tfunction getPath(c, readable)\n\t{\tvar path1 = [];\n\t\tfor (k=0; k<c.length; k++) \n\t\t{\tpath1.push(c2p[0]*c[k][0]+c2p[1]*c[k][1]+c2p[4]);\n\t\t\tpath1.push(c2p[2]*c[k][0]+c2p[3]*c[k][1]+c2p[5]);\n\t\t}\n\t\t// Revert line ?\n\t\tif (readable && path1[0]>path1[path1.length-2])\n\t\t{\tvar path2 = [];\n\t\t\tfor (k=path1.length-2; k>=0; k-=2)\n\t\t\t{\tpath2.push(path1[k]);\n\t\t\t\tpath2.push(path1[k+1]);\n\t\t\t}\n\t\t\treturn path2;\n\t\t}\n\t\telse return path1;\n\t}\n\tvar ctx = e.context;\n\tctx.save();\n\tctx.scale(e.frameState.pixelRatio,e.frameState.pixelRatio);\n\tvar features = this.getSource().getFeaturesInExtent(extent);\n\tfor (var i=0, f; f=features[i]; i++)\n\t{\t{\tvar style = this.textPathStyle_(f,e.frameState.viewState.resolution);\n\t\t\tfor (var s,j=0; s=style[j]; j++)\n\t\t\t{\t\n\t\t\t\tvar g = s.getGeometry() || f.getGeometry();\n\t\t\t\tvar c;\n\t\t\t\tswitch (g.getType())\n\t\t\t\t{\tcase \"LineString\": c = g.getCoordinates(); break;\n\t\t\t\t\tcase \"MultiLineString\": c = g.getLineString(0).getCoordinates(); break;\n\t\t\t\t\tdefault: continue;\n\t\t\t\t}\n\t\t\t\tvar st = s.getText();\n\t\t\t\tvar path = getPath(c, st.getRotateWithView() );\n\t\t\t\tctx.font = st.getFont();\n\t\t\t\tctx.textBaseline = st.getTextBaseline();\n\t\t\t\tctx.textAlign = st.getTextAlign();\n\t\t\t\tctx.lineWidth = st.getStroke() ? (st.getStroke().getWidth()||0) : 0;\n\t\t\t\tctx.strokeStyle = st.getStroke() ? (st.getStroke().getColor()||\"#fff\") : \"#fff\";\n\t\t\t\tctx.fillStyle = st.getFill() ? st.getFill().getColor()||\"#000\" : \"#000\";\n\t\t\t\t// New params\n\t\t\t\tctx.textJustify = st.getTextAlign()==\"justify\";\n\t\t\t\tctx.textOverflow = st.getTextOverflow ? st.getTextOverflow():\"\";\n\t\t\t\tctx.minWidth = st.getMinWidth ? st.getMinWidth():0;\n\t\t\t\t// Draw textpath\n\t\t\t\tctx.textPath(st.getText()||f.get(\"name\"), path);\n\t\t\t}\n\t\t}\n\t}\n\tctx.restore();\n}\n/** Set the style for features. \n*\tThis can be a single style object, an array of styles, or a function that takes a feature and resolution and \n*\treturns an array of styles. If it is undefined the default style is used. \n*\tIf it is null the layer has no style (a null style). \n*\tSee ol.style for information on the default style.\n*\t@param {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction} style\n*\t@param {Number} maxResolution to display text, default: 0\n*/\nol.layer.Vector.prototype.setTextPathStyle = function(style, maxResolution)\n{\n\t// Remove existing style\n\tif (style===null)\n\t{\tif (this.textPath_) this.unByKey(this.textPath_);\n\t\tthis.textPath_ = null;\n\t\tthis.changed();\n\t\treturn;\n\t}\n\t// New postcompose\n\tif (!this.textPath_)\n\t{\tthis.textPath_ = this.on(['postcompose','postrender'], drawTextPath.bind(this));\n\t}\n\t// Set textPathStyle\n\tif (style===undefined)\n\t{\tstyle = [ new ol.style.Style({ text: new ol.style.Text()}) ];\n\t}\n\tif (typeof(style) == \"function\") this.textPathStyle_ = style;\n\telse this.textPathStyle_ = function() { return style; };\n\tthis.textPathMaxResolution_ = Number(maxResolution) || Number.MAX_VALUE;\n\t// Force redraw\n\tthis.changed();\n}\n/** Add new properties to ol.style.Text\n* to use with ol.layer.Vector.prototype.setTextPathStyle\n* @constructor\n* @param {} options\n*\t@param {visible|ellipsis|string} textOverflow\n*\t@param {number} minWidth minimum width (px) to draw text, default 0\n*/\nol.style.TextPath = function(options)\n{\tif (!options) options={};\n\tol.style.Text.call (this, options);\n\tthis.textOverflow_ = typeof(options.textOverflow)!=\"undefined\" ?  options.textOverflow : \"visible\";\n\tthis.minWidth_ = options.minWidth || 0;\n}\nol.ext.inherits(ol.style.TextPath, ol.style.Text);\nol.style.TextPath.prototype.getTextOverflow = function()\n{\treturn this.textOverflow_; \n};\nol.style.TextPath.prototype.getMinWidth = function()\n{\treturn this.minWidth_; \n};\n/**/\n})();\n/** CanvasRenderingContext2D: draw text along path\n* @param {string} text\n* @param {Array<Number>} path\n*/\nCanvasRenderingContext2D.prototype.textPath = function (text, path)\n{\n\tvar ctx = this;\n\tfunction dist2D(x1,y1,x2,y2)\n\t{\tvar dx = x2-x1;\n\t\tvar dy = y2-y1;\n\t\treturn Math.sqrt(dx*dx+dy*dy);\n\t}\n\tvar di, dpos=0;\n\tvar pos=2;\n\tfunction getPoint(path, dl)\n\t{\tif (!di || dpos+di<dl)\n\t\t{ for (; pos<path.length; )\n\t\t\t{\tdi = dist2D(path[pos-2],path[pos-1],path[pos],path[pos+1]);\n\t\t\t\tif (dpos+di>dl) break;\n\t\t\t\tpos += 2;\n\t\t\t\tif (pos>=path.length) break;\n\t\t\t\tdpos += di;\n\t\t\t}\n\t\t}\n\t\tvar x, y, a, dt = dl-dpos;\n\t\tif (pos>=path.length) \n\t\t{\tpos = path.length-2;\n\t\t}\n\t\tif (!dt) \n\t\t{\tx = path[pos-2];\n\t\t\ty = path[pos-1];\n\t\t\ta = Math.atan2(path[pos+1]-path[pos-1], path[pos]-path[pos-2]);\n\t\t}\n\t\telse\n\t\t{\tx = path[pos-2]+ (path[pos]-path[pos-2])*dt/di;\n\t\t\ty = path[pos-1]+(path[pos+1]-path[pos-1])*dt/di;\n\t\t\ta = Math.atan2(path[pos+1]-path[pos-1], path[pos]-path[pos-2]);\n\t\t}\n\t\treturn [x,y,a];\n\t}\n\tvar letterPadding = ctx.measureText(\" \").width *0.25;\n\tvar start = 0;\n\tvar d = 0;\n\tfor (var i=2; i<path.length; i+=2)\n\t{\td += dist2D(path[i-2],path[i-1],path[i],path[i+1])\n\t}\n\tif (d < ctx.minWidth) return;\n\tvar nbspace = text.split(\" \").length -1;\n\t// Remove char for overflow\n\tif (ctx.textOverflow != \"visible\")\n\t{\tif (d < ctx.measureText(text).width + (text.length-1 + nbspace) * letterPadding)\n\t\t{\tvar overflow = (ctx.textOverflow==\"ellipsis\") ? '\\u2026' : ctx.textOverflow;\n\t\t\tdo\n\t\t\t{\tnbspace = text.split(\" \").length -1;\n\t\t\t\ttext = text.slice(0,text.length-1);\n\t\t\t} while (text && d < ctx.measureText(text+overflow).width + (text.length + overflow.length-1 + nbspace) * letterPadding)\n\t\t\ttext += overflow;\n\t\t}\n\t}\n\tswitch (ctx.textJustify || ctx.textAlign)\n\t{\tcase true: // justify\n\t\tcase \"center\":\n\t\tcase \"end\":\n\t\tcase \"right\":\n\t\t{\t// Text align\n\t\t\tif (ctx.textJustify) \n\t\t\t{\tstart = 0;\n\t\t\t\tletterPadding = (d - ctx.measureText(text).width) / (text.length-1 + nbspace);\n\t\t\t}\n\t\t\telse\n\t\t\t{\tstart = d - ctx.measureText(text).width - (text.length + nbspace) * letterPadding;\n\t\t\t\tif (ctx.textAlign == \"center\") start /= 2;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n\tfor (var t=0; t<text.length; t++)\n\t{\tvar letter = text[t];\n\t\tvar wl = ctx.measureText(letter).width;\n\t\tvar p = getPoint(path, start+wl/2);\n\t\tctx.save();\n\t\tctx.textAlign = \"center\";\n\t\tctx.translate(p[0], p[1]);\n\t\tctx.rotate(p[2]);\n\t\tif (ctx.lineWidth) ctx.strokeText(letter,0,0);\n\t\tctx.fillText(letter,0,0);\n\t\tctx.restore();\n\t\tstart += wl+letterPadding*(letter==\" \"?2:1);\n\t}\n};\n//NB: (Not confirmed)To use this module, you just have to :\n//   import('ol-ext/layer/getpreview')\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*\n*  Shadow image style for point vector features\n*/\n/**\n * @requires ol.style.Circle\n * @requires ol.structs.IHasChecksum\n */\n/**\n * @classdesc\n * Set Shadow style for point vector features.\n *\n * @constructor\n * @param {} options Options.\n *   @param {ol.style.Fill | undefined} options.fill fill style, default rgba(0,0,0,0.5)\n *   @param {number} options.radius point radius\n * \t @param {number} options.blur lur radius, default radius/3\n * \t @param {number} options.offsetX x offset, default 0\n * \t @param {number} options.offsetY y offset, default 0\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.Shadow = function(options)\n{\toptions = options || {};\n\tif (!options.fill) options.fill = new ol.style.Fill({ color: \"rgba(0,0,0,0.5)\" });\n\tol.style.RegularShape.call (this,{ radius: options.radius, fill: options.fill });\n\tthis.fill_ = options.fill;\n\tthis.radius_ = options.radius;\n\tthis.blur_ = options.blur===0 ? 0 : options.blur || options.radius/3;\n\tthis.offset_ = [options.offsetX ? options.offsetX : 0, options.offsetY ? options.offsetY : 0];\n\tthis.renderShadow_();\n};\nol.ext.inherits(ol.style.Shadow, ol.style.RegularShape);\n/**\n * Clones the style. \n * @return {ol.style.Shadow}\n */\nol.style.Shadow.prototype.clone = function()\n{\tvar s = new ol.style.Shadow(\n\t{\tfill: this.fill_,\n\t\tradius: this.radius_,\n\t\tblur: this.blur_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1]\n\t});\n\ts.setScale(this.getScale());\n\ts.setOpacity(this.getOpacity());\n\treturn s;\n};\n/**\n * @private\n */\nol.style.Shadow.prototype.renderShadow_ = function()\n{\t\n\tvar radius = this.radius_;\n\tvar canvas = this.getImage();\n\tvar s = [canvas.width, canvas.height];\n\ts[1] = radius;\n\t// Remove the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tcontext.beginPath();\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tcontext.scale(1,0.5);\n\tcontext.arc(radius, -radius, radius-this.blur_, 0, 2 * Math.PI, false);\n    context.fillStyle = '#000';\n\tcontext.shadowColor = this.fill_.getColor();\n\tcontext.shadowBlur = 0.7*this.blur_;\n\tcontext.shadowOffsetX = 0;\n\tcontext.shadowOffsetY = 1.5*radius;\n\tcontext.closePath();\n    context.fill();\n\tcontext.shadowColor = 'transparent';\n\t// Set anchor\n\tvar a = this.getAnchor();\n\ta[0] = canvas.width /2 -this.offset_[0];\n\ta[1] = canvas.height/2 -this.offset_[1];\n}\n/**\n * @inheritDoc\n */\nol.style.Shadow.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.form_+\"-\"+this.glyphs_ != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.form_+\"-\"+this.glyphs_;\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.form_+\"-\"+this.glyphs_];\n\t}\n\treturn this.checksums_[0];\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * Stroke style with named pattern\n *\n * @constructor\n * @param {any}  options\n *\t@param {ol.style.Image|undefined} options.image an image pattern, image must be preloaded to draw on first call\n *\t@param {number|undefined} options.opacity opacity with image pattern, default:1\n *\t@param {olx.style.fillPattern} options.pattern pattern name (override by image option)\n *\t@param {ol.colorLike} options.color pattern color\n *\t@param {ol.style.Fill} options.fill fill color (background)\n *\t@param {number} options.offset pattern offset for hash/dot/circle/cross pattern\n *\t@param {number} options.size line size for hash/dot/circle/cross pattern\n *\t@param {number} options.spacing spacing for hash/dot/circle/cross pattern\n *\t@param {number|bool} options.angle angle for hash pattern / true for 45deg dot/circle/cross\n *\t@param {number} options.scale pattern scale \n * @extends {ol.style.Fill}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.StrokePattern = function(options)\n{\tif (!options) options = {};\n\tvar pattern, i;\n\tvar canvas = this.canvas_ = document.createElement('canvas');\n\tvar scale = Number(options.scale)>0 ? Number(options.scale) : 1;\n\tvar ratio = scale*ol.has.DEVICE_PIXEL_RATIO || ol.has.DEVICE_PIXEL_RATIO;\n\tvar ctx = canvas.getContext('2d');\n\tif (options.image)\n\t{\toptions.image.load();\n\t\tvar img = options.image.getImage();\n\t\tif (img.width)\n\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t}\n\t\telse \n\t\t{\tvar self = this;\n\t\t\tpattern = [0,0,0,0];\n\t\t\timg.onload = function ()\n\t\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t\tself.setColor(pattern);\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\tvar pat = this.getPattern_(options);\n\t\tcanvas.width = Math.round(pat.width *ratio);\n\t\tcanvas.height = Math.round(pat.height *ratio);\n\t\tctx.beginPath();\n\t\tif (options.fill) \n\t\t{\tctx.fillStyle = ol.color.asString(options.fill.getColor());\n\t\t\tctx.fillRect(0,0, canvas.width, canvas.height);\n\t\t}\n\t\tctx.scale(ratio,ratio);\n\t\tctx.lineCap = \"round\";\n\t\tctx.lineWidth = pat.stroke || 1;\n\t\tctx.fillStyle = ol.color.asString(options.color||\"#000\");\n\t\tctx.strokeStyle = ol.color.asString(options.color||\"#000\");\n\t\tif (pat.circles) for (i=0; i<pat.circles.length; i++)\n\t\t{\tvar ci = pat.circles[i]; \n\t\t\tctx.beginPath();\n\t\t\tctx.arc(ci[0], ci[1], ci[2], 0,2*Math.PI);\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t}\n\t\tif (!pat.repeat) pat.repeat=[[0,0]];\n\t\tif (pat.char)\n\t\t{\tctx.font = pat.font || (pat.width)+\"px Arial\";\n\t\t\tctx.textAlign = 'center';\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tif (pat.angle) \n\t\t\t{\tctx.fillText(pat.char, pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, 3*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, 3*pat.height/4);\n\t\t\t}\n\t\t\telse ctx.fillText(pat.char, pat.width/2, pat.height/2);\n\t\t}\n\t\tif (pat.lines) for (i=0; i<pat.lines.length; i++) for (var r=0; r<pat.repeat.length; r++)\n\t\t{\tvar li = pat.lines[i];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(li[0]+pat.repeat[r][0],li[1]+pat.repeat[r][1]);\n\t\t\tfor (var k=2; k<li.length; k+=2)\n\t\t\t{\tctx.lineTo(li[k]+pat.repeat[r][0],li[k+1]+pat.repeat[r][1]);\n\t\t\t}\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t\tctx.save()\n\t\t\tctx.strokeStyle = 'red';\n\t\t\tctx.strokeWidth = 0.1;\n\t\t\t//ctx.strokeRect(0,0,canvas.width,canvas.height);\n\t\t\tctx.restore()\n\t\t}\n\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\tif (options.offset)\n\t\t{\tvar offset = options.offset;\n\t\t\tif (typeof(offset) == \"number\") offset = [offset,offset];\n\t\t\tif (offset instanceof Array) \n\t\t\t{\tvar dx = Math.round((offset[0]*ratio));\n\t\t\t\tvar dy = Math.round((offset[1]*ratio));\n\t\t\t\t// New pattern\n\t\t\t\tctx.scale(1/ratio,1/ratio)\n\t\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\t\t\t\tctx.translate(dx,dy);\n\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\tctx.fillRect(-dx, -dy, canvas.width,canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t}\n\t\t}\n\t}\n\toptions.color = pattern;\n\tol.style.Stroke.call (this, options);\n};\nol.ext.inherits(ol.style.StrokePattern, ol.style.Stroke);\n/**\n * Clones the style. \n * @return {ol.style.StrokePattern}\n */\nol.style.StrokePattern.prototype.clone = function() {\n\tvar s = ol.style.Fill.prototype.clone.call(this);\n\ts.canvas_ = this.canvas_;\n\treturn s;\n};\n/** Get canvas used as pattern\n*\t@return {canvas}\n*/\nol.style.StrokePattern.prototype.getImage = function()\n{\treturn this.canvas_;\n}\n/** Get pattern\n*\t@param {olx.style.FillPatternOption}\n*/\nol.style.StrokePattern.prototype.getPattern_ = function(options)\n{\tvar pat = ol.style.FillPattern.prototype.patterns[options.pattern]\n\t\t|| ol.style.FillPattern.prototype.patterns.dot;\n\tvar d = Math.round(options.spacing)||10;\n\tvar size;\n//\tvar d2 = Math.round(d/2)+0.5;\n\tswitch (options.pattern)\n\t{\tcase 'dot':\n\t\tcase 'circle':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.circles = [[ d/2, d/2, size ]]\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/2+d, d/2, size ],\n\t\t\t\t\t\t[ d/2-d, d/2, size ],\n\t\t\t\t\t\t[ d/2, d/2+d, size ],\n\t\t\t\t\t\t[ d/2, d/2-d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2-d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2-d, size ] ])\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\td = pat.width = pat.height = Math.round(d*1.4);\n\t\t\t\tpat.circles = [[ d/4, d/4, size ], [ 3*d/4, 3*d/4, size ]];\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/4+d, d/4, size ],\n\t\t\t\t\t\t[ d/4, d/4+d, size ],\n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4, size ],\n\t\t\t\t\t\t[ 3*d/4, 3*d/4-d, size ],\n\t\t\t\t\t\t[ d/4+d, d/4+d, size ], \n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4-d, size ] ]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'tile':\n\t\tcase 'square':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.lines = [[ d/2-size, d/2-size, d/2+size, d/2-size, d/2+size, d/2+size, d/2-size,d/2+size, d/2-size, d/2-size ]]\n\t\t\t}\n\t\t\telse\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\t//size *= Math.sqrt(2);\n\t\t\t\tpat.lines = [[ d/2-size,d/2, d/2,d/2-size, d/2+size,d/2, d/2,d/2+size, d/2-size,d/2 ]]\n\t\t\t}\n\t\t\tif (options.pattern=='square') pat.repeat = [[0,0], [0,d], [d,0], [0,-d], [-d,0], [-d,-d], [d,d], [-d,d], [d,-d] ]\n\t\t\tbreak;\n\t\t}\n\t\tcase 'cross':\n\t\t{\t// Limit angle to 0 | 45\n\t\t\tif (options.angle) options.angle = 45;\n\t\t}\n\t\t// fallthrough\n\t\tcase 'hatch':\n\t\t{\tvar a = Math.round(((options.angle||0)-90)%360);\n\t\t\tif (a>180) a -= 360;\n\t\t\ta *= Math.PI/180;\n\t\t\tvar cos = Math.cos(a);\n\t\t\tvar sin = Math.sin(a);\n\t\t\tif (Math.abs(sin)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0,0.5, d, 0.5 ] ];\n\t\t\t\tpat.repeat = [ [0,0], [0,d] ];\n\t\t\t}\n\t\t\telse  if (Math.abs(cos)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0.5,0, 0.5, d] ];\n\t\t\t\tpat.repeat = [ [0,0], [d,0] ];\n\t\t\t\tif (options.pattern=='cross') \n\t\t\t\t{\tpat.lines.push ([ 0,0.5, d, 0.5 ]);\n\t\t\t\t\tpat.repeat.push([0,d]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\tvar w = pat.width = Math.round(Math.abs(d/sin)) || 1;\n\t\t\t\tvar h = pat.height = Math.round(Math.abs(d/cos)) || 1;\n\t\t\t\tif (options.pattern=='cross')\n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h], [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0] ];\n\t\t\t\t}\n\t\t\t\telse if (cos*sin>0) \n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\tpat.lines = [ [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [-w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tpat.stroke = options.size===0 ? 0 : options.size||4;\n\t\t\tbreak;\n\t\t}\n\t\tdefault: {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn pat\n}\n"]}